window.__require=function e(t,a,n){function o(l,r){if(!a[l]){if(!t[l]){var s=l.split("/");if(s=s[s.length-1],!t[s]){var c="function"==typeof __require&&__require;if(!r&&c)return c(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+l+"'")}l=s}var p=a[l]={exports:{}};t[l][0].call(p.exports,function(e){return o(t[l][1][e]||e)},p,p.exports,e,t,a,n)}return a[l].exports}for(var i="function"==typeof __require&&__require,l=0;l<n.length;l++)o(n[l]);return o}({0:[function(e,t){"use strict";function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"2e0095voMxFDYUkJZ6CKXce","0");var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};window.__extends=window.__extends||function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},window.__assign=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},window.__rest=window.__rest||function(e,t){var a={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(a[n[o]]=e[n[o]])}return a},window.__decorate=window.__decorate||function(e,t,n,o){var i,l=arguments.length,r=l<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(r=(l<3?i(r):l>3?i(t,n,r):i(t,n))||r);return l>3&&r&&Object.defineProperty(t,n,r),r},window.__param=window.__param||function(e,t){return function(a,n){t(a,n,e)}},window.__metadata=window.__metadata||function(e,t){if("object"==("undefined"==typeof Reflect?"undefined":a(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},window.__awaiter=window.__awaiter||function(e,t,a,n){return new(a||(a=Promise))(function(o,i){function l(e){try{s(n.next(e))}catch(t){i(t)}}function r(e){try{s(n.throw(e))}catch(t){i(t)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(l,r)}s((n=n.apply(e,t||[])).next())})},window.__generator=window.__generator||function(e,t){var a,n,o,i,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function r(e){return function(t){return s([e,t])}}function s(i){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(o=(o=l.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(r){i=[6,r],n=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}},window.__exportStar=window.__exportStar||function(e,t){for(var a in e)"default"===a||Object.prototype.hasOwnProperty.call(t,a)||__createBinding(t,e,a)},window.__createBinding=window.__createBinding||(Object.create?function(e,t,a,n){void 0===n&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){void 0===n&&(n=a),e[n]=t[a]}),window.__values=window.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,a=t&&e[t],n=0;if(a)return a.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},window.__read=window.__read||function(e,t){var a="function"==typeof Symbol&&e[Symbol.iterator];if(!a)return e;var n,o,i=a.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)l.push(n.value)}catch(r){o={error:r}}finally{try{n&&!n.done&&(a=i.return)&&a.call(i)}finally{if(o)throw o.error}}return l},window.__spread=window.__spread||function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},window.__spreadArrays=window.__spreadArrays||function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<a;t++)for(var i=arguments[t],l=0,r=i.length;l<r;l++,o++)n[o]=i[l];return n},window.__await=window.__await||function(e){return this instanceof __await?(this.v=e,this):new __await(e)},window.__asyncGenerator=window.__asyncGenerator||function(e,t,a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=a.apply(e,t||[]),i=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(e){o[e]&&(n[e]=function(t){return new Promise(function(a,n){i.push([e,t,a,n])>1||r(e,t)})})}function r(e,t){try{(a=o[e](t)).value instanceof __await?Promise.resolve(a.value.v).then(s,c):p(i[0][2],a)}catch(n){p(i[0][3],n)}var a}function s(e){r("next",e)}function c(e){r("throw",e)}function p(e,t){e(t),i.shift(),i.length&&r(i[0][0],i[0][1])}},window.__asyncDelegator=window.__asyncDelegator||function(e){var t,a;return t={},n("next"),n("throw",function(e){throw e}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(a=!a)?{value:__await(e[n](t)),done:"return"===n}:o?o(t):t}:o}},window.__asyncValues=window.__asyncValues||function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,a=e[Symbol.asyncIterator];return a?a.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(a){t[a]=e[a]&&function(t){return new Promise(function(n,i){o(n,i,(t=e[a](t)).done,t.value)})}}function o(e,t,a,n){Promise.resolve(n).then(function(t){e({value:t,done:a})},t)}},window.__makeTemplateObject=window.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};var o=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};window.__importStar=window.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.prototype.hasOwnProperty.call(e,a)&&__createBinding(t,e,a);return o(t,e),t},window.__importDefault=window.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},window.__classPrivateFieldGet=window.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},window.__classPrivateFieldSet=window.__classPrivateFieldSet||function(e,t,a){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,a),a},cc._RF.pop()},{}],AdManager:[function(e,t,a){"use strict";cc._RF.push(t,"ebc85sNI9lCyJWQyxaPSz5O","AdManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("GameCommon"),l=n("ShareManager"),r=n("MoreGameManager"),s=n("VideoManager"),c=(p.prototype.push=function(e){var t=this;this.tasks.push(new Promise(function(a){function n(){t.activeCount++;try{e().then(function(e){a(e)}).then(function(){t.next()}).catch(function(e){t.next(),console.error(e)})}catch(l){t.next(),console.error(l)}}t.activeCount<t.concurrency?n():t.queue.push(n)}))},p.prototype.all=function(){return Promise.all(this.tasks)},p.prototype.next=function(){this.activeCount--,0<this.queue.length&&this.queue.shift()()},p.prototype.addTask=function(e){this.push(function(){return new Promise(function(t){e(function(){t("")},function(){t("")})})})},p.addTask=function(e){null==this.instance&&(this.instance=new p),this.instance.addTask(e)},p.instance=null,p);function p(){this.concurrency=1,this.queue=[],this.tasks=[],this.activeCount=0}function d(){}o.BannerTaskManager=c,d.initVideoAd=function(){return null},d.showVideoAd=function(){},d.hasVideoAd=function(){return!1},d.initInterstitialAD=function(){var e=this;try{if(!i.GameCommon.isWechat()||"function"!=typeof wx.createInterstitialAd||null==i.GameConfig.interstitialAdUnitId)return;if(this.interstitialAd=wx.createInterstitialAd({adUnitId:i.GameConfig.interstitialAdUnitId}),!this.interstitialAd)return;this.interstitialAd.onLoad(function(){}),this.interstitialAd.onError(function(t){console.error("\u63d2\u5c4f\u5e7f\u544aonError",t.errMsg,t.errCode),e.interstitialAd=null}),this.interstitialAd.onClose(function(){e.interstitialCloseCall&&e.interstitialCloseCall(),e.interstitialCloseCall=null,console.error("\u5173\u95ed\u63d2\u5c4f\u5e7f\u544a")})}catch(e){console.error(e)}},d.showInterstitialAd=function(e,t){var a=this;if(l.ShareManager.getInterstitialAdControl()&&i.GameCommon.isWechat()&&!s.VideoManager.hasVideoAdShow())if(this.interstitialShowCall=e,this.interstitialCloseCall=t,null!=this.interstitialAd)try{this.interstitialAd.show().then(function(){a.interstitialShowCall&&a.interstitialShowCall(),a.interstitialShowCall=null}).catch(function(e){console.error(e)})}catch(e){console.error(e)}else this.initInterstitialAD()},d.loadBannerAd=function(e,t,a,n){void 0===n&&(n=null),this.bannerStyle={left:e,top:t,width:a},this.onResizeCall=n,this.bannerAdLoading||c.addTask(this.loadBannerAdTask.bind(this))},d.showBannerAd=function(){c.addTask(this.showBannerAdTask.bind(this))},d.showOldBannerAd=function(e,t,a,n){void 0===n&&(n=null),this.wxBannerAd&&l.ShareManager.getBannerAdControl()&&(this.bannerStyle={left:e,top:t,width:a},this.onResizeCall=n,this.bannerAdShow=!0,this.wxBannerAd.style.left=e,this.wxBannerAd.style.top=t,this.wxBannerAd.style.width=a,n&&n(this.wxBannerAd),this.showBannerAd())},d.loadAndShowBannerAd=function(e,t,a,n){void 0===n&&(n=null),this.bannerStyle={left:e,top:t,width:a},this.onResizeCall=n,this.bannerAdLoading||c.addTask(this.loadBannerAdTask.bind(this)),c.addTask(this.showBannerAdTask.bind(this))},d.hideBannerAd=function(){c.addTask(this.hideBannerAdTask.bind(this))},d.loadBannerAdTask=function(e,t){var a,n,o=this;this.bannerAdLoading?e&&e():(this.bannerAdLoading=!0,a=wx.createBannerAd({adUnitId:i.GameConfig.bannerAdUnitId,style:this.bannerStyle}),n=!1,a.onResize(function(e){o.realSize.width=e.width,o.realSize.height=e.height,o.onResizeCall&&o.onResizeCall(a,o.realSize)}),a.onError(function(i){return a._destroyed?(console.warn("loadBannerAd","onError doubble call _destroyed",a),n=!0,o.bannerAdLoading=!1,void(e&&e())):(n=!0,o.bannerAdLoading=!1,a&&a.destroy(),o.wxBannerAd&&(o.wxBannerAd.style.left=o.bannerStyle.left,o.wxBannerAd.style.top=o.bannerStyle.top,o.wxBannerAd.style.width=o.bannerStyle.width,o.onResizeCall&&o.onResizeCall(o.wxBannerAd,o.realSize)),t&&t(),void console.error(i))}),a.onLoad(function(){a._destroyed?(console.warn("loadBannerAd","onLoad doubble call _destroyed",a),n=!0,o.bannerAdLoading=!1):(n=!0,o.bannerAdLoading=!1,o.wxBannerAd&&o.wxBannerAd.destroy(),o.wxBannerAd=a),e&&e()}),setTimeout(function(){if(!n){if(a._destroyed)return console.warn("loadBannerAd","setTimeout doubble call _destroyed",a),n=!0,o.bannerAdLoading=!1,void(e&&e());o.bannerAdLoading=!1,a&&a.destroy(),o.wxBannerAd&&(o.wxBannerAd.style.left=o.bannerStyle.left,o.wxBannerAd.style.top=o.bannerStyle.top,o.wxBannerAd.style.width=o.bannerStyle.width,o.onResizeCall&&o.onResizeCall(o.wxBannerAd,o.realSize)),t&&t()}},5e3))},d.showBannerAdTask=function(e,t){var a=this;this.wxBannerAd&&l.ShareManager.getBannerAdControl()?(this.bannerAdShow=!0,this.wxBannerAd.show().then(function(){null==a.onResizeCall&&(a.wxBannerAd.style.left=a.bannerStyle.left,a.wxBannerAd.style.top=a.bannerStyle.top,a.wxBannerAd.style.width=a.bannerStyle.width),e&&e(),r.MoreGameManager.closeNewMoreGame(),r.MoreGameManager.closePartMoreGame(),r.MoreGameManager.closeBackHomeMoreGame(),r.MoreGameManager.closeBoyMoreGame()}).catch(function(e){console.error(e)})):t&&t()},d.hideBannerAdTask=function(e){this.bannerAdShow=!1,null!=this.wxBannerAd&&this.wxBannerAd.hide(),e&&e()},d.wxBannerAd=null,d.bannerAdShow=!1,d.bannerAdLoading=!1,d.interstitialAd=null,d.canShowInterstitial=!1,d.interstitialShowCall=null,d.interstitialCloseCall=null,d.bannerStyle={left:-1e4,top:-1e4,width:300},d.realSize=new cc.Size(0,0),d.onResizeCall=null,o.AdManager=n=d,cc._RF.pop()},{}],AddWxSmallGameConf:[function(e,t,a){"use strict";cc._RF.push(t,"483cf0MrRtAL4aDvJFdhBeJ","AddWxSmallGameConf");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.gameIcon=null,e.rewardIcon=null,e.gameName="",e.rewardEvent=null,e.addGameTip=null,e.popNode=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onLoad=function(){c.gameIcon=this.gameIcon,c.rewardIcon=this.rewardIcon,c.gameName=this.gameName,c.hasReward=null!=this.rewardEvent,c.rewardEvent=this.rewardEvent},s.prototype.onEnable=function(){this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.rotateTo(1,-25),cc.rotateTo(1,0),cc.rotateTo(1,25),cc.rotateTo(1,0))))},s.prototype.clickAddTip=function(){var e;this.addGameTip&&this.popNode&&(e=r.GameCommonPool.requestInstant(this.addGameTip))&&e.setParent(this.popNode)},__decorate([o({type:cc.SpriteFrame,displayName:"\u6e38\u620ficon"})],s.prototype,"gameIcon",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u6e38\u620f\u5956\u52b1\u56fe\u7247"})],s.prototype,"rewardIcon",void 0),__decorate([o({displayName:"\u6e38\u620f\u7b80\u79f0"})],s.prototype,"gameName",void 0),__decorate([o({type:cc.Component.EventHandler,displayName:"\u6536\u85cf\u5956\u52b1"})],s.prototype,"rewardEvent",void 0),__decorate([o({type:cc.Prefab,displayName:"\u6dfb\u52a0\u63d0\u793a\u9884\u8bbe"})],s.prototype,"addGameTip",void 0),__decorate([o({type:cc.Node,displayName:"\u5f39\u51fa\u6846\u7236\u8282\u70b9"})],s.prototype,"popNode",void 0),n=__decorate([n],s),i.AddWxSmallGameConf=n;var c=(p.gameIcon=null,p.rewardIcon=null,p.gameName=null,p.hasReward=!1,p.rewardEvent=null,p);function p(){}i.AddTipConfig=c,cc._RF.pop()},{}],AddWxSmallGameTip:[function(e,t,a){"use strict";cc._RF.push(t,"833f6HULj5PHIP+Ty5DLf5U","AddWxSmallGameTip");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("AddWxSmallGameConf");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.tip4=null,e.gameIcon1=null,e.gameName1=null,e.gameIcon2=null,e.gameName2=null,e.rewardTitle=null,e.rewardIcon=null,e.board=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.onLoad=function(){this.tip4.string="<color=#1e1e1e>\u70b9\u51fb\u6211\u7684\u5c0f\u7a0b\u5e8f</color><color=#ff2828> \u201c"+s.AddTipConfig.gameName+"\u201d </color><color=#1e1e1e>\u8fdb\u5165\u6e38\u620f\u5373\u53ef\u83b7\u5f97\u5956\u52b1\uff01</color><br/><color=#1e1e1e>\uff08\u5982\u53f3\u56fe\uff09</color>",this.gameName1.string=this.gameName2.string=s.AddTipConfig.gameName,this.gameIcon1.spriteFrame=this.gameIcon2.spriteFrame=s.AddTipConfig.gameIcon,this.rewardIcon.spriteFrame=s.AddTipConfig.rewardIcon,this.rewardTitle.active=s.AddTipConfig.hasReward},c.prototype.onEnable=function(){this.board.stopAllActions(),this.board.scale=0,this.board.opacity=0,this.board.runAction(cc.spawn(cc.scaleTo(.25,1),cc.fadeIn(.25)))},c.prototype.clickClose=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o(cc.RichText)],c.prototype,"tip4",void 0),__decorate([o(cc.Sprite)],c.prototype,"gameIcon1",void 0),__decorate([o(cc.Label)],c.prototype,"gameName1",void 0),__decorate([o(cc.Sprite)],c.prototype,"gameIcon2",void 0),__decorate([o(cc.Label)],c.prototype,"gameName2",void 0),__decorate([o(cc.Node)],c.prototype,"rewardTitle",void 0),__decorate([o(cc.Sprite)],c.prototype,"rewardIcon",void 0),__decorate([o(cc.Node)],c.prototype,"board",void 0),n=__decorate([n],c),i.AddWxSmallGameTip=n,cc._RF.pop()},{}],AppearEffect:[function(e,t,a){"use strict";cc._RF.push(t,"f75637BEl5I4KCkTiOEA3ZN","AppearEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.appearAnimation=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.appearAnimation.play("Appear"),this.appearAnimation.on("finished",this.close,this)},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),this.appearAnimation.off("finished",this.close,this)},p.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u7ec4\u4ef6",type:cc.Animation})],p.prototype,"appearAnimation",void 0),n=__decorate([n],p),i.AppearEffect=n,cc._RF.pop()},{}],Arrow:[function(e,t,a){"use strict";cc._RF.push(t,"f0648BcdbRP56LuFkjUnM/x","Arrow");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("EnumAndConst"),c=n("ConvertManager"),p=n("Body"),d=n("Head"),u=n("Shield"),h=n("Util"),m=n("Timer"),f=n("ConfigData"),g=n("SpriteFrameManager"),y=n("SkillSystem"),v=n("SpecailSkill"),D=n("WorldEventManager"),E=n("LocalWorldEventType"),S=n("LocalSoundManager"),A=n("FootRest"),C=n("BattleNodeManager"),M=n("ShareManager"),T=n("EnemyShield"),_=n("BattleNumManager"),k=n("LocalData"),P=n("EquipmentEffectSystem"),R=n("EnemyArea"),I=n("SingleEffectManager"),w=n("RoleManager"),b=n("GameState"),N=n("EffectCreate"),B=n("PlayerState"),L=n("EndlessModelConfigData");function G(){var e=null!==l&&l.apply(this,arguments)||this;return e.weapinSprite=null,e.collider=null,e.gravity=0,e.horizontalSpeed=0,e.verticalSpeed=0,e.roleData=null,e.lastHurtData=null,e.arrowState=s.ArrowStateEnum.HOLDING,e.divisionCount=0,e.delayTime=0,e.weaponType=null,e.isIgnite=!1,e.isFrozen=!1,e.isThunder=!1,e.isPenetrate=!1,e.isRebound=!1,e.maxCatapultCount=0,e.catapultCount=0,e.isCatapulting=!1,e.isCatapultMoving=!1,e.isSmartArrow=!1,e.atkDamping=!1,e.additonEffects=[],e.heads=[],e.bigWeapon=!1,e.weaponConfig=null,e.orientation=1,e.arrowSize=1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(G,l),(r=G).prototype.onEnable=function(){this.horizontalSpeed=0,this.verticalSpeed=0,D.WorldEventManager.addListener(E.LocalWorldEventType.BackHome,this.close,this),D.WorldEventManager.addListener(E.LocalWorldEventType.NextPart,this.nextPartClose,this),D.WorldEventManager.addListener(E.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},G.prototype.onDisable=function(){for(var e=0;e<this.additonEffects.length;e++){var t=this.additonEffects[e];this.additonEffects.splice(e,1),e--,t.destroy()}D.WorldEventManager.removeListener(E.LocalWorldEventType.BackHome,this.close,this),D.WorldEventManager.removeListener(E.LocalWorldEventType.NextPart,this.nextPartClose,this),D.WorldEventManager.removeListener(E.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},G.prototype.update=function(e){this.refrshEffectPositon(),null!=this.roleData&&((this.arrowState==s.ArrowStateEnum.LAUNCHING||this.arrowState==s.ArrowStateEnum.REBOUNDING)&&(800<=this.node.x||this.node.x<=-800||this.node.y<=-300)||this.roleData.isDestroy&&this.arrowState==s.ArrowStateEnum.HOLDING?this.close():this.arrowState!=s.ArrowStateEnum.LAUNCHING&&this.arrowState!=s.ArrowStateEnum.REBOUNDING||this.isCatapultMoving||this.deltaMove(e))},G.prototype.bindData=function(e,t){void 0===t&&(t=null),this.roleData=e,this.arrowState=s.ArrowStateEnum.HOLDING,this.weaponType=this.roleData.isBoss?f.ConfigData.getBossWeaponType(e.weaponIndex):f.ConfigData.getWeaponType(e.weaponIndex),e=1,e=this.roleData.isPlayer?k.LocalData.getEquippedEquipment(k.EquipmentType.weapon).rank:b.GameState.endlessModel?L.EndlessModelConfigData.getEndlessEnemyEqeuipmentRank(b.GameState.currentPart):f.ConfigData.getEnemyEquipmentRank(b.GameState.currentChapter),this.weapinSprite.spriteFrame=this.roleData.isBoss?g.SpriteFrameManager.getBossWeaponSpriteFrame(this.roleData.weaponIndex):g.SpriteFrameManager.getLaunchWeaponSpriteFrame(this.roleData.weaponIndex,e),this.refrshArrow(),t&&(this.isIgnite=t.isIgnite,this.isFrozen=t.isFrozen,this.isThunder=t.isThunder,this.isPenetrate=t.isPenetrate,this.maxCatapultCount=t.maxCatapultCount,this.catapultCount=t.catapultCount,this.isRebound=t.isRebound,this.atkDamping=t.atkDamping),this.additionSkillEffect(null!=t),this.node.scaleX=f.ConfigData.getEquipmentScale(this.roleData,k.EquipmentType.weapon),this.node.scaleY=Math.abs(this.node.scaleX),this.arrowSize=this.node.scaleY/f.ConfigData.equipmentInitScale},G.prototype.refrshArrow=function(){var e=(this.roleData.isBoss?f.ConfigData.bossWeaponConfigDatas:f.ConfigData.weaponConfigDatas)[this.roleData.weaponIndex];null!=e&&(this.weaponConfig=e,this.gravity=this.weaponConfig.gravity,this.node.anchorX=e.holdAnchorX,this.node.anchorY=e.holdAnchorY,4<=(this.roleData.isPlayer?k.LocalData.getEquippedEquipment(k.EquipmentType.weapon).rank:1)?(this.collider.size.width=e.plusColliderWidth,this.collider.size.height=e.plusColliderHeight,this.collider.offset.x=e.plusOffsetX,this.collider.offset.y=e.plusOffsetY):(this.collider.size.width=e.colliderWidth,this.collider.size.height=e.colliderHeight,this.collider.offset.x=e.offsetX,this.collider.offset.y=e.offsetY))},G.prototype.deltaMove=function(e){var t=this.isCatapulting||this.isSmartArrow?0:this.gravity,a=this.node.position;this.verticalSpeed=this.verticalSpeed+t*e;var n=this.verticalSpeed*e;t=this.horizontalSpeed*e,n=cc.v2(t,n),this.node.setPosition(a.add(n)),this.arrowState!=s.ArrowStateEnum.REBOUNDING&&(this.weaponType==s.LaunchWeaponTypeEnum.SHOOT?0==n.x&&0==n.y||(n=180*n.normalize().signAngle(cc.Vec2.RIGHT)/Math.PI,this.node.angle=-n+(0<this.orientation?180:0)):this.weaponType==s.LaunchWeaponTypeEnum.ROTATE&&(this.node.angle+=2880*e*(0<this.orientation?f.ConfigData.equipmentInitScale:-f.ConfigData.equipmentInitScale)*5))},G.prototype.refrshEffectPositon=function(){var e=C.BattleNodeManager.getParentNode(s.BattleNodeEnum.PARTICLE_NODE);if(null!=e)if(this.arrowState==s.ArrowStateEnum.HOLDING||this.arrowState==s.ArrowStateEnum.WAITING)for(var t=this.weaponConfig.holdEffectPos,a=this.node.convertToWorldSpaceAR(t),n=e.convertToNodeSpaceAR(a),o=0;o<this.additonEffects.length;o++)this.additonEffects[o].position=n;else if(this.arrowState==s.ArrowStateEnum.LAUNCHING||this.arrowState==s.ArrowStateEnum.REBOUNDING)for(t=this.weaponConfig.launchEffectPos,a=this.node.convertToWorldSpaceAR(t),n=e.convertToNodeSpaceAR(a),o=0;o<this.additonEffects.length;o++)this.additonEffects[o].position=n},G.prototype.launch=function(e,t,a,n,o){var i=this;if(void 0===o&&(o=1),null!=this.roleData)return this.delayTime=t,this.horizontalSpeed=e.x,this.verticalSpeed=e.y,this.divisionCount=a,this.orientation=this.roleData.orientation,null!=n&&(this.gravity=n),S.LocalSoundManager.playThrowAudio(),this.arrowState=s.ArrowStateEnum.WAITING,m.TimerManager.addTimer(this.delayTime,function(){var e;i&&i.node.isValid&&null!=i.roleData&&(i.arrowSize=o,i.roleData.isPlayer?(e=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.WEAPON_BIG),Math.random()<e&&(i.bigWeapon=!0,i.arrowSize=2)):b.GameState.endlessModel&&b.GameState.currentPart>L.EndlessModelConfigData.endlessPartLine&&(i.arrowSize=2),i.refreshScale(),i.arrowState=s.ArrowStateEnum.LAUNCHING,i.node.anchorX=i.weaponConfig.launchAnchorX,i.node.anchorY=i.weaponConfig.launchAnchorY,i.weaponType==s.LaunchWeaponTypeEnum.ROTATE&&(i.node.angle=h.Util.getRandomNum(0,360)),w.RoleManager.clearWaitingLaunchArrows(i.roleData))},this.node)},G.prototype.onCollisionEnter=function(e,t){e&&t&&(null==this.roleData||this.arrowState!=s.ArrowStateEnum.LAUNCHING||this.isCatapultMoving||(e.node.group!=s.GroupNameEnum.WALL?e.node.group!=s.GroupNameEnum.ARROW?e.node.group!=s.GroupNameEnum.FOOT_REST?e.node.group!=s.GroupNameEnum.BODY?e.node.group!=s.GroupNameEnum.HEAD?e.node.group!=s.GroupNameEnum.SHIELD||this.collideShield(e,t,!1):this.collideHead(e,t):this.collideBody(e,t):this.collideFootRest(e,t):this.collideArrow(e,t):this.collideWall(e,t)))},G.prototype.onCollisionStay=function(e,t){e&&t&&(null==this.roleData||this.arrowState!=s.ArrowStateEnum.LAUNCHING||this.isCatapultMoving||e.node.group!=s.GroupNameEnum.SHIELD||this.collideShield(e,t,!0))},G.prototype.collideWall=function(e){this.roleData.isPlayer&&this.isRebound&&(0==e.tag?this.verticalSpeed=-this.verticalSpeed:this.horizontalSpeed=-this.horizontalSpeed,this.lastHurtData=null)},G.prototype.collideArrow=function(e,t){var a;this.isSmartArrow||null==(a=e.getComponent(r))||null!=(e=a.roleData)&&this.roleData!=e&&this.arrowState==s.ArrowStateEnum.LAUNCHING&&a.arrowState==s.ArrowStateEnum.LAUNCHING&&(e.isEnemy||this.roleData.isEnemy||this.isSmartArrow)&&this.roleData.isPlayer&&e.isEnemy&&(S.LocalSoundManager.playAudio("weaponCollision"),this.arrowSize<a.arrowSize?(this.reduceArrowSize(1),a.reduceArrowSize(1)):a.reduceArrowSize(this.arrowSize),null==(t=t.world.points)||t.length<=0||N.EffectCreate.createSpark(t[0],this.node.scaleX,!0))},G.prototype.collideFootRest=function(e,t){this.arrowState!=s.ArrowStateEnum.LAUNCHING||null!=(e=e.getComponent(A.FootRest))&&(null==(e=e.roleData)||e.isTeleporting||e.hasEnemyShield||!(e.isEnemy||this.roleData.isEnemy||this.isSmartArrow)||this.roleData.isEnemy&&e.isEnemy&&(b.GameState.heroModel||b.GameState.endlessModel)||e==this.roleData&&this.roleData.profession==s.ProfessionEnum.ROBOT_MIXED&&!this.isSmartArrow||e.isBoss&&this.roleData.isBoss&&!this.isSmartArrow||(S.LocalSoundManager.playHelmetResistAudio(),null==(t=t.world.points)||t.length<=0||(N.EffectCreate.createSpark(t[0],this.node.scaleX,!0),this.rebound())))},G.prototype.collideHead=function(e,t){var a=this,n=e.getComponent(d.Head);if(null!=n){var o=n.roleData;if(null!=o&&!o.isTeleporting&&o!=this.lastHurtData&&(o.isEnemy||this.roleData.isEnemy||this.isSmartArrow)&&(o!=this.roleData||this.isSmartArrow)&&(!this.roleData.isEnemy||!o.isEnemy||!b.GameState.heroModel&&!b.GameState.endlessModel||this.isSmartArrow)&&(o.profession==s.ProfessionEnum.FLY_HEAD_GHOST||o.isBoss&&7==b.GameState.currentChapter||!o.hasEnemyShield)&&(!o.isBoss||!this.roleData.isBoss||this.isSmartArrow)&&!this.dodgeSkill(o))if(!b.GameState.isGaming&&0<o.hp)this.rebound();else if(b.GameState.isBossPart&&b.GameState.isBossPartPass&&this.roleData.isBoss)this.rebound();else if(o.profession!=s.ProfessionEnum.NECROMANCER&&o.profession!=s.ProfessionEnum.SHIELD_WIZARD||!(o.hp<=0)){var i=o.helmetDefense;if(null!=n.helmet&&0<i)this.collideHelmet(e,t,n,o);else{var l=!1;this.roleData.isPlayer&&(p=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.CRIT),Math.random()<p&&(l=!0)),this.roleData.isPlayer&&0<o.hp&&o.isMoveModel&&0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.REPEL)&&(o.repelTime=.5);var r=n.isEye;i=this.roleData.atk,i=this.getFinalDamage(i,0,o,l,r),this.roleData.isPlayer&&o.isPlayer&&(i*=.3);var p=t.world;if(null!=p&&!(null==(t=p.points)||t.length<=0)&&null!=(p=this.node.parent)){p=p.convertToNodeSpaceAR(t[0]),t=o.isDead,r=w.RoleManager.roleIsDamaged(o,this.roleData,i,p,!0,!0,l,!1,this.bigWeapon,r),(this.lastHurtData=o).invincibleTime<=0?(S.LocalSoundManager.playAudio("headAttack"),S.LocalSoundManager.playVibrateShort(),u=cc.v2(0,0),u=o.isBoss&&7==b.GameState.currentChapter?p:o.headPosition,I.SingleEffectManager.showBloodEffect(u,this.node.scaleX,o)):S.LocalSoundManager.playShieldResistAudio(),this.roleData.isEnemy&&o.isEnemy&&D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:43}),this.roleData.isPlayer&&!t&&(this.roleData.continueHeadShootCount++,1<this.roleData.continueHeadShootCount?D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:22}):D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:21})),0<r&&!t&&this.sukbloodSkill(i),0<o.hp&&(this.frozenSkill(o),this.igniteSkill(t,o)),this.thunderSkill(t,o,!0);var u=o.headPosition;if(0<o.invincibleTime)this.rebound();else if(r=o.isBoss&&3==b.GameState.currentChapter,i=o.isBoss&&7==b.GameState.currentChapter,!(i=r||i||o.isBoss&&!o.isUltimateBoss||o.profession==s.ProfessionEnum.NECROMANCER||o.profession==s.ProfessionEnum.SHIELD_WIZARD||o.profession==s.ProfessionEnum.FIRE_DRAGON||o.profession==s.ProfessionEnum.ICE_DRAGON||o.profession==s.ProfessionEnum.RUN_DRAGON)&&o.hp<=0&&!t&&M.ShareManager.getViolenceControl()&&(n.beHitedFly(),c.ConvertManager.setNodeParent(e.node,this.node),e.node.group=s.GroupNameEnum.ARROW,this.heads.push(e.node)),!this.isSmartArrow&&!t&&0<this.catapultCount){for(var m=R.EnemyArea.enemyDataArray,f=99999,g=null,v=0;v<m.length;v++){var A,C=m[v];null==C||C.isDead||C.isDestroy||C.isTeleporting||C==o||(A=h.Util.getDistance(this.node.position,C.logicPos))<f&&(f=A,g=C)}null!=g?(this.catapultCount--,this.isCatapulting=!0,this.isCatapultMoving=!0,this.node.runAction(cc.sequence(cc.moveTo(.1,u),cc.callFunc(function(){a.trackingAttack(g),a.isCatapultMoving=!1})))):(this.isCatapulting=!1,this.isCatapultMoving=!1,(i||0<o.hp||t)&&!this.isPenetrate&&(this.insert(),I.SingleEffectManager.insertArrow(o,this.node),c.ConvertManager.setNodeParent(this.node,e.node),this.changeGroup(s.GroupNameEnum.HEAD)))}else this.isCatapulting&&this.catapultCount<=0&&(this.isCatapulting=!1),(i||0<o.hp||t)&&!this.isPenetrate&&(this.catapultCount<=0||this.isSmartArrow)&&(this.insert(),I.SingleEffectManager.insertArrow(o,this.node),c.ConvertManager.setNodeParent(this.node,e.node),this.changeGroup(s.GroupNameEnum.HEAD));o.hp<=0&&!o.isFalledDown&&(o.isDead=!0,o.killerData=this.roleData,w.RoleManager.roleDie(o))}}}}},G.prototype.collideHelmet=function(e,t,a,n){var o=t.world;null!=o&&(null==(t=o.points)||t.length<=0||null!=(o=this.node.parent)&&(n.invincibleTime<=0&&N.EffectCreate.createSpark(t[0],this.node.scaleX,!0),S.LocalSoundManager.playHelmetResistAudio(),o=o.convertToNodeSpaceAR(t[0]),t=this.roleData.atk,t=this.getFinalDamage(t,1,n),this.roleData.isPlayer&&n.isPlayer&&(t*=.3),w.RoleManager.equipmentIsDamaged(n,k.EquipmentType.helmet,this.roleData,t,o),this.rebound(),null!=a.helmet&&a.helmet.node.active&&n.helmetDefense<=0&&(a.helmet.drop(.2*-this.horizontalSpeed,this.verticalSpeed),a.helmet=null)))},G.prototype.collideBody=function(e,t){var a=this,n=e.getComponent(p.Body);if(null!=n){var o=n.roleData;if(null!=o&&!o.isTeleporting&&o!=this.lastHurtData&&!o.hasEnemyShield&&(o.isEnemy||this.roleData.isEnemy||this.isSmartArrow)&&(o!=this.roleData||this.isSmartArrow)&&(!this.roleData.isEnemy||!o.isEnemy||!b.GameState.heroModel&&!b.GameState.endlessModel||this.isSmartArrow)&&(!o.isBoss||!this.roleData.isBoss||this.isSmartArrow)&&!this.dodgeSkill(o))if(!b.GameState.isGaming&&0<o.hp)this.rebound();else if(b.GameState.isBossPart&&b.GameState.isBossPartPass&&this.roleData.isBoss)this.rebound();else if(o.profession!=s.ProfessionEnum.NECROMANCER&&o.profession!=s.ProfessionEnum.SHIELD_WIZARD||!(o.hp<=0)){var i=t.world;if(null!=i&&!(null==(d=i.points)||d.length<=0)){var l=this.node.parent;if(null!=l){t=l.convertToNodeSpaceAR(d[0]),i=!1,this.roleData.isPlayer&&(r=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.CRIT),Math.random()<r&&(i=!0)),n.isSkinArmor&&(i=!1),l=this.roleData.atk,l=this.getFinalDamage(l,2,o,i),this.roleData.isPlayer&&o.isPlayer&&(l*=.3),d=!1,n.isSkinArmor&&(l*=.1,d=!0),this.roleData.isPlayer&&0<o.hp&&o.isMoveModel&&0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.REPEL)&&(o.repelTime=.5);var r=o.isDead,d=w.RoleManager.roleIsDamaged(o,this.roleData,l,t,!0,!1,i,d,this.bigWeapon);if((this.lastHurtData=o).invincibleTime<=0){if(n.isSkinArmor?S.LocalSoundManager.playShieldResistAudio():i?S.LocalSoundManager.playAudio("headAttack"):S.LocalSoundManager.playArrowHitAudio(),S.LocalSoundManager.playVibrateShort(),n.isSkinArmor)return N.EffectCreate.createSpark(t,this.node.scaleX,!1),void this.rebound();I.SingleEffectManager.showBloodEffect(t,this.node.scaleX,o)}else S.LocalSoundManager.playShieldResistAudio();if(this.roleData.isEnemy&&o.isEnemy&&D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:43}),this.roleData.isPlayer&&!r&&(this.roleData.continueHeadShootCount=0),0<o.invincibleTime)this.rebound();else if(!this.isSmartArrow&&!r&&0<this.catapultCount){for(var u=R.EnemyArea.enemyDataArray,m=99999,f=null,g=0;g<u.length;g++){var v,A=u[g];null==A||A.isDead||A.isDestroy||A.isTeleporting||A==o||(v=h.Util.getDistance(this.node.position,A.logicPos))<m&&(m=v,f=A)}null!=f?(this.catapultCount--,this.isCatapulting=!0,this.isCatapultMoving=!0,this.node.runAction(cc.sequence(cc.moveTo(.1,o.logicPos),cc.callFunc(function(){a.trackingAttack(f),a.isCatapultMoving=!1})))):(this.isCatapulting=!1,this.isCatapultMoving=!1,this.isPenetrate||(this.insert(),I.SingleEffectManager.insertArrow(o,this.node),c.ConvertManager.setNodeParent(this.node,e.node)))}else this.isCatapulting&&this.catapultCount<=0&&(this.isCatapulting=!1),!this.isPenetrate&&(this.catapultCount<=0||this.isSmartArrow)&&(this.insert(),I.SingleEffectManager.insertArrow(o,this.node),c.ConvertManager.setNodeParent(this.node,e.node));0<d&&!r&&this.sukbloodSkill(l),0<o.hp&&(this.frozenSkill(o),this.igniteSkill(r,o)),this.thunderSkill(r,o,!1),o.hp<=0&&!o.isFalledDown&&(o.isDead=!0,o.killerData=this.roleData,w.RoleManager.roleDie(o))}}}}},G.prototype.collideShield=function(e,t,a){var n=e.getComponent(T.EnemyShield);if(null!=n){var o=n.roleData;if((null==o||o.isTeleporting||this.roleData.isEnemy==o.isEnemy)&&!this.isSmartArrow)return;var i=this.roleData.atk;if(i=this.getFinalDamage(i,3,o),o.isBoss){if(a)return;if(w.RoleManager.restoreRoleHp(o,Math.round(.7*i),!1,!0),this.isSmartArrow=!0,this.trackingAttack(this.roleData),null==(a=t.world))return;var l=a.points;return null==l||l.length<=0?void 0:null==(a=this.node.parent)?void 0:(l=a.convertToNodeSpaceAR(l[0]),N.EffectCreate.createSpark(l,this.node.scaleX,!1),void S.LocalSoundManager.playShieldResistAudio())}return this.roleData.isPlayer&&o.isPlayer&&(i*=.3),n.breaking(),null==(l=t.world)?void 0:null==(n=l.points)||n.length<=0||null==(l=this.node.parent)?void 0:(l=l.convertToNodeSpaceAR(n[0]),n=i>=f.ConfigData.MAX_DAMAGE?s.BattleNumTypeEnum.BROKE_EQUIPMENT:s.BattleNumTypeEnum.HP_REDUCE,_.BattleNumManager.createBattleNumEffect(n,i,o,l),S.LocalSoundManager.playShieldResistAudio(),void this.rebound())}null!=(i=e.getComponent(u.Shield))&&(null==(o=i.roleData)||o.shieldDefense<0||o.isTeleporting||o==this.lastHurtData||o.hasEnemyShield||!(o.isEnemy||this.roleData.isEnemy||this.isSmartArrow)||o==this.roleData&&!this.isSmartArrow||this.roleData.isEnemy&&o.isEnemy&&(b.GameState.heroModel||b.GameState.endlessModel)&&!this.isSmartArrow||this.dodgeSkill(o)||(!b.GameState.isGaming&&0<o.hp||b.GameState.isBossPart&&b.GameState.isBossPartPass&&this.roleData.isBoss?this.rebound():(l=this.roleData.atk,l=this.getFinalDamage(l,3,o),null!=(e=t.world)&&(null==(t=e.points)||t.length<=0||null!=(e=this.node.parent)&&(e=e.convertToNodeSpaceAR(t[0]),w.RoleManager.equipmentIsDamaged(o,k.EquipmentType.shield,this.roleData,l,e),o.shieldDefense<=0&&i.drop(.2*this.horizontalSpeed,.2*this.verticalSpeed),o.invincibleTime<=0&&N.EffectCreate.createSpark(t[0],this.node.scaleX,!0),S.LocalSoundManager.playShieldResistAudio(),this.rebound())))))},G.prototype.getFinalDamage=function(e,t,a,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var i,l=e;if(0==t||2==t){if(!a.isDead&&!a.isBoss&&this.roleData.isPlayer&&!a.isPlayer&&0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.SECKILL)){var r=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.SECKILL);if(Math.random()<r)return f.ConfigData.MAX_DAMAGE}}else if(!a.isDead&&!a.isBoss&&this.bigWeapon)return f.ConfigData.MAX_DAMAGE;if(this.roleData.isPlayer&&(i=0,null!=(e=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.FURY))&&0<e&&(r=(this.roleData.maxHp-this.roleData.hp)/this.roleData.maxHp,i=Math.floor(r/.1)*e),l*=1+y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.DAMAGE_UP)+i),l*=1-.15*this.divisionCount,this.atkDamping)for(var c=this.maxCatapultCount-this.catapultCount,p=0;p<c;p++)l*=.5;return 0==t?(l*=2,o||(l*=1-a.headHurtReduction,l=Math.max(2,l)),n&&(l=l/2*3)):2==t&&(l*=1-a.bodyHurtReduction,l=Math.max(1,l),n&&(l*=2)),Math.floor(l)},G.prototype.additionSkillEffect=function(e){var t,a=this;e||(this.isIgnite=!1,this.isFrozen=!1,this.isThunder=!1,this.isPenetrate=!1,this.catapultCount=0,this.roleData.isFireArrow&&(this.isIgnite=!0),this.roleData.isPlayer?(0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.IGNITE)&&(this.isIgnite=!0),0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.FROZEN)&&(this.isFrozen=!0),0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.THUNDER)&&(this.isThunder=!0),0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.PENETRATE)&&(this.isPenetrate=!0),0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.CATAPULT)&&(this.maxCatapultCount=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.CATAPULT),this.catapultCount=this.maxCatapultCount,this.atkDamping=!0),0<y.SkillSystem.getSkillLevel(s.SkillTypeEnum.REBOUND)&&(this.isRebound=!0)):(this.roleData.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.IGNITE)&&(this.isIgnite=!0),this.roleData.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.THUNDER)&&(this.isThunder=!0),this.roleData.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.FROZEN)&&(this.isFrozen=!0))),null==C.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE)||null!=(t=C.BattleNodeManager.getParentNode(s.BattleNodeEnum.PARTICLE_NODE))&&(this.isIgnite&&v.SpecailSkill.createSkillEffectInArrow(s.SkillTypeEnum.IGNITE,function(e){null!=e&&(e.setParent(t),e.x=-a.node.width*a.node.anchorX+5,a.additonEffects.push(e))}),this.isFrozen&&v.SpecailSkill.createSkillEffectInArrow(s.SkillTypeEnum.FROZEN,function(e){null!=e&&(e.setParent(t),e.x=-a.node.width*a.node.anchorX+5,a.additonEffects.push(e))}),this.isThunder&&v.SpecailSkill.createSkillEffectInArrow(s.SkillTypeEnum.THUNDER,function(e){null!=e&&(e.setParent(t),e.x=-a.node.width*a.node.anchorX+5,a.additonEffects.push(e))}))},G.prototype.sukbloodSkill=function(e){var t,a;!this.roleData.isPlayer||e>=f.ConfigData.MAX_DAMAGE||null==(t=y.SkillSystem.getSkillLevel(s.SkillTypeEnum.SUKBLOOD))||t<=0||null==(a=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.SUKBLOOD))||a<=0||(t=this.roleData.hp/this.roleData.maxHp,a=Math.round(e*(.7<t?.005*a:.3<t?.01*a:.03*a)),a=Math.max(1,a),B.PlayerState.player.restoreRoleStatus(!1,a))},G.prototype.igniteSkill=function(e,t){!e&&this.isIgnite&&(t.isPlayer&&(e=null==P.EquipmentEffectSystem.currentCloakEffectData[1]?0:P.EquipmentEffectSystem.currentCloakEffectData[1],Math.random()<e)?N.EffectCreate.createRoleTip(t.logicPos,2):t.isBoss&&7==b.GameState.currentChapter?N.EffectCreate.createRoleTip(t.headPosition,2):I.SingleEffectManager.showIgniteEffect(this.roleData,t))},G.prototype.thunderSkill=function(e,t,a){var n;!e&&this.isThunder&&t.thunderImmuneTime<=0&&(n=[],n=this.roleData.isEnemy&&!this.isSmartArrow?this.isSmartArrow?n.concat(R.EnemyArea.enemyDataArray):(n=n.concat([B.PlayerState.playerData])).concat(R.EnemyArea.friendDatas):this.isSmartArrow?(n=n.concat([B.PlayerState.playerData])).concat(R.EnemyArea.friendDatas):n.concat(R.EnemyArea.enemyDataArray),e=this.roleData.isPlayer?y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.THUNDER):y.SkillSystem.getEquipedSkillInitData(s.SkillTypeEnum.THUNDER),v.SpecailSkill.thunderSkill(this.roleData,t,n,e,a))},G.prototype.frozenSkill=function(e){if(this.isFrozen&&!e.isFrozening&&e.frozenImmuneTime<=0){if(e.isPlayer){var t=null==P.EquipmentEffectSystem.currentShieldEffectData[4]?0:P.EquipmentEffectSystem.currentShieldEffectData[4];if(t+=(null==P.EquipmentEffectSystem.currentHelmetEffectData[4]?0:P.EquipmentEffectSystem.currentHelmetEffectData[4])+(null==P.EquipmentEffectSystem.currentCloakEffectData[7]?0:P.EquipmentEffectSystem.currentCloakEffectData[7]),Math.random()<t)return void N.EffectCreate.createRoleTip(e.logicPos,2)}e.isBoss&&7==b.GameState.currentChapter?N.EffectCreate.createRoleTip(e.headPosition,2):I.SingleEffectManager.showFrozenEffect(this.roleData,e)}},G.prototype.dodgeSkill=function(e){if(e.isDead)return!1;var t=0;return this.roleData.isEnemy&&e.isPlayer&&(t=y.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.DODGE)),e.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.DODGE)&&(t=y.SkillSystem.getEquipedSkillInitData(s.SkillTypeEnum.DODGE),e.isBoss&&b.GameState.heroModel&&(t*=2)),Math.random()<t&&(t=cc.v2(0,0),t=e.isBoss&&7==b.GameState.currentChapter?e.headPosition:e.logicPos,N.EffectCreate.createRoleTip(t,0),this.lastHurtData=e,this.roleData.isPlayer&&e.isEnemy&&D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:18}),!0)},G.prototype.isReviveKnocked=function(){this.roleData.isEnemy&&this.arrowState==s.ArrowStateEnum.LAUNCHING&&this.rebound()},G.prototype.insert=function(){for(var e=0;e<this.additonEffects.length;e++){var t=this.additonEffects[e];this.additonEffects.splice(e,1),e--;var a=t.getComponent(cc.ParticleSystem);null!=a?(a.autoRemoveOnFinish=!0,a.duration=.3):t.destroy()}this.arrowState=s.ArrowStateEnum.INSERTING,this.node.stopAllActions(),this.collider.enabled=!1},G.prototype.trackingAttack=function(e){e=e.logicPos.sub(this.node.position).normalize().mul(Math.abs(1200)),this.horizontalSpeed=e.x,this.verticalSpeed=e.y,e=h.Util.getVectorsAngle(e,cc.Vec2.RIGHT),this.node.angle=-e+(this.roleData.isEnemy?180:0),this.lastHurtData=null},G.prototype.reduceArrowSize=function(e){var t;this.arrowSize-=e,0<this.arrowSize?this.refreshScale():(this.roleData.isEnemy&&null!=(t=y.SkillSystem.getSkillLevel(s.SkillTypeEnum.SMART_ARROW))&&0<t&&!this.roleData.isTeleporting?(this.isSmartArrow=!0,this.trackingAttack(this.roleData)):this.rebound(),D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBubble,{type:27}))},G.prototype.refreshScale=function(){this.orientation=this.roleData.orientation;var e=f.ConfigData.equipmentInitScale*this.arrowSize;this.node.scaleX=this.orientation*e,this.node.scaleY=e},G.prototype.rebound=function(){for(var e=0;e<this.additonEffects.length;e++){var t=this.additonEffects[e];this.additonEffects.splice(e,1),e--;var a=t.getComponent(cc.ParticleSystem);null!=a?(a.autoRemoveOnFinish=!0,a.duration=.3):t.destroy()}this.isSmartArrow=!1,this.arrowState=s.ArrowStateEnum.REBOUNDING,this.horizontalSpeed*=-.2,this.verticalSpeed*=.2,this.isCatapultMoving=!1,this.isCatapulting=!1,this.isSmartArrow=!1;var n=h.Util.getRandomFloatNum(.5,2),o=.5<Math.random()?360:-360;this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.rotateBy(n,o))),this.collider.enabled=!1},G.prototype.changeGroup=function(e){this.node.group=e;for(var t=0;t<this.heads.length;t++)null!=this.heads[t]&&this.heads[t].isValid?this.heads[t].group=e:this.heads.splice(t,1)},G.prototype.nextPartClose=function(){this.arrowState!=s.ArrowStateEnum.REBOUNDING&&this.arrowState!=s.ArrowStateEnum.LAUNCHING||this.close()},G.prototype.close=function(){this.node.destroy()},__decorate([o({displayName:"\u6b66\u5668\u56fe\u7247",type:cc.Sprite})],G.prototype,"weapinSprite",void 0),__decorate([o({displayName:"\u78b0\u649e\u76d2",type:cc.BoxCollider})],G.prototype,"collider",void 0),n=r=__decorate([n],G),i.Arrow=n,cc._RF.pop()},{}],AuthorizationManager:[function(e,t,a){"use strict";cc._RF.push(t,"64718PmnPlNg6Oc0IRZEb2a","AuthorizationManager");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l=o("UserData");function r(){}o=(n=cc._decorator).ccclass,n.property,r.popWxAuthorization=function(e,t,a){var n=this;try{if("function"!=typeof wx.createUserInfoButton){var o=this;return void wx.getSetting({success:function(t){null!=t&&null!=t.authSetting&&null!=t.authSetting["scope.userInfo"]||wx.authorize({scope:"scope.userInfo",success:function(t){console.log(t),o.getUserInfo(e)}})}})}this.destroyAuthorizationButton();var i=window.gameCommon.getSDK.getSystemInfo(),r=i&&i.screenWidth,s=i&&i.screenHeight;if(this.authorizationButton=wx.createUserInfoButton({type:"image",image:t||"img/startGameButton.png",style:a||{left:0,top:0,width:r,height:s}}),!this.authorizationButton)return;this.authorizationButton.onTap(function(t){n.destroyAuthorizationButton(),null!=(t=t&&t.userInfo)&&(l.UserData.data.gender=t.gender),e&&e(t)})}catch(e){this.destroyAuthorizationButton(),console.error(e)}},r.destroyAuthorizationButton=function(){try{if(!this.authorizationButton)return;this.authorizationButton.destroy(),this.authorizationButton=null}catch(n){this.authorizationButton=null,console.error(n)}},r.getUserInfo=function(e){try{if("function"!=typeof wx.getUserInfo)return;wx.getUserInfo({success:function(t){null!=(t=t&&t.userInfo)&&(l.UserData.data.gender=t.gender),e&&e(t)}})}catch(e){console.error(e)}},r.authorizationButton=null,o=__decorate([o],r),i.AuthorizationManager=o,cc._RF.pop()},{}],AutoAtkBtnUI:[function(e,t,a){"use strict";cc._RF.push(t,"3dc6aRUMLZBtbNoIJyRxT1o","AutoAtkBtnUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("LocalSoundManager"),c=n("GameManager"),p=n("ShareManager"),d=n("ShareVideoControl"),u=n("GameState"),h=n("PlayerState");function m(){var e=null!==r&&r.apply(this,arguments)||this;return e.autoAtkBtnBg=null,e.atkSelfBtnBg=null,e.tipClickAnimationNode=null,e.voideSpNode=null,e.barNode=null,e.swordAnimationNode=null,e.autoSp=null,e.btnTypeNum=0,e.btnBg=null,e.barSp=null,e.atkCd=0,e.atkTotalCd=0,e.finishWatching=!1,e}n=(o=cc._decorator).ccclass,o=o.property,r=cc.Component,__extends(m,r),m.prototype.onLoad=function(){this.btnTypeNum=l.atkSelfBtn,this.btnBg=this.node.getComponent(cc.Sprite),this.barSp=this.barNode.getComponent(cc.Sprite),this.atkCd=.8,this.atkTotalCd=.8},m.prototype.onDisable=function(){this.voideSpNode.active=!0,this.btnTypeNum=l.autoAtkBtn,this.btnTypeChange(),this.finishWatching=!1},m.prototype.clickAutoAtkBtn=function(){var e=this;if(s.LocalSoundManager.playAudio("click"),!this.finishWatching){var t=function(){cc.director.resume(),e.finishWatching=!0,e.voideSpNode.active=!1,e.btnTypeNum=l.atkSelfBtn,e.btnTypeChange()},a=function(){cc.director.resume()};if(p.ShareManager.getShareControlType()==p.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME)return void t();d.ShareVideoControl.videoFunc("\u83b7\u5f97\u81ea\u52a8\u653b\u51fb\u6280\u80fd",t,a,t,a,function(){cc.director.pause()},d.VideoAdIdEnum.AUTO_ATK_ID)}this.btnTypeChange()},m.prototype.btnTypeChange=function(){this.finishWatching&&(this.btnTypeNum==l.atkSelfBtn?(this.btnTypeNum=l.autoAtkBtn,this.btnBg.spriteFrame=this.autoAtkBtnBg,this.tipClickAnimationNode.stopAllActions(),this.tipClickAnimationNode.active=!1,this.swordAnimationNode.active=!0,this.autoSp.active=!0,this.barNode.active=!0,this.atkCd=0):(this.btnTypeNum=l.atkSelfBtn,this.btnBg.spriteFrame=this.atkSelfBtnBg,this.swordAnimationNode.stopAllActions(),this.swordAnimationNode.active=!1,this.tipClickAnimationNode.active=!0,this.barNode.active=!1,this.autoSp.active=!1))},m.prototype.update=function(e){this.finishWatching&&(this.barChange(e),this.touchToCancelAutoAtk(),this.auotoAck())},m.prototype.barChange=function(e){return!h.PlayerState.player.isAttacking&&u.GameState.isGaming?(this.atkCd+=e,this.atkCd>=this.atkTotalCd&&(this.atkCd=0),void(this.barSp.fillRange=this.atkCd/this.atkTotalCd)):(this.atkCd=this.atkTotalCd,this.barSp.fillRange=this.atkCd/this.atkTotalCd,void(this.atkCd=0))},m.prototype.touchToCancelAutoAtk=function(){var e=h.PlayerState.playerData;null!=e.attackPower&&null!=e.attackAngle&&(this.btnTypeNum=l.autoAtkBtn,this.btnTypeChange())},m.prototype.auotoAck=function(){this.btnTypeNum!=l.atkSelfBtn&&0==this.atkCd&&(h.PlayerState.player.isAttacking||c.GameManager.playerAutoAtk())},__decorate([o({displayName:"\u81ea\u52a8\u653b\u51fb\u6309\u94ae\u80cc\u666f",type:cc.SpriteFrame})],m.prototype,"autoAtkBtnBg",void 0),__decorate([o({displayName:"\u624b\u52a8\u653b\u51fb\u6309\u94ae\u80cc\u666f",type:cc.SpriteFrame})],m.prototype,"atkSelfBtnBg",void 0),__decorate([o({displayName:"\u5149\u5708\u52a8\u753b\u8282\u70b9",type:cc.Node})],m.prototype,"tipClickAnimationNode",void 0),__decorate([o({displayName:"\u5e7f\u544a\u5f55\u50cf",type:cc.Node})],m.prototype,"voideSpNode",void 0),__decorate([o({displayName:"\u8fdb\u5ea6\u6761\u8282\u70b9",type:cc.Node})],m.prototype,"barNode",void 0),__decorate([o({displayName:"\u5251\u52a8\u753b\u8282\u70b9",type:cc.Node})],m.prototype,"swordAnimationNode",void 0),__decorate([o({displayName:"\u81ea\u52a8\u6587\u5b57\u7cbe\u7075",type:cc.Node})],m.prototype,"autoSp",void 0),n=__decorate([n],m),i.AutoAtkBtnUI=n,(i=l=i.btnType||(i.btnType={}))[i.autoAtkBtn=0]="autoAtkBtn",i[i.atkSelfBtn=1]="atkSelfBtn",cc._RF.pop()},{}],BGMPlayer:[function(e,t,a){"use strict";cc._RF.push(t,"f6aefqoS3pBO60/hXmlPxvo","BGMPlayer");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("UserData");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.bgm=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),(r=c).prototype.onLoad=function(){r._instance=this,r.playBgm()},c.playBgm=function(){var e;0==s.UserData.data.gameSound||cc.audioEngine.isMusicPlaying()||null!=(e=this._instance)&&cc.audioEngine.playMusic(e.bgm,!0)},c.resumeBgm=function(){cc.audioEngine.isMusicPlaying()||cc.audioEngine.resumeMusic()},c.pauseBgm=function(){cc.audioEngine.pauseMusic()},c.stopBgm=function(){cc.audioEngine.stopMusic()},c.setBgmVolum=function(e){cc.audioEngine.setMusicVolume(e)},c._instance=null,__decorate([o({displayName:"\u80cc\u666f\u97f3\u4e50",type:cc.AudioClip})],c.prototype,"bgm",void 0),n=r=__decorate([n],c),i.BGMPlayer=n,cc._RF.pop()},{}],BackHomeMoreGame:[function(e,t,a){"use strict";cc._RF.push(t,"99664t9CnFCxIj7goOtNwiA","BackHomeMoreGame");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("ShareManager"),s=n("GameCommon"),c=n("MoreGameManager"),p=n("StatisticsManager"),d=n("UserData"),u=n("GameCommonHttp"),h=n("GameCommonPool"),m=n("HomeGameItem");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.moreGameItemPrefab=null,e.upContent=null,e.downContent=null,e.bg=null,e.board=null,e.btnNode=null,e.moreGameArrayLoading=!1,e.moreGameArray=new Array,e.clickAction=null,e.backAction=null,e.homeAction=null,e.show=!1,e.originalPosition=null,e.originalWidth=0,e.currentGender=null,e.itemArrays=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),f.prototype.onLoad=function(){this.clickAction=function(e,t){null!=e&&(p.StatisticsManager.uploadJumpRecord(e.gameAppId,e.gameName,"playerClick",d.ExportTypeEnum.BACK_HOME_MORE_GAME,t),window.gameCommon.getSDK.navigateToMiniProgram(e.gameAppId,e.jumpPath,function(a){a?p.StatisticsManager.uploadJumpRecord(e.gameAppId,e.gameName,"jumpSuccess",d.ExportTypeEnum.BACK_HOME_MORE_GAME,t):e.switchQRCode&&window.gameCommon.getSDK.previewImage(e.QRCode)}))},this.originalPosition=this.board.position.clone(),this.originalWidth=this.board.width},f.prototype.onEnable=function(){this.checkMoreGameConfig(),this.board.stopAllActions(),this.board.x=-this.originalWidth,this.showMoreGame(),d.UserData.addModuleShows(d.ExportTypeEnum.BACK_HOME_MORE_GAME,1)},f.prototype.onDisable=function(){this.show=!1},f.prototype.update=function(){null==this.moreGameArray||this.moreGameArray.length<=0||this.currentGender!=d.UserData.data.gender&&1==d.UserData.data.gender&&(this.currentGender=d.UserData.data.gender,this.showBoyGame())},f.prototype.initBackHomeMoreGame=function(){var e=this,t=r.ShareManager.cdnFileUrl+"/game-common/"+s.GameConfig.wxAppName+"/assets/"+s.GameConfig.versionCode+"/backHomeMoreGameConfig.txt?time="+Date.now();this.moreGameArrayLoading=!0,u.GameCommonHttp.wxHttpGet(t,function(t,a){if(e.moreGameArrayLoading=!1,0==t&&null!=a){if(null!=(a=a.moreGames))for(var n=0,o=a;n<o.length;n++){var i=o[n];i._jumpSwith&&e.addMoreGame(i._name,i._jumpImageUrl,i._jumpAppId,i._jumpPath,i._jumpSwith,i._redDot,i._QRCode,i._switchQRCode,i.gameDesc,i.rectIconUrl,i.boyGame)}e.initMoreGameItems()}})},f.prototype.checkMoreGameConfig=function(){this.moreGameArrayLoading||(null==this.moreGameArray||this.moreGameArray.length<=0)&&this.initBackHomeMoreGame()},f.prototype.addMoreGame=function(e,t,a,n,o,i,l,r,s,p,d){(s=new c.MoreGameInfo(e,t,a,n,o,i,l,r,s)).rectIconUrl=p,s.boyGame=d,this.moreGameArray.push(s)},f.prototype.initMoreGameItems=function(){if(!(null==this.moreGameArray||this.moreGameArray.length<=0)){for(var e,t,a,n=0;n<8;n++){if(null==(e=this.moreGameArray[n]))return;null!=(t=h.GameCommonPool.requestInstant(this.moreGameItemPrefab))&&(t.setParent(this.upContent),null!=(a=t.getComponent(m.HomeGameItem))&&(a.bindData(e,n+1,this.clickAction),t.active=!e.boyGame,this.itemArrays.push(t)))}for(n=8;n<this.moreGameArray.length;n++){if(null==(e=this.moreGameArray[n]))return;null!=(t=h.GameCommonPool.requestInstant(this.moreGameItemPrefab))&&(t.setParent(this.downContent),null!=(a=t.getComponent(m.HomeGameItem))&&(a.bindData(e,n+1,this.clickAction),t.active=!e.boyGame,this.itemArrays.push(t)))}}},f.prototype.showMoreGame=function(){var e;this.show||(this.btnNode.opacity=0,this.show=!0,(e=this).board.runAction(cc.sequence(cc.moveTo(.5,this.originalPosition).easing(cc.easeQuarticActionOut()),cc.callFunc(function(){e.btnNode.runAction(cc.fadeIn(.3))}))),this.bg.opacity=0,this.bg.runAction(cc.sequence(cc.delayTime(.2),cc.fadeIn(.5))))},f.prototype.showBoyGame=function(){for(var e=0,t=this.itemArrays;e<t.length;e++){var a=t[e];null!=a&&(a.active=!0)}},f.prototype.bindAction=function(e,t){this.backAction=e,this.homeAction=t},f.prototype.clickBack=function(){this.node.active=!1,this.backAction&&this.backAction()},f.prototype.clickHome=function(){this.node.active=!1,this.homeAction&&this.homeAction()},__decorate([o({type:cc.Prefab,displayName:"\u6e38\u620f\u5143\u7d20\u9884\u8bbe"})],f.prototype,"moreGameItemPrefab",void 0),__decorate([o({type:cc.Node,displayName:"\u4e0a\u754c\u9762\u5bb9\u5668"})],f.prototype,"upContent",void 0),__decorate([o({type:cc.Node,displayName:"\u4e0b\u754c\u9762\u5bb9\u5668"})],f.prototype,"downContent",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f"})],f.prototype,"bg",void 0),__decorate([o({type:cc.Node,displayName:"\u754c\u9762"})],f.prototype,"board",void 0),__decorate([o({type:cc.Node,displayName:"\u6309\u94ae"})],f.prototype,"btnNode",void 0),n=__decorate([n],f),i.BackHomeMoreGame=n,cc._RF.pop()},{}],BackHomeReturn:[function(e,t,a){"use strict";cc._RF.push(t,"7149fxnrmFAxa70eCmnWMCB","BackHomeReturn");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("GameCommonPool"),s=o("WorldEventManager"),c=o("LocalWorldEventType");function p(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this)},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},p.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},o=__decorate([o],p),i.BackHomeReturn=o,cc._RF.pop()},{}],BackHomeWarnUI:[function(e,t,a){"use strict";cc._RF.push(t,"cde71yDG+JFaoro8gBjjTTO","BackHomeWarnUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("LocalWorldEventType"),c=n("UIManager"),p=n("GameManager"),d=n("WorldEventManager"),u=n("LocalData"),h=n("LocalSoundManager"),m=n("GameState"),f=n("Connecting");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.widget=null,e.confirmAction=null,e.cancelAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.onEnable=function(){this.widget.updateAlignment()},g.prototype.update=function(){c.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},g.prototype.clickConfirm=function(){h.LocalSoundManager.playAudio("click"),cc.director.resume(),d.WorldEventManager.triggerEvent(s.LocalWorldEventType.BackHome,null),p.GameManager.backHome(),m.GameState.endlessModel?u.LocalData.data.lastEndlessDataJson=null:u.LocalData.data.lastBattleDataJson=null,f.Connecting.enterMainScene(function(){c.UIManager.showMainBoard()}),this.close()},g.prototype.clickCancel=function(){h.LocalSoundManager.playAudio("click"),this.close()},g.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Widget})],g.prototype,"widget",void 0),n=__decorate([n],g),i.BackHomeWarnUI=n,cc._RF.pop()},{}],BattleNodeManager:[function(e,t,a){"use strict";cc._RF.push(t,"1a59bSprPhBX6bLGggjFlO5","BattleNodeManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.parentNodes=[],e}i=cc.Component,__extends(s,i),(l=s).prototype.onEnable=function(){l.instance=this},s.getParentNode=function(e){var t=l.instance;if(null!=t)return null==e||e<0||e>=t.parentNodes.length?t.parentNodes[0]:t.parentNodes[e]},s.showAllNodes=function(e){var t=l.instance;null!=t&&t.parentNodes.forEach(function(t){t.active=e})},s.instance=null,__decorate([r({displayName:"\u6218\u573a\u7236\u8282\u70b9\u96c6\u5408",type:cc.Node})],s.prototype,"parentNodes",void 0),n=l=__decorate([n],s),o.BattleNodeManager=n,cc._RF.pop()},{}],BattleNumEffect:[function(e,t,a){"use strict";cc._RF.push(t,"10576QOsqZKpJKQakVTBVwr","BattleNumEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameCommonPool"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("BattleNumSpecial"),u=n("BattleNum");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.battleNum=null,e.specialBattleNum=null,e.battleNumParent=null,e.specialBattleNumParent=null,e.battleNumNodes=null,e.battleNumSpecialNodes=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onEnable=function(){this.battleNumNodes=[],this.battleNumSpecialNodes=[],c.WorldEventManager.addListener(p.LocalWorldEventType.BackHome,this.close,this)},h.prototype.onDisable=function(){c.WorldEventManager.removeListener(p.LocalWorldEventType.BackHome,this.close,this)},h.prototype.showBattleNum=function(e,t,a){var n=this,o=null;if(a.y=Math.max(-170,a.y),e==r.BattleNumTypeEnum.SECKILL||e==r.BattleNumTypeEnum.BROKE_EQUIPMENT){var i=s.GameCommonPool.requestInstant(this.specialBattleNum);if(null==i)return;var l=i.getComponent(d.BattleNumSpecial);if(null==l)return;l.bindData(e),i.setParent(this.specialBattleNumParent),i.setPosition(a),o=i}else{if(null==(l=s.GameCommonPool.requestInstant(this.battleNum)))return;if(null==(i=l.getComponent(u.BattleNum)))return;i.bindData(e,t),l.setParent(this.battleNumParent),l.setPosition(a),o=l}for(var c,p=0;p<this.battleNumSpecialNodes.length;p++)50<Math.abs(o.x-this.battleNumSpecialNodes[p].x)||(c=Math.abs(o.y-this.battleNumSpecialNodes[p].y),o.y>this.battleNumSpecialNodes[p].y&&25<c||this.battleNumSpecialNodes[p].runAction(cc.moveBy(.3,0,40)));if(e==r.BattleNumTypeEnum.HP_UP||e==r.BattleNumTypeEnum.EQUIPMENT_UP)return this.battleNumNodes.push(o),o.stopAllActions(),o.opacity=255,o.scale=.5,void o.runAction(cc.sequence(cc.moveBy(.2,0,60),cc.fadeOut(.5),cc.callFunc(function(){s.GameCommonPool.returnInstant(o)})));this.battleNumSpecialNodes.push(o),o.stopAllActions(),o.scale=.8,o.opacity=0,o.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,.45),cc.fadeIn(.2)),cc.delayTime(.5),cc.spawn(cc.scaleTo(.2,.8),cc.fadeOut(.2)),cc.callFunc(function(){s.GameCommonPool.returnInstant(o);var e=n.battleNumSpecialNodes.indexOf(o);-1!=e&&n.battleNumSpecialNodes.splice(e,1)})))},h.prototype.close=function(){null!=this.battleNumSpecialNodes&&0<this.battleNumSpecialNodes.length&&this.battleNumSpecialNodes.forEach(function(e){s.GameCommonPool.returnInstant(e)}),null!=this.battleNumNodes&&0<this.battleNumNodes.length&&this.battleNumNodes.forEach(function(e){s.GameCommonPool.returnInstant(e)}),s.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6218\u573a\u6570\u503c\u9884\u8bbe",type:cc.Prefab})],h.prototype,"battleNum",void 0),__decorate([o({displayName:"\u7279\u6b8a\u6218\u573a\u6570\u503c\u9884\u8bbe",type:cc.Prefab})],h.prototype,"specialBattleNum",void 0),__decorate([o({displayName:"\u6218\u573a\u6570\u503c\u9884\u8bbe\u7236\u8282\u70b9",type:cc.Node})],h.prototype,"battleNumParent",void 0),__decorate([o({displayName:"\u7279\u6b8a\u6218\u573a\u6570\u503c\u9884\u8bbe\u7236\u8282\u70b9",type:cc.Node})],h.prototype,"specialBattleNumParent",void 0),n=__decorate([n],h),i.BattleNumEffect=n,cc._RF.pop()},{}],BattleNumManager:[function(e,t,a){"use strict";cc._RF.push(t,"ab39dYwJ41EZoo9UDD6Gb+5","BattleNumManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("BattleNumEffect"),c=n("EnumAndConst"),p=n("GameCommonPool"),d=n("BattleNodeManager");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.battleNumEffectPrefab=null,e.battleNumEffecMap=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),(r=u).prototype.onEnable=function(){r.instance=this},u.createBattleNumEffect=function(e,t,a,n){var o,i,l=r.instance;null==l||null!=(o=d.BattleNodeManager.getParentNode(c.BattleNodeEnum.BATTLE_NUM_NODE))&&(l.battleNumEffecMap.has(a)?l.battleNumEffecMap.get(a).showBattleNum(e,t,n):null!=(i=p.GameCommonPool.requestInstant(l.battleNumEffectPrefab))&&(i.setParent(o),i.setPosition(cc.Vec2.ZERO),null!=(i=i.getComponent(s.BattleNumEffect))&&(i.showBattleNum(e,t,n),l.battleNumEffecMap.set(a,i))))},u.resetBattleNum=function(){var e=r.instance;null!=e&&(null==e.battleNumEffecMap||e.battleNumEffecMap.size<=0?e.battleNumEffecMap=new Map:(e.battleNumEffecMap.forEach(function(e){null!=e&&e.close()}),e.battleNumEffecMap.clear()))},u.instance=null,__decorate([o({displayName:"\u6218\u573a\u6570\u503c\u7279\u6548",type:cc.Prefab})],u.prototype,"battleNumEffectPrefab",void 0),n=r=__decorate([n],u),i.BattleNumManager=n,cc._RF.pop()},{}],BattleNumSpecial:[function(e,t,a){"use strict";cc._RF.push(t,"2f604fHDCVCpqTNbkkGIAuw","BattleNumSpecial");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("EnumAndConst"),p=n("GameCommonPool");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.effectSprite=null,e.effectSpriteFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.bindData=function(e){e=e==c.BattleNumTypeEnum.SECKILL?0:1,this.effectSprite.spriteFrame=this.effectSpriteFrames[e]},d.prototype.close=function(){p.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7279\u6548\u56fe\u7247",type:cc.Sprite})],d.prototype,"effectSprite",void 0),__decorate([o({displayName:"\u7279\u6548\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],d.prototype,"effectSpriteFrames",void 0),n=__decorate([n],d),i.BattleNumSpecial=n,cc._RF.pop()},{}],BattleNum:[function(e,t,a){"use strict";cc._RF.push(t,"bceb5prY0BLXbq9Sjbdv8yI","BattleNum");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameCommonPool"),d=n("EnumAndConst");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.numberArray=new Array,e.battleNum=null,e.critMark=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this)},u.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},u.prototype.bindData=function(e,t){this.critMark.active=!1,this.battleNum.value=t+"";var a=cc.Color.WHITE;switch(e){case d.BattleNumTypeEnum.HP_UP:a=new cc.Color(190,255,109,255);break;case d.BattleNumTypeEnum.HP_REDUCE:a=cc.Color.WHITE;break;case d.BattleNumTypeEnum.EQUIPMENT_UP:a=new cc.Color(149,186,239,255);break;case d.BattleNumTypeEnum.EQUIPMENT_REDUCE:a=new cc.Color(71,107,178,255);break;case d.BattleNumTypeEnum.HEAD_SHOOT:a=new cc.Color(247,60,60,255);break;case d.BattleNumTypeEnum.HEAD_SHOOT_CRIT:case d.BattleNumTypeEnum.CRIT:a=new cc.Color(247,60,60,255),this.critMark.active=!0;break;case d.BattleNumTypeEnum.ABSORB:a=cc.Color.YELLOW}this.numberArray.forEach(function(e){e.color=a})},u.prototype.close=function(){p.GameCommonPool.returnInstant(this.node)},__decorate([o([cc.Node])],u.prototype,"numberArray",void 0),__decorate([o({displayName:"\u6570\u503c",type:r.NumberImg})],u.prototype,"battleNum",void 0),__decorate([o({displayName:"\u66b4\u51fb\u6807\u8bc6",type:cc.Node})],u.prototype,"critMark",void 0),n=__decorate([n],u),i.BattleNum=n,cc._RF.pop()},{}],BattleStartUI:[function(e,t,a){"use strict";cc._RF.push(t,"11041ZvMPhL+6wfxIjDlFg5","BattleStartUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameManager"),s=n("LocalSoundManager"),c=n("LocalData"),p=n("ConfigData"),d=n("UIManager"),u=n("CommonMask"),h=n("TipManager"),m=n("GameState"),f=n("SpriteFrameManager"),g=n("WorldEventManager"),y=n("LocalWorldEventType"),v=n("GameConfigData"),D=n("AuthorizationManager"),E=n("Connecting");function S(){var e=null!==l&&l.apply(this,arguments)||this;return e.partBgAll=null,e.partBg=null,e.partTitle=null,e.energyAni=null,e.bossSprite=null,e.heroModelBtn=null,e.heroModelBtnSprite=[],e.normalModelBtn=null,e.normalModelBtnSprite=[],e.heroIcon=null,e.heroAll=null,e.heroTip=null,e.dropAll=[],e.maxPartNode=null,e.maxPartNum=null,e.eggMachineTip=null,e.selectPartBtn=null,e.endlessBtn=null,e.endlessBtnSprite=[],e.endlessBgSprite=null,e.powerCost=null,e.startBtn=null,e.continueBtn=null,e.greenDropNode=null,e.rankingButtonSprite=null,e.rankingButtonSpriteFrames=[],e.rewardButton=null,e.rewardCondition=null,e.starEffect=null,e.lastSelectChapter=null,e.energyAniStartPos=null,e.endlessUnlockChapter=5,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(S,l),S.prototype.onLoad=function(){this.energyAniStartPos=this.energyAni.position,d.UIManager.createBubbleText(this.node,cc.v2(-240,106),!1,1)},S.prototype.onEnable=function(){this.heroTip.active=!1,4==c.LocalData.temp_last_pass_chapter&&5<=c.LocalData.data.passChapter&&(c.LocalData.temp_last_pass_chapter=null,h.TipManager.showTip("\u65e0\u5c3d\u6a21\u5f0f\u5df2\u89e3\u9501!")),u.CommonMask.hideMask(),this.refreshChapter(),this.partSelectAnimation(),this.heroModelShow(),this.refreshTips(),g.WorldEventManager.addListener(y.LocalWorldEventType.RefreshActivity,this.refreshTips,this)},S.prototype.onDisable=function(){g.WorldEventManager.removeListener(y.LocalWorldEventType.RefreshActivity,this.refreshTips,this)},S.prototype.refreshTips=function(){this.eggMachineTip.active=0<c.LocalData.data.eggMachineDailyTimes},S.prototype.update=function(){this.lastSelectChapter!=c.LocalData.data.selectChapter&&(m.GameState.heroModel=!1,this.refreshChapter())},S.prototype.refreshChapter=function(){var e=c.LocalData.data.selectChapter;this.selectPartBtn.active=!0,this.bossSprite.node.active=!0,this.lastSelectChapter=e,this.partBg.spriteFrame=f.SpriteFrameManager.getFullMap(e),this.partTitle.string=p.ConfigData.MAP_NAME_ARRAY[e-1],this.bossSprite.spriteFrame=f.SpriteFrameManager.getBossSpriteFrame(e),e>c.LocalData.data.passChapter?(this.bossSprite.node.color=cc.color(0,0,0),this.heroAll.active=!1):(this.bossSprite.node.color=cc.color(255,255,255),this.heroAll.active=!m.GameState.endlessModel),this.energyAni.position=cc.v2(33,280),this.startBtn.active=!0,this.continueBtn.active=!1,m.GameState.endlessModel?(this.powerCost.string="X10",this.partBg.spriteFrame=this.endlessBgSprite,this.partTitle.string="\u65e0\u5c3d\u6a21\u5f0f",this.bossSprite.node.active=!1,this.selectPartBtn.active=!1,this.endlessBtn.spriteFrame=this.endlessBtnSprite[0],this.rankingButtonSprite.spriteFrame=this.rankingButtonSpriteFrames[1],null!=c.LocalData.data.lastEndlessDataJson&&(this.startBtn.active=!1,this.continueBtn.active=!0),null==c.LocalData.data.userInfo&&this.createUserInfoButton()):(this.powerCost.string="X5",this.endlessBtn.spriteFrame=this.endlessBtnSprite[1],this.rankingButtonSprite.spriteFrame=this.rankingButtonSpriteFrames[0],null==c.LocalData.data.userInfo&&D.AuthorizationManager.destroyAuthorizationButton()),this.heroModelShow()},S.prototype.partSelectAnimation=function(){this.partBgAll.position=cc.v2(800,-48),this.partBgAll.stopAllActions(),this.partBgAll.runAction(cc.sequence(cc.moveTo(.3,266,-48),cc.moveTo(.1,300,-48),cc.moveTo(.1,266,-48))),this.partTitle.node.position=cc.v2(270,516),this.partTitle.node.angle=0,this.partTitle.node.stopAllActions(),this.partTitle.node.runAction(cc.sequence(cc.rotateTo(.1,-5),cc.moveTo(.4,265,216),cc.spawn(cc.moveTo(.1,265,230),cc.rotateTo(.1,5)),cc.spawn(cc.moveTo(.1,265,216),cc.rotateTo(.1,0))))},S.prototype.clickSelectHeroModel=function(){s.LocalSoundManager.playAudio("click"),m.GameState.heroModel=!0,this.heroModelShow()},S.prototype.clickEndlessModel=function(){s.LocalSoundManager.playAudio("click"),c.LocalData.data.passChapter<this.endlessUnlockChapter?h.TipManager.showTip("\u901a\u8fc7\u7b2c\u4e94\u7ae0\u8282\u540e\u624d\u80fd\u89e3\u9501\u65e0\u5c3d\u6a21\u5f0f\u54e6\uff01"):(m.GameState.endlessModel=!m.GameState.endlessModel,m.GameState.endlessModel&&(m.GameState.heroModel=!1),g.WorldEventManager.triggerEvent(y.LocalWorldEventType.EndlessModel,null),this.refreshChapter())},S.prototype.clickSelectNormalModel=function(){s.LocalSoundManager.playAudio("click"),m.GameState.heroModel=!1,this.heroModelShow()},S.prototype.clickStart=function(){if(s.LocalSoundManager.playAudio("click"),m.GameState.endlessModel&&null!=c.LocalData.data.lastEndlessDataJson)return u.CommonMask.showMask(),void E.Connecting.enterGameScene(m.GameState.endlessModel,1,function(){u.CommonMask.hideMask(),r.GameManager.beginGame(!0)});var e=m.GameState.endlessModel?v.GameConfigData.data.endlessEnergyCost:v.GameConfigData.data.normalEnergyCost;c.LocalData.data.energyNum<e?d.UIManager.showGetEnergyPop():(u.CommonMask.showMask(),c.LocalData.data.energyNum-=e,this.energyAni.position=cc.v2(33,280),this.energyAni.stopAllActions(),this.energyAni.runAction(cc.sequence(cc.moveTo(.5,this.energyAniStartPos),cc.callFunc(function(){E.Connecting.enterGameScene(m.GameState.endlessModel,c.LocalData.data.selectChapter,function(){u.CommonMask.hideMask(),r.GameManager.beginGame(!1)})}))))},S.prototype.clickSelectChapter=function(){s.LocalSoundManager.playAudio("click"),d.UIManager.showSelectMapPop()},S.prototype.clickHeroTipBtn=function(){this.heroTip.active=!this.heroTip.active},S.prototype.clickDailyLogin=function(){s.LocalSoundManager.playAudio("click"),d.UIManager.showDailyLoginReward(null)},S.prototype.clickRankingUI=function(){s.LocalSoundManager.playAudio("click"),m.GameState.endlessModel?d.UIManager.showEndlessRankingUI():d.UIManager.showRankingUIPop()},S.prototype.clickEggBtn=function(){s.LocalSoundManager.playAudio("click"),d.UIManager.showEggMachineUIPop(null)},S.prototype.heroModelShow=function(){this.refreshMaxPart(),this.showDropItem(m.GameState.heroModel,m.GameState.endlessModel),this.refreshProgressReward(),m.GameState.heroModel?(this.heroModelBtn.spriteFrame=this.heroModelBtnSprite[1],this.normalModelBtn.spriteFrame=this.normalModelBtnSprite[0],this.heroIcon.active=!0):(this.heroModelBtn.spriteFrame=this.heroModelBtnSprite[0],this.normalModelBtn.spriteFrame=this.normalModelBtnSprite[1],this.heroIcon.active=!1)},S.prototype.refreshMaxPart=function(){var e,t;m.GameState.endlessModel?this.maxPartNode.active=!1:(e=m.GameState.heroModel,t=c.LocalData.data.selectChapter,(t=c.LocalData.getChapterMaxPart(e,t))<=0?this.maxPartNode.active=!1:(this.maxPartNode.active=!0,this.maxPartNum.string=t+""))},S.prototype.showDropItem=function(e,t){for(var a=c.LocalData.data.selectChapter,n=0,o=this.dropAll;n<o.length;n++)o[n].active=!0;if(this.greenDropNode.active=!0,t)return this.greenDropNode.active=!1,this.dropAll[0].active=!1,this.dropAll[1].active=!1,this.dropAll[2].active=!1,this.dropAll[3].active=!1,void(this.dropAll[4].active=!1);if(e)switch(this.dropAll[0].active=!0,a){case 1:this.dropAll[3].active=!1,this.dropAll[4].active=!1;break;case 2:case 3:case 4:this.dropAll[4].active=!1;break;case 5:case 6:case 7:this.dropAll[1].active=!1}else switch(this.dropAll[0].active=!1,a){case 1:this.dropAll[2].active=!1,this.dropAll[3].active=!1,this.dropAll[4].active=!1;break;case 2:case 3:case 4:this.dropAll[3].active=!1,this.dropAll[4].active=!1;break;case 5:case 6:case 7:this.dropAll[4].active=!1}},S.prototype.refreshProgressReward=function(){var e,t,a;m.GameState.endlessModel?this.rewardButton.active=!1:(e=m.GameState.heroModel,a=c.LocalData.data.selectChapter,(t=c.LocalData.getChapterProgressRewardCondition(e,a))<=0?this.rewardButton.active=!1:(a=c.LocalData.getChapterMaxPart(e,a),this.starEffect.active=t<=a,this.rewardButton.active=!0,this.rewardCondition.string="\u901a\u8fc7\u7b2c"+t+"\u5173"))},S.prototype.clickProgressReward=function(){var e=this;s.LocalSoundManager.playAudio("click");var t=m.GameState.heroModel,a=c.LocalData.data.selectChapter,n=c.LocalData.getChapterPregressReward(t,a),o=c.LocalData.getChapterProgressRewardCondition(t,a);d.UIManager.showChapterProgressRewardUI(t,a,o,n,function(){e.refreshProgressReward()})},S.prototype.createUserInfoButton=function(){var e,t=window.gameCommon.getSDK.getSystemInfo();null!=t&&(e=t.screenHeight/640,e={left:(t.screenWidth-1136*e)/2+436*e,top:130*e,width:100*e,height:100*e},D.AuthorizationManager.popWxAuthorization(function(e){null!=e&&(c.LocalData.data.userInfo=e),d.UIManager.showEndlessRankingUI()},"img/authorizationButton.png",e))},__decorate([o({type:cc.Node,displayName:"\u80cc\u666f"})],S.prototype,"partBgAll",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5173\u5361\u80cc\u666f"})],S.prototype,"partBg",void 0),__decorate([o({type:cc.Label,displayName:"\u5173\u5361\u6807\u9898"})],S.prototype,"partTitle",void 0),__decorate([o({type:cc.Node,displayName:"\u4f53\u529b\u52a8\u753b"})],S.prototype,"energyAni",void 0),__decorate([o({type:cc.Sprite,displayName:"boss\u56fe\u7247"})],S.prototype,"bossSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u82f1\u96c4\u6309\u94ae"})],S.prototype,"heroModelBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u82f1\u96c4\u6309\u94ae\u56fe\u7247"})],S.prototype,"heroModelBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u666e\u901a\u6309\u94ae"})],S.prototype,"normalModelBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u666e\u901a\u6309\u94ae\u56fe\u7247"})],S.prototype,"normalModelBtnSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u82f1\u96c4\u56fe\u6807"})],S.prototype,"heroIcon",void 0),__decorate([o({type:cc.Node,displayName:"\u82f1\u96c4\u6a21\u5f0f\u76f8\u5173"})],S.prototype,"heroAll",void 0),__decorate([o({type:cc.Node,displayName:"\u82f1\u96c4\u6a21\u5f0f\u89e3\u91ca"})],S.prototype,"heroTip",void 0),__decorate([o({type:cc.Node,displayName:"\u6389\u843d\u5185\u5bb9"})],S.prototype,"dropAll",void 0),__decorate([o({displayName:"\u7ae0\u8282\u5230\u8fbe\u7684\u6700\u5927\u5173\u5361\u5c55\u793a",type:cc.Node})],S.prototype,"maxPartNode",void 0),__decorate([o({displayName:"\u7ae0\u8282\u5230\u8fbe\u7684\u6700\u5927\u5173\u5361",type:cc.Label})],S.prototype,"maxPartNum",void 0),__decorate([o({displayName:"\u626d\u86cb\u673a\u63d0\u793a",type:cc.Node})],S.prototype,"eggMachineTip",void 0),__decorate([o({displayName:"\u5173\u5361\u65cb\u8f6c\u6309\u94ae",type:cc.Node})],S.prototype,"selectPartBtn",void 0),__decorate([o({displayName:"\u65e0\u5c3d\u6a21\u5f0f\u6309\u94ae",type:cc.Sprite})],S.prototype,"endlessBtn",void 0),__decorate([o({displayName:"\u65e0\u5c3d\u6a21\u5f0f\u6309\u94ae\u56fe\u7247",type:cc.SpriteFrame})],S.prototype,"endlessBtnSprite",void 0),__decorate([o({displayName:"\u65e0\u5c3d\u6a21\u5f0f\u80cc\u666f\u56fe\u7247",type:cc.SpriteFrame})],S.prototype,"endlessBgSprite",void 0),__decorate([o({displayName:"\u4f53\u529b\u82b1\u8d39",type:cc.Label})],S.prototype,"powerCost",void 0),__decorate([o({displayName:"\u5f00\u59cb\u6309\u94ae",type:cc.Node})],S.prototype,"startBtn",void 0),__decorate([o({displayName:"\u7ee7\u7eed\u6309\u94ae",type:cc.Node})],S.prototype,"continueBtn",void 0),__decorate([o({displayName:"\u7cbe\u826f\u6389\u843d\u8282\u70b9",type:cc.Node})],S.prototype,"greenDropNode",void 0),__decorate([o({displayName:"\u6392\u884c\u699c\u5f0f\u6309\u94ae\u56fe\u7247",type:cc.Sprite})],S.prototype,"rankingButtonSprite",void 0),__decorate([o({displayName:"\u6392\u884c\u699c\u5f0f\u6309\u94ae\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],S.prototype,"rankingButtonSpriteFrames",void 0),__decorate([o({displayName:"\u5173\u5361\u8fdb\u5ea6\u5956\u52b1\u6309\u94ae",type:cc.Node})],S.prototype,"rewardButton",void 0),__decorate([o({displayName:"\u5173\u5361\u8fdb\u5ea6\u5956\u52b1\u6761\u4ef6",type:cc.Label})],S.prototype,"rewardCondition",void 0),__decorate([o({displayName:"\u5173\u5361\u8fdb\u5ea6\u5956\u52b1\u661f\u661f\u7279\u6548",type:cc.Node})],S.prototype,"starEffect",void 0),n=__decorate([n],S),i.BattleStartUI=n,cc._RF.pop()},{}],BattleUI:[function(e,t,a){"use strict";cc._RF.push(t,"c0b20eEMvpP6rBZMr1ey45P","BattleUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("NumberImg"),c=n("GameManager"),p=n("ConfigData"),d=n("UIManager"),u=n("LocalSoundManager"),h=n("SkillDescribeEffect"),m=n("EnemyArea"),f=n("Timer"),g=n("ShareVideoControl"),y=n("TipManager"),v=n("ShareManager"),D=n("RoleManager"),E=n("LocalData"),S=n("GameState"),A=n("EffectCreate"),C=n("PlayerState"),M=n("HpSlider"),T=n("EndlessModelConfigData"),_=n("WorldEventManager"),k=n("LocalWorldEventType"),P=n("AdManager");function R(){var e=null!==l&&l.apply(this,arguments)||this;return e.currentPart=null,e.nextPart=null,e.bossPart=null,e.finishNode=null,e.partPro=null,e.playerHpSprite=null,e.shieldDefenseSprite=null,e.helmetDefenseSprite=null,e.playerLevelNum=null,e.playerExpSprite=null,e.rewardCoin=null,e.hpNum=null,e.shieldDefenseNum=null,e.helmetDefenseNum=null,e.skillDescribeBg=null,e.bossHpNode=null,e.bossHpSlider=null,e.lightningBtn=null,e.btnNode=null,e.part=null,e.totalEnemyCount=null,e.killCount=null,e.playerHp=null,e.playerMaxHp=null,e.shieldDefense=null,e.helmetDefense=null,e.playerRewards=null,e.bossData=null,e.bossHp=null,e.isInit=!1,e.usedLightningSkill=!1,e.addExpTween=null,e.expSlideMsg=[],e.isAddingExp=!1,e.bannerRefrshInterval=0,e.canShowBanner=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(R,l),(r=R).prototype.onLoad=function(){(r.instance=this).playerExpSprite.fillRange=0,d.UIManager.createBubbleText(this.node,cc.v2(-450,-110),!0,0);var e,t=window.gameCommon.getSDK.getSystemInfo();null==t||t.model.includes("iPhone X")?this.canShowBanner=!1:(e=t.screenHeight,t=t.screenWidth,this.canShowBanner=!(t-300<e/640*1136/t*582))},R.prototype.onEnable=function(){_.WorldEventManager.addListener(k.LocalWorldEventType.AddExp,this.refreshExpSlider,this),this.isInit=!1,this.usedLightningSkill=!1,this.expSlideMsg=[],this.isAddingExp=!1,r.bannerShow=!1,this.bannerRefrshInterval=0,this.reset(),this.skillDescribeBg.active=!1,this.refreshStatus(),this.refrshChapter(),this.ifShowAutoAtkBtn()},R.prototype.onDisable=function(){this.addExpTween&&this.addExpTween.stop(),this.addExpTween=null,_.WorldEventManager.removeListener(k.LocalWorldEventType.AddExp,this.refreshExpSlider,this)},R.prototype.update=function(e){if(this.refreshBossHp(),this.refreshBanner(e),null!=(e=C.PlayerState.playerData)){if(!this.isInit)return this.isInit=!0,void this.initPlayerData(e);null==e||e.maxHp==this.playerMaxHp&&e.hp==this.playerHp&&e.shieldDefense==this.shieldDefense&&e.helmetDefense==this.helmetDefense||this.refreshStatus(),e.rewardCoin!=this.playerRewards&&this.refreshCoin(),this.part==S.GameState.currentPart&&this.killCount==m.EnemyArea.killEnemyCount||this.refrshChapter(),0==C.PlayerState.reviveCount||this.usedLightningSkill||S.GameState.isBossPart?this.lightningBtn.active=!1:this.lightningBtn.active=!0}},R.prototype.initPlayerData=function(e){this.playerLevelNum.value="lv."+e.level;var t=S.GameState.endlessModel?T.EndlessModelConfigData.getEndlessLevelUpExp(e.level):p.ConfigData.getLevelUpExp(e.level,S.GameState.currentChapter);this.playerExpSprite.fillRange=e.exp/t,this.refreshStatus(),this.refreshCoin()},R.prototype.reset=function(){this.bossData=null,this.bossHpSlider.initHpSlider(),this.bossHpNode.active=!1,this.playerLevelNum.value="lv.1",this.playerExpSprite.fillRange=0},R.prototype.refrshChapter=function(){this.part=S.GameState.currentPart;var e=this.part+1;this.totalEnemyCount=m.EnemyArea.totalEnemyCount,this.killCount=m.EnemyArea.killEnemyCount,this.currentPart.value=this.part+"",this.nextPart.value=e+"",this.partPro.fillRange=this.killCount/this.totalEnemyCount,S.GameState.endlessModel?this.finishNode.active=!1:this.finishNode.active=21==e;var t=p.ConfigData.isBossPart(this.part);e=p.ConfigData.isBossPart(e),t?(this.bossPart.active=!0,this.bossPart.position=cc.v2(-108,-4),this.currentPart.node.active=!1,S.GameState.endlessModel?this.nextPart.node.active=!0:this.nextPart.node.active=10==this.part):e?(this.bossPart.active=!0,this.bossPart.position=cc.v2(108,-4),this.currentPart.node.active=!0,this.nextPart.node.active=!1):(this.bossPart.active=!1,this.currentPart.node.active=!0,this.nextPart.node.active=!0)},R.prototype.refreshStatus=function(){var e=C.PlayerState.playerData;null!=e&&(this.playerHp=e.hp,this.playerMaxHp=e.maxHp,this.shieldDefense=e.shieldDefense,this.helmetDefense=e.helmetDefense,this.playerHpSprite.fillRange=e.hp/e.maxHp,this.shieldDefenseSprite.fillRange=null==e.shieldIndex?0:e.shieldDefense/e.maxShieldDefense,this.helmetDefenseSprite.fillRange=null==e.helmetIndex?0:e.helmetDefense/e.maxHelmetDefense,this.hpNum.value=e.hp+"",this.shieldDefenseNum.value=e.shieldDefense+"",this.helmetDefenseNum.value=e.helmetDefense+"")},R.prototype.refreshCoin=function(){var e=C.PlayerState.playerData;null!=e&&(this.rewardCoin.value=""+Math.round(e.rewardCoin))},R.prototype.refreshExpSlider=function(e){var t=this;if(null!=e&&null!=e.lastlevel&&null!=e.currentExpPercent&&null!=e.addTime&&null!=e.isSlide&&(this.playerLevelNum.value="lv."+e.lastlevel,!(e.lastlevel>=T.EndlessModelConfigData.endlessMaxLevel)))if(this.isAddingExp)this.expSlideMsg.push(e);else{if(!e.isSlide)return this.playerLevelNum.value="lv."+e.lastlevel,void(this.playerExpSprite.fillRange=e.currentExpPercent);this.isAddingExp=!0,this.addExpTween&&this.addExpTween.stop(),this.addExpTween=null,this.addExpTween=new cc.Tween,this.addExpTween.target(this.playerExpSprite),this.addExpTween.to(e.addTime,{fillRange:e.currentExpPercent},null),this.addExpTween.call(function(){t.addExpTween&&t.addExpTween.stop(),t.addExpTween=null,t.isAddingExp=!1,e.currentExpPercent<1?t.playerLevelNum.value="lv."+e.lastlevel:t.playerLevelNum.value="lv."+(e.lastlevel+1),1<=e.currentExpPercent&&e.lastlevel<T.EndlessModelConfigData.endlessMaxLevel-1&&(t.playerExpSprite.fillRange=0);var a=t.expSlideMsg.shift();null!=a&&t.refreshExpSlider(a)}),this.addExpTween.start()}},R.showSkillDescribe=function(e){var t,a=r.instance;null==a||null==e||null!=(a=(t=a.skillDescribeBg).getComponent(h.SkillDescribeEffect))&&(a.skillIndex=e,t.active=!0)},R.prototype.refreshBossHp=function(){S.GameState.isBossPart?(S.GameState.isBossPart&&(null==this.bossData||this.bossData.isDead)&&(this.bossData=c.GameManager.getBossData(),this.bossHpNode.active=!0),null!=this.bossData&&this.bossHp!=this.bossData.hp&&(this.bossHp=this.bossData.hp,this.bossHpSlider.updateHpSlider(this.bossData.hp,this.bossData.maxHp))):this.bossHpNode.active=!1},R.prototype.clickGamePause=function(){u.LocalSoundManager.playAudio("click"),d.UIManager.showGamePausePop()},R.prototype.clickGetHelp=function(){u.LocalSoundManager.playAudio("click"),d.UIManager.showNoobGuidePop(null)},R.prototype.clickLightningSkill=function(){var e,t=this;return S.GameState.isGaming?S.GameState.isBossPart?(u.LocalSoundManager.playAudio("click"),void y.TipManager.showTip("boss\u5173\u5361\u65e0\u6cd5\u4f7f\u7528")):(S.GameState.isGaming=!1,void(v.ShareManager.getShareControlType()!=v.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?g.ShareVideoControl.videoFunc("\u5168\u5c4f\u95ea\u7535\u6280\u80fd",a,e=function(){cc.director.resume(),S.GameState.isGaming=!0},a,e,function(){cc.director.pause()},g.VideoAdIdEnum.REVIVE_ID):a())):(u.LocalSoundManager.playAudio("click"),void y.TipManager.showTip("\u6e38\u620f\u8fdb\u884c\u4e2d\u624d\u53ef\u4f7f\u7528"));function a(){cc.director.resume();for(var e=m.EnemyArea.enemyDataArray,a=C.PlayerState.playerData,n=0,o=0;o<e.length;o++)!function(){var t=e[o];null==t||t.isDead||t.isBoss||(f.TimerManager.addTimer(.2*n,function(){t.isTeleporting||A.EffectCreate.createLightning(t,function(){u.LocalSoundManager.playAudio("lightning"),D.RoleManager.roleIsDamaged(t,a,p.ConfigData.MAX_DAMAGE,t.logicPos)})}),n++)}();c.GameManager.shakeEffect(.2*n+.2),t.usedLightningSkill=!0,S.GameState.isGaming=!0}},R.prototype.ifShowAutoAtkBtn=function(){var e,t;S.GameState.endlessModel?this.btnNode.active=!1:(e=S.GameState.heroModel,t=E.LocalData.data.selectChapter,!e&&t<=1?this.btnNode.active=!1:(t=E.LocalData.getChapterMaxPart(e,t),this.btnNode.active=1<=(t=null==t?0:t)))},R.prototype.refreshBanner=function(e){if(this.canShowBanner&&v.ShareManager.getBannerAdControl())if(0<this.bannerRefrshInterval)this.bannerRefrshInterval-=e;else{var t;if(this.bannerRefrshInterval=.1,(!(e=d.UIManager.hasPopUI()||S.GameState.isBossPart)||r.bannerShow)&&(e||!r.bannerShow)){if(e&&r.bannerShow)return r.bannerShow=!1,void P.AdManager.hideBannerAd();e||r.bannerShow||(null!=(e=window.gameCommon.getSDK.getSystemInfo())?(t=e.screenHeight,e=380*e.screenWidth/1136,r.bannerShow=!0,P.AdManager.loadAndShowBannerAd(e,1e4,240,function(e,a){null!=e?e.style.top=t-a.height:r.bannerShow=!1})):r.bannerShow=!1)}}},R.instance=null,R.bannerShow=!1,__decorate([o({displayName:"\u5f53\u524d\u5173\u5361",type:s.NumberImg})],R.prototype,"currentPart",void 0),__decorate([o({displayName:"\u4e0b\u4e00\u5173\u5361",type:s.NumberImg})],R.prototype,"nextPart",void 0),__decorate([o({displayName:"boss\u5173\u63d0\u793a",type:cc.Node})],R.prototype,"bossPart",void 0),__decorate([o({displayName:"\u901a\u5173\u63d0\u793a",type:cc.Node})],R.prototype,"finishNode",void 0),__decorate([o({displayName:"\u5173\u5361\u8fdb\u5ea6\u6761",type:cc.Sprite})],R.prototype,"partPro",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u8840\u6761",type:cc.Sprite})],R.prototype,"playerHpSprite",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u62a4\u76fe\u62a4\u7532\u503c",type:cc.Sprite})],R.prototype,"shieldDefenseSprite",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u5934\u76d4\u62a4\u7532\u503c",type:cc.Sprite})],R.prototype,"helmetDefenseSprite",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u7b49\u7ea7",type:s.NumberImg})],R.prototype,"playerLevelNum",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u7ecf\u9a8c\u503c\u8fdb\u5ea6",type:cc.Sprite})],R.prototype,"playerExpSprite",void 0),__decorate([o({displayName:"\u5956\u52b1\u91d1\u5e01",type:s.NumberImg})],R.prototype,"rewardCoin",void 0),__decorate([o({displayName:"\u751f\u547d\u503c",type:s.NumberImg})],R.prototype,"hpNum",void 0),__decorate([o({displayName:"\u76fe\u724c\u62a4\u7532\u503c",type:s.NumberImg})],R.prototype,"shieldDefenseNum",void 0),__decorate([o({displayName:"\u5934\u76d4\u62a4\u7532\u503c",type:s.NumberImg})],R.prototype,"helmetDefenseNum",void 0),__decorate([o({displayName:"\u6280\u80fd\u63cf\u8ff0",type:cc.Node})],R.prototype,"skillDescribeBg",void 0),__decorate([o({displayName:"boss\u8840\u6761\u8282\u70b9",type:cc.Node})],R.prototype,"bossHpNode",void 0),__decorate([o({displayName:"boss\u8840\u6761",type:M.HpSlider})],R.prototype,"bossHpSlider",void 0),__decorate([o({displayName:"\u5168\u5c4f\u95ea\u7535\u6309\u94ae",type:cc.Node})],R.prototype,"lightningBtn",void 0),__decorate([o({displayName:"\u6309\u94ae\u5c42",type:cc.Node})],R.prototype,"btnNode",void 0),n=r=__decorate([n],R),i.BattleUI=n,cc._RF.pop()},{}],BgAni:[function(e,t,a){"use strict";cc._RF.push(t,"c28c6lYx1JEc4DEWpJXnYaa","BgAni");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameState"),p=n("GameCommonPool");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.bg=null,e.bgUpL=null,e.bgUpR=null,e.bgWeaponPrefab=null,e.move=!1,e.bgWeapons=[],e.moving=!1,e.moveX=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onLoad=function(){this.createBgWeapon()},d.prototype.onEnable=function(){this.move&&(r.WorldEventManager.addListener(s.LocalWorldEventType.ShowMainUI,this.startAni,this),r.WorldEventManager.addListener(s.LocalWorldEventType.HideMainUI,this.stopAni,this),r.WorldEventManager.addListener(s.LocalWorldEventType.EndlessModel,this.changeBg,this),this.changeBg())},d.prototype.onDisable=function(){this.move&&(r.WorldEventManager.removeListener(s.LocalWorldEventType.ShowMainUI,this.startAni,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.HideMainUI,this.stopAni,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.EndlessModel,this.changeBg,this))},d.prototype.update=function(e){var t,a=this;this.moving&&(this.moveX+=t=-50*e,this.bgWeapons.forEach(function(e){null!=e&&(e.x=e.x+t,a.moveX<=-200&&e.x<=-890&&(e.x=e.x+1600))}),this.moveX<=-200&&(this.moveX=0))},d.prototype.changeBg=function(){c.GameState.endlessModel?(this.bg.color=cc.color(78,84,201),this.bgUpL.color=cc.color(23,25,93),this.bgUpR.color=cc.color(23,25,93)):(this.bg.color=cc.color(44,104,155),this.bgUpL.color=cc.color(23,51,93),this.bgUpR.color=cc.color(23,51,93))},d.prototype.createBgWeapon=function(){for(var e=0;e<8;e++){var t=p.GameCommonPool.requestInstant(this.bgWeaponPrefab);null!=t&&(t.parent=this.node,this.bgWeapons.push(t),t.x=200*e-690,t.y=e%2*100)}},d.prototype.startAni=function(){this.moving=!0},d.prototype.stopAni=function(){this.moving=!1},__decorate([o({type:cc.Node})],d.prototype,"bg",void 0),__decorate([o({type:cc.Node})],d.prototype,"bgUpL",void 0),__decorate([o({type:cc.Node})],d.prototype,"bgUpR",void 0),__decorate([o({type:cc.Prefab,displayName:"\u80cc\u666f\u6b66\u5668\u9884\u8bbe"})],d.prototype,"bgWeaponPrefab",void 0),__decorate([o({displayName:"\u79fb\u52a8\u52a8\u753b"})],d.prototype,"move",void 0),n=__decorate([n],d),i.BgAni=n,cc._RF.pop()},{}],BlastEffect:[function(e,t,a){"use strict";cc._RF.push(t,"7da04qe1p5MOIjlNbYEChZ+","BlastEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("EnumAndConst"),c=n("SkillSystem"),p=n("WorldEventManager"),d=n("LocalWorldEventType"),u=n("LocalSoundManager"),h=n("Util"),m=n("ConfigData"),f=n("EnemyArea"),g=n("SingleEffectManager"),y=n("RoleManager"),v=n("GameState");function D(){var e=null!==l&&l.apply(this,arguments)||this;return e.blastAni=null,e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(D,l),D.prototype.onEnable=function(){u.LocalSoundManager.playBlastAudio(),this.blastAni.play("Blast"),this.blastAni.on("finished",this.close,this),p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this)},D.prototype.onDisable=function(){this.blastAni.off("finished",this.close,this),p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},D.prototype.bindData=function(e){this.roleData=e,this.casueDamage()},D.prototype.casueDamage=function(){if(v.GameState.isGaming)for(var e=f.EnemyArea.enemyDataArray,t=0;t<e.length;t++){var a=e[t];if(null!=a&&!a.isDead&&a.isEnemy&&!a.isTeleporting){var n=!1;if(h.Util.getDistance(this.node.position,a.logicPos)>m.ConfigData.BLAST_RANGE){if(null==a.headPosition)continue;if(h.Util.getDistance(this.node.position,a.headPosition)>m.ConfigData.BLAST_RANGE)continue;n=!0}var o=c.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.BLAST);o=Math.floor(this.roleData.atk*o),y.RoleManager.roleIsDamaged(a,this.roleData,o,a.logicPos),a.invincibleTime<=0&&(o=n?a.headPosition:a.logicPos,n=this.node.x>this.roleData.logicPos.x?1:-1,g.SingleEffectManager.showBloodEffect(o,n,a))}}},D.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7206\u70b8\u52a8\u753b",type:cc.Animation})],D.prototype,"blastAni",void 0),n=__decorate([n],D),i.BlastEffect=n,cc._RF.pop()},{}],Body:[function(e,t,a){"use strict";cc._RF.push(t,"d8c7aICPUZKiIRc8s/xPV7V","Body");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.isSkinArmor=!1,e.roleData=null,e}i=cc.Component,__extends(r,i),r.prototype.bindData=function(e){this.roleData=e,this.node.scale=this.roleData.isBoss?2:1},__decorate([l({displayName:"\u662f\u5426\u662f\u9e9f\u7532"})],r.prototype,"isSkinArmor",void 0),n=__decorate([n],r),o.Body=n,cc._RF.pop()},{}],BossBubbleText:[function(e,t,a){"use strict";cc._RF.push(t,"52d4akD61FO+LhQnv+rxAqY","BossBubbleText");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool"),p=n("GameConfigData"),d=n("Util");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.bubbleLable=null,e.bossData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this)},u.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},u.prototype.update=function(){null!=this.bossData&&!this.bossData.isDestroy||this.close()},u.prototype.lateUpdate=function(){null!=this.bossData&&null!=this.bossData.headPosition&&(this.node.position=this.bossData.headPosition.add(cc.v2(0,100)))},u.prototype.bindData=function(e,t){var a=this;this.bossData=e;var n=null;switch(t){case 0:n=p.GameConfigData.data.boss7FirstBornText;break;case 1:n=p.GameConfigData.data.boss7FirstFailText;break;case 2:n=p.GameConfigData.data.boss7SecondBornText;break;case 3:n=p.GameConfigData.data.boss7FireSkillText}null==n||n.length<=0?this.close():(this.bubbleLable.string=d.Util.getRandomValueFromArray(n),this.node.scale=0,this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){a.node.height=a.bubbleLable.node.height+16}),cc.scaleTo(.1,-1.1,1.1),cc.scaleTo(.05,-.9,.9),cc.scaleTo(.05,-1,1),cc.delayTime(3),cc.scaleTo(.1,0),cc.callFunc(function(){a.close()}))))},u.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6c14\u6ce1\u6587\u672c\u6846",type:cc.Label})],u.prototype,"bubbleLable",void 0),n=__decorate([n],u),i.BossBubbleText=n,cc._RF.pop()},{}],BossFive:[function(e,t,a){"use strict";cc._RF.push(t,"07d57Etw5lHx7TzI/erni0V","BossFive");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameManager"),c=n("Head"),p=n("Timer"),d=n("Util"),u=n("ConfigData"),h=n("WorldEventManager"),m=n("LocalWorldEventType"),f=n("BattleNodeManager"),g=n("GameCommonPool"),y=n("MagicBallBlast"),v=n("LocalSoundManager"),D=n("Laser"),E=n("EnemyArea"),S=n("SingleEffectManager"),A=n("LongRoleBase"),C=n("RoleManager"),M=n("GameState"),T=n("EffectCreate"),_=n("PlayerState"),k=n("GameConfigData"),P=n("EquipmentEffectSystem");function R(){var e=null!==l&&l.apply(this,arguments)||this;return e.thruster=null,e.laserPrefab=null,e.teleportSkillTime=0,e.ultimateSkillTime=0,e.isUsingSkill=!1,e.laserCount=0,e.laserGunCount=0,e.teleportSkillReady=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=A.LongRoleBase,__extends(R,l),R.prototype.onEnable=function(){h.WorldEventManager.addListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.teleportSkillTime=0,this.targetForce=null,this.ultimateSkillTime=0,this.isUsingSkill=!1,this.laserCount=0,this.laserGunCount=0,this.teleportSkillReady=!1,this.roleUp.scale=2,this.roleDown.scale=2,this.node.scale=1,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null)},R.prototype.onDisable=function(){h.WorldEventManager.removeListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},R.prototype.update=function(e){this.refreshSkillTime(e)},R.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},R.prototype.bindData=function(e,t,a){this.thruster.active=!1,this.roleData=e;var n=a.getComponent(c.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},R.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttackForce()},R.prototype.setAttackForce=function(e){var t,a,n;void 0===e&&(e=!1),null!=this.roleData&&!this.roleData.isDead&&(this.searchAttackTargetData(),this.attackTargetData&&this.currentArrow&&M.GameState.isGaming)&&(this.setHitRate(),this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce),a=this.attackTargetData.logicPos,n=d.Util.getRandomFloatNum(a.x-30,a.x+30),t=d.Util.getRandomFloatNum(a.y+40,a.y-40),a=cc.v2(n,t),n=this.roleData.logicPos.x-a.x,t=-(this.roleData.logicPos.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*s.GameManager.getGravity()*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.randomAttackAngle(e))},R.prototype.randomAttackAngle=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&this.attackTargetData&&this.currentArrow&&M.GameState.isGaming){var a=-(d.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+150*this.roleData.orientation);if(e)return this.roleUp.angle=a,this.spineController.refreshWeapon(),void this.launch();var n=e?.5:d.Util.getRandomFloatNum(1,2);e=e?1:n+1,M.GameState.heroModel&&(n/=k.GameConfigData.data.heroBossArrakFrequency,e/=k.GameConfigData.data.heroBossArrakFrequency),this.isUsingSkill||this.roleUp.runAction(cc.rotateTo(n,a)),p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||t.roleData.isTeleporting||t.launch()},this.node)}},R.prototype.launch=function(){var e,t,a,n,o=this;null!=this.roleData&&!this.roleData.isDead&&this.currentArrow&&(t=this.currentArrow.node.position,n=this.attackTargetData.logicPos,a=null,n=Math.random()<=this.hitRate?(e=d.Util.getRandomFloatNum(n.x-20,n.x+20),d.Util.getRandomFloatNum(n.y+35,n.y-25)):(e=Math.random()<.5?d.Util.getRandomFloatNum(n.x+80,n.x+100):d.Util.getRandomFloatNum(n.x-120,n.x-140),n.y),a=cc.v2(e,n),n=t.x-a.x,t=-(t.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*u.ConfigData.bossWeaponConfigDatas[this.roleData.weaponIndex].gravity*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.roleData.weaponLaunch=!0,n=this.targetForce,n=this.currentArrow.launch(n,.15,0,null,2),C.RoleManager.addWaitingLaunchArrow(this.roleData,n),this.currentArrow=null,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){o.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),10<=o.ultimateSkillTime?o.useTeleportSkill(!0):o.teleportSkillReady||5<=o.teleportSkillTime?o.useTeleportSkill(!1):(o.equipWeapon(),o.setAttackForce())}))},R.prototype.refreshSkillTime=function(e){M.GameState.isGaming&&(null==this.roleData||this.roleData.isDead||(this.teleportSkillTime+=e,this.ultimateSkillTime+=e))},R.prototype.useTeleportSkill=function(e){var t,a=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,this.teleportSkillReady?this.teleportSkillReady=!1:this.teleportSkillTime=0,this.roleData.isTeleporting=!0,T.EffectCreate.createAppearEffect(this.roleData.logicPos),t=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),S.SingleEffectManager.clearInsertArrows(this.roleData),p.TimerManager.addTimer(.8,function(){if(null!=a.roleData&&!a.roleData.isDead&&!a.roleData.isDestroy){E.EnemyArea.setEnemyPostionMap(t.x,null);var n=e?cc.v2(440,d.Util.getRandomFloatNum(0,160)):E.EnemyArea.getEmptyPosition(a.roleData);if(null==n)return a.node.position=a.roleData.logicPos,void(a.footRest&&a.footRest.updatePosition());a.roleData.logicPos=n,T.EffectCreate.createAppearEffect(a.roleData.logicPos),a.node.position=a.roleData.logicPos,a.footRest&&a.footRest.updatePosition(),E.EnemyArea.setEnemyPostionMap(a.roleData.logicPos.x,a.roleData),a.roleData.isTeleporting=!1,e?a.useUltimateSkill():(a.equipWeapon(),a.setAttackForce(!0))}},this.node))},R.prototype.useUltimateSkill=function(){var e=this;null==this.roleData||this.roleData.isDead||(h.WorldEventManager.triggerEvent(m.LocalWorldEventType.ShowBubble,{type:42}),null==f.BattleNodeManager.getParentNode(r.BattleNodeEnum.PARTICLE_NODE))||(this.ultimateSkillTime=0,this.isUsingSkill=!0,this.roleUp.stopAllActions(),this.roleUp.angle=0,this.spineController.playAnimation(r.SpineAniNameEnum.Magic_atk,!0,!1,function(){if(null!=_.PlayerState.playerData){var t=f.BattleNodeManager.getParentNode(r.BattleNodeEnum.EFFECT_NODE);if(null!=t){e.laserGunCount=e.roleData.isUltimateBoss?3:1,M.GameState.heroModel&&e.laserGunCount++,e.laserCount=e.laserGunCount;for(var a=0;a<e.laserGunCount;a++){var n=g.GameCommonPool.requestInstant(e.laserPrefab);if(null==n)return;if(n.setParent(t),null==(n=n.getComponent(D.Laser)))return;n.bindData(e.roleData,function(){e.brokeLaserGun()},function(){return e.laserCount},function(){e.turnOffLaser()})}e.isUsingSkill=!1,e.ultimateSkillTime=0,e.useTeleportSkill(!1)}}}))},R.prototype.turnOffLaser=function(){this.laserCount--},R.prototype.brokeLaserGun=function(){this.laserGunCount--,this.laserGunCount<=0&&(v.LocalSoundManager.stopLaserAudio(),s.GameManager.shakeEffect(0))},R.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isUsingSkill?this.isHitAniRunning=!1:this.isHitAniRunning||(this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},R.prototype.isFroze=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){if(this.isUsingSkill)return this.roleData.isFrozening=!1,void T.EffectCreate.createRoleTip(this.roleData.logicPos,1);this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),p.TimerManager.pasueAllTimers(this.node),C.RoleManager.pauseWaitingLaunchArrows(this.roleData);var t=this.roleData.frozenTime;p.TimerManager.addTimer(t,function(){null==e.roleData||e.roleData.isDead||e.roleData.isDestroy||(e.roleData.isFrozening=!1,e.spineController.pauseAnimation(!1),e.roleUp.resumeAllActions(),p.TimerManager.resumeAllTimers(e.node),C.RoleManager.resumeWaitingLaunchArrows(e.roleData),e.teleportSkillReady=!0)},this.node)}},R.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),C.RoleManager.hitRole(this.roleData))},R.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,C.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),this.spineController.pauseAnimation(!1),p.TimerManager.removeAllTimers(this.node),s.GameManager.killEnemy(this.roleData,!0),P.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?r.SpineAniNameEnum.D2:r.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,function(){p.TimerManager.addTimer(.1,function(){var e,a;null!=t.roleData&&(g.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,e=-110-t.roleData.logicPos.y,a=Math.abs(e)/300,t.node.runAction(cc.sequence(cc.moveBy(a,0,e),cc.callFunc(function(){var e;t.roleData.isUltimateBoss?(e=t.roleData.logicPos.clone(),t.roleUp.runAction(cc.scaleTo(.5,3)),t.node.runAction(cc.sequence(cc.sequence(cc.moveTo(.05,e.add(cc.v2(5,11))),cc.moveTo(.05,e.add(cc.v2(-6,15))),cc.moveTo(.05,e.add(cc.v2(-3,15))),cc.moveTo(.05,e.add(cc.v2(3,16))),cc.moveTo(.05,e.add(cc.v2(-5,25))),cc.moveTo(.05,e.add(cc.v2(2,24))),cc.moveTo(.05,e.add(cc.v2(-8,28))),cc.moveTo(.05,e.add(cc.v2(3,38))),cc.moveTo(.05,e.add(cc.v2(-3,36))),cc.moveTo(.05,e.add(cc.v2(0,40)))),cc.callFunc(function(){E.EnemyArea.bossAlive=!1,s.GameManager.passPart(),v.LocalSoundManager.playBlastAudio();var e,a,n=f.BattleNodeManager.getParentNode(r.BattleNodeEnum.EFFECT_NODE);null!=n&&(null==(e=E.EnemyArea.createMaigcBallBlast())||null!=(a=e.getComponent(y.MagicBallBlast))&&(e.setParent(n),e.setPosition(t.node.position),a.showBlast(null,null,!0,2),t.roleData.isDestroy=!0,t.close()))})))):t.escape()}))))},t.node)}))},R.prototype.escape=function(){var e=this;null==this.currentArrow||this.roleData.weaponLaunch||(this.currentArrow.node.destroy(),this.currentArrow=null,this.spineController.equipWeapon(null)),S.SingleEffectManager.clearInsertArrows(this.roleData),this.roleData.orientation=-1,this.roleUp.scaleX*=this.roleData.orientation,this.roleDown.scaleX*=this.roleData.orientation,this.thruster.active=!0,this.spineController.playAnimation(r.SpineAniNameEnum.Magic_st,!0,!0,null);var t=cc.v2(800,160),a=d.Util.getDistance(this.roleData.logicPos,t)/300;this.node.runAction(cc.sequence(cc.moveTo(a,t),cc.callFunc(function(){E.EnemyArea.bossAlive=!1,s.GameManager.passPart(),e.roleData.isDestroy=!0,e.close()})))},__decorate([o({displayName:"\u63a8\u8fdb\u5668",type:cc.Node})],R.prototype,"thruster",void 0),__decorate([o({displayName:"\u6fc0\u5149",type:cc.Prefab})],R.prototype,"laserPrefab",void 0),n=__decorate([n],R),i.BossFive=n,cc._RF.pop()},{}],BossFlyHead:[function(e,t,a){"use strict";cc._RF.push(t,"20be7tWaiNEyI6wtGMvorFI","BossFlyHead");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameManager"),p=n("BattleNodeManager"),d=n("EnumAndConst"),u=n("MagicBallBlast"),h=n("LocalSoundManager"),m=n("Util"),f=n("Head"),g=n("MagicBall"),y=n("Timer"),v=n("EnemyArea"),D=n("GameCommonPool"),E=n("RoleBase"),S=n("GameState"),A=n("EffectCreate"),C=n("PlayerState"),M=n("ConfigData"),T=n("EquipmentEffectSystem");function _(){var e=null!==l&&l.apply(this,arguments)||this;return e.fireBallPrefab=null,e.partical=null,e.headNode=null,e.demonHead=null,e.moveSpeed=250,e.fireBallMoveSpeed=350,e.stayGroundPosY=-150,e.roleHead=null,e.isUsingSkill=!1,e.fireBallSkillTime=0,e.passiveSkillTime=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=E.RoleBase,__extends(_,l),_.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.addListener(s.LocalWorldEventType.NextPart,this.close,this),this.roleData=null,this.roleHead=null,this.isUsingSkill=!1,this.fireBallSkillTime=0,this.passiveSkillTime=0,this.headNode.active=!0,this.demonHead.opacity=0,this.node.scale=2,h.LocalSoundManager.playAudio("laugh")},_.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.NextPart,this.close,this)},_.prototype.update=function(e){null!=this.roleData&&(this.refreshDeadState(),null!=this.roleHead&&this.roleHead.isValid&&(this.roleHead.angle=this.node.angle,this.roleHead.position=this.node.position),this.roleData.isDead||(this.prepareFireBallSkill(e),this.refreshPassiveSkill(e)))},_.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},_.prototype.bindFlyHeadData=function(e,t){var a=this;this.roleData=e,this.roleData.isFrozening=!1,this.headNode.scaleX=1,this.demonHead.scaleX=1,this.node.angle=t,this.partical.resetSystem(),this.partical.enabled=!1;var n=v.EnemyArea.createRoleHead(null,3);null!=n&&(null!=(t=n.getComponent(f.Head))&&t.bindData(e,4,!1),this.roleHead=n,this.demonHead.stopAllActions(),this.demonHead.runAction(cc.sequence(cc.fadeIn(1),cc.callFunc(function(){a.headNode.active=!1}))),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(1),cc.callFunc(function(){a.partical.enabled=!0,a.randomMove(),a.node.runAction(cc.rotateTo(1,0))}))))},_.prototype.randomMove=function(){var e,t,a,n=this;null==this.roleData||this.roleData.isDead||(e=cc.v2(m.Util.getRandomFloatNum(-190,440),m.Util.getRandomFloatNum(0,160)),t=m.Util.getDistance(this.node.position,e)/this.moveSpeed,a=e.sub(this.node.position).normalize(),this.demonHead.scaleX=0<a.x?-1:1,this.roleData.orientation=0<a.x?-1:1,this.node.runAction(cc.sequence(cc.moveTo(t,e),cc.callFunc(function(){n.randomMove()}))))},_.prototype.prepareFireBallSkill=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&!this.roleData.isFrozening&&!(this.isUsingSkill||(this.fireBallSkillTime+=e,this.fireBallSkillTime<3))){this.fireBallSkillTime=0,this.isUsingSkill=!0;var a=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.PARTICLE_NODE);if(null!=a){var n=this.roleData.isUltimateBoss?3:1;S.GameState.heroModel&&n++;for(var o=this,i=0;i<n;i++)!function(e){y.TimerManager.addTimer(+e,function(){null==t.roleData||t.roleData.isDead||(t.createMaigcBall(1).forEach(function(e){e.setParent(a),e.setPosition(t.node.position),e.scale=0,e.runAction(cc.scaleTo(.1,1));var n,o,i,l,r,s,c=e.getComponent(g.MagicBall);null!=c&&(n=m.Util.getRandomNum(0,2),null!=(o=C.PlayerState.playerData)&&(e=o.logicPos,s=-1==t.demonHead.scaleX?(r=t.node.position.add(cc.v2(300,0)),l=e.sub(r).normalize(),i=Math.random(),s=m.Util.rotateAngle(l,.5<i?90:-90),cc.v2((e.x+t.node.x)/2,(e.y+t.node.y)/2).add(s.mul(.5<i?300:150))):(i=(o=cc.v2((e.x+t.node.x)/3,(e.y+t.node.y)/3)).mul(2),l=e.sub(t.node.position).normalize(),s=m.Util.rotateAngle(l,90),r=o.add(s.mul(150*-(n-2))),i.add(s.mul(150*-(n-2)))),r.x<=-200&&(r.x=-200),s.x<=-200&&(s.x=-200),c.bindData(n,!0,t.roleData,t.fireBallMoveSpeed,null,[r,s])))}),n-1<=e&&(t.isUsingSkill=!1))},o.node)}(i)}}},_.prototype.createMaigcBall=function(e){for(var t=[],a=0;a<e;a++){var n=D.GameCommonPool.requestInstant(this.fireBallPrefab);t.push(n)}return t},_.prototype.refreshPassiveSkill=function(e){var t;null==this.roleData||this.roleData.isDead||(this.passiveSkillTime+=e,this.passiveSkillTime<6)||(this.passiveSkillTime=0,t=M.ConfigData.getEnemyConfig(13),e=m.Util.getRandomFloatNum(0,M.ConfigData.rightGroundBornPos.x),v.EnemyArea.createEnemy(t,!0,cc.v2(e,M.ConfigData.rightGroundBornPos.y)))},_.prototype.isHit=function(){this.isHitAniRunning=!1},_.prototype.isFroze=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,A.EffectCreate.createRoleTip(this.roleData.logicPos,1))},_.prototype.die=function(){var e,t,a,n=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,y.TimerManager.removeAllTimers(this.node),c.GameManager.killEnemy(this.roleData,!0),T.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),a=(t=(e=this.node.x+m.Util.getRandomFloatNum(160,200))+100)+20,this.node.stopAllActions(),this.node.runAction(cc.spawn(cc.sequence(cc.jumpTo(1,e,this.stayGroundPosY,100,1).easing(cc.easeIn(1)),cc.jumpTo(.5,t,this.stayGroundPosY,20,1),cc.jumpTo(.2,a,this.stayGroundPosY,10,1),cc.callFunc(function(){var e,t;n.roleData.isUltimateBoss?(t=n.node.position.clone(),n.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,3),cc.sequence(cc.moveTo(.05,t.add(cc.v2(5,10))),cc.moveTo(.05,t.add(cc.v2(-6,13))),cc.moveTo(.05,t.add(cc.v2(-3,12))),cc.moveTo(.05,t.add(cc.v2(3,12))),cc.moveTo(.05,t.add(cc.v2(-5,20))),cc.moveTo(.05,t.add(cc.v2(2,18))),cc.moveTo(.05,t.add(cc.v2(-8,21))),cc.moveTo(.05,t.add(cc.v2(3,30))),cc.moveTo(.05,t.add(cc.v2(-3,27))),cc.moveTo(.05,t.add(cc.v2(0,30))))),cc.callFunc(function(){v.EnemyArea.bossAlive=!1,c.GameManager.passPart(),h.LocalSoundManager.playBlastAudio();var e,t,a=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);null!=a&&(null==(e=v.EnemyArea.createMaigcBallBlast())||null!=(t=e.getComponent(u.MagicBallBlast))&&(e.setParent(a),e.setPosition(n.node.position),t.showBlast(null,null,!0,2),n.close()))})))):(n.demonHead.scaleX=-1,e=cc.v2(800,m.Util.getRandomFloatNum(0,160)),t=m.Util.getDistance(n.node.position,e)/n.moveSpeed,n.node.runAction(cc.sequence(cc.moveTo(t,e),cc.callFunc(function(){v.EnemyArea.bossAlive=!1,c.GameManager.passPart(),n.close()}))))})),cc.rotateBy(1.7,720))))},_.prototype.close=function(){null!=this.roleHead&&this.roleHead.destroy(),D.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u706b\u7403",type:cc.Prefab})],_.prototype,"fireBallPrefab",void 0),__decorate([o({displayName:"\u7c92\u5b50",type:cc.ParticleSystem})],_.prototype,"partical",void 0),__decorate([o({displayName:"\u5934\u90e8",type:cc.Node})],_.prototype,"headNode",void 0),__decorate([o({displayName:"\u6076\u7075\u5934\u90e8",type:cc.Node})],_.prototype,"demonHead",void 0),n=__decorate([n],_),i.BossFlyHead=n,cc._RF.pop()},{}],BossFour:[function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"a308czQZgJIFaRMQviVRYYt","BossFour");var o=e,i=t,l=a;Object.defineProperty(l,"__esModule",{value:!0});var r,s=o("EnumAndConst"),c=o("GameManager"),p=o("Head"),d=o("Timer"),u=o("Util"),h=o("ConfigData"),m=o("WorldEventManager"),f=o("LocalWorldEventType"),g=o("MagicBall"),y=o("BattleNodeManager"),v=o("GameCommonPool"),D=o("SuperMagicBall"),E=o("LocalSoundManager"),S=o("MagicBallBlast"),A=o("EnemyArea"),C=o("SingleEffectManager"),M=o("LongRoleBase"),T=o("RoleManager"),_=o("GameState"),k=o("EffectCreate"),P=o("GameConfigData"),R=o("EquipmentEffectSystem");function I(){var e=null!==r&&r.apply(this,arguments)||this;return e.superMagicBall=null,e.iceBallPrefab=null,e.water=null,e.teleportSkillTime=0,e.launchCount=0,e.ultimateSkillTime=0,e.passiveSkillTime=0,e.isUsingSkill=!1,e.littleMagicBallCount=0,e.teleportSkillReady=!1,e.littleMagicBallSpeed=150,e}o=(i=cc._decorator).ccclass,i=i.property,r=M.LongRoleBase,__extends(I,r),I.prototype.onEnable=function(){m.WorldEventManager.addListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.addListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.teleportSkillTime=0,this.passiveSkillTime=0,this.targetForce=null,this.launchCount=0,this.ultimateSkillTime=0,this.isUsingSkill=!1,this.littleMagicBallCount=0,this.teleportSkillReady=!1,this.roleUp.scale=2,this.roleDown.scale=2,this.node.scale=1,this.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null)},I.prototype.onDisable=function(){m.WorldEventManager.removeListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.removeListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},I.prototype.update=function(e){this.refreshDeadState(),this.refreshSkillTime(e)},I.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},I.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(p.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},I.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttackForce()},I.prototype.setAttackForce=function(e){var t,a,n;void 0===e&&(e=!1),null!=this.roleData&&!this.roleData.isDead&&(this.searchAttackTargetData(),this.attackTargetData&&this.currentArrow&&_.GameState.isGaming)&&(this.setHitRate(),this.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce),a=this.attackTargetData.logicPos,n=u.Util.getRandomFloatNum(a.x-30,a.x+30),t=u.Util.getRandomFloatNum(a.y+40,a.y-40),a=cc.v2(n,t),n=this.roleData.logicPos.x-a.x,t=-(this.roleData.logicPos.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*c.GameManager.getGravity()*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.randomAttackAngle(e))},I.prototype.randomAttackAngle=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&this.attackTargetData&&this.currentArrow&&_.GameState.isGaming){var a=-(u.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+150*this.roleData.orientation);if(e)return this.roleUp.angle=a,this.spineController.refreshWeapon(),void this.launch();var n=e?.5:u.Util.getRandomFloatNum(1,2);e=e?1:n+1,_.GameState.heroModel&&(n/=P.GameConfigData.data.heroBossArrakFrequency,e/=P.GameConfigData.data.heroBossArrakFrequency),this.isUsingSkill||this.roleUp.runAction(cc.rotateTo(n,a)),d.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||t.roleData.isTeleporting||t.launch()},this.node)}},I.prototype.launch=function(){var e,t,a,n,o=this;null!=this.roleData&&!this.roleData.isDead&&this.currentArrow&&(t=this.currentArrow.node.position,n=this.attackTargetData.logicPos,a=null,n=Math.random()<=this.hitRate?(e=u.Util.getRandomFloatNum(n.x-20,n.x+20),u.Util.getRandomFloatNum(n.y+35,n.y-25)):(e=Math.random()<.5?u.Util.getRandomFloatNum(n.x+80,n.x+100):u.Util.getRandomFloatNum(n.x-120,n.x-140),n.y),a=cc.v2(e,n),n=t.x-a.x,t=-(t.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*h.ConfigData.bossWeaponConfigDatas[this.roleData.weaponIndex].gravity*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.roleData.weaponLaunch=!0,n=this.targetForce,n=this.currentArrow.launch(n,.15,0,null,2),T.RoleManager.addWaitingLaunchArrow(this.roleData,n),this.currentArrow=null,this.spineController.playAnimation(s.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){o.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),o.launchCount++;var e=o.roleData.isUltimateBoss?2:3;o.launchCount>=e&&(o.launchCount=0,o.usePassiveSkill()),10<=o.ultimateSkillTime?o.useUltimateSkill():o.teleportSkillReady||5<=o.teleportSkillTime?o.useTeleportSkill():(o.equipWeapon(),o.setAttackForce())}))},I.prototype.refreshSkillTime=function(e){_.GameState.isGaming&&(null==this.roleData||this.roleData.isDead||(this.teleportSkillTime+=e,this.ultimateSkillTime+=e,this.isUsingSkill&&(this.passiveSkillTime+=e,2<=this.passiveSkillTime&&(this.passiveSkillTime=0,this.usePassiveSkill()))))},I.prototype.useTeleportSkill=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,this.teleportSkillReady?this.teleportSkillReady=!1:this.teleportSkillTime=0,this.roleData.isTeleporting=!0,k.EffectCreate.createAppearEffect(this.roleData.logicPos),e=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),C.SingleEffectManager.clearInsertArrows(this.roleData),d.TimerManager.addTimer(.8,function(){if(null!=t.roleData&&!t.roleData.isDead&&!t.roleData.isDestroy){A.EnemyArea.setEnemyPostionMap(e.x,null);var a=A.EnemyArea.getEmptyPosition(t.roleData);if(null==a)return t.node.position=t.roleData.logicPos,void(t.footRest&&t.footRest.updatePosition());t.roleData.logicPos=a,k.EffectCreate.createAppearEffect(t.roleData.logicPos),t.node.position=t.roleData.logicPos,t.footRest&&t.footRest.updatePosition(),A.EnemyArea.setEnemyPostionMap(t.roleData.logicPos.x,t.roleData),t.roleData.isTeleporting=!1,10<=t.ultimateSkillTime?t.useUltimateSkill():(t.equipWeapon(),t.setAttackForce(!0))}},this.node))},I.prototype.usePassiveSkill=function(){var e;null==this.roleData||this.roleData.isDead||(e=h.ConfigData.getEnemyConfig(15),A.EnemyArea.createEnemy(e,!0,h.ConfigData.rightGroundBornPos))},I.prototype.useUltimateSkill=function(){var e,t,a=this;null==this.roleData||this.roleData.isDead||(m.WorldEventManager.triggerEvent(f.LocalWorldEventType.ShowBubble,{type:40}),null!=(e=y.BattleNodeManager.getParentNode(s.BattleNodeEnum.PARTICLE_NODE))&&(this.ultimateSkillTime=0,this.passiveSkillTime=0,this.isUsingSkill=!0,this.roleUp.stopAllActions(),this.roleUp.angle=0,t=null,d.TimerManager.addTimer(.8,function(){if(null!=a.roleData&&!a.roleData.isDead&&!a.roleData.isDestroy&&(a.spineController.pauseAnimation(!0),null!=(i=a.createSuperMaigcBall()))){var o=a.roleData.logicPos.add(cc.v2(-100,100));if(i.setParent(e),i.setPosition(o),i.scale=0,i.runAction(cc.scaleTo(.5,1)),null!=(t=i.getComponent(D.SuperMagicBall))){t.bindData(!1,a.roleData);var i,l=a.roleData.isUltimateBoss?5:3;(i=_.GameState.heroModel)&&l++,a.littleMagicBallCount=l;var r=a.createMaigcBall(l),s=a.roleData.isUltimateBoss?[cc.v2(-400,320),cc.v2(-200,320),cc.v2(0,320),cc.v2(200,320),cc.v2(400,320)]:[cc.v2(-300,320),cc.v2(0,320),cc.v2(300,320)];i&&s.push(cc.v2(500,320));for(var c=0;c<r.length;c++){var p=function(n){var i=r[n];i.setParent(e),i.setPosition(s[n]),i.scale=0;var l=i.getComponent(g.MagicBall);if(null==l)return{value:void 0};l.bindData(null,!1,a.roleData,0,function(){null==a.roleData||a.roleData.isDead||a.reduceLittleMagicBall()}),n=u.Util.getDistance(s[n],o)/a.littleMagicBallSpeed,i.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,1),cc.moveTo(n,o)),cc.callFunc(function(){t.blendLittleMagicBall(),a.reduceLittleMagicBall(),i.destroy()})))}(c);if("object"==n(p))return p.value}}}},this.node),this.spineController.playAnimation(s.SpineAniNameEnum.Magic_atk,!0,!1,function(){a.ultimateSkillTime=0,a.isUsingSkill=!1,t.moveAction(),a.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),a.teleportSkillReady||5<=a.teleportSkillTime?a.useTeleportSkill():(a.equipWeapon(),a.setAttackForce())})))},I.prototype.createSuperMaigcBall=function(){if(null!=A.EnemyArea.instance){var e=v.GameCommonPool.requestInstant(this.superMagicBall);if(null!=e)return e}},I.prototype.createMaigcBall=function(e){for(var t=[],a=0;a<e;a++){var n=v.GameCommonPool.requestInstant(this.iceBallPrefab);t.push(n)}return t},I.prototype.reduceLittleMagicBall=function(){this.littleMagicBallCount--,this.littleMagicBallCount<=0&&this.spineController.pauseAnimation(!1)},I.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isUsingSkill?this.isHitAniRunning=!1:this.isHitAniRunning||(this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},I.prototype.isFroze=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){if(this.isUsingSkill)return this.roleData.isFrozening=!1,void k.EffectCreate.createRoleTip(this.roleData.logicPos,1);this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),d.TimerManager.pasueAllTimers(this.node),T.RoleManager.pauseWaitingLaunchArrows(this.roleData);var t=this.roleData.frozenTime;d.TimerManager.addTimer(t,function(){null==e.roleData||e.roleData.isDead||(e.roleData.isFrozening=!1,0<e.littleMagicBallCount||(e.spineController.pauseAnimation(!1),e.roleUp.resumeAllActions(),d.TimerManager.resumeAllTimers(e.node),T.RoleManager.resumeWaitingLaunchArrows(e.roleData),e.teleportSkillReady=!0))},this.node)}},I.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),T.RoleManager.hitRole(this.roleData))},I.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,T.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),this.spineController.pauseAnimation(!1),d.TimerManager.removeAllTimers(this.node),c.GameManager.killEnemy(this.roleData,!0),R.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?s.SpineAniNameEnum.D2:s.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,function(){d.TimerManager.addTimer(.1,function(){var e,a;null!=t.roleData&&(v.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,e=(t.roleData.isUltimateBoss?-110:-210)-t.roleData.logicPos.y,a=Math.abs(e)/300,t.node.runAction(cc.sequence(cc.moveBy(a,0,e),cc.callFunc(function(){var e,a;t.roleData.isUltimateBoss?(a=t.roleData.logicPos.clone(),t.roleUp.runAction(cc.scaleTo(.5,3)),t.node.runAction(cc.sequence(cc.sequence(cc.moveTo(.05,a.add(cc.v2(5,11))),cc.moveTo(.05,a.add(cc.v2(-6,15))),cc.moveTo(.05,a.add(cc.v2(-3,15))),cc.moveTo(.05,a.add(cc.v2(3,16))),cc.moveTo(.05,a.add(cc.v2(-5,25))),cc.moveTo(.05,a.add(cc.v2(2,24))),cc.moveTo(.05,a.add(cc.v2(-8,28))),cc.moveTo(.05,a.add(cc.v2(3,38))),cc.moveTo(.05,a.add(cc.v2(-3,36))),cc.moveTo(.05,a.add(cc.v2(0,40)))),cc.callFunc(function(){A.EnemyArea.bossAlive=!1,c.GameManager.passPart(),E.LocalSoundManager.playBlastAudio();var e,a,n=y.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE);null!=n&&(null==(e=A.EnemyArea.createMaigcBallBlast())||null!=(a=e.getComponent(S.MagicBallBlast))&&(e.setParent(n),e.setPosition(t.node.position),a.showBlast(null,null,!1,2),t.roleData.isDestroy=!0,t.close()))})))):null==(e=y.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE))||null!=(a=v.GameCommonPool.requestInstant(t.water))&&(a.setParent(e),a.setPosition(cc.v2(t.node.x,-120)),t.escape())}))))},t.node)}))},I.prototype.escape=function(){var e=this;C.SingleEffectManager.clearInsertArrows(this.roleData),null==this.currentArrow||this.roleData.weaponLaunch||(this.currentArrow.node.destroy(),this.roleData.weaponLaunch=!0,this.currentArrow=null),this.roleData.orientation=-1,this.roleUp.scaleX*=this.roleData.orientation,this.roleDown.scaleX*=this.roleData.orientation,this.spineController.playAnimation(s.SpineAniNameEnum.Run,!0,!0,null);var t=cc.v2(800,this.roleData.logicPos.y),a=u.Util.getDistance(this.roleData.logicPos,t)/300;this.node.runAction(cc.sequence(cc.delayTime(.5),cc.moveTo(a,t),cc.callFunc(function(){A.EnemyArea.bossAlive=!1,c.GameManager.passPart(),e.roleData.isDestroy=!0,e.close()})))},__decorate([i({displayName:"\u8d85\u7ea7\u9b54\u6cd5\u7403",type:cc.Prefab})],I.prototype,"superMagicBall",void 0),__decorate([i({displayName:"\u51b0\u7403",type:cc.Prefab})],I.prototype,"iceBallPrefab",void 0),__decorate([i({displayName:"\u6c34\u82b1",type:cc.Prefab})],I.prototype,"water",void 0),o=__decorate([o],I),l.BossFour=o,cc._RF.pop()},{}],BossOne:[function(e,t,a){"use strict";cc._RF.push(t,"f36ebQ/D1dFioyqJFR5Fy6F","BossOne");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameManager"),c=n("Head"),p=n("Timer"),d=n("Util"),u=n("ConfigData"),h=n("WorldEventManager"),m=n("LocalWorldEventType"),f=n("MagicBall"),g=n("BattleNodeManager"),y=n("GameCommonPool"),v=n("SpecailSkill"),D=n("EnemyArea"),E=n("SingleEffectManager"),S=n("LongRoleBase"),A=n("RoleManager"),C=n("GameState"),M=n("EffectCreate"),T=n("GameConfigData"),_=n("EquipmentEffectSystem");function k(){var e=null!==l&&l.apply(this,arguments)||this;return e.fireBallPrefab=null,e.teleportSkillTime=0,e.ultimateSkillTime=0,e.isUsingSkill=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=S.LongRoleBase,__extends(k,l),k.prototype.onEnable=function(){h.WorldEventManager.addListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.teleportSkillTime=0,this.targetForce=null,this.ultimateSkillTime=0,this.isUsingSkill=!1,this.roleUp.scaleX=2,this.roleDown.scaleX=2,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null)},k.prototype.onDisable=function(){h.WorldEventManager.removeListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},k.prototype.update=function(e){this.refreshDeadState(),this.refreshSkillTime(e)},k.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},k.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(c.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},k.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttackForce()},k.prototype.setAttackForce=function(e){var t,a,n;void 0===e&&(e=!1),null==this.roleData||this.roleData.isDead||(this.searchAttackTargetData(),this.setHitRate(),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce),a=this.attackTargetData.logicPos,n=d.Util.getRandomFloatNum(a.x-30,a.x+30),t=d.Util.getRandomFloatNum(a.y+40,a.y-40),a=cc.v2(n,t),n=this.roleData.logicPos.x-a.x,t=-(this.roleData.logicPos.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*u.ConfigData.bossWeaponConfigDatas[this.roleData.weaponIndex].gravity*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),Math.random()>=this.hitRate&&(a=d.Util.getRandomNum(15,30),80<this.node.x?(n=Math.random(),this.targetForce=n<.5?d.Util.rotateAngle(this.targetForce,a):d.Util.rotateAngle(this.targetForce,-15)):this.targetForce=d.Util.rotateAngle(this.targetForce,a)),this.randomAttackAngle(e))},k.prototype.randomAttackAngle=function(e){var t,a,n=this;null!=this.roleData&&!this.roleData.isDead&&this.attackTargetData&&this.currentArrow&&C.GameState.isGaming&&(t=-(d.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+150*this.roleData.orientation),a=e?.5:d.Util.getRandomFloatNum(1,2),e=e?1:a+1,C.GameState.heroModel&&(a/=T.GameConfigData.data.heroBossArrakFrequency,e/=T.GameConfigData.data.heroBossArrakFrequency),this.isHitAniRunning||this.isUsingSkill||this.roleUp.runAction(cc.rotateTo(a,t)),p.TimerManager.addTimer(e,function(){null==n.roleData||n.roleData.isDead||n.roleData.isDestroy||n.roleData.isTeleporting||n.launch()},this.node))},k.prototype.launch=function(){var e,t,a=this;null!=this.roleData&&!this.roleData.isDead&&this.currentArrow&&(this.roleData.weaponLaunch=!0,e=this.roleUp.angle-30*this.roleData.orientation,t=Math.sin(e*Math.PI/180),e=Math.cos(e*Math.PI/180),t=cc.v2(e,t).mul(-this.targetForce.mag()),t=this.currentArrow.launch(t,.15,0,null,1),v.SpecailSkill.division(this.currentArrow,2),A.RoleManager.addWaitingLaunchArrow(this.roleData,t),this.currentArrow=null,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){a.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),10<=a.ultimateSkillTime?a.useUltimateSkill():5<=a.teleportSkillTime?a.useTeleportSkill():(a.equipWeapon(),a.setAttackForce())}))},k.prototype.refreshSkillTime=function(e){C.GameState.isGaming&&(null==this.roleData||this.roleData.isDead||(this.teleportSkillTime+=e,this.ultimateSkillTime+=e))},k.prototype.useTeleportSkill=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,this.teleportSkillTime=0,this.roleData.isTeleporting=!0,M.EffectCreate.createAppearEffect(this.roleData.logicPos),e=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),E.SingleEffectManager.clearInsertArrows(this.roleData),p.TimerManager.addTimer(.8,function(){if(null!=t.roleData&&!t.roleData.isDead&&!t.roleData.isDestroy){D.EnemyArea.setEnemyPostionMap(e.x,null);var a=D.EnemyArea.getEmptyPosition(t.roleData);if(null==a)return t.node.position=t.roleData.logicPos,void(t.footRest&&t.footRest.updatePosition());t.roleData.logicPos=a,M.EffectCreate.createAppearEffect(t.roleData.logicPos),t.node.position=t.roleData.logicPos,t.footRest&&t.footRest.updatePosition(),D.EnemyArea.setEnemyPostionMap(t.roleData.logicPos.x,t.roleData),t.roleData.isTeleporting=!1,10<=t.ultimateSkillTime?t.useUltimateSkill():(t.equipWeapon(),t.setAttackForce(!0))}},this.node))},k.prototype.useUltimateSkill=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){h.WorldEventManager.triggerEvent(m.LocalWorldEventType.ShowBubble,{type:34});var t=g.BattleNodeManager.getParentNode(r.BattleNodeEnum.PARTICLE_NODE);if(null!=t){this.ultimateSkillTime=0,this.isUsingSkill=!0,this.roleUp.stopAllActions(),this.roleUp.angle=0;var a=this.roleData.isUltimateBoss?3:1;C.GameState.heroModel&&a++;var n=this.createMaigcBall(a);n.forEach(function(e){e.setParent(t),e.scale=0,e.runAction(cc.scaleTo(.5,1))}),this.spineController.magicBalls=n;for(var o=this,i=0;i<n.length;i++)!function(t){p.TimerManager.addTimer(.8+.3*t,function(){var a;null==e.roleData||e.roleData.isDead||e.roleData.isDestroy||null!=(a=e.spineController.magicBalls.shift().getComponent(f.MagicBall))&&a.bindData(t,!0,e.roleData,80)},o.node)}(i);this.spineController.playAnimation(r.SpineAniNameEnum.Magic_atk,!0,!1,function(){e.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),5<=e.teleportSkillTime?e.useTeleportSkill():(e.equipWeapon(),e.setAttackForce(),e.isUsingSkill=!1)})}}},k.prototype.createMaigcBall=function(e){for(var t=[],a=0;a<e;a++){var n=y.GameCommonPool.requestInstant(this.fireBallPrefab);t.push(n)}return t},k.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isUsingSkill?this.isHitAniRunning=!1:this.isHitAniRunning||(this.roleUp.stopAllActions(),this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},k.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),p.TimerManager.pasueAllTimers(this.node),A.RoleManager.pauseWaitingLaunchArrows(this.roleData),e=this.roleData.frozenTime,p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),t.roleUp.resumeAllActions(),p.TimerManager.resumeAllTimers(t.node),A.RoleManager.resumeWaitingLaunchArrows(t.roleData))},this.node))},k.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),A.RoleManager.hitRole(this.roleData))},k.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,A.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),this.spineController.pauseAnimation(!1),p.TimerManager.removeAllTimers(this.node),s.GameManager.killEnemy(this.roleData,!0),_.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?r.SpineAniNameEnum.D2:r.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,function(){p.TimerManager.addTimer(.1,function(){var e,a;null!=t.roleData&&(y.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,e=t.roleData.isUltimateBoss?-400-t.roleData.logicPos.y:u.ConfigData.PLYAER_POS.y+30-t.roleData.logicPos.y,a=Math.abs(e)/300,a=Math.max(0,a),t.node.runAction(cc.sequence(cc.moveBy(a,0,e),cc.callFunc(function(){t.roleData.isUltimateBoss?(D.EnemyArea.bossAlive=!1,s.GameManager.passPart(),t.roleData.isDestroy=!0,t.close()):t.escape()}))))})}))},k.prototype.escape=function(){var e=this;E.SingleEffectManager.clearInsertArrows(this.roleData),this.roleData.orientation=-1,this.roleUp.scaleX*=this.roleData.orientation,this.roleDown.scaleX*=this.roleData.orientation,this.spineController.playAnimation(r.SpineAniNameEnum.Run,!0,!0,null);var t=cc.v2(800,this.roleData.logicPos.y),a=d.Util.getDistance(this.roleData.logicPos,t)/300;this.node.runAction(cc.sequence(cc.moveTo(a,t),cc.callFunc(function(){D.EnemyArea.bossAlive=!1,s.GameManager.passPart(),e.roleData.isDestroy=!0,e.close()})))},__decorate([o({displayName:"\u706b\u7403",type:cc.Prefab})],k.prototype,"fireBallPrefab",void 0),n=__decorate([n],k),i.BossOne=n,cc._RF.pop()},{}],BossSeven:[function(e,t,a){"use strict";cc._RF.push(t,"128d1ufjNxH6YKUToOh5ymD","BossSeven");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LongRoleBase"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("PlayerState"),d=n("EnumAndConst"),u=n("Util"),h=n("GameState"),m=n("GameConfigData"),f=n("Timer"),g=n("Head"),y=n("BattleNodeManager"),v=n("GameCommonPool"),D=n("ConfigData"),E=n("EnemyArea"),S=n("Eye"),A=n("MagicBall"),C=n("EnemyShield"),M=n("RoleManager"),T=n("SingleEffectManager"),_=n("LocalData"),k=n("GameManager"),P=n("EquipmentEffectSystem"),R=n("EffectCreate"),I=n("UIManager"),w=n("LocalSoundManager");function b(){var e=null!==l&&l.apply(this,arguments)||this;return e.eyePrefab=null,e.iceBall=null,e.fireBall=null,e.bossShield=null,e.maxSummonCount=2,e.maxHitEyeCount=2,e.magicBallSize=2,e.summonDragonArray=[],e.attackCount=0,e.isInSequence=!1,e.sequenceNumber=0,e.hitEyeCount=0,e.isUltimateSkill=!1,e.isCharging=!1,e.showFireBubble=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.LongRoleBase,__extends(b,l),b.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.roleData=null,this.head=null,this.attackCount=0,this.isInSequence=!1,this.sequenceNumber=0,this.isHitAniRunning=!1,this.isWaitingRevive=!1,this.hitEyeCount=0,this.isUltimateSkill=!1,this.isCharging=!1,this.showFireBubble=!1,this.summonDragonArray=[]},b.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},b.prototype.update=function(){this.refreshDeadState(),this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370),this.refreshSummonDragonArray()},b.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},b.prototype.bindData=function(e,t,a){var n=this;this.roleData=e;var o=a.getComponent(g.Head);if(null!=o&&(this.head=o,this.head.bindData(e,1)),null!=(o=a.getComponent(cc.Collider))){if(null==(a=this.createEyePrefab()))return;null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,o,a)}this.roleData.headHurtReduction=.5,this.roleData.enemyEquipSkills.addSkill(d.SkillTypeEnum.IGNITE),this.roleData.invincibleTime=9999,this.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!1,null),this.node.opacity=255,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(.5,D.ConfigData.rightGroundBornPos.add(cc.v2(-100,0))).easing(cc.easeQuadraticActionIn()),cc.callFunc(function(){w.LocalSoundManager.playAudio("reviveKnock"),n.roleData.isUltimateBoss?I.UIManager.createBossBubbleText(n.roleData,2):I.UIManager.createBossBubbleText(n.roleData,0),w.LocalSoundManager.playAudio("evilDragonSummon"),k.GameManager.shakeEffect(1.3),n.spineController.playAnimation("Atk_3",!1,!1,null)}),cc.delayTime(1.5),cc.callFunc(function(){n.roleData.invincibleTime=0,n.searchAttackTarget(),n.setLongRangeAttack()}))),h.GameState.heroModel?(this.roleData.isUltimateBoss?(this.maxHitEyeCount=4,this.magicBallSize=4):(this.maxHitEyeCount=3,this.magicBallSize=3),this.maxSummonCount=4):(this.roleData.isUltimateBoss?(this.maxHitEyeCount=3,this.magicBallSize=3):(this.maxHitEyeCount=2,this.magicBallSize=2),this.maxSummonCount=2)},b.prototype.createEyePrefab=function(){var e=y.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_HEAD_NODE);if(null!=e){var t=cc.instantiate(this.eyePrefab);if(null!=t&&(t.setParent(e),t.setPosition(cc.v2(9999,9999)),null!=(e=t.getComponent(S.Eye))))return e.bindData(this.roleData),t}},b.prototype.searchAttackTarget=function(){var e;null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||null!=(e=p.PlayerState.playerData)&&(this.attackTargetData=e)},b.prototype.setLongRangeAttack=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,this.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null),e=u.Util.getRandomFloatNum(2,3),h.GameState.heroModel&&(e/=m.GameConfigData.data.heroBossArrakFrequency),f.TimerManager.addTimer(e,function(){t.attack()},this.node))},b.prototype.attack=function(){if(null!=this.roleData&&!this.roleData.isDead)if(this.isInSequence)switch(this.sequenceNumber){case 1:this.shootMagicBall();break;case 2:this.summonDragons();break;case 3:this.releaseFire();break;case 4:this.summonShield()}else this.attackCount++,this.attackCount%6==1||this.attackCount%6==3||this.attackCount%6==5?this.shootMagicBall():this.attackCount%6==2?this.summonDragons():this.attackCount%6==4?this.summonShield():this.releaseFire()},b.prototype.shootMagicBall=function(){var e,t,a,n=this;null==this.roleData||this.roleData.isDead||(w.LocalSoundManager.playAudio("evilDragonAttack"),this.isHitAniRunning=!1,null!=(e=y.BattleNodeManager.getParentNode(d.BattleNodeEnum.PARTICLE_NODE))&&(t=!1,Math.random()<.5&&(t=!0),(a=this.createMaigcBall(t)).setParent(e),a.scale=this.magicBallSize,this.spineController.magicBalls=[a],this.spineController.refreshMagicBalls(),f.TimerManager.addTimer(.5,function(){var e,a,o,i,l,r=n.spineController.magicBalls.shift();null==r||null!=(e=r.getComponent(A.MagicBall))&&(l=u.Util.getRandomNum(0,2),null!=(o=p.PlayerState.playerData)&&(a=o.logicPos,o=(i=cc.v2((a.x+r.x)/3,(a.y+r.y)/3)).mul(2),r=a.sub(r.position).normalize(),r=u.Util.rotateAngle(r,90),i=i.add(r.mul(150*-(l-2))),l=o.add(r.mul(150*-(l-2))),i.x<=-200&&(i.x=-200),l.x<=-200&&(l.x=-200),e.bindData(0,t,n.roleData,400,null,[i,l],n.magicBallSize)))},this.node),this.spineController.playAnimation("Atk_1",!1,!1,function(){n.isInSequence&&(n.sequenceNumber=2),n.setLongRangeAttack()})))},b.prototype.summonDragons=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){if(this.summonDragonArray.length>=this.maxSummonCount)return this.isInSequence&&(this.sequenceNumber=3),void this.attack();w.LocalSoundManager.playAudio("evilDragonSummon"),f.TimerManager.addTimer(1,function(){if(!(e.summonDragonArray.length>=e.maxSummonCount))for(var t=e.maxSummonCount-e.summonDragonArray.length,a=0;a<t;a++)f.TimerManager.addTimer(.5*a,function(){var t=u.Util.getRandomValueFromArray([21,22,23]),a=D.ConfigData.getEnemyConfig(t);t=23==t?D.ConfigData.rightGroundBornPos:D.ConfigData.getRightAirBornPos(),t=E.EnemyArea.createEnemy(a,!0,t),e.summonDragonArray.push(t)},e.node)},this.node),this.spineController.playAnimation("Atk_3",!1,!1,function(){e.isInSequence&&(e.sequenceNumber=3),e.setLongRangeAttack()})}},b.prototype.summonShield=function(){var e=this;null==this.roleData||this.roleData.isDead||(w.LocalSoundManager.playAudio("evilDragonSummon"),f.TimerManager.addTimer(1,function(){e.createBossShield()},this.node),this.spineController.playAnimation("Atk_3",!1,!1,function(){e.isInSequence&&(e.isInSequence=!1,e.sequenceNumber=0),e.setLongRangeAttack()}))},b.prototype.releaseFire=function(){var e=this;null==this.roleData||this.roleData.isDead||(this.isUltimateSkill=!0,this.hitEyeCount=0,this.spineController.playAnimation("Atk_2_1",!1,!1,function(){e.isCharging=!0,f.TimerManager.addTimer(1.5,function(){e.isCharging=!1,w.LocalSoundManager.playAudio("releaseFire1"),e.spineController.playAnimation("Atk_2_3",!1,!1,function(){w.LocalSoundManager.playAudio("releaseFire2"),e.fireDamage(),e.showFireBubble||(I.UIManager.createBossBubbleText(e.roleData,3),e.showFireBubble=!0);var t=h.GameState.heroModel?5.2:3.2;f.TimerManager.addTimer(t,function(){e.spineController.playAnimation("Atk_2_5",!1,!1,function(){e.stopFireRelease(),e.isInSequence?e.sequenceNumber=4:(e.isInSequence=!0,e.sequenceNumber=1),e.setLongRangeAttack()})},e.node),e.spineController.playAnimation("Atk_2_4",!1,!0,null)})},e.node),e.spineController.playAnimation("Atk_2_2",!1,!0,null)}))},b.prototype.fireDamage=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){var t=h.GameState.heroModel?5.2:3.2;k.GameManager.shakeEffect(t);for(var a=h.GameState.heroModel?16:10,n=h.GameState.heroModel?15*this.roleData.atk:9*this.roleData.atk,o=this,i=0;i<a;i++)!function(t){var i=Math.round(n/a);f.TimerManager.addTimer(.32*t,function(){var n=E.EnemyArea.friendDatas;if(null!=n&&0<n.length)for(var o=D.ConfigData.MAX_DAMAGE,l=0;l<n.length;l++){var r=n[l];null==r||r.isDead||M.RoleManager.roleIsDamaged(r,e.roleData,o,r.logicPos)}var s=p.PlayerState.playerData;if(null!=s)return 0<s.shieldDefense?(p.PlayerState.player.equipmentIsDamaged(_.EquipmentType.shield,e.roleData,i,s.logicPos),s.shieldDefense<=0&&(s.shieldDroped=!0)):0<s.helmetDefense?(p.PlayerState.player.equipmentIsDamaged(_.EquipmentType.helmet,e.roleData,i,s.logicPos),s.helmetDefense<=0&&(s.helmetDroped=!0)):(s.invincibleTime<=0&&T.SingleEffectManager.showBloodEffect(s.logicPos,e.node.scaleX,s),M.RoleManager.roleIsDamaged(s,e.roleData,i,s.logicPos)),void(a-1<=t||s.isDead)},o.node)}(i)}},b.prototype.stopFireRelease=function(){this.isUltimateSkill=!1,this.isCharging=!1,f.TimerManager.removeAllTimers(this.node),k.GameManager.shakeEffect(0),w.LocalSoundManager.stop("releaseFire1"),w.LocalSoundManager.stop("releaseFire2")},b.prototype.createMaigcBall=function(e){if(e=e?this.fireBall:this.iceBall,null!=(e=v.GameCommonPool.requestInstant(e)))return e},b.prototype.refreshSummonDragonArray=function(){var e,t=this;null==this.summonDragonArray||this.summonDragonArray.length<=0||(e=[],this.summonDragonArray.forEach(function(t){t.isDead&&e.push(t)}),null==e||e.length<=0||e.forEach(function(e){e=t.summonDragonArray.indexOf(e),t.summonDragonArray.splice(e,1)}))},b.prototype.createBossShield=function(){s.WorldEventManager.triggerEvent(c.LocalWorldEventType.ShowBubble,{type:47});var e,t,a=y.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHIRLD_NODE);null!=a&&(null==(e=v.GameCommonPool.requestInstant(this.bossShield))||null!=(t=e.getComponent(C.EnemyShield))&&(t.bindData(this.roleData),e.setParent(a),e.setPosition(this.roleData.logicPos)))},b.prototype.isFroze=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,R.EffectCreate.createRoleTip(this.roleData.logicPos,1))},b.prototype.isHit=function(e,t,a){var n=this;a&&this.isUltimateSkill&&(this.hitEyeCount++,this.hitEyeCount>=this.maxHitEyeCount)&&(w.LocalSoundManager.playAudio("evilDragonHit"),this.hitEyeCount=0,this.stopFireRelease(),a=this.isCharging?"Shouji2":"Shouji",this.spineController.playAnimation(a,!1,!1,function(){n.isInSequence?n.sequenceNumber=4:(n.isInSequence=!0,n.sequenceNumber=1),n.setLongRangeAttack()}))},b.prototype.die=function(){var e,t,a=this;this.roleData.isFalledDown||(this.stopFireRelease(),this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,M.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),f.TimerManager.removeAllTimers(this.node),k.GameManager.killEnemy(this.roleData,!0),P.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.isUltimateBoss?d.SpineAniNameEnum.D:"Jitui",t=this.roleData.isUltimateBoss?.3:2,this.roleData.isUltimateBoss||I.UIManager.createBossBubbleText(this.roleData,1),this.roleData.isUltimateBoss&&w.LocalSoundManager.playAudio("evilDragonDead"),this.spineController.playAnimation(e,!1,!1,function(){E.EnemyArea.bossAlive=!1,k.GameManager.passPart(),a.roleData.isDestroy=!0,a.roleData.isUltimateBoss?a.node.runAction(cc.sequence(cc.fadeOut(2),cc.callFunc(function(){a.close()}))):a.close()},t))},b.prototype.close=function(){this.stopFireRelease(),T.SingleEffectManager.clearInsertArrows(this.roleData),null==this.head||this.roleData.headDroped||null!=this.head.node&&this.head.node.destroy(),v.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u773c\u775b\u78b0\u649e\u5668\u9884\u8bbe",type:cc.Prefab})],b.prototype,"eyePrefab",void 0),__decorate([o({displayName:"\u51b0\u7403\u9884\u8bbe",type:cc.Prefab})],b.prototype,"iceBall",void 0),__decorate([o({displayName:"\u706b\u7403\u9884\u8bbe",type:cc.Prefab})],b.prototype,"fireBall",void 0),__decorate([o({displayName:"\u62a4\u76fe",type:cc.Prefab})],b.prototype,"bossShield",void 0),n=__decorate([n],b),i.BossSeven=n,cc._RF.pop()},{}],BossSix:[function(e,t,a){"use strict";cc._RF.push(t,"0fd96UrtB5FtqnICD8eoP9e","BossSix");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LongRoleBase"),s=n("Head"),c=n("EnumAndConst"),p=n("Timer"),d=n("GameState"),u=n("Util"),h=n("WorldEventManager"),m=n("LocalWorldEventType"),f=n("ConfigData"),g=n("RoleManager"),y=n("EffectCreate"),v=n("SingleEffectManager"),D=n("EnemyArea"),E=n("SkillSystem"),S=n("BattleNumManager"),A=n("LocalSoundManager"),C=n("LocalData"),M=n("GameManager"),T=n("BattleNodeManager"),_=n("MagicBallBlast"),k=n("GameCommonPool"),P=n("NewLaser"),R=n("PlayerState"),I=n("GameConfigData"),w=n("EquipmentEffectSystem");function b(){var e=null!==l&&l.apply(this,arguments)||this;return e.aimingRayPrefab=null,e.thruster=null,e.laserPrefab=null,e.aimingRay=null,e.aimBone=null,e.moveSpeed=300,e.dangerHpLine=.3,e.standPosY=-107,e.posXOffset=180,e.moveDirection=null,e.moveTime=null,e.isUsingRestoreSkill=!1,e.isUsingUltimateSkill=!1,e.teleportSkillTime=0,e.restoreSkillCd=20,e.restoreSkillTime=0,e.ultimateSkillCd=8,e.ultimateSkillTime=0,e.teleportSkillReady=!1,e.meleeAttackCount=0,e.aimingPos=null,e.ultimateSkillTween=null,e.isBurrowing=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.LongRoleBase,__extends(b,l),b.prototype.onEnable=function(){h.WorldEventManager.addListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.targetForce=null,this.isUsingRestoreSkill=!1,this.isUsingUltimateSkill=!1,this.teleportSkillTime=0,this.restoreSkillCd=20,this.restoreSkillTime=this.restoreSkillCd,this.ultimateSkillCd=d.GameState.heroModel?6:8,this.ultimateSkillTime=0,this.teleportSkillReady=!1,this.meleeAttackCount=0,this.aimingPos=null,this.node.scale=1,this.roleUp.scale=2,this.aimingRay=null,this.aimBone=null,this.isBurrowing=!1},b.prototype.onDisable=function(){h.WorldEventManager.removeListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},b.prototype.update=function(e){this.refreshDeadState(),this.refreshSkillTime(e),this.move(e),this.aiming(),this.refreshAimingRayPos(),this.isBeRepeled(e),this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)},b.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},b.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(s.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.searchAttackTarget(),this.setMoveAction(),this.setLongRangeAttack()},b.prototype.searchAttackTarget=function(){var e;null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||null!=(e=R.PlayerState.playerData)&&(this.attackTargetData=e)},b.prototype.setLongRangeAttack=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.attackModel=c.AttackModelTypeEnum.LONG_RANGE_ATTACK,this.thruster.active=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Run,!1,!0,null),e=u.Util.getRandomFloatNum(2,3),d.GameState.heroModel&&(e/=I.GameConfigData.data.heroBossArrakFrequency),p.TimerManager.addTimer(e,function(){t.launch()},this.node))},b.prototype.launch=function(){var e=this;null==this.roleData||this.roleData.isDead||(p.TimerManager.addTimer(.3,function(){var t,a,n,o;null==e.roleData||e.roleData.isDead||(e.setHitRate(),e.equipWeapon(),e.spineController.refreshWeapon(),a=e.currentArrow.node.position,n=e.attackTargetData.logicPos,e.targetForceMagnitude=e.minForce+Math.random()*(e.maxForce-e.minForce),o=null,n=Math.random()<=e.hitRate?(t=u.Util.getRandomFloatNum(n.x-20,n.x+20),u.Util.getRandomFloatNum(n.y+35,n.y-25)):(t=Math.random()<.5?u.Util.getRandomFloatNum(n.x+80,n.x+100):u.Util.getRandomFloatNum(n.x-120,n.x-140),n.y),o=cc.v2(t,n),n=a.x-o.x,a=-(a.y-o.y),n/=o=e.targetForceMagnitude,n=(a-.5*f.ConfigData.bossWeaponConfigDatas[e.roleData.weaponIndex].gravity*Math.pow(n,2))/n,e.targetForce=cc.v2(-o,n),e.roleData.weaponLaunch=!0,n=180*(o=e.targetForce).normalize().signAngle(cc.Vec2.RIGHT)/Math.PI,e.currentArrow.node.angle=-n+(0<e.roleData.orientation?180:0),o=e.currentArrow.launch(o,0,0,null,2),g.RoleManager.addWaitingLaunchArrow(e.roleData,o),e.currentArrow=null)},this.node),this.spineController.playAnimation(c.SpineAniNameEnum.Atk_run,!1,!1,function(){e.spineController.playAnimation(c.SpineAniNameEnum.Run,!1,!0,null),e.ultimateSkillTime>=e.ultimateSkillCd?e.useTeleportSkill(!0):e.teleportSkillReady||e.teleportSkillTime>=e.ultimateSkillCd/2?e.useTeleportSkill(!1):e.setLongRangeAttack()}))},b.prototype.setMeleeAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.callFunc(function(){e.meleeAttackCount++,e.spineController.playAnimation(c.SpineAniNameEnum.Atk_Zuantou,!1,!1,function(){null==e.roleData||e.roleData.isDead||(e.setMoveAction(),e.setLongRangeAttack())})}),cc.delayTime(.33),cc.callFunc(function(){var t,a,n,o,i=e.attackTargetData;null==i||i.isDead||i.isTeleporting||(t=Math.abs(e.roleData.logicPos.x-i.logicPos.x),n=Math.abs(e.roleData.logicPos.y-i.logicPos.y),90<t||90<n||(n=0,e.roleData.isEnemy&&e.attackTargetData.isPlayer&&(n=E.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.DODGE)),e.attackTargetData.enemyEquipSkills.isHaveSkill(c.SkillTypeEnum.DODGE)&&(n=E.SkillSystem.getEquipedSkillInitData(c.SkillTypeEnum.DODGE),e.attackTargetData.isBoss&&d.GameState.heroModel&&(n*=2)),Math.random()<n?y.EffectCreate.createRoleTip(i.logicPos,0):i.hasEnemyShield?(i.hasEnemyShield=!1,a=Math.round(e.roleData.atk),n=c.BattleNumTypeEnum.HP_REDUCE,S.BattleNumManager.createBattleNumEffect(n,a,i,i.logicPos),A.LocalSoundManager.playShieldResistAudio()):0<i.shieldDefense?(A.LocalSoundManager.playShieldResistAudio(),a=Math.round(e.roleData.atk),g.RoleManager.equipmentIsDamaged(e.attackTargetData,C.EquipmentType.shield,e.roleData,a,cc.v2(i.logicPos.x+35,i.logicPos.y)),i.shieldDefense<=0&&(i.shieldDroped=!0)):0<i.helmetDefense?(A.LocalSoundManager.playHelmetResistAudio(),o=Math.round(e.roleData.atk),g.RoleManager.equipmentIsDamaged(e.attackTargetData,C.EquipmentType.helmet,e.roleData,o,cc.v2(i.headPosition.x,i.headPosition.y)),i.helmetDefense<=0&&(i.helmetDroped=!0)):(o=Math.round(e.roleData.atk),o*=1-i.bodyHurtReduction,g.RoleManager.roleIsDamaged(e.attackTargetData,e.roleData,o,i.logicPos),i.invincibleTime<=0?(A.LocalSoundManager.playArrowHitAudio(),A.LocalSoundManager.playVibrateShort(),v.SingleEffectManager.showBloodEffect(i.logicPos,1,i)):A.LocalSoundManager.playShieldResistAudio())))}))))},b.prototype.setMoveAction=function(){var e=cc.v2(u.Util.getRandomFloatNum(-190,440),u.Util.getRandomFloatNum(0,160)),t=this.moveSpeed,a=u.Util.getDistance(this.node.position,e);this.moveTime=a/t,this.moveDirection=e.sub(this.roleData.logicPos).normalize()},b.prototype.move=function(e){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.roleData.isTeleporting||this.isUsingRestoreSkill||this.roleData.attackModel!=c.AttackModelTypeEnum.MELEE_ATTACK&&(null==this.moveTime||null==this.moveDirection||0==this.moveDirection.x&&0==this.moveDirection.y||(this.node.position=this.node.position.add(this.moveDirection.mul(this.moveSpeed*e)),this.moveTime-=e,this.moveTime<=0&&this.setMoveAction()))},b.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=E.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.roleData.isFrozening||this.isHitAniRunning||!d.GameState.isGaming||(this.setMoveAction(),this.setLongRangeAttack())))},b.prototype.aiming=function(){if(null==this.roleData||this.roleData.isDead)return this.aimingRay&&k.GameCommonPool.returnInstant(this.aimingRay),void(this.aimingRay=null);var e;null!=this.aimingRay&&(e=this.aimingRay.position.sub(this.aimingPos),e=180*-cc.v2(e).signAngle(cc.Vec2.RIGHT)/Math.PI,this.aimingRay.angle=e,e=u.Util.getDistance(this.aimingPos,this.aimingRay.position),this.aimingPos!=this.attackTargetData.logicPos&&(e+=500),this.aimingRay.width=e)},b.prototype.refreshSkillTime=function(e){d.GameState.isGaming&&null!=this.roleData&&!this.roleData.isDead&&(this.teleportSkillTime+=e,this.restoreSkillTime+=e,this.ultimateSkillTime+=e,e=this.roleData.hp/this.roleData.maxHp,!this.roleData.isTeleporting&&this.restoreSkillTime>=this.restoreSkillCd&&e<=this.dangerHpLine&&(this.restoreSkillTime=0,this.useRestoreSkill()))},b.prototype.useTeleportSkill=function(e){var t,a=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,this.teleportSkillReady?this.teleportSkillReady=!1:this.teleportSkillTime=0,this.roleData.isTeleporting=!0,this.thruster.active=!1,y.EffectCreate.createAppearEffect(this.roleData.logicPos),t=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),v.SingleEffectManager.clearInsertArrows(this.roleData),p.TimerManager.addTimer(.8,function(){if(null!=a.roleData&&!a.roleData.isDead&&!a.roleData.isDestroy){D.EnemyArea.setEnemyPostionMap(t.x,null);var n=e?cc.v2(440,u.Util.getRandomFloatNum(0,160)):D.EnemyArea.getEmptyPosition(a.roleData);if(null==n)return a.node.position=a.roleData.logicPos,void(a.footRest&&a.footRest.updatePosition());a.roleData.logicPos=n,y.EffectCreate.createAppearEffect(a.roleData.logicPos),a.node.position=a.roleData.logicPos,a.footRest&&a.footRest.updatePosition(),D.EnemyArea.setEnemyPostionMap(a.roleData.logicPos.x,a.roleData),a.roleData.isTeleporting=!1,a.thruster.active=!0,a.setMoveAction(),e?a.useUltimateSkill():a.launch()}},this.node))},b.prototype.useRestoreSkill=function(){var e,t,a=this;null==this.roleData||this.roleData.isDead||(this.spineController.playAnimation(c.SpineAniNameEnum.Run,!1,!0,null),this.restoreSkillCd+=10,this.isUsingRestoreSkill=!0,this.roleData.isFrozening=!1,this.isHitAniRunning=!1,this.roleUp.angle=0,this.roleUp.stopAllActions(),p.TimerManager.removeAllTimers(this.node),this.stopUltimateSkill(),e=cc.v2(this.roleData.logicPos.x,this.standPosY),t=(this.roleData.logicPos.y-e.y)/(2*this.moveSpeed),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(t,e),cc.callFunc(function(){a.burrowDown()}))))},b.prototype.useUltimateSkill=function(){var e=this;this.isUsingUltimateSkill=!0,this.ultimateSkillTime=0,this.roleData.isFrozening=!1,this.isHitAniRunning=!1,this.roleUp.angle=0,this.roleUp.stopAllActions(),this.node.stopAllActions(),p.TimerManager.removeAllTimers(this.node),this.spineController.playAnimation(c.SpineAniNameEnum.Aim,!1,!1,function(){e.spineController.playAnimation(c.SpineAniNameEnum.Aim2,!1,!1,function(){var t,a=e.createAimingRay();null!=a&&(e.aimingRay=a,e.refreshAimingRayPos(),t=e.attackTargetData.logicPos.sub(e.aimingRay.position).normalize(),a=e.attackTargetData.logicPos.add(t.mul(500)),t=Math.random(),e.aimingPos=t<.5?a.add(cc.v2(0,1).mul(u.Util.getRandomNum(200,300))):a.add(cc.v2(0,-1).mul(u.Util.getRandomNum(200,300))),e.ultimateSkillTween=new cc.Tween,e.ultimateSkillTween.target(e),e.ultimateSkillTween.to(3,{aimingPos:e.attackTargetData.logicPos.clone()},null),e.ultimateSkillTween.call(function(){e.aimingPos=e.attackTargetData.logicPos}),e.ultimateSkillTween.delay(1),e.ultimateSkillTween.call(function(){e.stopUltimateSkill();var t=e.roleData.isUltimateBoss?2:1;d.GameState.heroModel&&t++,function a(){e.node.stopAllActions(),e.node.runAction(cc.sequence(cc.callFunc(function(){e.spineController.playAnimation(c.SpineAniNameEnum.Aim3,!1,!1,null),e.shootLaser()}),cc.moveBy(.1,50,0),cc.callFunc(function(){e.spineController.playAnimation(c.SpineAniNameEnum.Aim2,!1,!1,null)}),cc.moveBy(.1,-60,0),cc.callFunc(function(){0<--t&&a()}),cc.delayTime(.5),cc.callFunc(function(){e.ultimateSkillTime=0,e.useTeleportSkill(!1)})))}()}),e.ultimateSkillTween.start())})})},b.prototype.createAimingRay=function(){var e=k.GameCommonPool.requestInstant(this.aimingRayPrefab);if(null!=e){var t=T.BattleNodeManager.getParentNode(c.BattleNodeEnum.EFFECT_NODE);if(null!=t)return e.width=0,e.setParent(t),e}},b.prototype.burrowDown=function(){var e=this;v.SingleEffectManager.clearInsertArrows(this.roleData),this.thruster.active=!1,this.roleData.isTeleporting=!0,this.isBurrowing=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Down,!1,!1,function(){e.isBurrowing=!1;var t=d.GameState.heroModel?.3:.2;t=Math.round(e.roleData.maxHp*t),g.RoleManager.restoreRoleHp(e.roleData,t,!1,!0),e.isUsingRestoreSkill=!1,e.roleData.attackModel=c.AttackModelTypeEnum.MELEE_ATTACK,e.node.x-=e.posXOffset,p.TimerManager.addTimer(1,function(){var t=cc.v2(e.attackTargetData.logicPos.x+80,e.standPosY),a=(e.roleData.logicPos.x-t.x)/e.moveSpeed;e.node.stopAllActions(),e.node.runAction(cc.sequence(cc.moveTo(a,t),cc.callFunc(function(){e.burrowUp()})))}),e.spineController.playAnimation(c.SpineAniNameEnum.Run_ug,!1,!0,null)},1)},b.prototype.burrowUp=function(){var e=this;this.isBurrowing=!0,p.TimerManager.addTimer(.6,function(){e.roleData.isTeleporting=!1},this.node),this.spineController.playAnimation(c.SpineAniNameEnum.Up,!1,!1,function(){e.isBurrowing=!1,e.meleeAttackCount=0,e.setMeleeAttack()})},b.prototype.shootLaser=function(){A.LocalSoundManager.playAudio("newLaser");var e,t,a=k.GameCommonPool.requestInstant(this.laserPrefab);null!=a&&(null==(e=T.BattleNodeManager.getParentNode(c.BattleNodeEnum.EFFECT_NODE))||null!=(t=this.spineController.getBoneWorldPos(c.BoneNameEnum.F_N_PLUS_R))&&(t=this.roleUp.convertToWorldSpaceAR(t),t=e.convertToNodeSpaceAR(t),a.setParent(e),a.setPosition(t),null!=(a=a.getComponent(P.NewLaser))&&a.bindData(3*this.roleData.atk,this.roleData,this.attackTargetData)))},b.prototype.refreshAimingRayPos=function(){var e;null==this.roleData||this.roleData.isDead||(null!=this.aimBone?null!=this.aimingRay&&(e=cc.v2(this.aimBone.worldX,this.aimBone.worldY),e=this.roleUp.convertToWorldSpaceAR(e),e=this.node.parent.convertToNodeSpaceAR(e),this.aimingRay.position=e):this.aimBone=this.spineController.getBoneByName(c.BoneNameEnum.F_N_PLUS_L))},b.prototype.stopUltimateSkill=function(){this.node.stopAllActions(),this.ultimateSkillTween&&this.ultimateSkillTween.stop(),this.ultimateSkillTween=null,this.isUsingUltimateSkill=!1,this.ultimateSkillTime=0,this.aimingRay&&k.GameCommonPool.returnInstant(this.aimingRay),this.aimingRay=null},b.prototype.isHit=function(e,t){var a=this;if(null==this.roleData||this.roleData.isDead||this.isBurrowing||this.roleData.isTeleporting||this.isUsingRestoreSkill)this.isHitAniRunning=!1;else{var n=!1;if(this.isUsingUltimateSkill&&(e||t)&&(this.stopUltimateSkill(),n=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Run,!1,!0,null)),this.roleData.attackModel==c.AttackModelTypeEnum.MELEE_ATTACK){if(this.isHitAniRunning)return;this.isHitAniRunning=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Fankui,!1,!1,function(){a.isHitAniRunning=!1,0<a.roleData.repelTime||0<a.roleData.reviveRepelTime||(0<a.meleeAttackCount?(a.setMoveAction(),a.setLongRangeAttack()):a.setMeleeAttack())})}else this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,10),cc.rotateBy(.1,-20),cc.rotateBy(.1,10),cc.callFunc(function(){a.roleUp.angle=0,a.isHitAniRunning=!1,n&&a.useTeleportSkill(!1)})));this.roleData.isFrozening&&this.spineController.pauseAnimation(!0)}},b.prototype.isFroze=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){if(this.isUsingRestoreSkill||this.isUsingUltimateSkill)return this.roleData.isFrozening=!1,void y.EffectCreate.createRoleTip(this.roleData.logicPos,1);this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),p.TimerManager.pasueAllTimers(this.node),g.RoleManager.pauseWaitingLaunchArrows(this.roleData);var t=this.roleData.frozenTime;p.TimerManager.addTimer(t,function(){null==e.roleData||e.roleData.isDead||e.roleData.isDestroy||(e.roleData.isFrozening=!1,e.spineController.pauseAnimation(!1),e.roleUp.resumeAllActions(),p.TimerManager.resumeAllTimers(e.node),g.RoleManager.resumeWaitingLaunchArrows(e.roleData),e.teleportSkillReady=!0)},this.node)}},b.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||this.isBurrowing||this.roleData.isTeleporting||this.isUsingRestoreSkill||(this.roleData.attackModel==c.AttackModelTypeEnum.LONG_RANGE_ATTACK?g.RoleManager.hitRole(this.roleData):(g.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5))},b.prototype.die=function(){var e,t,a,n,o=this;this.roleData.isFalledDown||(this.stopUltimateSkill(),this.thruster.active=!1,this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,g.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),p.TimerManager.removeAllTimers(this.node),M.GameManager.killEnemy(this.roleData,!0),w.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),t=e=!1,n=-57-this.roleData.logicPos.y,a=Math.abs(n)/300,this.node.runAction(cc.sequence(cc.moveBy(a,0,n),cc.callFunc(function(){e=!0,t&&(o.roleData.isUltimateBoss?o.dieBlast():o.escape())}))),n=this.roleData.headDroped?c.SpineAniNameEnum.D2:c.SpineAniNameEnum.D,this.spineController.playAnimation(n,!0,!1,function(){t=!0,e&&(o.roleData.isUltimateBoss?o.dieBlast():o.escape())}))},b.prototype.dieBlast=function(){var e=this,t=this.roleData.logicPos.clone();this.roleUp.runAction(cc.scaleTo(.5,3)),this.node.runAction(cc.sequence(cc.sequence(cc.moveTo(.05,t.add(cc.v2(5,14))),cc.moveTo(.05,t.add(cc.v2(-6,21))),cc.moveTo(.05,t.add(cc.v2(-3,24))),cc.moveTo(.05,t.add(cc.v2(3,28))),cc.moveTo(.05,t.add(cc.v2(-5,40))),cc.moveTo(.05,t.add(cc.v2(2,42))),cc.moveTo(.05,t.add(cc.v2(-8,49))),cc.moveTo(.05,t.add(cc.v2(3,62))),cc.moveTo(.05,t.add(cc.v2(-3,103))),cc.moveTo(.05,t.add(cc.v2(0,70)))),cc.callFunc(function(){D.EnemyArea.bossAlive=!1,M.GameManager.passPart(),A.LocalSoundManager.playBlastAudio();var t,a,n=T.BattleNodeManager.getParentNode(c.BattleNodeEnum.EFFECT_NODE);null!=n&&(null==(t=D.EnemyArea.createMaigcBallBlast())||null!=(a=t.getComponent(_.MagicBallBlast))&&(t.setParent(n),t.setPosition(e.node.position),a.showBlast(null,null,!0,2),e.roleData.isDestroy=!0,e.close()))})))},b.prototype.escape=function(){var e=this;this.node.y-=50,null==this.currentArrow||this.roleData.weaponLaunch||(this.currentArrow.node.destroy(),this.currentArrow=null),v.SingleEffectManager.clearInsertArrows(this.roleData),this.thruster.active=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Run,!1,!0,null);var t=cc.v2(800,160),a=u.Util.getDistance(this.roleData.logicPos,t)/(2*this.moveSpeed);this.node.runAction(cc.sequence(cc.moveTo(a,t),cc.callFunc(function(){D.EnemyArea.bossAlive=!1,M.GameManager.passPart(),e.roleData.isDestroy=!0,e.close()})))},b.prototype.close=function(){this.stopUltimateSkill(),l.prototype.close.call(this)},__decorate([o({displayName:"\u7ea2\u5916\u7784\u51c6\u7ebf\u9884\u8bbe",type:cc.Prefab})],b.prototype,"aimingRayPrefab",void 0),__decorate([o({displayName:"\u63a8\u8fdb\u5668",type:cc.Node})],b.prototype,"thruster",void 0),__decorate([o({displayName:"\u6fc0\u5149",type:cc.Prefab})],b.prototype,"laserPrefab",void 0),n=__decorate([n],b),i.BossSix=n,cc._RF.pop()},{}],BossThree:[function(e,t,a){"use strict";cc._RF.push(t,"04258yonoJLvZjJouqkFtLd","BossThree");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameManager"),c=n("Head"),p=n("Timer"),d=n("Util"),u=n("ConfigData"),h=n("WorldEventManager"),m=n("LocalWorldEventType"),f=n("BattleNodeManager"),g=n("GameCommonPool"),y=n("BossFlyHead"),v=n("EnemyArea"),D=n("SingleEffectManager"),E=n("LongRoleBase"),S=n("RoleManager"),A=n("GameState"),C=n("EffectCreate"),M=n("GameConfigData");function T(){var e=null!==l&&l.apply(this,arguments)||this;return e.bossFlyHead=null,e.teleportSkillTime=0,e.isUsingSkill=!1,e.teleportSkillReady=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=E.LongRoleBase,__extends(T,l),T.prototype.onEnable=function(){h.WorldEventManager.addListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.teleportSkillTime=0,this.targetForce=null,this.isUsingSkill=!1,this.teleportSkillReady=!1,this.node.scaleX=1,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null)},T.prototype.onDisable=function(){h.WorldEventManager.removeListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},T.prototype.update=function(e){this.refreshDeadState(),this.refreshSkillTime(e)},T.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.isFeignDeath||(this.roleData.logicPos=this.node.position))},T.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(c.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},T.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttackForce()},T.prototype.setAttackForce=function(e){var t,a,n;void 0===e&&(e=!1),null!=this.roleData&&!this.roleData.isDead&&(this.searchAttackTargetData(),this.attackTargetData&&this.currentArrow&&A.GameState.isGaming)&&(this.setHitRate(),this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce),a=this.attackTargetData.logicPos,n=d.Util.getRandomFloatNum(a.x-30,a.x+30),t=d.Util.getRandomFloatNum(a.y+40,a.y-40),a=cc.v2(n,t),n=this.roleData.logicPos.x-a.x,t=-(this.roleData.logicPos.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*s.GameManager.getGravity()*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.randomAttackAngle(e))},T.prototype.randomAttackAngle=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&this.attackTargetData&&this.currentArrow&&A.GameState.isGaming){var a=-(d.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+150*this.roleData.orientation);if(e)return this.roleUp.angle=a,this.spineController.refreshWeapon(),void this.launch();var n=e?.5:d.Util.getRandomFloatNum(1,2);e=e?1:n+1,A.GameState.heroModel&&(n/=M.GameConfigData.data.heroBossArrakFrequency,e/=M.GameConfigData.data.heroBossArrakFrequency),this.isUsingSkill||this.roleUp.runAction(cc.rotateTo(n,a)),p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||t.roleData.isTeleporting||t.launch()},this.node)}},T.prototype.launch=function(){var e,t,a,n,o=this;null!=this.roleData&&!this.roleData.isDead&&this.currentArrow&&(t=this.currentArrow.node.position,n=this.attackTargetData.logicPos,a=null,n=Math.random()<=this.hitRate?(e=d.Util.getRandomFloatNum(n.x-20,n.x+20),d.Util.getRandomFloatNum(n.y+35,n.y-25)):(e=Math.random()<.5?d.Util.getRandomFloatNum(n.x+80,n.x+100):d.Util.getRandomFloatNum(n.x-120,n.x-140),n.y),a=cc.v2(e,n),n=t.x-a.x,t=-(t.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*u.ConfigData.bossWeaponConfigDatas[this.roleData.weaponIndex].gravity*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.roleData.weaponLaunch=!0,n=this.targetForce,n=this.currentArrow.launch(n,.15,0,null,2),S.RoleManager.addWaitingLaunchArrow(this.roleData,n),this.currentArrow=null,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_atk_nwp_a_blade,!1,!1,function(){o.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),o.teleportSkillReady||5<=o.teleportSkillTime?o.useTeleportSkill():(o.equipWeapon(),o.setAttackForce())}))},T.prototype.refreshSkillTime=function(e){A.GameState.isGaming&&(null==this.roleData||this.roleData.isDead||(this.teleportSkillTime+=e))},T.prototype.useTeleportSkill=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!1,this.teleportSkillReady?this.teleportSkillReady=!1:this.teleportSkillTime=0,this.roleData.isTeleporting=!0,C.EffectCreate.createAppearEffect(this.roleData.logicPos),e=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),D.SingleEffectManager.clearInsertArrows(this.roleData),p.TimerManager.addTimer(.8,function(){if(null!=t.roleData&&!t.roleData.isDead&&!t.roleData.isDestroy){v.EnemyArea.setEnemyPostionMap(e.x,null);var a=v.EnemyArea.getEmptyPosition(t.roleData);if(null==a)return t.node.position=t.roleData.logicPos,void(t.footRest&&t.footRest.updatePosition());t.roleData.logicPos=a,C.EffectCreate.createAppearEffect(t.roleData.logicPos),t.node.position=t.roleData.logicPos,t.footRest&&t.footRest.updatePosition(),v.EnemyArea.setEnemyPostionMap(t.roleData.logicPos.x,t.roleData),t.roleData.isTeleporting=!1,t.equipWeapon(),t.setAttackForce(!0)}},this.node))},T.prototype.useUltimateSkill=function(){var e,t,a,n;null!=this.roleData&&(h.WorldEventManager.triggerEvent(m.LocalWorldEventType.ShowBubble,{type:38}),null!=(e=f.BattleNodeManager.getParentNode(r.BattleNodeEnum.BOSS_SPINE_NODE))&&(this.isUsingSkill=!0,null==(t=this.createBossFlyHead())||null!=(a=t.getComponent(y.BossFlyHead))&&(this.roleData.resetData(),this.roleData.headHurtReduction=.5,n=this.roleData.isUltimateBoss?1:.5,A.GameState.heroModel&&(n*=2),this.roleData.hp=Math.ceil(this.roleData.maxHp*n),this.roleData.maxHp=this.roleData.hp,t.setParent(e),t.setPosition(this.roleData.headPosition),a.bindFlyHeadData(this.roleData,this.head.node.angle),S.RoleManager.addRole(this.roleData.id,a))))},T.prototype.createBossFlyHead=function(){var e=g.GameCommonPool.requestInstant(this.bossFlyHead);if(null!=e)return e},T.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isUsingSkill?this.isHitAniRunning=!1:this.isHitAniRunning||(this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},T.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),p.TimerManager.pasueAllTimers(this.node),S.RoleManager.pauseWaitingLaunchArrows(this.roleData),e=this.roleData.frozenTime,p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),t.roleUp.resumeAllActions(),p.TimerManager.resumeAllTimers(t.node),S.RoleManager.resumeWaitingLaunchArrows(t.roleData),t.teleportSkillReady=!0)},this.node))},T.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),S.RoleManager.hitRole(this.roleData))},T.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,S.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),this.spineController.pauseAnimation(!1),p.TimerManager.removeAllTimers(this.node),this.useUltimateSkill(),this.roleData.isDestroy=!0,null==this.currentArrow||this.roleData.weaponLaunch||(this.currentArrow.node.destroy(),this.currentArrow=null),null==this.head||this.roleData.headDroped||null!=this.head.node&&(this.head.node.destroy(),this.head=null),this.roleData.isFeignDeath=!0,this.roleData.headDroped=!0,e=r.SpineAniNameEnum.D2,this.spineController.playAnimation(e,!0,!1,function(){p.TimerManager.addTimer(.1,function(){var e,a;null!=t.roleData&&(g.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,e=-400-t.roleData.logicPos.y,a=Math.abs(e)/300,t.node.runAction(cc.sequence(cc.moveBy(a,0,e),cc.callFunc(function(){t.close()}))))},t.node)}))},__decorate([o({displayName:"boss\u98de\u5934",type:cc.Prefab})],T.prototype,"bossFlyHead",void 0),n=__decorate([n],T),i.BossThree=n,cc._RF.pop()},{}],BossTwo:[function(e,t,a){"use strict";cc._RF.push(t,"ac3ffiyPIVIookQuI7nH3Zo","BossTwo");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("RoleData"),s=o("EnumAndConst"),c=o("GameManager"),p=o("Head"),d=o("Timer"),u=o("Util"),h=o("ConfigData"),m=o("WorldEventManager"),f=o("LocalWorldEventType"),g=o("BattleNodeManager"),y=o("GameCommonPool"),v=o("EnemyArea"),D=o("LocalSoundManager"),E=o("SingleEffectManager"),S=o("LongRoleBase"),A=o("RoleManager"),C=o("GameCommonUtil"),M=o("GameState"),T=o("EffectCreate"),_=o("GameConfigData"),k=o("EquipmentEffectSystem");function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.teleportSkillTime=0,e.ultimateSkillTime=0,e.ultimateSkillCd=10,e.isUsingSkill=!1,e.teleportSkillReady=!1,e.dividesTime=0,e}o=(n=cc._decorator).ccclass,n.property,l=S.LongRoleBase,__extends(P,l),P.prototype.onEnable=function(){m.WorldEventManager.addListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.addListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.teleportSkillTime=0,this.targetForce=null,this.ultimateSkillTime=0,this.ultimateSkillCd=10,this.isUsingSkill=!1,this.teleportSkillReady=!1,this.node.scaleX=1,this.dividesTime=0,this.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null)},P.prototype.onDisable=function(){m.WorldEventManager.removeListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.removeListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},P.prototype.update=function(e){null!=this.roleData&&(this.refreshDeadState(),this.roleData.isRecycled||(this.refreshSkillTime(e),this.roleData.isDivideBoss&&null!=this.roleData.ancestorData&&this.roleData.ancestorData.isDead&&(this.roleData.isDead=!0)))},P.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},P.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(p.Head);null!=n&&(this.head=n,this.head.bindData(e,2)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},P.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttackForce()},P.prototype.setAttackForce=function(e){var t,a,n;void 0===e&&(e=!1),null!=this.roleData&&!this.roleData.isDead&&(this.searchAttackTargetData(),this.attackTargetData&&this.currentArrow&&M.GameState.isGaming)&&(this.setHitRate(),this.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce),a=this.attackTargetData.logicPos,n=u.Util.getRandomFloatNum(a.x-30,a.x+30),t=u.Util.getRandomFloatNum(a.y+40,a.y-40),a=cc.v2(n,t),n=this.roleData.logicPos.x-a.x,t=-(this.roleData.logicPos.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*c.GameManager.getGravity()*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.randomAttackAngle(e))},P.prototype.randomAttackAngle=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&this.attackTargetData&&this.currentArrow&&M.GameState.isGaming){var a=-(u.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+150*this.roleData.orientation);if(e)return this.roleUp.angle=a,this.spineController.refreshWeapon(),void this.launch();var n=e?.5:u.Util.getRandomFloatNum(1,2);e=e?1:n+1,M.GameState.heroModel&&(n/=_.GameConfigData.data.heroBossArrakFrequency,e/=_.GameConfigData.data.heroBossArrakFrequency),this.isUsingSkill||this.roleUp.runAction(cc.rotateTo(n,a)),d.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||t.roleData.isTeleporting||t.launch()},this.node)}},P.prototype.launch=function(){var e,t,a,n,o=this;this.currentArrow&&null!=this.roleData&&!this.roleData.isDead&&(t=this.currentArrow.node.position,n=this.attackTargetData.logicPos,a=null,n=Math.random()<=this.hitRate?(e=u.Util.getRandomFloatNum(n.x-20,n.x+20),u.Util.getRandomFloatNum(n.y+35,n.y-25)):(e=Math.random()<.5?u.Util.getRandomFloatNum(n.x+80,n.x+100):u.Util.getRandomFloatNum(n.x-120,n.x-140),n.y),a=cc.v2(e,n),n=t.x-a.x,t=-(t.y-a.y),n/=a=this.targetForceMagnitude,n=(t-.5*h.ConfigData.bossWeaponConfigDatas[this.roleData.weaponIndex].gravity*Math.pow(n,2))/n,this.targetForce=cc.v2(-a,n),this.roleData.weaponLaunch=!0,n=this.targetForce,n=this.currentArrow.launch(n,.15,0,null,2),A.RoleManager.addWaitingLaunchArrow(this.roleData,n),this.currentArrow=null,this.spineController.playAnimation(s.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){o.spineController.playAnimation(s.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),o.teleportSkillReady||5<=o.teleportSkillTime||o.ultimateSkillTime>=o.ultimateSkillCd?o.useTeleportSkill():(o.equipWeapon(),o.setAttackForce())}))},P.prototype.refreshSkillTime=function(e){M.GameState.isGaming&&(null==this.roleData||this.roleData.isDead||this.roleData.isDivideBoss||(this.teleportSkillTime+=e,null!=this.roleData.divideBossDatas&&0<this.roleData.divideBossDatas.length?this.dividesTime-=e:this.ultimateSkillTime+=e))},P.prototype.useTeleportSkill=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){this.roleData.isFrozening=!1,this.teleportSkillReady?this.teleportSkillReady=!1:this.teleportSkillTime=0,this.roleData.isTeleporting=!0,T.EffectCreate.createAppearEffect(this.roleData.logicPos);var t=this.roleData.logicPos.clone();if(this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),E.SingleEffectManager.clearInsertArrows(this.roleData),null!=this.roleData.divideBossDatas&&0<this.roleData.divideBossDatas.length)for(var a=0;a<this.roleData.divideBossDatas.length;a++){var n=this.roleData.divideBossDatas[a];null!=n?(n.isRecycled=!0,A.RoleManager.recyvleRole(n),this.dividesTime<=0&&(n.isDead=!0,this.roleData.divideBossDatas.splice(a,1),a--,A.RoleManager.roleDie(n))):(this.roleData.divideBossDatas.splice(a,1),a--)}d.TimerManager.addTimer(.8,function(){if(null!=e.roleData&&!e.roleData.isDead&&!e.roleData.isDestroy){v.EnemyArea.setEnemyPostionMap(t.x,null);var a=v.EnemyArea.getEmptyPosition(e.roleData);if(null==a)return e.node.position=e.roleData.logicPos,void(e.footRest&&e.footRest.updatePosition());e.roleData.logicPos=a,T.EffectCreate.createAppearEffect(e.roleData.logicPos),e.node.position=e.roleData.logicPos,e.footRest&&e.footRest.updatePosition(),v.EnemyArea.setEnemyPostionMap(e.roleData.logicPos.x,e.roleData),e.roleData.isTeleporting=!1,e.ultimateSkillTime>=e.ultimateSkillCd||null!=e.roleData.divideBossDatas&&0<e.roleData.divideBossDatas.length?e.useUltimateSkill():(e.equipWeapon(),e.setAttackForce(!0))}},this.node)}},P.prototype.useUltimateSkill=function(){if(null!=this.roleData&&!this.roleData.isDead&&(m.WorldEventManager.triggerEvent(f.LocalWorldEventType.ShowBubble,{type:36}),null!=g.BattleNodeManager.getParentNode(s.BattleNodeEnum.PARTICLE_NODE))){D.LocalSoundManager.playAudio("ninja"),this.ultimateSkillTime=0,this.ultimateSkillCd+=5,this.isUsingSkill=!0;var e=this.roleData.isUltimateBoss?2:1;M.GameState.heroModel&&e++;var t=null!=this.roleData.divideBossDatas&&0<this.roleData.divideBossDatas.length,a=t?this.roleData.divideBossDatas.length:e;t||(this.dividesTime=5);for(var n=0;n<a;n++){var o=null;t?(o=this.roleData.divideBossDatas[n]).maxHp=o.hp:((o=new r.RoleData).orientation=1,o.id=C.GameCommonUtil.uuid(),o.isPlayer=!1,o.isEnemy=!0,o.isBoss=!0,o.isUltimateBoss=!1,o.isDivideBoss=!0,o.ancestorData=this.roleData,o.totalDamage=0,o.profession=this.roleData.profession,o.attackModel=s.AttackModelTypeEnum.LONG_RANGE_ATTACK,o.weaponIndex=this.roleData.weaponIndex,o.maxHp=Math.round(.1*this.roleData.maxHp),o.hp=this.roleData.maxHp,o.atk=.5*this.roleData.atk,o.isMoveModel=!1,o.rewardExpCount=0,o.rewardCoinCount=0),o.logicPos=v.EnemyArea.getEmptyPosition(o),o.resetData(),M.GameState.heroModel&&o.getEnemyRandomSkill(),v.EnemyArea.createBoss(o),this.roleData.divideBossDatas[n]=o}this.equipWeapon(),this.setAttackForce(),this.isUsingSkill=!1}},P.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isUsingSkill?this.isHitAniRunning=!1:this.isHitAniRunning||(this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},P.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.isUsingSkill?this.roleData.isFrozening=!1:(this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),d.TimerManager.pasueAllTimers(this.node),A.RoleManager.pauseWaitingLaunchArrows(this.roleData),e=this.roleData.frozenTime,d.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),t.roleUp.resumeAllActions(),d.TimerManager.resumeAllTimers(t.node),A.RoleManager.resumeWaitingLaunchArrows(t.roleData),t.teleportSkillReady=!0)},this.node)))},P.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),A.RoleManager.hitRole(this.roleData))},P.prototype.die=function(){var e=this;if(!this.roleData.isFalledDown){if(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,A.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),d.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),null!=this.roleData.divideBossDatas&&0<this.roleData.divideBossDatas.length&&this.roleData.divideBossDatas.forEach(function(e){e.isRecycled=!0,e.isDead=!0,A.RoleManager.recyvleRole(e)}),this.roleData.isDivideBoss){var t=this.roleData.ancestorData.divideBossDatas.indexOf(this.roleData);return-1!=t&&this.roleData.ancestorData.divideBossDatas.splice(t,1),this.recyvle(),void(0<this.roleData.totalDamage&&A.RoleManager.restoreRoleHp(this.roleData.ancestorData,this.roleData.totalDamage))}c.GameManager.killEnemy(this.roleData,!0),k.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),t=this.roleData.headDroped?s.SpineAniNameEnum.D2:s.SpineAniNameEnum.D,this.spineController.playAnimation(t,!0,!1,function(){d.TimerManager.addTimer(.1,function(){var t,a;null!=e.roleData&&(y.GameCommonPool.returnInstant(e.footRest.node),e.footRest=null,t=e.roleData.isUltimateBoss?-400-e.roleData.logicPos.y:h.ConfigData.PLYAER_POS.y+30-e.roleData.logicPos.y,a=Math.abs(t)/300,a=Math.max(0,a),e.node.runAction(cc.sequence(cc.moveBy(a,0,t),cc.callFunc(function(){e.roleData.isUltimateBoss?(v.EnemyArea.bossAlive=!1,c.GameManager.passPart(),e.roleData.isDestroy=!0,e.close()):e.escape()}))))},e.node)})}},P.prototype.escape=function(){var e=this;this.spineController.playAnimation(s.SpineAniNameEnum.Magic_atk,!0,!1,function(){E.SingleEffectManager.clearInsertArrows(e.roleData),T.EffectCreate.createAppearEffect(e.roleData.logicPos),e.roleData.isDestroy=!0,e.close(),v.EnemyArea.bossAlive=!1,c.GameManager.passPart()})},o=__decorate([o],P),i.BossTwo=o,cc._RF.pop()},{}],BoxItem:[function(e,t,a){"use strict";cc._RF.push(t,"bd7e2FGWHNL3ZyUpU+BeNmx","BoxItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("LocalData"),c=n("SpriteFrameManager"),p=n("ConfigData"),d=n("NumberImg"),u=n("UIManager");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.itemSprite=null,e.energySpriteFrame=null,e.coinSpriteFrame=null,e.defaultSpriteFrame=null,e.countNum=null,e.equipmentLevelSprite=null,e.equipmentLevel=null,e.equipmentRank=null,e.equipmentProperty=null,e.equipmentProgress=null,e.equipmentName=null,e.progressSprite=null,e.canUpgradeTip=null,e.informationBg=null,e.stars=null,e.equipmentRankEffectNode=null,e.equipmentRankEffect=null,e.isGet=!0,e.sameEquipmentCount=null,e.rewardType=null,e.boxItemData=null,e.itemSpriteStartPos=cc.v2(0,13),e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onLoad=function(){this.itemSpriteStartPos=this.itemSprite.node.position},h.prototype.onEnable=function(){var e=this;this.informationBg.position=cc.v2(-183,0),this.stars.active=this.isGet,this.isGet?(this.node.scale=.1,this.node.position=cc.v2(0,-20),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.2,1),cc.moveTo(.2,0,97)),cc.callFunc(function(){e.informationBgAnimation()})))):(this.node.scale=1.1,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.scaleTo(.1,1.2),cc.scaleTo(.1,1))))},h.prototype.bindData=function(e,t){if(null!=this.equipmentRankEffect&&(this.equipmentRankEffect.node.active=!1),null!=e){if(this.boxItemData=e,this.itemSprite.node.angle=0,this.rewardType=e.type,this.itemSprite.node.position=this.itemSpriteStartPos,e.type==r.coin)return this.itemSprite.node.scale=.8,this.itemSprite.spriteFrame=this.coinSpriteFrame,this.countNum.value="x"+e.count,this.equipmentLevel.node.active=!1,this.countNum.node.active=!0,this.equipmentName.string="\u91d1\u5e01",void(this.equipmentLevelSprite.spriteFrame=this.defaultSpriteFrame);if(e.type==r.energy)return this.itemSprite.node.scale=.8,this.itemSprite.spriteFrame=this.energySpriteFrame,this.countNum.value="x"+e.count,this.equipmentLevel.node.active=!1,this.countNum.node.active=!0,this.equipmentName.string="\u4f53\u529b",void(this.equipmentLevelSprite.spriteFrame=this.defaultSpriteFrame);var a=e.equipmentData;if(null!=a){this.equipmentLevel.node.active=!0,this.countNum.node.active=!1;var n=a.rank;if(e=a.index,null!=n&&null!=e){if(t){if(null==this.equipmentRankEffect){if(null==(t=u.UIManager.createEquipmentRankNormalEffect()))return;t.node.setParent(this.equipmentRankEffectNode),t.node.setPosition(cc.Vec2.ZERO),this.equipmentRankEffect=t}this.equipmentRankEffect.node.active=!0,this.equipmentRankEffect.bindData(n,1.5)}this.equipmentLevelSprite.spriteFrame=c.SpriteFrameManager.getEquipmentRankSpriteFrame(n-1),this.equipmentRank.spriteFrame=c.SpriteFrameManager.getEquipmentLevelNameSpriteFrame(n-1),a.type==s.EquipmentType.weapon?(this.equipmentProperty.string="\u653b\u51fb\u529b\uff1a"+p.ConfigData.getWeaponAtk(e,1,n),this.equipmentName.string=p.ConfigData.weaponName[e],4<=n&&(this.equipmentName.string=p.ConfigData.weaponName[e]+"\xb7\u5229\u5203"),this.itemSprite.spriteFrame=c.SpriteFrameManager.getLaunchWeaponSpriteFrame(e,n),this.itemSprite.node.scale=5==e?.5:.28,this.itemSprite.node.angle=-45):a.type==s.EquipmentType.helmet?(this.equipmentProperty.string="\u62a4\u7532\u503c\uff1a"+p.ConfigData.getDefense(s.EquipmentType.helmet,e,1,n),this.equipmentName.string=p.ConfigData.helmetName[e],4<=n&&(this.equipmentName.string=p.ConfigData.helmetName[e]+"\xb7\u65e0\u754f"),this.itemSprite.spriteFrame=c.SpriteFrameManager.getHelmetSpriteFrame(e,n),this.itemSprite.node.scale=.5,0==e&&4<=n&&(this.itemSprite.node.scale=.4),5==e&&4<=n&&(this.itemSprite.node.scale=.4)):a.type==s.EquipmentType.shield?(this.equipmentProperty.string="\u62a4\u7532\u503c\uff1a"+p.ConfigData.getDefense(s.EquipmentType.shield,e,1,n),this.equipmentName.string=p.ConfigData.shieldName[e],4<=n&&(this.equipmentName.string=p.ConfigData.shieldName[e]+"\xb7\u94c1\u58c1"),this.itemSprite.spriteFrame=c.SpriteFrameManager.getShieldSpriteFrame(e,n),this.itemSprite.node.angle=-45,this.itemSprite.node.scale=0==e&&n<4?.5:.3,5==e&&4<=n&&(this.itemSprite.node.position=this.itemSpriteStartPos.sub(cc.v2(0,11)))):a.type==s.EquipmentType.cloak&&(this.equipmentProperty.string="\u751f\u547d\u503c\uff1a"+p.ConfigData.getCloakHp(e,n,1),this.equipmentName.string=p.ConfigData.cloakName[e],this.itemSprite.spriteFrame=c.SpriteFrameManager.getCloakSpriteFrame(e),this.itemSprite.node.scale=.3),this.sameEquipmentCount=s.LocalData.getEquipmentData(a.type,a.index,a.rank).length,this.equipmentProgress.value=this.sameEquipmentCount-1+"/"+p.ConfigData.upgradeEquipmentNeedCount,this.progressSprite.node.scaleX=Math.min((this.sameEquipmentCount-1)/p.ConfigData.upgradeEquipmentNeedCount,1),3<=this.sameEquipmentCount?this.canUpgradeTip.active=!0:this.canUpgradeTip.active=!1}}}},h.prototype.informationBgAnimation=function(){var e=this;this.rewardType==r.equipment&&(this.informationBg.stopAllActions(),this.informationBg.runAction(cc.sequence(cc.moveTo(.2,0,0),cc.callFunc(function(){e.progressAnimation()}))))},h.prototype.progressAnimation=function(){var e=this;this.progressSprite.node.stopAllActions(),this.progressSprite.node.runAction(cc.sequence(cc.scaleTo(.3,Math.min(this.sameEquipmentCount/p.ConfigData.upgradeEquipmentNeedCount,1),1),cc.callFunc(function(){e.equipmentProgress.value=e.sameEquipmentCount+"/"+p.ConfigData.upgradeEquipmentNeedCount})))},h.prototype.selectDoubble=function(e){null!=this.rewardType&&null!=this.boxItemData&&(this.rewardType==r.coin&&(this.countNum.value="x"+(e?2*this.boxItemData.count:this.boxItemData.count)),this.rewardType==r.equipment&&(this.equipmentLevel.value=e?"lv.5":"lv.1"))},__decorate([o({type:cc.Sprite,displayName:"\u7269\u54c1\u56fe\u7247"})],h.prototype,"itemSprite",void 0),__decorate([o({displayName:"\u4f53\u529b\u56fe\u7247",type:cc.SpriteFrame})],h.prototype,"energySpriteFrame",void 0),__decorate([o({displayName:"\u91d1\u5e01\u56fe\u7247",type:cc.SpriteFrame})],h.prototype,"coinSpriteFrame",void 0),__decorate([o({displayName:"\u9ed8\u8ba4\u80cc\u666f\u56fe\u7247",type:cc.SpriteFrame})],h.prototype,"defaultSpriteFrame",void 0),__decorate([o({type:d.NumberImg,displayName:"\u7269\u54c1\u6570\u91cf"})],h.prototype,"countNum",void 0),__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u7b49\u7ea7\u56fe\u7247"})],h.prototype,"equipmentLevelSprite",void 0),__decorate([o({type:d.NumberImg,displayName:"\u88c5\u5907\u7b49\u7ea7"})],h.prototype,"equipmentLevel",void 0),__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u54c1\u7ea7"})],h.prototype,"equipmentRank",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u5c5e\u6027"})],h.prototype,"equipmentProperty",void 0),__decorate([o({type:d.NumberImg,displayName:"\u88c5\u5907\u8fdb\u5ea6"})],h.prototype,"equipmentProgress",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u540d\u79f0"})],h.prototype,"equipmentName",void 0),__decorate([o({type:cc.Sprite,displayName:"\u8fdb\u5ea6\u56fe\u7247"})],h.prototype,"progressSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u5347\u7ea7\u63d0\u793a"})],h.prototype,"canUpgradeTip",void 0),__decorate([o({type:cc.Node,displayName:"\u5c5e\u6027\u9762\u677f"})],h.prototype,"informationBg",void 0),__decorate([o({type:cc.Node,displayName:"\u661f\u661f"})],h.prototype,"stars",void 0),__decorate([o({displayName:"\u88c5\u5907\u54c1\u7ea7\u7279\u6548\u8282\u70b9",type:cc.Node})],h.prototype,"equipmentRankEffectNode",void 0),n=__decorate([n],h),i.BoxItem=n,i.BoxItemData=function(){this.type=null,this.equipmentData=null,this.count=null},(i=r=i.ItemType||(i.ItemType={}))[i.equipment=0]="equipment",i[i.energy=1]="energy",i[i.coin=2]="coin",cc._RF.pop()},{}],BoxReward:[function(e,t,a){"use strict";cc._RF.push(t,"82a86KmymRGp4CBZzWkqT7T","BoxReward");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("Util"),l=n("UIManager"),r=n("BoxItem"),s=n("UserData"),c=n("LocalData"),p=n("GameConfigData"),d=n("EnumAndConst");function u(){}u.normalBoxReward=function(e,t,a){void 0===a&&(a=null),u.itemData=[];var n=1+i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.normalCountChance);null!=a&&(this.getFixEquipment(a.type,a.index,a.rank),n--);for(var o=p.GameConfigData.data.weaponChance,r=p.GameConfigData.data.shieldChance,s=p.GameConfigData.data.helmetChance,c=p.GameConfigData.data.normalBoxChance,d=0;d<n;d++){var h=i.Util.getRandomIndexInChanceArray([c[0],o*c[1],o*c[2],o*c[3],o*c[4],o*c[5],r*c[6],r*c[7],r*c[8],r*c[9],r*c[10],s*c[11],s*c[12],s*c[13],s*c[14],s*c[15]]);this.rewardObject(h+1,1)}l.UIManager.showGetBoxPop(1,e,t)},u.legendBoxReward=function(e,t,a){void 0===a&&(a=null),u.itemData=[];var n=1+i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.legendCountChance);null!=a&&(this.getFixEquipment(a.type,a.index,a.rank),n--);for(var o=p.GameConfigData.data.weaponChance,r=p.GameConfigData.data.shieldChance,s=p.GameConfigData.data.helmetChance,c=p.GameConfigData.data.legendBoxChance,d=0;d<n;d++){var h=i.Util.getRandomIndexInChanceArray([c[0],o*c[1],o*c[2],o*c[3],o*c[4],o*c[5],r*c[6],r*c[7],r*c[8],r*c[9],r*c[10],s*c[11],s*c[12],s*c[13],s*c[14],s*c[15]]);this.rewardObject(h+1,2)}l.UIManager.showGetBoxPop(2,e,t)},u.weaponBoxReward=function(e,t,a){void 0===a&&(a=null),u.itemData=[],null!=a&&this.getFixEquipment(a.type,a.index,a.rank);var n=!1;if(0==c.LocalData.data.openWeaponBoxTimes?.5<=Math.random()?n=!0:c.LocalData.data.getCloakNum=i.Util.getRandomNum(1,5):c.LocalData.data.getCloakNum&&c.LocalData.data.openWeaponBoxTimes==c.LocalData.data.getCloakNum&&(n=!0),n)n=[3,4,5,6,7],n=(n=s.UserData.data.loginRewardRecievedCount<2?[3,5,6,7]:n)[d=i.Util.getRandomNum(0,n.length-1)],this.newWeaponReward(n+1);else{var o=1+i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.weaponCountChance);null!=a&&o--;for(var r=0;r<o;r++){var d=i.Util.getRandomNum(0,2);this.newWeaponReward(d+1)}}l.UIManager.showGetBoxPop(3,e,t),c.LocalData.data.openWeaponBoxTimes++,5<c.LocalData.data.openWeaponBoxTimes&&(c.LocalData.data.openWeaponBoxTimes=1,c.LocalData.data.getCloakNum=i.Util.getRandomNum(1,5))},u.rewardObject=function(e,t){if(!(16<e||e<0||2<t||t<1))switch(e){case 1:var a,n=new r.BoxItemData;n.type=r.ItemType.coin,1==t?(a=i.Util.getRandomNum(p.GameConfigData.data.normalMinCoin,p.GameConfigData.data.normalMaxCoin),c.LocalData.changeCoin(a),n.count=a):2==t&&(a=i.Util.getRandomNum(p.GameConfigData.data.legendMinCoin,p.GameConfigData.data.legendMaxCoin),c.LocalData.changeCoin(a),n.count=a),u.itemData.push(n);break;case 2:this.getEquipment(c.EquipmentType.weapon,0,t);break;case 3:this.getEquipment(c.EquipmentType.weapon,1,t);break;case 4:this.getEquipment(c.EquipmentType.weapon,4,t);break;case 5:this.getEquipment(c.EquipmentType.weapon,2,t);break;case 6:this.getEquipment(c.EquipmentType.weapon,3,t);break;case 7:this.getEquipment(c.EquipmentType.shield,0,t);break;case 8:this.getEquipment(c.EquipmentType.shield,1,t);break;case 9:this.getEquipment(c.EquipmentType.shield,2,t);break;case 10:this.getEquipment(c.EquipmentType.shield,3,t);break;case 11:this.getEquipment(c.EquipmentType.shield,4,t);break;case 12:this.getEquipment(c.EquipmentType.helmet,0,t);break;case 13:this.getEquipment(c.EquipmentType.helmet,1,t);break;case 14:this.getEquipment(c.EquipmentType.helmet,2,t);break;case 15:this.getEquipment(c.EquipmentType.helmet,3,t);break;case 16:this.getEquipment(c.EquipmentType.helmet,4,t)}},u.newWeaponReward=function(e){var t=new r.BoxItemData;t.type=r.ItemType.equipment;var a=1+i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.weaponRankChance);switch(e){case 1:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.weapon,5,a);break;case 2:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.weapon,6,a);break;case 3:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.weapon,7,a);break;case 4:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.cloak,0,4);break;case 5:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.cloak,1,4);break;case 6:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.cloak,2,4);break;case 7:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.cloak,3,4);break;case 8:t.equipmentData=c.LocalData.rewardEquipment(c.EquipmentType.cloak,4,4)}u.itemData.push(t)},u.getFixEquipment=function(e,t,a){var n=new r.BoxItemData;n.type=r.ItemType.equipment,n.count=1,n.equipmentData=c.LocalData.rewardEquipment(e,t,a),u.itemData.push(n)},u.getEquipment=function(e,t,a){var n=new r.BoxItemData;n.type=r.ItemType.equipment;var o,l=n.count=1;1==a?(l+=i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.normalRankChance),n.equipmentData=c.LocalData.rewardEquipment(e,t,l)):2==a&&(a=p.GameConfigData.data.legendRankChance.concat([]),e==c.EquipmentType.helmet&&2==t&&s.UserData.data.loginRewardRecievedCount<3&&(o=a[3]+a[4],a[0]+=o/3,a[1]+=o/3,a[2]+=1-a[0]-a[1],a[3]=0,a[4]=0),e==c.EquipmentType.shield&&2==t&&s.UserData.data.loginRewardRecievedCount<5&&(o=a[3]+a[4],a[0]+=o/3,a[1]+=o/3,a[2]+=1-a[0]-a[1],a[3]=0,a[4]=0),e==c.EquipmentType.weapon&&1==t&&s.UserData.data.loginRewardRecievedCount<7&&(o=a[4],a[0]+=o/4,a[1]+=o/4,a[2]+=o/4,a[3]+=1-a[0]-a[1]-a[2],a[4]=0),l+=i.Util.getRandomIndexInChanceArray(a),n.equipmentData=c.LocalData.rewardEquipment(e,t,l)),u.itemData.push(n)},u.eggMachineGet=function(e,t){c.LocalData.data.eggMachineTimes++;var a=e?p.GameConfigData.data.eggGemRankChance:p.GameConfigData.data.eggVideoRankChance,n=1+i.Util.getRandomIndexInChanceArray(a),o=p.GameConfigData.data.eggTypeChance.concat([]);if(a=null,a=n<4?(o=[p.GameConfigData.data.eggTypeChance[0],p.GameConfigData.data.eggTypeChance[1],p.GameConfigData.data.eggTypeChance[2],p.GameConfigData.data.eggTypeChance[4]],i.Util.getRandomIndexInChanceArray(o,1-p.GameConfigData.data.eggTypeChance[3])):i.Util.getRandomIndexInChanceArray(o),c.LocalData.data.eggMachineTimes>=p.GameConfigData.data.eggBottomTime&&(c.LocalData.data.eggMachineTimes=0,(n=4)==a&&(a=i.Util.getRandomNum(0,3))),4<=n&&4!=a&&(c.LocalData.data.eggMachineTimes=0,c.LocalData.data.eggMachineGetCloak||(a=c.EquipmentType.cloak)),n<4&&3==a||4<=n&&4==a){var r=i.Util.getRandomIndexInChanceArray(p.GameConfigData.data.eggCoinChance);return o=(e?p.GameConfigData.data.eggGemMinCoinChance:p.GameConfigData.data.eggVideoMinCoinChance)[r],r=(e?p.GameConfigData.data.eggGemMaxCoinChance:p.GameConfigData.data.eggVideoMaxCoinChance)[r],o=i.Util.getRandomNum(o,r),c.LocalData.changeCoin(o),(r=new d.RewardData).rewardType=d.RewardTypeEnum.COIN,r.rewardCount=o,void l.UIManager.showNewRewardUIPop(r,t)}r=this.newEquipmentIndex,a==c.EquipmentType.cloak&&(c.LocalData.data.eggMachineGetCloak=!0),a==c.EquipmentType.weapon&&(r=this.newWeaponIndex),r=c.LocalData.rewardEquipment(a,r,n),n=[new c.NewEquipmentData(0,0,1,!1),new c.NewEquipmentData(0,0,1,!1),new c.NewEquipmentData(0,0,1,!1)],l.UIManager.showEquipmentCombinePop(n,r,!0,t)},u.isOpenBox=!1,u.itemData=[],u.newEquipmentIndex=7,u.newWeaponIndex=10,n=u,o.BoxReward=n,cc._RF.pop()},{}],BoxUI:[function(e,t,a){"use strict";cc._RF.push(t,"a2ad2HCgaFLzY3bKtsx93ZC","BoxUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("BoxItem"),c=n("LocalSoundManager"),p=n("UIManager"),d=n("ShareManager"),u=n("ShareVideoControl"),h=n("TipManager"),m=n("BoxReward"),f=n("LocalData");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.getBg=null,e.showBg=null,e.showBgbottom=null,e.showBgItem=null,e.normalBox=null,e.normalBoxCover=null,e.normalBoxPart1=null,e.normalBoxPart2=null,e.normalBoxBottom=null,e.legendBox=null,e.legendBoxCover=null,e.legendBoxPart1=null,e.legendBoxPart2=null,e.legendBoxBottom=null,e.weaponBox=null,e.weaponBoxComplete=null,e.weaponBoxCover=null,e.weaponBoxBottom=null,e.rotateBg1=null,e.rotateBg2=null,e.gatherAni=null,e.bgParticle=null,e.itemCountNode=null,e.itemCountLabel=null,e.nextBtn=null,e.shareBtn=null,e.itemPrefab=null,e.doubbleConfirmBtn=null,e.doubbleBtn=null,e.normalBtn=null,e.doubbleReward=!1,e.rankEffectAni=null,e.currentItem=null,e.getItems=[],e.itemCount=3,e.closeAction=null,e.isProfeeter=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.openBox=function(e,t,a){this.closeAction=t,this.isProfeeter=a,this.normalBox.active=1==e,this.legendBox.active=2==e,this.weaponBox.active=3==e,this.normalBoxBottom.scaleY=1,this.legendBoxBottom.scaleY=1,this.weaponBoxBottom.scaleY=1,this.itemCount=m.BoxReward.itemData.length,this.getItems=[],this.getBg.active=!0,this.showBg.active=!1,this.itemCountLabel.string=this.itemCount-1+"",this.rotateBg1.angle=0,this.rotateBg1.active=!1,this.rotateBg2.angle=0,this.rotateBg2.active=!1,this.gatherAni.node.active=!1,this.bgParticle.active=!1,this.itemCountNode.active=!1,this.nextBtn.opacity=0,this.nextBtn.active=!1,this.shareBtn.active=!1,this.shareBtn.opacity=0,this.normalBox.position=cc.v2(0,800),this.normalBox.angle=0,this.normalBoxCover.position=cc.v2(0,28),this.normalBoxCover.angle=0,this.normalBoxPart1.position=cc.v2(-19,-4),this.normalBoxPart1.angle=0,this.normalBoxPart2.position=cc.v2(51,6),this.normalBoxPart2.angle=0,this.legendBox.position=cc.v2(0,800),this.legendBox.angle=0,this.legendBoxCover.position=cc.v2(0,89),this.legendBoxCover.angle=0,this.legendBoxPart1.position=cc.v2(-60,-44),this.legendBoxPart1.angle=0,this.legendBoxPart2.position=cc.v2(36,-40),this.legendBoxPart2.angle=0,this.weaponBox.position=cc.v2(0,800),this.weaponBoxCover.position=cc.v2(2,49),this.weaponBoxBottom.position=cc.v2(0,-100),this.weaponBoxBottom.active=!1,this.weaponBoxComplete.active=!0,null!=this.rankEffectAni&&(this.rankEffectAni.node.active=!1),this.BoxAni(e)},g.prototype.BoxAni=function(e){var t=this,a=null;1==e?a=this.normalBox:2==e?a=this.legendBox:3==e&&(a=this.weaponBox),a.stopAllActions(),a.runAction(cc.sequence(cc.moveTo(.3,0,0),cc.callFunc(function(){c.LocalSoundManager.playAudio("box"),t.gatherAni.node.active=!0,t.gatherAni.play()}),cc.rotateTo(.1,15),cc.rotateTo(.1,-15),cc.rotateTo(.1,15),cc.rotateTo(.1,-15),cc.rotateTo(.1,15),cc.rotateTo(.1,0),cc.callFunc(function(){t.boxDispersed(),t.newItemGet()}),cc.moveTo(.1,0,-75),cc.delayTime(.2),cc.callFunc(function(){1<t.itemCount&&(t.itemCountNode.active=!0),t.nextBtn.active=!0,t.nextBtn.stopAllActions(),t.nextBtn.runAction(cc.fadeIn(.5));var e=m.BoxReward.itemData[t.itemCount-1];null!=e&&null!=e.equipmentData&&(e=3<=e.equipmentData.rank,(t.shareBtn.active=e)&&(t.shareBtn.stopAllActions(),t.shareBtn.runAction(cc.fadeIn(.5))))})))},g.prototype.boxDispersed=function(){this.gatherAni.node.active=!1,this.normalBoxCover.stopAllActions(),this.normalBoxCover.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,0,1e3))),this.normalBoxPart1.stopAllActions(),this.normalBoxPart1.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,-800,0))),this.normalBoxPart2.stopAllActions(),this.normalBoxPart2.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,800,0))),this.legendBoxCover.stopAllActions(),this.legendBoxCover.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,0,1e3))),this.legendBoxPart1.stopAllActions(),this.legendBoxPart1.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,-800,0))),this.legendBoxPart2.stopAllActions(),this.legendBoxPart2.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,800,0))),this.weaponBoxCover.stopAllActions(),this.weaponBoxCover.runAction(cc.spawn(cc.rotateBy(.3,360),cc.moveTo(.3,0,1e3))),this.weaponBoxBottom.active=!0,this.weaponBoxComplete.active=!1,this.rotateBg1.active=!0,this.rotateBg2.active=!0,this.rotateBg1.stopAllActions(),this.rotateBg1.runAction(cc.repeatForever(cc.rotateBy(.5,10))),this.rotateBg2.stopAllActions(),this.rotateBg2.runAction(cc.repeatForever(cc.rotateBy(.5,-10)))},g.prototype.newItemGet=function(){if(null==this.rankEffectAni){var e=p.UIManager.createEquipmentRankSpecialEffect();if(null==e)return;e.node.setParent(this.node),e.node.setPosition(cc.Vec2.ZERO),this.rankEffectAni=e}this.rankEffectAni.node.active=!1;var t=m.BoxReward.itemData[this.itemCount-1];null!=t&&(null!=t.equipmentData&&6==t.equipmentData.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect3")),null!=t.equipmentData&&5==t.equipmentData.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect2")),null!=t.equipmentData&&4==t.equipmentData.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect1")),this.currentItem=r.GameCommonPool.requestInstant(this.itemPrefab),null!=this.currentItem)&&(this.currentItem.setParent(this.getBg),null!=(e=this.currentItem.getComponent(s.BoxItem))&&(c.LocalSoundManager.playAudio("equipment"),e.bindData(t,!0),this.itemCountLabel.string=this.itemCount-1+"",this.itemCount<=1&&(this.itemCountNode.active=!1)))},g.prototype.clickNextItem=function(){var e=this;if(c.LocalSoundManager.playAudio("click"),this.legendBox.stopAllActions(),this.normalBox.stopAllActions(),this.itemCount<=1){this.rankEffectAni.node.active=!1,this.getBg.active=!1,this.showBg.active=!0;for(var t=0,a=m.BoxReward.itemData;t<a.length;t++){var n,o,i=a[t];null!=i&&(null==(n=r.GameCommonPool.requestInstant(this.itemPrefab))||null!=(o=n.getComponent(s.BoxItem))&&(o.isGet=!1,n.setParent(this.showBgItem),o.bindData(i,!1),n.position=cc.v2(0,20),n.active=!1,this.getItems.push(o)))}return this.refreshShowDoubbleReward(),this.showBgbottom.position=cc.v2(-1265,0),this.showBgbottom.stopAllActions(),void this.showBgbottom.runAction(cc.sequence(cc.moveTo(.3,0,0),cc.callFunc(function(){null==e.getItems||e.getItems.length<1||(e.getItems[0].node.active=!0)}),cc.delayTime(.2),cc.callFunc(function(){null==e.getItems||e.getItems.length<2||(e.getItems[1].node.active=!0)}),cc.delayTime(.2),cc.callFunc(function(){null==e.getItems||e.getItems.length<3||(e.getItems[2].node.active=!0)})))}this.nexClickAnimation(),r.GameCommonPool.returnInstant(this.currentItem),this.itemCount--,this.newItemGet();var l=m.BoxReward.itemData[this.itemCount-1];null!=l&&null!=l.equipmentData?(l=3<=l.equipmentData.rank,(this.shareBtn.active=l)&&(this.shareBtn.stopAllActions(),this.shareBtn.runAction(cc.fadeIn(.5)))):this.shareBtn.active=!1},g.prototype.nexClickAnimation=function(){this.normalBoxBottom.scaleY=1,this.normalBoxBottom.stopAllActions(),this.normalBoxBottom.runAction(cc.sequence(cc.scaleTo(.1,1,.6),cc.scaleTo(.1,1,1))),this.legendBoxBottom.scaleY=1,this.legendBoxBottom.stopAllActions(),this.legendBoxBottom.runAction(cc.sequence(cc.scaleTo(.1,1,.6),cc.scaleTo(.1,1,1))),this.weaponBoxBottom.scaleY=1,this.weaponBoxBottom.stopAllActions(),this.weaponBoxBottom.runAction(cc.sequence(cc.scaleTo(.1,1,.6),cc.scaleTo(.1,1,1)))},g.prototype.clickClose=function(){c.LocalSoundManager.playAudio("click"),this.closeAction&&this.closeAction(),this.isProfeeter&&h.TipManager.showTip("\u60a8\u7684\u5956\u52b1\u5df2\u53d1\u653e\uff0c\u8bf7\u8fd4\u56de\u4e3b\u754c\u9762\u65f6\u67e5\u770b~"),this.close()},g.prototype.close=function(){for(var e=0,t=this.getItems;e<t.length;e++){var a=t[e];null!=a&&r.GameCommonPool.returnInstant(a.node)}r.GameCommonPool.returnInstant(this.currentItem),r.GameCommonPool.returnInstant(this.node)},g.prototype.refreshShowDoubbleReward=function(e){if(null==(e=void 0===e?null:e))for(var t=0,a=m.BoxReward.itemData;t<a.length;t++){var n=a[t];if(null!=n){if(n.type==s.ItemType.coin&&1e3<=n.count){e=!0;break}if(n.type==s.ItemType.equipment&&null!=n.equipmentData&&1<n.equipmentData.rank){e=!0;break}}}for(var o=0,i=this.getItems;o<i.length;o++){var l=i[o];null!=l&&l.selectDoubble(e)}this.doubbleReward=1==e,this.doubbleConfirmBtn.active=this.doubbleReward,this.doubbleBtn.active=this.doubbleReward,this.normalBtn.active=!this.doubbleReward},g.prototype.clcikDoubbleConfirm=function(){c.LocalSoundManager.playAudio("click"),this.refreshShowDoubbleReward(!this.doubbleReward)},g.prototype.clcikDoubble=function(){var e=this;function t(){for(var t=0,a=m.BoxReward.itemData;t<a.length;t++){var n=a[t];null!=n&&(n.type==s.ItemType.coin&&f.LocalData.changeCoin(n.count),n.type==s.ItemType.equipment&&null!=n.equipmentData&&(n.equipmentData.level=5))}e.closeAction&&e.closeAction(),e.close(),e.isProfeeter?h.TipManager.showTip("\u60a8\u7684\u5956\u52b1\u5df2\u53d1\u653e\uff0c\u8bf7\u8fd4\u56de\u4e3b\u754c\u9762\u65f6\u67e5\u770b~"):h.TipManager.showTip("\u606d\u559c\u6210\u529f\u83b7\u5f97\u5956\u52b1~")}c.LocalSoundManager.playAudio("click"),d.ShareManager.getShareControlType()!=d.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?u.ShareVideoControl.videoFunc("\u5b9d\u7bb1\u83b7\u53d6\u53cc\u500d\u9886\u53d6",t,null,t,null,null,u.VideoAdIdEnum.DOUBBLE_BOX):t()},g.prototype.clcikShare=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)try{wx.shareAppMessage({title:"\u4e00\u53d1\u5165\u9b42\uff01\u6211\u7adf\u7136\u5f00\u5230\u4e86\u8fd9\u4ef6\u795e\u5668\uff01",imageUrl:canvas.toTempFilePathSync({x:(canvas.width-.72*1.25*canvas.height)/2,y:0,width:.72*1.25*canvas.height,height:.72*canvas.height,destWidth:500,destHeight:400})})}catch(o){console.error(o)}},__decorate([o({type:cc.Node,displayName:"\u83b7\u5f97\u80cc\u666f"})],g.prototype,"getBg",void 0),__decorate([o({type:cc.Node,displayName:"\u5c55\u793a\u80cc\u666f"})],g.prototype,"showBg",void 0),__decorate([o({type:cc.Node,displayName:"\u5c55\u793a\u80cc\u666fbottom"})],g.prototype,"showBgbottom",void 0),__decorate([o({type:cc.Node,displayName:"\u5c55\u793a\u80cc\u666fitem"})],g.prototype,"showBgItem",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1"})],g.prototype,"normalBox",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1\u76d6\u5b50"})],g.prototype,"normalBoxCover",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1\u96f6\u4ef61"})],g.prototype,"normalBoxPart1",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1\u96f6\u4ef62"})],g.prototype,"normalBoxPart2",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1\u5e95"})],g.prototype,"normalBoxBottom",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1"})],g.prototype,"legendBox",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u76d6\u5b50"})],g.prototype,"legendBoxCover",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u96f6\u4ef61"})],g.prototype,"legendBoxPart1",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u96f6\u4ef62"})],g.prototype,"legendBoxPart2",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u5e95"})],g.prototype,"legendBoxBottom",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1"})],g.prototype,"weaponBox",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1\u5b8c\u6574\u56fe\u7247"})],g.prototype,"weaponBoxComplete",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1\u76d6\u5b50"})],g.prototype,"weaponBoxCover",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1\u5e95"})],g.prototype,"weaponBoxBottom",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f\u65cb\u8f6c1"})],g.prototype,"rotateBg1",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f\u65cb\u8f6c2"})],g.prototype,"rotateBg2",void 0),__decorate([o({type:cc.Animation,displayName:"\u805a\u96c6\u52a8\u753b"})],g.prototype,"gatherAni",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f\u7c92\u5b50"})],g.prototype,"bgParticle",void 0),__decorate([o({type:cc.Node,displayName:"\u7269\u54c1\u6570\u91cf"})],g.prototype,"itemCountNode",void 0),__decorate([o({type:cc.Label,displayName:"\u7269\u54c1\u6570\u91cfLabel"})],g.prototype,"itemCountLabel",void 0),__decorate([o({type:cc.Node,displayName:"\u4e0b\u4e00\u4e2a\u6309\u94ae"})],g.prototype,"nextBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u5206\u4eab\u6309\u94ae"})],g.prototype,"shareBtn",void 0),__decorate([o({type:cc.Prefab,displayName:"\u7269\u54c1\u9884\u8bbe"})],g.prototype,"itemPrefab",void 0),__decorate([o({type:cc.Node,displayName:"\u5f00\u542f\u53cc\u500d\u6309\u94ae"})],g.prototype,"doubbleConfirmBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u53cc\u500d\u6309\u94ae"})],g.prototype,"doubbleBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u6309\u94ae"})],g.prototype,"normalBtn",void 0),n=__decorate([n],g),i.BoxUI=n,cc._RF.pop()},{}],BroadcastManager:[function(e,t,a){"use strict";cc._RF.push(t,"eb87dk2wBhGbLJG1KDun/Rs","BroadcastManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("WorldEventManager"),c=n("LocalWorldEventType");function p(){var e=null!==r&&r.apply(this,arguments)||this;return e.broadcastSprite=null,e.broadcastSpriteFrames=[],e.currentBroadcastIndex=0,e}n=(o=cc._decorator).ccclass,o=o.property,r=cc.Component,__extends(p,r),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.ShowBroadcast,this.showBroadcast,this),this.broadcastSprite.node.active=!1,this.currentBroadcastIndex=0},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.ShowBroadcast,this.showBroadcast,this)},p.prototype.showBroadcast=function(e){var t,a=this;null!=e&&null!=e.type&&((t=e.type)<this.currentBroadcastIndex||t<0||t>=this.broadcastSpriteFrames.length||(this.broadcastSprite.spriteFrame=this.broadcastSpriteFrames[t],this.currentBroadcastIndex=t,this.broadcastSprite.node.active=!0,this.broadcastSprite.node.scale=1,this.broadcastSprite.node.opacity=255,this.broadcastSprite.node.stopAllActions(),e.type==l.DANGEROUS?this.broadcastSprite.node.runAction(cc.sequence(cc.repeat(cc.sequence(cc.scaleTo(.3,1.2),cc.scaleTo(.2,1),cc.callFunc(function(){a.broadcastSprite.node.scale=1,a.broadcastSprite.node.opacity=255})),3),cc.delayTime(.5),cc.fadeOut(.5),cc.callFunc(function(){a.broadcastSprite.node.active=!1,a.currentBroadcastIndex=0}))):this.broadcastSprite.node.runAction(cc.sequence(cc.scaleTo(.3,1.2),cc.scaleTo(.2,1),cc.delayTime(.5),cc.fadeOut(.5),cc.callFunc(function(){a.broadcastSprite.node.active=!1,a.currentBroadcastIndex=0})))))},__decorate([o({displayName:"\u64ad\u62a5\u56fe\u7247",type:cc.Sprite})],p.prototype,"broadcastSprite",void 0),__decorate([o({displayName:"\u64ad\u62a5\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],p.prototype,"broadcastSpriteFrames",void 0),n=__decorate([n],p),i.BroadcastManager=n,(i=l=i.BroadCastTypeEnum||(i.BroadCastTypeEnum={}))[i.HEAD_KILL=0]="HEAD_KILL",i[i.BIG_WAVE=1]="BIG_WAVE",i[i.LAST_WAVE=2]="LAST_WAVE",i[i.DANGEROUS=3]="DANGEROUS",cc._RF.pop()},{}],BubbleText:[function(e,t,a){"use strict";cc._RF.push(t,"d0720LvCH5Gdq7WmDW8xZpj","BubbleText");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameConfigData"),p=n("Util"),d=n("TimeController"),u=n("GameManager"),h=n("LocalData");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.bubbleLable=null,e.isBattleScene=null,e.uiIndex=null,e.bubbleCd=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.onEnable=function(){if(this.node.scale=0,this.bubbleCd=0,this.bubbleLable.node.active=!1,r.WorldEventManager.addListener(s.LocalWorldEventType.ShowBubble,this.showBubble,this),null!=this.isBattleScene&&null!=this.uiIndex&&!this.isBattleScene){if(1==this.uiIndex&&h.LocalData.temp_pass_chapter&&!h.LocalData.temp_hero_model)return h.LocalData.temp_pass_chapter=!1,h.LocalData.temp_hero_model=!1,void this.showBubble({type:12});this.showBubble({type:this.uiIndex})}},m.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.ShowBubble,this.showBubble,this)},m.prototype.update=function(e){this.isBattleScene&&(this.bubbleCd-=e)},m.prototype.bindData=function(e,t){if(this.isBattleScene=e,this.uiIndex=t,null!=this.isBattleScene&&null!=this.uiIndex)if(this.isBattleScene)this.bubbleLable.fontSize=30,this.bubbleLable.lineHeight=35;else{if(this.bubbleLable.fontSize=18,this.bubbleLable.lineHeight=25,1==this.uiIndex&&h.LocalData.temp_pass_chapter&&!h.LocalData.temp_hero_model)return h.LocalData.temp_pass_chapter=!1,h.LocalData.temp_hero_model=!1,void this.showBubble({type:12});this.showBubble({type:this.uiIndex})}},m.prototype.showBubble=function(e){var t=this;if(null!=e&&null!=e.type&&null!=this.isBattleScene&&null!=this.uiIndex&&(this.isBattleScene||!(0<d.TimeController.uiBubbleCd))&&!(this.isBattleScene&&0<this.bubbleCd||this.isBattleScene&&(3<=u.GameManager.partBubbleCount||30<=u.GameManager.chapterBubbleCount)||.3<=Math.random())){var a=null;switch(e.type){case 0:a=c.GameConfigData.data.equipmentUIBubbleText;break;case 1:a=c.GameConfigData.data.battleStartUIBubbleText;break;case 2:a=c.GameConfigData.data.talentUIBubbleText;break;case 3:a=c.GameConfigData.data.equipNewEquipmentText;break;case 4:a=c.GameConfigData.data.equipmentAwakenText;break;case 5:a=c.GameConfigData.data.defendEquipmentUpGradeText;break;case 6:a=c.GameConfigData.data.powerUpGradeText;break;case 7:a=c.GameConfigData.data.defendUpGradeText;break;case 8:a=c.GameConfigData.data.agilityUpGradeText;break;case 9:a=c.GameConfigData.data.healthUpGradeText;break;case 10:a=c.GameConfigData.data.recoverUpGradeText;break;case 11:a=c.GameConfigData.data.giftUpGradeText;break;case 12:a=c.GameConfigData.data.passNormalChapterText;break;case 13:a=c.GameConfigData.data.chooseChapter1Text;break;case 14:a=c.GameConfigData.data.chooseChapter2Text;break;case 15:a=c.GameConfigData.data.chooseChapter3Text;break;case 16:a=c.GameConfigData.data.chooseChapter4Text;break;case 17:a=c.GameConfigData.data.chooseChapter5Text;break;case 18:a=c.GameConfigData.data.attackMissText;break;case 19:a=c.GameConfigData.data.manyEnemyText;break;case 20:a=c.GameConfigData.data.hitBubbleText;break;case 21:a=c.GameConfigData.data.headShootText;break;case 22:a=c.GameConfigData.data.continueHeadShootText;break;case 23:a=c.GameConfigData.data.shieldDropedText;break;case 24:a=c.GameConfigData.data.helmetDropedText;break;case 25:a=c.GameConfigData.data.lowHpText;break;case 26:a=c.GameConfigData.data.deadText;break;case 27:a=c.GameConfigData.data.parryEnemyArrowText;break;case 28:a=c.GameConfigData.data.meetZombieText;break;case 29:a=c.GameConfigData.data.meetFlyHeadGhostText;break;case 30:a=c.GameConfigData.data.meetSharkerText;break;case 31:a=c.GameConfigData.data.meetNecromanceText;break;case 32:a=c.GameConfigData.data.meetShieldWizardText;break;case 33:a=c.GameConfigData.data.meetBoss1Text;break;case 34:a=c.GameConfigData.data.boss1SkillText;break;case 35:a=c.GameConfigData.data.meetBoss2Text;break;case 36:a=c.GameConfigData.data.boss2SkillText;break;case 37:a=c.GameConfigData.data.meetBoss3Text;break;case 38:a=c.GameConfigData.data.boss3SkillText;break;case 39:a=c.GameConfigData.data.meetBoss4Text;break;case 40:a=c.GameConfigData.data.boss4SkillText;break;case 41:a=c.GameConfigData.data.meetBoss5Text;break;case 42:a=c.GameConfigData.data.boss5SkillText;break;case 43:a=c.GameConfigData.data.enemyAttackEnemyText;break;case 44:a=c.GameConfigData.data.shildWithstandText;break;case 45:a=c.GameConfigData.data.helmetWithstandText;break;case 46:a=c.GameConfigData.data.meetBoss7Text;break;case 47:a=c.GameConfigData.data.boss7SkillText;break;case 48:a=c.GameConfigData.data.chooseChapter6Text;break;case 49:a=c.GameConfigData.data.chooseChapter7Text}if(!(null==a||a.length<=0||(e=p.Util.getRandomNum(0,a.length-1))<0||e>=a.length)){if(e=a[e],this.bubbleLable.string=e,this.isBattleScene){if(-1!=u.GameManager.partBubbleText.indexOf(e))return;this.bubbleCd=10,u.GameManager.partBubbleCount++,u.GameManager.chapterBubbleCount++,u.GameManager.partBubbleText.push(e)}else d.TimeController.uiBubbleCd=10;this.bubbleLable.node.active=!0,e=this.isBattleScene?.5:1,this.node.runAction(cc.sequence(cc.delayTime(.1),cc.callFunc(function(){t.node.height=t.bubbleLable.node.height+16}),cc.scaleTo(.1,-(e+1/e*.1),e+1/e*.1),cc.scaleTo(.05,-(e-1/e*.1),e-1/e*.1),cc.scaleTo(.05,-e,e),cc.delayTime(3),cc.scaleTo(.1,0),cc.callFunc(function(){t.bubbleLable.node.active=!1})))}}},__decorate([o({displayName:"\u6c14\u6ce1\u6587\u672c\u6846",type:cc.Label})],m.prototype,"bubbleLable",void 0),n=__decorate([n],m),i.BubbleText=n,cc._RF.pop()},{}],CanvasFit:[function(e,t,a){"use strict";cc._RF.push(t,"284abVwbdFKIr+EY+KocsPu","CanvasFit");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.canvas=null,e}i=cc.Component,__extends(r,i),r.prototype.onLoad=function(){var e,t=cc.view.getVisibleSize();t&&(e=t.width,.6<t.height/e&&(this.canvas.fitWidth=!0,this.canvas.fitHeight=!0))},__decorate([l(cc.Canvas)],r.prototype,"canvas",void 0),n=__decorate([n],r),o.CanvasFit=n,cc._RF.pop()},{}],CarouseRotate:[function(e,t,a){"use strict";cc._RF.push(t,"990fbFxkepFob4jO7WRFIut","CarouseRotate");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.target=null,e.leftAngle=-35,e.rightAngle=35,e.duration=.5,e.delayTime=1,e.forever=!0,e._action=null,e}i=cc.Component,__extends(r,i),r.prototype.onEnable=function(){this.target.stopAllActions(),this.show()},r.prototype.show=function(){null!=this.target&&(this.forever?this._action=this.target.runAction(cc.repeatForever(cc.sequence(cc.rotateTo(this.duration/2,this.leftAngle),cc.rotateTo(this.duration/2,this.rightAngle),cc.rotateTo(this.duration/2,this.leftAngle),cc.rotateTo(this.duration/2,this.rightAngle),cc.rotateTo(this.duration/2,0),cc.delayTime(this.delayTime)))):this._action=this.target.runAction(cc.sequence(cc.rotateTo(this.duration/2,this.leftAngle),cc.rotateTo(this.duration/2,this.rightAngle),cc.rotateTo(this.duration/2,this.leftAngle),cc.rotateTo(this.duration/2,this.rightAngle),cc.rotateTo(this.duration/2,this.leftAngle),cc.delayTime(this.delayTime))))},r.prototype.hide=function(){null!=this._action&&(this.node.angle=this.leftAngle,this.target.stopAction(this._action))},__decorate([l(cc.Node)],r.prototype,"target",void 0),__decorate([l(cc.Float)],r.prototype,"leftAngle",void 0),__decorate([l(cc.Float)],r.prototype,"rightAngle",void 0),__decorate([l(cc.Float)],r.prototype,"duration",void 0),__decorate([l(cc.Float)],r.prototype,"delayTime",void 0),__decorate([l(cc.Boolean)],r.prototype,"forever",void 0),n=__decorate([n],r),o.CarouseRotate=n,cc._RF.pop()},{}],CarouselButton:[function(e,t,a){"use strict";cc._RF.push(t,"093d0+g98ZLt57mVK+PaOjD","CarouselButton");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonUtil"),s=n("GameCommon"),c=n("CarouseRotate"),p=n("StatisticsManager"),d=n("GameCommonHttp"),u=n("ShareManager"),h=n("UserData"),m=(n=(o=cc._decorator).ccclass,o=o.property,m||{});function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.moreBtnType=m.More,e.currentSpriteConfig=null,e.rotate=null,e.switchTime=15,e._configJsonData=null,e._spriteUrlArr=[],e._spriteArr=[],e._currentIndex=0,e._dataIsLoad=!1,e._isSettingSprite=!1,e._currentTime=0,e._isLoading=!1,e}m[m.More=0]="More",l=cc.Component,__extends(f,l),Object.defineProperty(f.prototype,"currentSprite",{get:function(){return this.currentSpriteConfig},enumerable:!0,configurable:!0}),f.prototype.onLoad=function(){var e=u.ShareManager.cdnFileUrl+"/game-common/"+s.GameConfig.wxAppName+"/assets/"+s.GameConfig.versionCode+"/carouselButtonConfig.json";this.setConfigJsonData(e)},f.prototype.onEnable=function(){p.StatisticsManager.thirdSendEvent("main_carousel_show_succ"),u.ShareManager.getCarouseControl()?h.UserData.addModuleShows(h.ExportTypeEnum.CAROUSEL_BUTTON,1):this.node.active=!1},f.prototype.hide=function(){this&&this.node.active&&(this.node.active=!1,this.rotate.hide())},f.prototype.setConfigJsonData=function(e){var t=this;d.GameCommonHttp.wxHttpGet(e,function(e,a){0==e&&null!=a&&null!=a.moreConfig?(t.moreBtnType===m.More&&(t._configJsonData=a.moreConfig),t._configJsonData._jumpSwith?(t.node.active=!0,t._dataIsLoad=!0,t.setSpriteUrlArr(),t._currentIndex=-1,t.nextGame()):t.hide()):t.hide()})},f.prototype.setSpriteUrlArr=function(){var e=this;this._configJsonData.array.forEach(function(t){null==t||null!=t._jumpSwith&&!t._jumpSwith||e._spriteUrlArr.push(t._jumpImageUrl)})},f.prototype.setSprite=function(){var e;this.node.active&&!this._isSettingSprite&&(this._isSettingSprite=!0,(e=this)._dataIsLoad&&0!==this._spriteUrlArr.length?0===this._spriteArr.length||this._currentIndex>this._spriteArr.length-1||null===this._spriteArr[this._currentIndex]?(console.log("down load sprite"),r.GameCommonUtil.getTextureByUrl(e._spriteUrlArr[this._currentIndex],function(t){null!=t&&null!=e&&null!=e.currentSpriteConfig&&(e._isSettingSprite=!1,null!=(t=new cc.SpriteFrame(t))&&(e.currentSpriteConfig.spriteFrame=t,e._spriteArr.push(t),e._spriteArr.sort()),console.log("more spriteFrame :"+t))})):(null!=this._spriteArr[this._currentIndex]&&(this.currentSpriteConfig.spriteFrame=this._spriteArr[this._currentIndex]),this._isSettingSprite=!1,console.log("is have down sprite")):e.scheduleOnce(function(){e.setSprite()},5))},f.prototype.click=function(){p.StatisticsManager.thirdSendEvent("main_carousel_click");var e,t,a,n,o,i=this;null===i._configJsonData||this._configJsonData.array.length<this._currentIndex||(e=i._configJsonData.array[i._currentIndex]._jumpAppId,t=i._configJsonData.array[i._currentIndex]._jumpPath,a=i._configJsonData.array[i._currentIndex]._name,n=i._configJsonData.array[i._currentIndex]._QRCode,o=i._configJsonData.array[i._currentIndex]._switchQRCode,e&&(i._currentTime=0,p.StatisticsManager.uploadJumpRecord(e,a,"playerClick",h.ExportTypeEnum.CAROUSEL_BUTTON),window.gameCommon.getSDK.navigateToMiniProgram(e,t,function(t){return i.nextGame(),t?(p.StatisticsManager.thirdSendEvent("main_carousel_navigate_succ"),void p.StatisticsManager.uploadJumpRecord(e,a,"jumpSuccess",h.ExportTypeEnum.CAROUSEL_BUTTON)):(p.StatisticsManager.thirdSendEvent("main_carousel_navigate_fail"),void(o&&window.gameCommon.getSDK.previewImage(n)))})))},f.prototype.update=function(e){this.node.active&&1<this._spriteUrlArr.length&&(this._currentTime+=e,this._currentTime>=this.switchTime&&this.nextGame())},f.prototype.nextGame=function(){this._currentIndex++,this._currentTime=0,this._currentIndex>=this._spriteUrlArr.length&&(this._currentIndex=0);var e=this._configJsonData&&this._configJsonData.array&&this._configJsonData.array[this._currentIndex];null==e||e.boyGame&&1!=h.UserData.data.gender?this.nextGame():this.setSprite()},__decorate([o({type:cc.Enum(m)})],f.prototype,"moreBtnType",void 0),__decorate([o(cc.Sprite)],f.prototype,"currentSpriteConfig",void 0),__decorate([o(c.CarouseRotate)],f.prototype,"rotate",void 0),__decorate([o(cc.Float)],f.prototype,"switchTime",void 0),n=__decorate([n],f),i.CarouselButton=n,cc._RF.pop()},{}],ChapterProgressRewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"a8b26cCQgVND7Igrhe2l5Aa","ChapterProgressRewardUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LocalData"),s=n("GameCommonPool"),c=n("LocalSoundManager"),p=n("TipManager");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.rewardCountLabel=null,e.conditionLabel=null,e.receiveButtonNode=null,e.receiveAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.bindData=function(e,t,a,n,o){if(null!=e&&null!=t&&null!=a&&null!=n){if(this.rewardCountLabel.string="x"+n,r.LocalData.getChapterMaxPart(e,t)<a)return this.receiveButtonNode.active=!1,this.conditionLabel.node.active=!0,this.conditionLabel.string="\u901a\u8fc7"+(e?"\u82f1\u96c4\u6a21\u5f0f":"")+"\u7b2c"+t+"\u7ae0\u7b2c"+a+"\u5173\u9886\u53d6",void(this.receiveAction=null);this.receiveButtonNode.active=!0,this.conditionLabel.node.active=!1,this.receiveAction=function(){r.LocalData.changeGem(n),r.LocalData.receiveChapterProgressRewar(e,t,a),p.TipManager.showTip("\u606d\u559c\u83b7\u5f97"+n+"\u94bb\u77f3!"),o&&o()}}},d.prototype.clickReceive=function(){c.LocalSoundManager.playAudio("click"),this.close(),this.receiveAction&&this.receiveAction()},d.prototype.clickBack=function(){c.LocalSoundManager.playAudio("click"),this.close()},d.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5956\u52b1\u6570\u91cf",type:cc.Label})],d.prototype,"rewardCountLabel",void 0),__decorate([o({displayName:"\u89e3\u9501\u6761\u4ef6",type:cc.Label})],d.prototype,"conditionLabel",void 0),__decorate([o({displayName:"\u9886\u53d6\u6309\u94ae\u8282\u70b9",type:cc.Node})],d.prototype,"receiveButtonNode",void 0),n=__decorate([n],d),i.ChapterProgressRewardUI=n,cc._RF.pop()},{}],CloakController:[function(e,t,a){"use strict";cc._RF.push(t,"322ac+DR11As5oTXPFV7oZX","CloakController");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.cloakBone=null,e.cloakBoneArray=[],e}i=cc.Component,__extends(r,i),r.prototype.selectCloak=function(e){this.cloakBone.skeletonData=this.cloakBoneArray[e],this.cloakBone.animation="animation"},__decorate([l({type:sp.Skeleton,displayName:"\u62ab\u98ce\u9aa8\u9abc"})],r.prototype,"cloakBone",void 0),__decorate([l({type:sp.SkeletonData,displayName:"\u62ab\u98ce\u9aa8\u9abc\u96c6\u5408"})],r.prototype,"cloakBoneArray",void 0),n=__decorate([n],r),o.CloakController=n,cc._RF.pop()},{}],CollisionManager:[function(e,t,a){"use strict";cc._RF.push(t,"d8853INZrhNvYX8lhOjLYB+","CollisionManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.self=null,e.enableCollision=!0,e.enabledDebugDraw=!0,e.collisionMgr=null,e}i=cc.Component,__extends(s,i),l=s,Object.defineProperty(s,"getInstance",{get:function(){return this.instance},enumerable:!0,configurable:!0}),s.prototype.onLoad=function(){(this.self=l.instance=this).collisionMgr=cc.director.getCollisionManager(),this.collisionMgr.enabled=this.enableCollision,this.collisionMgr.enabledDebugDraw=this.enabledDebugDraw},s.prototype.getCollisionManager=function(){return this.self?this.self.collisionMgr:null},s.instance=null,__decorate([r({displayName:"\u5f00\u542f\u78b0\u649e"})],s.prototype,"enableCollision",void 0),__decorate([r({displayName:"\u5f00\u542f\u7ed8\u5236"})],s.prototype,"enabledDebugDraw",void 0),n=l=__decorate([n],s),o.CollisionManager=n,cc._RF.pop()},{}],CommonMask:[function(e,t,a){"use strict";cc._RF.push(t,"78b11cTWQRDPJwMCLEI+Akh","CommonMask");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.mask=null,e.time=5,e}i=cc.Component,__extends(s,i),(l=s).prototype.onLoad=function(){(l.instance=this).mask.active=!1},s.prototype.update=function(e){this.mask.active&&(this.time-=e,this.time<=0&&(this.time=5,this.mask.active=!1))},s.showMask=function(e){void 0===e&&(e=!1);var t=l.instance;null!=t&&(t.mask.opacity=0,t.mask.active=!0,e&&(t.mask.stopAllActions(),t.mask.runAction(cc.fadeIn(.3))))},s.hideMask=function(e){void 0===e&&(e=!1);var t=l.instance;if(null!=t){if(e)return t.node.active=!0,t.mask.opacity=255,t.mask.stopAllActions(),void t.mask.runAction(cc.sequence(cc.fadeOut(.3),cc.callFunc(function(){t.mask.active=!1,t.time=5})));t.mask.active=!1,t.time=5}},s.instance=null,__decorate([r({type:cc.Node,displayName:"\u906e\u6321"})],s.prototype,"mask",void 0),n=l=__decorate([n],s),o.CommonMask=n,cc._RF.pop()},{}],CommonTip:[function(e,t,a){"use strict";cc._RF.push(t,"f8b0e9nVD9JgLw6KzFFNNtr","CommonTip");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.tipText=null,e}i=cc.Component,__extends(r,i),r.prototype.show=function(e,t){void 0===t&&(t=null),null!=e&&(t=null==t?"535353":t.toHEX("#rrggbb"),this.tipText.string="<color=#"+t+"><b>"+e+"</b></c>",this.node.height=this.tipText.node.height+30)},__decorate([l({type:cc.RichText})],r.prototype,"tipText",void 0),n=__decorate([n],r),o.CommonTip=n,cc._RF.pop()},{}],CommonToast:[function(e,t,a){"use strict";cc._RF.push(t,"b24e5eM4i5OiKS6fP/kkrJR","CommonToast");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("CommonTip");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.text=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.showText=function(e,t){void 0===t&&(t=null),null!=this.text&&this.text.show(e,t)},c.prototype.clickClose=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o(s.CommonTip)],c.prototype,"text",void 0),n=__decorate([n],c),i.CommonToast=n,cc._RF.pop()},{}],ConfigData:[function(e,t,a){"use strict";cc._RF.push(t,"b7c9f4KjOtP/rQkjCB2Waus","ConfigData");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l,r=n("EnumAndConst"),s=n("LocalData"),c=n("Util"),p=n("GameConfigData"),d=n("GameState"),u=n("EndlessModelConfigData");function h(){return null!==i&&i.apply(this,arguments)||this}n=cc._decorator.ccclass,i=cc.Component,__extends(h,i),(l=h).getLevelUpExp=function(e,t){return null==e||--e<0||e>=p.GameConfigData.data.levelUpExp.length?20:p.GameConfigData.data.levelUpExp[e]*(1+.25*(t-1))},h.getSkillName=function(e){return null==e||e<0||e>this.skillName.length-1?"":this.skillName[e]},h.getSkillArrayIndex=function(e,t,a,n){if(null!=e&&null!=t)return t>p.GameConfigData.data.skillChanceConfig.length&&(t=p.GameConfigData.data.skillChanceConfig.length),t=p.GameConfigData.data.skillChanceConfig[(t=t<1?1:t)-1],2<=e&&(2==n&&(t=[.4,.3,.3]),3==n&&(t=[.5,.5])),c.Util.getRandomIndexInChanceArray(t=a?[0,.1,.4,.5]:t)},h.getSkillArray=function(e,t,a,n){var o=[],i=[];switch(e){case-1:o=p.GameConfigData.data.noobSkillArray;break;case 0:o=this.getGradeSkillArray(p.GameConfigData.data.initialSkillArray,n);break;case 1:o=this.getGradeSkillArray(p.GameConfigData.data.middleSkillArray,n);break;case 2:o=this.getGradeSkillArray(p.GameConfigData.data.heighSkillArray,n);break;case 3:o=this.getGradeSkillArray(p.GameConfigData.data.exHeightSkillArray,n)}for(var l=0;l<o.length;l++){var r=o[l];-1==t.indexOf(r)&&-1==a.indexOf(r)&&i.push(r)}return i},h.getSectByChapter=function(e){return e<=0?[r.sectType.fireSuppressionSect]:e<=1?[r.sectType.fireSuppressionSect,r.sectType.ummonSect]:e<=2?[r.sectType.fireSuppressionSect,r.sectType.ummonSect,r.sectType.recoveryAndBeatBackSect]:[r.sectType.fireSuppressionSect,r.sectType.ummonSect,r.sectType.recoveryAndBeatBackSect,r.sectType.berserkSect]},h.getGradeSkillArray=function(e,t){return c.Util.arrayIntersection(e,t)},h.getSkillPoolWithSect=function(){var e=[];if(d.GameState.endlessModel){e=[];for(var t=0;t<p.GameConfigData.data.skillMaxLevel.length;t++)t!=r.SkillTypeEnum.REVIVE_HALO&&e.push(t);return e}if((o=s.LocalData.data.passChapter)<=0)return p.GameConfigData.data.noobSkillArray;var a=l.getSectByChapter(o),n=p.GameConfigData.data.noSectSkillArray,o=[];return a=c.Util.getRandomArrayElements(a,2),n=c.Util.getRandomArrayElements(n,10),null!=a[0]&&((0==a[0]||null!=a[1]&&0==a[1])&&(o=o.concat(p.GameConfigData.data.recoveryAndBeatBackSectArray)),(1==a[0]||null!=a[1]&&1==a[1])&&(o=o.concat(p.GameConfigData.data.ummonSectArray)),(2==a[0]||null!=a[1]&&2==a[1])&&(o=o.concat(p.GameConfigData.data.berSerkSectArray)),(3==a[0]||null!=a[1]&&3==a[1])&&(o=o.concat(p.GameConfigData.data.fireSuppressionSectArray))),e=o.concat(n),c.Util.arrayRemoveRepeatElements(e)},h.getRightAirBornPos=function(){var e=c.Util.getRandomFloatNum(l.longEnemyMinPosY,l.longEnemyMaxPosY);return cc.v2(650,e)},h.isWizardProfession=function(e){return-1!=this.wizardProfessions.indexOf(e)},h.isZombieProfession=function(e){return-1!=this.zombieProfessions.indexOf(e)},h.isRobotProfession=function(e){return-1!=this.RobotProfessions.indexOf(e)},h.getEnemyConfig=function(e){if(null!=e)return this.enemyConfigs[e]},h.getEnhanceEnemyIndex=function(e){switch(e){case 0:e=4,.5<Math.random()&&(e=2);break;case 1:e=7,.5<Math.random()&&(e=8);break;case 2:case 4:e=5;break;case 7:case 8:e=9;break;case 3:e=6}return e},h.getEnemyCount=function(e,t){return(t=20*(e-1)+t-1)<0||t>=p.GameConfigData.data.enemyCount.length?p.GameConfigData.data.enemyCount[0]:p.GameConfigData.data.enemyCount[t]},h.getEnemyWeaponIndex=function(e){if(null==e)return 0;switch(e){case 1:return 0;case 2:return 1;case 3:return 3;case 4:return Math.random()<.5?0:4;case 5:return Math.random()<.5?2:3;case 6:return 2;case 7:return 8;default:return 0}},h.getEnemyEquipmentRank=function(e){return null==e?0:6!==e?1:4},h.getEnemyShieldIndex=function(e){if(null==e)return 0;var t=Math.random();switch(e){case 1:return 0;case 2:return t<.5?0:2;case 3:return t<.5?1:2;case 4:return t<.5?0:4;case 5:return t<.5?1:3;case 6:return 3;case 7:return 5;default:return 0}},h.getEnemyHelmetIndex=function(e){if(null==e)return 0;var t=Math.random();switch(e){case 1:return 0;case 2:return t<.5?0:1;case 3:return t<.5?1:4;case 4:return t<.5?1:2;case 5:return t<.5?1:3;case 6:return 3;case 7:return 5;default:return 0}},h.getEnemyExtraExp=function(e){if(null==e)return 0;switch(e){case 1:case 2:case 3:return 0;case 4:case 5:return 1;default:return 0}},h.getBossHp=function(e,t,a){return null==e||null==t||null==a?2e3:(a?p.GameConfigData.data.heroBossInitHp:p.GameConfigData.data.bossInitHp)[e-1][20<=t?1:0]},h.getEnemyHp=function(e,t,a){return null==e||null==t?100:p.GameConfigData.data.enemyInitHp[e-1][Math.ceil(t/5)-1]+(a?p.GameConfigData.data.heroAddHp[e-1]:0)},h.getEnemyInitDefense=function(e,t){return null==e||null==t?100:p.GameConfigData.data.enemyInitDefense[e-1][Math.ceil(t/5)-1]},h.getEnemyAtk=function(e,t,a){if(null==e||null==t||null==a)return 50;var n=p.GameConfigData.data.enemyInitAtk[e-1],o=0;return t.isBoss?o=(a?p.GameConfigData.data.heroBossAddAtk:p.GameConfigData.data.bossAddAtk)[e-1]:a&&(o=p.GameConfigData.data.heroAddAtk[e-1]),o=n+o,this.isWizardProfession(t.profession)?Math.round(1.5*o):o},h.getEnemyChance=function(e,t){return(t=20*(e-1)+t-1)<0||t>=p.GameConfigData.data.enemyChanceConfig.length?p.GameConfigData.data.enemyChanceConfig[0]:p.GameConfigData.data.enemyChanceConfig[t]},h.isBossPart=function(e){return e%10==0},h.getEnemyHitRate=function(e,t,a,n,o){e=.03*(Math.ceil(e/5)-1),t=t?p.GameConfigData.data.heroAddHitRate:0,n=Math.abs(a-n);var i,l=o?(n-=Math.abs(this.PLYAER_POS.x-this.longEnemyPosX[0]),n=Math.max(0,n),((i=Math.ceil(n/90))<0||i>=this.longEnemyAttackPlayerHitRate.length)&&(i=0),this.longEnemyAttackPlayerHitRate[i]+e+t):(((i=Math.ceil(n/90)-1)<0||i>=this.longEnemyAttackEnemyHitRate.length)&&(i=0),this.longEnemyAttackEnemyHitRate[i]);return Math.min(l,this.longEnemyMaxHitRate)},h.getBossHitRate=function(e,t,a,n,o){var i,l=0;return n=Math.abs(a-n),o?(n-=Math.abs(this.PLYAER_POS.x-this.longEnemyPosX[0]),n=Math.max(0,n),((i=Math.ceil(n/90))<0||i>=this.bossAttackHitRate.length)&&(i=0)):((i=Math.ceil(n/90)-1)<0||i>=this.bossAttackHitRate.length)&&(i=0),l=this.bossAttackHitRate[i],e&&(l+=u.EndlessModelConfigData.endlessBossExtraHitRate),l},h.findNearestEnemyHeadPos=function(e){for(var t=cc.v2(1136,640),a=0,n=e;a<n.length;a++){var o=n[a];null==o||o.isDead||null!=o.headPosition&&t.x>o.headPosition.x&&(t=o.headPosition)}return 1136<=t.x?null:t},h.getWeaponAtk=function(e,t,a){if(null!=e){null!=t&&null!=a||(t=s.LocalData.getEquippedEquipment(s.EquipmentType.weapon).level,a=s.LocalData.getEquippedEquipment(s.EquipmentType.weapon).rank);var n=p.GameConfigData.data.weaponStartAtk[e]+(a-1)*this.rankAddAtk;6==a&&(n+=this.rank6AddAtk);for(var o=1;o<=t-1;o++)o<5?n+=this.upgradeAddAtk[0]:o<10?n+=this.upgradeAddAtk[1]:o<15?n+=this.upgradeAddAtk[2]:o<20?n+=this.upgradeAddAtk[3]:o<25&&(n+=this.upgradeAddAtk[4]);return 25<t&&(n+=this.rank6LevelAddAtk[0]),26<t&&(n+=this.rank6LevelAddAtk[1]),27<t&&(n+=this.rank6LevelAddAtk[2]),28<t&&(n+=this.rank6LevelAddAtk[3]),29<t&&(n+=this.rank6LevelAddAtk[4]),n}},h.getDefense=function(e,t,a,n){if(null!=t&&null!=e){null!=a&&null!=n||(a=s.LocalData.getEquippedEquipment(e).level,n=s.LocalData.getEquippedEquipment(e).rank);var o=0;e==s.EquipmentType.helmet?o=p.GameConfigData.data.helmetStartDefense[t]+(n-1)*this.rankAddDefense:e==s.EquipmentType.shield&&(o=p.GameConfigData.data.shieldStartDefense[t]+(n-1)*this.rankAddDefense),6==n&&(o+=this.rank6AddDefense);for(var i=1;i<=a-1;i++)i<5?o+=this.upgradeAddDefense[0]:i<10?o+=this.upgradeAddDefense[1]:i<15?o+=this.upgradeAddDefense[2]:i<20?o+=this.upgradeAddDefense[3]:i<25&&(o+=this.upgradeAddDefense[4]);return 25<a&&(o+=this.rank6LevelAddDefense[0]),26<a&&(o+=this.rank6LevelAddDefense[1]),27<a&&(o+=this.rank6LevelAddDefense[2]),28<a&&(o+=this.rank6LevelAddDefense[3]),29<a&&(o+=this.rank6LevelAddDefense[4]),o}},h.getCloakHp=function(e,t,a){var n=p.GameConfigData.data.cloakStartHp[e],o=(a-1)*this.upgradeAddHp;return e=(t-4)*this.rankAddHp,6==t&&(e+=this.rank6AddHp),10<a&&(o+=this.rank6LevelAddHp[0]),11<a&&(o+=this.rank6LevelAddHp[1]),12<a&&(o+=this.rank6LevelAddHp[2]),13<a&&(o+=this.rank6LevelAddHp[3]),14<a&&(o+=this.rank6LevelAddHp[4]),n+o+e},h.getDropedEquipmentData=function(e,t){var a=c.Util.getRandomNum(0,2),n=l.getDropedEquipmentIndex(a);return t=l.getDropedEquipmentRank(e,t),new s.NewEquipmentData(a,n,t,!0)},h.getDropedEquipmentIndex=function(e){var t=null;switch(e){case s.EquipmentType.weapon:t=p.GameConfigData.data.arrowIndexDropChance;break;case s.EquipmentType.helmet:t=p.GameConfigData.data.helmetIdexDropChance;break;case s.EquipmentType.shield:t=p.GameConfigData.data.shieldIndexDropChance}return c.Util.getRandomIndexInChanceArray(t)},h.getDropedEquipmentRank=function(e,t){var a=p.GameConfigData.data.dropRankChance[e-1];return t&&(a=p.GameConfigData.data.heroDropRankChance[e-1]),c.Util.getRandomIndexInChanceArray(a)+1},h.getEquipmentScale=function(e,t){if(null==e)return this.equipmentInitScale;var a=e.attackModel,n=e.isBoss;return e=e.orientation*this.equipmentInitScale,t!=s.EquipmentType.weapon||(e*=n?2:1,a==r.AttackModelTypeEnum.MELEE_ATTACK&&(e=-e)),e},h.getWeaponType=function(e){switch(e){case 0:case 1:case 2:case 3:case 5:case 8:case 10:return r.LaunchWeaponTypeEnum.SHOOT;case 4:case 6:case 7:case 9:return r.LaunchWeaponTypeEnum.ROTATE}},h.getBossWeaponType=function(e){switch(e){case 0:case 1:return r.LaunchWeaponTypeEnum.ROTATE;case 2:case 3:case 4:case 5:return r.LaunchWeaponTypeEnum.SHOOT}},h.MAX_DAMAGE=99999,h.PLYAER_POS=cc.v2(-450,-155),h.MAP_NAME_ARRAY=["1.\u591c\u9690\u6c99\u6f20","2.\u5e7d\u9759\u7af9\u6797","3.\u8352\u6f20\u6218\u573a","4.\u6781\u5730\u51b0\u539f","5.\u7194\u5ca9\u6838\u5fc3","6.\u9057\u5fd8\u5de5\u5382","7.\u9f99\u5cad\u8ff7\u7a9f"],h.MAP_DESCRIBE=["\u65c5\u4eba\u4eec\u4ece\u4e0d\u613f\u8e0f\u8db3\u7684\u6c99\u6f20\uff0c\u76f8\u4f20\u5728\u6df1\u591c\u4f1a\u51fa\u73b0\u53ef\u6015\u7684\u55dc\u8840\u602a\u7269\u3002","\u770b\u8d77\u6765\u5b89\u9759\u7965\u548c\u7684\u6df1\u5c71\u7af9\u6797\uff0c\u5374\u56e0\u4e3a\u4e00\u540d\u523a\u5ba2\u7684\u85cf\u533f\u800c\u53d8\u5f97\u5371\u673a\u56db\u4f0f\u3002","\u8fd9\u7247\u8352\u829c\u4e4b\u5730\u66fe\u9891\u53d1\u6218\u4e89\uff0c\u901d\u53bb\u7684\u5c06\u58eb\u4eec\u5316\u4f5c\u6076\u7075\u4ecd\u5728\u98ce\u66b4\u4e2d\u6218\u6597\u7740\u3002","\u5728\u8fd9\u51b0\u5929\u96ea\u5730\u7684\u6781\u5730\uff0c\u5b58\u5728\u7740\u5931\u53bb\u5fc3\u667a\u7684\u72c2\u66b4\u91ce\u517d\uff0c\u652f\u914d\u7740\u8fd9\u91cc\u7684\u4e00\u5207\u3002","\u706b\u5c71\u4e2d\u6700\u4e3a\u708e\u70ed\u7684\u5730\u5e26\uff0c\u4e0d\u754f\u7099\u70e4\u7684\u4eba\u5728\u8fd9\u91cc\u5b88\u62a4\u7740\u6700\u4e3a\u91cd\u8981\u7684\u6838\u5fc3\u3002","\u73b0\u5df2\u6b8b\u7834\u7684\u673a\u5668\u4eba\u5de5\u5382\uff0c\u636e\u8bf4\u81f3\u4eca\u5de5\u5382\u91cc\u4ecd\u4f1a\u65f6\u5e38\u51fa\u6ca1\u7740\u6b8b\u7559\u7740\u7684\u673a\u5668\u4eba\u548c\u795e\u79d8\u5931\u8e2a\u7684\u64cd\u4f5c\u5458\u4eec\u3002","\u8fd9\u91cc\u5c45\u4f4f\u7740\u5927\u9646\u4e0a\u6700\u4e3a\u51f6\u6076\u7684\u5de8\u9f99\uff0c\u4f20\u8bf4\u524d\u6765\u6311\u6218\u7684\u52c7\u8005\u4ece\u6ca1\u6709\u4eba\u80fd\u4ece\u8fd9\u91cc\u6d3b\u7740\u56de\u53bb\u2026"],h.EQUIPED_SKILL_MAX_COUNT=30,h.BLAST_RANGE=160,h.THUNDER_MAX_RANGE=225,h.skillName=["\u5206\u88c2","\u7206\u70b8","\u70b9\u71c3","\u51bb\u7ed3","\u96f7\u7535","\u5f39\u5c04","\u5c04\u901f\u63d0\u5347","\u653b\u51fb\u6c72\u53d6","\u7a7f\u900f","\u8fde\u7eed\u6295\u63b7","\u79d2\u6740","\u76fe\u724c\u4fee\u590d","\u751f\u547d\u56de\u590d","\u751f\u547d\u589e\u52a0","\u5934\u76d4\u4fee\u590d","\u4f24\u5bb3\u63d0\u5347","\u51fb\u9000","\u66b4\u51fb","\u53cd\u5f39","\u7a83\u53d6","\u5de8\u5927\u5316","\u590d\u6d3b\u5149\u73af","\u95ea\u907f","\u8346\u68d8\u9501\u94fe","\u795e\u5723\u62a4\u76fe","\u6025\u6551\u88c5\u7f6e","\u53d8\u5fc3","\u5929\u96f7","\u9ca8\u9c7c\u51b2\u523a","\u56de\u65cb\u5c16\u523a","\u72c2\u6012","\u751f\u547d\u673a\u5668","\u632f\u594b\u4e4b\u58c1","\u660e\u667a\u4e4b\u7bad"],h.skillDescribe=["\u6295\u63b7\u65f6\u989d\u5916\u5206\u88c2\u51fa\u4e00\u628a\u6b66\u5668","\u654c\u4eba\u6b7b\u4ea1\u65f6\u4ea7\u751f\u7206\u70b8","\u77ed\u65f6\u95f4\u5185\u9020\u6210\u707c\u70e7\u4f24\u5bb3","\u77ed\u65f6\u95f4\u5185\u9020\u6210\u51bb\u7ed3\u6548\u679c","\u547d\u4e2d\u654c\u4eba\u65f6\u80fd\u591f\u89e6\u53d1\u95ea\u7535\u94fe","\u653b\u51fb\u80fd\u5728\u654c\u4eba\u4e4b\u95f4\u5f39\u5c04","\u63d0\u9ad8\u6b66\u5668\u98de\u884c\u901f\u5ea6","\u547d\u4e2d\u654c\u4eba\u5438\u53d6\u90e8\u5206\u751f\u547d\u503c","\u76f4\u63a5\u7a7f\u900f\u65e0\u9632\u5177\u7684\u654c\u4eba","\u8fde\u7eed\u591a\u8fdb\u884c\u4e00\u6b21\u6295\u63b7\u653b\u51fb","\u8f83\u4f4e\u6982\u7387\u79d2\u6740\u5c0f\u5175","\u4fee\u590d\u53d7\u635f\u7684\u76fe\u724c","\u56de\u590d\u4e00\u5b9a\u751f\u547d\u503c","\u63d0\u9ad8\u751f\u547d\u4e0a\u9650","\u4fee\u590d\u53d7\u635f\u7684\u5934\u76d4","\u63d0\u9ad8\u6b66\u5668\u5bf9\u654c\u4eba\u9020\u6210\u7684\u4f24\u5bb3","\u51fb\u9000\u79fb\u52a8\u4e2d\u7684\u654c\u4eba","\u63d0\u9ad8\u66b4\u51fb\u6982\u7387","\u653b\u51fb\u78b0\u5230\u5730\u56fe\u8fb9\u7f18\u53ef\u4ee5\u53cd\u5f39","\u51fb\u6740\u6709\u6982\u7387\u83b7\u5f97\u53cc\u500d\u91d1\u5e01","\u6709\u6982\u7387\u4f7f\u6b66\u5668\u53d8\u5927\u7834\u574f\u9632\u5177","\u88ab\u51fb\u8d25\u540e\u6ee1\u72b6\u6001\u539f\u5730\u590d\u6d3b1\u6b21","\u6709\u6982\u7387\u95ea\u907f\u654c\u4eba\u7684\u653b\u51fb","\u53d7\u5230\u4f24\u5bb3\u65f6\u53cd\u5f39\u90e8\u5206\u4f24\u5bb3","\u6bcf\u9694\u4e00\u4f1a\u53ec\u5524\u4e00\u4e2a\u62a4\u76fe\u5438\u6536\u4f24\u5bb3","\u88ab\u653b\u51fb\u540e\u7f13\u6162\u56de\u590d\u90e8\u5206\u751f\u547d/\u62a4\u7532\u503c","\u51fb\u8d25\u7684\u654c\u4eba\u4f1a\u8f6c\u53d8\u4e3a\u53cb\u519b\uff0c\u83b7\u5f97\u73a9\u5bb6\u5168\u989d\u653b\u51fb\u529b","\u6bcf\u9694\u4e00\u4f1a\u53ec\u5524\u4e00\u9053\u5929\u96f7\u79d2\u6740\u4e00\u540d\u5c0f\u602a","\u653b\u51fb\u6709\u6982\u7387\u53ec\u5524\u9ca8\u9c7c\u4eba\uff0c\u83b7\u5f97\u90e8\u5206\u73a9\u5bb6\u653b\u51fb\u529b","\u6bcf\u9694\u4e00\u6bb5\u65f6\u95f4\u53ec\u5524\u4e00\u652f\u7bad\u653b\u51fb\u654c\u4eba\u540e\u6536\u56de\uff0c\u6709\u6982\u7387\u76f4\u63a5\u79d2\u6740\u5c0f\u602a","\u73a9\u5bb6\u51cf\u5c11\u751f\u547d\u503c\u4f1a\u63d0\u5347\u5bf9\u5e94\u7684\u653b\u51fb\u529b","\u53d7\u5230\u653b\u51fb\u65f6\u6d88\u8017\u751f\u547d\u56de\u590d\u62a4\u7532\u503c","\u6301\u6709\u62a4\u7532\u65f6\uff0c\u964d\u4f4e\u62a4\u7532\u53d7\u5230\u7684\u90e8\u5206\u4f24\u5bb3\u4e14\u4e0d\u4f1a\u88ab\u76f4\u63a5\u51fb\u6740","\u51fb\u4e2d\u654c\u4eba\u4e22\u51fa\u7684\u6b66\u5668\u53ef\u4ee5\u4f7f\u5176\u8fd4\u56de\u653b\u51fb\u654c\u4eba"],h.skillUpDescribe=["(\u5347\u7ea7\u589e\u52a0\u5206\u88c2\u6570)","(\u5347\u7ea7\u63d0\u9ad8\u4f24\u5bb3)","(\u5347\u7ea7\u589e\u52a0\u65f6\u95f4)","(\u5347\u7ea7\u589e\u52a0\u65f6\u95f4)","(\u5347\u7ea7\u589e\u52a0\u95ea\u7535\u94fe\u6b21\u6570)","(\u5347\u7ea7\u589e\u52a0\u5f39\u5c04\u6570)","(\u5347\u7ea7\u63d0\u9ad8\u901f\u5ea6)","(\u5347\u7ea7\u589e\u52a0\u5438\u53d6\u91cf)","","","(\u5347\u7ea7\u63d0\u9ad8\u6982\u7387)","","","","","(\u5347\u7ea7\u63d0\u9ad8\u4f24\u5bb3)","(\u5347\u7ea7\u63d0\u5347\u51fb\u9000\u8ddd\u79bb)","(\u5347\u7ea7\u63d0\u9ad8\u6982\u7387)","","(\u5347\u7ea7\u63d0\u9ad8\u6982\u7387)","(\u5347\u7ea7\u63d0\u9ad8\u6982\u7387)","","(\u5347\u7ea7\u63d0\u9ad8\u6982\u7387)","(\u5347\u7ea7\u589e\u52a0\u4f24\u5bb3)","","(\u5347\u7ea7\u589e\u52a0\u56de\u590d\u91cf)","(\u5347\u7ea7\u589e\u52a0\u6570\u91cf)","","(\u5347\u7ea7\u589e\u52a0\u4f24\u5bb3)","(\u5347\u7ea7\u63d0\u9ad8\u79d2\u6740\u6982\u7387)","(\u5347\u7ea7\u589e\u52a0\u653b\u51fb\u529b)","(\u5347\u7ea7\u63d0\u9ad8\u56de\u590d\u91cf)","",""],h.randomIncidentTypeString=["\u4f60\u9047\u5230\u4e86\u5929\u4f7f","\u662f\u5426\u4e0e\u6076\u9b54\u8fdb\u884c\u4ea4\u6613","\u4f60\u9047\u5230\u4e86\u4e16\u5916\u9ad8\u4eba","\u4f60\u9047\u5230\u4e86\u91ce\u5916\u5546\u4eba","\u4f60\u9047\u5230\u4e86\u4e16\u5916\u9ad8\u4eba"],h.normalBoxDetail="\u83b7\u5f97\u4e00\u4e9b\u91d1\u5e01\u6216\u88c5\u5907",h.legendBoxDetail="\u83b7\u5f97\u5927\u91cf\u91d1\u5e01\u6216\u591a\u4ef6\u9ad8\u7ea7\u88c5\u5907",h.weaponBoxDetail="\u83b7\u5f97\u5168\u65b0\u6b66\u5668\u6216\u8005\u5168\u65b0\u62ab\u98ce\u88c5\u5907",h.MAX_ENEMY_COUNT=8,h.longEnemyPosX=[-190,-100,-10,80,170,260,350,440],h.longEnemyMaxHitRate=.6,h.longEnemyAttackPlayerHitRate=[.24,.21,.18,.15,.12,.09,.06,.03],h.longEnemyAttackEnemyHitRate=[.4,.36,.32,.28,.24,.2,.16],h.bossAttackHitRate=[.5,.49,.48,.47,.46,.45,.44,.43],h.longEnemyMaxPosY=160,h.longEnemyMinPosY=0,h.rightGroundBornPos=cc.v2(650,-155),h.wizardProfessions=[r.ProfessionEnum.FIRE_WIZARD,r.ProfessionEnum.ICE_WIZARD,r.ProfessionEnum.FLY_HEAD_GHOST,r.ProfessionEnum.SHIELD_WIZARD,r.ProfessionEnum.NECROMANCER,r.ProfessionEnum.FIRE_DRAGON,r.ProfessionEnum.ICE_DRAGON],h.zombieProfessions=[r.ProfessionEnum.LONG_ZOMBIE,r.ProfessionEnum.SHORT_ZOMBIE],h.RobotProfessions=[r.ProfessionEnum.ROBOT_MIXED,r.ProfessionEnum.ROBOT_BURROW,r.ProfessionEnum.ROBOT_AIMED],h.enemyConfigs=[{enemyProfession:r.ProfessionEnum.WARRIOR,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:4,coinCount:3,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:2,heroModelCoinCount:6},{enemyProfession:r.ProfessionEnum.LAUNCHER,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:4,coinCount:3,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:2,heroModelCoinCount:6},{enemyProfession:r.ProfessionEnum.WARRIOR,carryHelmet:!1,carryShield:!0,isMoveModel:!0,expCount:5,coinCount:5,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:3,heroModelCoinCount:7},{enemyProfession:r.ProfessionEnum.SHIELD_DEFENDER,carryHelmet:!1,carryShield:!0,isMoveModel:!1,expCount:5,coinCount:5,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:3,heroModelCoinCount:7},{enemyProfession:r.ProfessionEnum.WARRIOR,carryHelmet:!0,carryShield:!1,isMoveModel:!0,expCount:5,coinCount:5,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:3,heroModelCoinCount:7},{enemyProfession:r.ProfessionEnum.WARRIOR,carryHelmet:!0,carryShield:!0,isMoveModel:!0,expCount:6,coinCount:8,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:5,heroModelCoinCount:10},{enemyProfession:r.ProfessionEnum.SHIELD_DEFENDER,carryHelmet:!0,carryShield:!0,isMoveModel:!1,expCount:6,coinCount:8,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:5,heroModelCoinCount:10},{enemyProfession:r.ProfessionEnum.LAUNCHER,carryHelmet:!1,carryShield:!0,isMoveModel:!1,expCount:5,coinCount:5,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:3,heroModelCoinCount:7},{enemyProfession:r.ProfessionEnum.LAUNCHER,carryHelmet:!0,carryShield:!1,isMoveModel:!1,expCount:5,coinCount:5,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:3,heroModelCoinCount:7},{enemyProfession:r.ProfessionEnum.LAUNCHER,carryHelmet:!0,carryShield:!0,isMoveModel:!1,expCount:6,coinCount:8,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:5,heroModelCoinCount:10},{enemyProfession:r.ProfessionEnum.ICE_WIZARD,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:7,coinCount:11,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.FIRE_WIZARD,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:7,coinCount:11,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.LONG_ZOMBIE,carryHelmet:!0,carryShield:!1,isMoveModel:!1,expCount:6,coinCount:8,bodyHurtReduction:.8,headHurtReduction:0,locationStartIndex:0,locationEndIndex:7,endlessExpCount:5,heroModelCoinCount:10},{enemyProfession:r.ProfessionEnum.SHORT_ZOMBIE,carryHelmet:!0,carryShield:!1,isMoveModel:!0,expCount:6,coinCount:8,bodyHurtReduction:.8,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:5,heroModelCoinCount:10},{enemyProfession:r.ProfessionEnum.FLY_HEAD_GHOST,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:7,coinCount:11,bodyHurtReduction:1,headHurtReduction:.5,locationStartIndex:0,locationEndIndex:7,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.SHARKER,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:0,headHurtReduction:0,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.SHIELD_WIZARD,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:0,locationStartIndex:3,locationEndIndex:5,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.NECROMANCER,carryHelmet:!1,carryShield:!1,isMoveModel:!1,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:0,locationStartIndex:5,locationEndIndex:7,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.ROBOT_BURROW,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:.5,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.ROBOT_MIXED,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:.5,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.ROBOT_AIMED,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:.5,locationStartIndex:0,locationEndIndex:7,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.FIRE_DRAGON,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.8,headHurtReduction:.5,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.ICE_DRAGON,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.8,headHurtReduction:.5,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15},{enemyProfession:r.ProfessionEnum.RUN_DRAGON,carryHelmet:!1,carryShield:!1,isMoveModel:!0,expCount:7,coinCount:11,bodyHurtReduction:.5,headHurtReduction:.5,locationStartIndex:-1,locationEndIndex:-1,endlessExpCount:6,heroModelCoinCount:15}],h.talentContent=["\u4f53\u8d28\uff1a\u751f\u547d\u503c\u4e0a\u9650\u63d0\u5347","\u6062\u590d\uff1a\u6062\u590d\u6548\u679c\u63d0\u5347","\u529b\u91cf\uff1a\u653b\u51fb\u529b\u63d0\u5347","\u654f\u6377\uff1a\u5c04\u901f\u63d0\u5347","\u9632\u5fa1\uff1a\u8fd1\u6218\u4f24\u5bb3\u51cf\u514d\u63d0\u5347","\u5929\u624d\uff1a\u5f00\u5c40\u53ef\u9009\u62e9\u4e00\u6b21\u80fd\u529b"],h.helmetName=["\u7ef4\u4eac\u5934\u76d4","\u65af\u5df4\u8fbe\u5934\u76d4","\u9a91\u58eb\u5934\u76d4","\u9632\u7206\u5934\u76d4","\u9e92\u9e9f\u5934\u76d4","\u9006\u9cde\u5934\u76d4","\u672b\u5f71\u5934\u76d4","\u60ca\u76ee\u5934\u76d4"],h.weaponName=["\u957f\u67aa","\u9a91\u58eb\u957f\u5251","\u706b\u5c16\u67aa","\u76d8\u9f99\u67aa","\u9614\u65a7","\u82e6\u65e0","\u88c2\u53e3\u5de8\u5251","\u7687\u5bb6\u5de8\u65a7","\u8d64\u9f99\u7384\u67aa","\u9b3c\u706d\u67aa\u65a7","\u6781\u9f99\u957f\u67aa"],h.shieldName=["\u5706\u76fe","\u592a\u9633\u76fe","\u767d\u94f6\u76fe","\u9632\u7206\u76fe\u724c","\u9e92\u9e9f\u76fe","\u9006\u9cde\u91cd\u76fe","\u672b\u5f71\u91cd\u76fe","\u60ca\u76ee\u91cd\u76fe"],h.cloakName=["\u91ce\u86ee\u62ab\u98ce","\u9a91\u58eb\u62ab\u98ce","\u65e5\u5149\u62ab\u98ce","\u9632\u7206\u62ab\u98ce","\u9e92\u9e9f\u62ab\u98ce","\u8d64\u9f99\u62ab\u98ce","\u9b3c\u706d\u62ab\u98ce","\u6781\u9f99\u62ab\u98ce"],h.profiteerWeaponCount=5,h.profiteerMaxWeaponCount=8,h.profiteerCloakCount=5,h.profiteerHelmetCount=5,h.profiteerShieldCount=5,h.weaponEffect=["1\u7ea7\u653b\u51fb\u6c72\u53d6\u80fd\u529b","\u5bf9\u8fd1\u6218\u5355\u4f4d\u4f24\u5bb3+5%","\u5bf9\u8fdc\u7a0b\u5355\u4f4d\u4f24\u5bb3+5%","1\u7ea7\u70b9\u71c3\u80fd\u529b","1\u7ea7\u96f7\u7535\u80fd\u529b","\u653b\u51fb\u63d0\u5347+5%","1\u7ea7\u79d2\u6740\u80fd\u529b","1\u7ea7\u66b4\u51fb\u80fd\u529b","\u5bf9\u6cd5\u5e08\u4f24\u5bb3+5%","\u5bf9\u50f5\u5c38\u4f24\u5bb3+5%","1\u7ea7\u7a7f\u900f\u80fd\u529b","1\u7ea7\u51fb\u9000\u80fd\u529b"],h.doubleWeaponEffect=["2\u7ea7\u653b\u51fb\u6c72\u53d6\u80fd\u529b","\u5bf9\u8fd1\u6218\u5355\u4f4d\u4f24\u5bb3+10%","\u5bf9\u8fdc\u7a0b\u5355\u4f4d\u4f24\u5bb3+10%","2\u7ea7\u70b9\u71c3\u80fd\u529b","2\u7ea7\u96f7\u7535\u80fd\u529b","\u653b\u51fb\u63d0\u5347+10%","2\u7ea7\u79d2\u6740\u80fd\u529b","2\u7ea7\u66b4\u51fb\u80fd\u529b","\u5bf9\u6cd5\u5e08\u4f24\u5bb3+10%","\u5bf9\u50f5\u5c38\u4f24\u5bb3+10%","2\u7ea7\u7a7f\u900f\u80fd\u529b","2\u7ea7\u51fb\u9000\u80fd\u529b"],h.denfenseEffect=["\u51fb\u6740\u67095%\u6982\u7387\u6062\u590d\u6700\u5927\u62a4\u7532\u503c\u76845%","\u8fd1\u6218\u51cf\u4f24+5%","\u8fdc\u7a0b\u51cf\u4f24+5%","\u706b\u5c5e\u6027\u51cf\u4f24+5%","\u51b0\u51bb\u62b5\u6297\u6982\u7387+5%","1\u7ea7\u95ea\u907f\u80fd\u529b","\u62a4\u7532\u63d0\u5347+5%","\u5bf9\u6cd5\u5e08\u4f24\u5bb3\u51cf\u514d+5%","\u5bf9\u50f5\u5c38\u4f24\u5bb3\u51cf\u514d+5%","\u4f24\u5bb3\u51cf\u514d+5%"],h.doubleDenfenseEffect=["\u51fb\u6740\u670910%\u6982\u7387\u6062\u590d\u6700\u5927\u62a4\u7532\u503c\u76845%","\u8fd1\u6218\u51cf\u4f24+10%","\u8fdc\u7a0b\u51cf\u4f24+10%","\u706b\u5c5e\u6027\u51cf\u4f24+10%","\u51b0\u51bb\u62b5\u6297\u6982\u7387+10%","2\u7ea7\u95ea\u907f\u80fd\u529b","\u62a4\u7532\u63d0\u5347+10%","\u5bf9\u6cd5\u5e08\u4f24\u5bb3\u51cf\u514d+10%","\u5bf9\u50f5\u5c38\u4f24\u5bb3\u51cf\u514d+10%","\u4f24\u5bb3\u51cf\u514d+10%"],h.cloakEffect=["\u653b\u51fb\u63d0\u534710%","\u70b9\u71c3\u62b5\u6297\u6982\u7387+20%","\u751f\u547d\u503c\u63d0\u534710%","1\u7ea7\u66b4\u51fb\u80fd\u529b","\u4f24\u5bb3\u51cf\u514d5%","\u8fd1\u6218\u4f24\u5bb3\u51cf\u514d10%","1\u7ea7\u653b\u51fb\u6c72\u53d6\u80fd\u529b","\u51b0\u51bb\u62b5\u6297\u6982\u7387+20%","\u8fdc\u7a0b\u4f24\u5bb3\u51cf\u514d10%","1\u7ea7\u79d2\u6740\u80fd\u529b"],h.maxEquipmentRank=6,h.upgradeEquipmentNeedCount=3,h.upgradeAddAtk=[2,4,6,8,10],h.rankAddAtk=10,h.rank6AddAtk=15,h.rank6LevelAddAtk=[15,20,25,30,35],h.upgradeAddDefense=[5,10,15,20,25],h.rankAddDefense=50,h.rank6AddDefense=50,h.rank6LevelAddDefense=[50,75,100,125,150],h.upgradeAddHp=20,h.rankAddHp=50,h.rank6AddHp=50,h.rank6LevelAddHp=[30,40,50,60,70],h.equipmentInitScale=.2,h.weaponConfigDatas=[{holdAnchorX:.75,holdAnchorY:.5,launchAnchorX:.75,launchAnchorY:.5,colliderWidth:160,colliderHeight:20,offsetX:-180,offsetY:0,holdEffectPos:cc.v2(-270,0),launchEffectPos:cc.v2(-270,0),maxForce:1200,gravity:-640,plusColliderWidth:160,plusColliderHeight:20,plusOffsetX:-210,plusOffsetY:0},{holdAnchorX:.9,holdAnchorY:.5,launchAnchorX:.9,launchAnchorY:.5,colliderWidth:200,colliderHeight:40,offsetX:-190,offsetY:0,holdEffectPos:cc.v2(-300,0),launchEffectPos:cc.v2(-300,0),maxForce:1200,gravity:-740,plusColliderWidth:200,plusColliderHeight:40,plusOffsetX:-230,plusOffsetY:-10},{holdAnchorX:.6,holdAnchorY:.5,launchAnchorX:.6,launchAnchorY:.5,colliderWidth:140,colliderHeight:40,offsetX:-140,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:1200,gravity:-740,plusColliderWidth:140,plusColliderHeight:40,plusOffsetX:-140,plusOffsetY:0},{holdAnchorX:.5,holdAnchorY:.5,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:140,colliderHeight:40,offsetX:-140,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:1200,gravity:-740,plusColliderWidth:140,plusColliderHeight:40,plusOffsetX:-140,plusOffsetY:-5},{holdAnchorX:.5,holdAnchorY:.2,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:155,colliderHeight:60,offsetX:0,offsetY:45,holdEffectPos:cc.v2(0,110),launchEffectPos:cc.v2(0,45),maxForce:1150,gravity:-800,plusColliderWidth:180,plusColliderHeight:80,plusOffsetX:0,plusOffsetY:55},{holdAnchorX:.9,holdAnchorY:.5,launchAnchorX:.9,launchAnchorY:.5,colliderWidth:140,colliderHeight:40,offsetX:-90,offsetY:0,holdEffectPos:cc.v2(-155,0),launchEffectPos:cc.v2(-155,0),maxForce:1300,gravity:-640,plusColliderWidth:140,plusColliderHeight:40,plusOffsetX:-90,plusOffsetY:0},{holdAnchorX:.5,holdAnchorY:.2,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:100,colliderHeight:180,offsetX:0,offsetY:50,holdEffectPos:cc.v2(0,220),launchEffectPos:cc.v2(0,35),maxForce:1100,gravity:-840,plusColliderWidth:100,plusColliderHeight:180,plusOffsetX:0,plusOffsetY:50},{holdAnchorX:.5,holdAnchorY:.3,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:180,colliderHeight:70,offsetX:0,offsetY:50,holdEffectPos:cc.v2(0,100),launchEffectPos:cc.v2(0,50),maxForce:1150,gravity:-840,plusColliderWidth:180,plusColliderHeight:70,plusOffsetX:0,plusOffsetY:50},{holdAnchorX:.6,holdAnchorY:.5,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:140,colliderHeight:40,offsetX:-140,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:1200,gravity:-740,plusColliderWidth:180,plusColliderHeight:40,plusOffsetX:-140,plusOffsetY:0},{holdAnchorX:.83,holdAnchorY:.35,launchAnchorX:.83,launchAnchorY:.48,colliderWidth:80,colliderHeight:120,offsetX:-28,offsetY:70,holdEffectPos:cc.v2(-35,120),launchEffectPos:cc.v2(-5,100),maxForce:1200,gravity:-740,plusColliderWidth:100,plusColliderHeight:230,plusOffsetX:-35,plusOffsetY:110},{holdAnchorX:.6,holdAnchorY:.55,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:140,colliderHeight:40,offsetX:-140,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:1200,gravity:-740,plusColliderWidth:180,plusColliderHeight:40,plusOffsetX:-140,plusOffsetY:0}],h.bossWeaponConfigDatas=[{holdAnchorX:.4,holdAnchorY:.2,launchAnchorX:.4,launchAnchorY:.3,colliderWidth:24,colliderHeight:160,offsetX:0,offsetY:90,holdEffectPos:cc.v2(35,210),launchEffectPos:cc.v2(35,180),maxForce:800,gravity:-640,plusColliderWidth:24,plusColliderHeight:160,plusOffsetX:0,plusOffsetY:90},{holdAnchorX:.5,holdAnchorY:.5,launchAnchorX:.5,launchAnchorY:.5,colliderWidth:24,colliderHeight:220,offsetX:0,offsetY:0,holdEffectPos:cc.v2(0,0),launchEffectPos:cc.v2(0,0),maxForce:800,gravity:-640,plusColliderWidth:24,plusColliderHeight:220,plusOffsetX:0,plusOffsetY:0},{holdAnchorX:.65,holdAnchorY:.6,launchAnchorX:.65,launchAnchorY:.6,colliderWidth:160,colliderHeight:80,offsetX:-200,offsetY:-10,holdEffectPos:cc.v2(-300,0),launchEffectPos:cc.v2(-300,0),maxForce:800,gravity:-640,plusColliderWidth:160,plusColliderHeight:80,plusOffsetX:-200,plusOffsetY:-10},{holdAnchorX:.85,holdAnchorY:.5,launchAnchorX:.85,launchAnchorY:.5,colliderWidth:150,colliderHeight:40,offsetX:-220,offsetY:0,holdEffectPos:cc.v2(-300,0),launchEffectPos:cc.v2(-300,0),maxForce:800,gravity:-640,plusColliderWidth:150,plusColliderHeight:40,plusOffsetX:-220,plusOffsetY:0},{holdAnchorX:.55,holdAnchorY:.5,launchAnchorX:.55,launchAnchorY:.5,colliderWidth:140,colliderHeight:60,offsetX:-120,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:800,gravity:-640,plusColliderWidth:140,plusColliderHeight:60,plusOffsetX:-120,plusOffsetY:0},{holdAnchorX:.6,holdAnchorY:.5,launchAnchorX:.6,launchAnchorY:.5,colliderWidth:140,colliderHeight:80,offsetX:-150,offsetY:0,holdEffectPos:cc.v2(-200,0),launchEffectPos:cc.v2(-200,0),maxForce:800,gravity:-640,plusColliderWidth:140,plusColliderHeight:80,plusOffsetX:-150,plusOffsetY:0}],n=l=__decorate([n],h),o.ConfigData=n,o.EnemyConfig=function(){this.enemyProfession=r.ProfessionEnum.LAUNCHER,this.carryHelmet=!1,this.carryShield=!1,this.isMoveModel=!0,this.expCount=0,this.coinCount=0,this.bodyHurtReduction=0,this.headHurtReduction=0,this.locationStartIndex=0,this.locationEndIndex=7,this.endlessExpCount=0,this.heroModelCoinCount=0},o.WeaponConfig=function(){this.holdAnchorX=null,this.holdAnchorY=null,this.launchAnchorX=null,this.launchAnchorY=null,this.colliderWidth=null,this.colliderHeight=null,this.offsetX=null,this.offsetY=null,this.holdEffectPos=null,this.launchEffectPos=null,this.maxForce=1200,this.gravity=-640,this.plusColliderWidth=null,this.plusColliderHeight=null,this.plusOffsetX=null,this.plusOffsetY=null},cc._RF.pop()},{}],Connecting:[function(e,t,a){"use strict";cc._RF.push(t,"ee459BMS05KaYqvAZV6lA6j","Connecting");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("UserData"),c=n("WorldEventManager"),p=n("WorldEventType"),d=n("MoreGameManager"),u=n("Loading"),h=n("GameCommonPool"),m=n("Timer"),f=n("UIManager");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.clearTip=null,e.userDataInit=!1,e.waitTime=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),(r=g).prototype.onLoad=function(){r.instacne=this,cc.game.addPersistRootNode(this.node)},g.prototype.onEnable=function(){u.Loading.loadGameResSucc&&(this.clearTip.active=!1)},g.prototype.update=function(e){this.waitUserData(e)},g.prototype.waitUserData=function(e){if(!this.userDataInit){if(this.waitTime+=e,5<=this.waitTime)return d.MoreGameManager.initHorizontalConfig(),c.WorldEventManager.triggerEvent(p.WorldEventType.GetUserDataFinish,null),this.node.active=!1,void(this.userDataInit=!0);s.UserData.init&&(d.MoreGameManager.initHorizontalConfig(),c.WorldEventManager.triggerEvent(p.WorldEventType.GetUserDataFinish,null),this.node.active=!1,this.userDataInit=!0)}},g.prototype.clickRestart=function(){cc.sys.platform==cc.sys.WECHAT_GAME&&(wxDownloader.cleanOldAssets(),u.Loading.showWxModal("\u63d0\u793a","\u7f13\u5b58\u6e05\u7406\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\uff01",function(){wx.exitMiniProgram()},null))},g.showConnect=function(){var e=this.instacne;null!=e&&(e.node.active=!0)},g.disConnect=function(){var e=this.instacne;null!=e&&(e.node.active=!1)},g.enterGameScene=function(e,t,a){var n=this;this.showConnect(),m.TimerManager.clearTimers(),f.UIManager.closeBoardNode(),u.Loading.loadGame(e,t,function o(){h.GameCommonPool.requestInstantByUrl("Game/Chapter/"+(e?"EndlessChapter":"Chapter"+t),function(e,i){return null!=e||null==t?(u.Loading.showWxModal("\u52a0\u8f7d\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u65b0\u52a0\u8f7d~",function(){o()},null),void console.error(e)):void(null!=(e=f.UIManager.getGameNode())&&(i.setParent(e),i.setPosition(cc.Vec2.ZERO),a&&a(),n.disConnect()))})})},g.enterMainScene=function(e){m.TimerManager.clearTimers(),e&&e()},g.instacne=null,__decorate([o({type:cc.Node,displayName:"\u6e05\u9664\u63d0\u793a"})],g.prototype,"clearTip",void 0),n=r=__decorate([n],g),i.Connecting=n,cc._RF.pop()},{}],ContinueBattleUI:[function(e,t,a){"use strict";cc._RF.push(t,"54905+ZNMlBBJeBkD0CSTK2","ContinueBattleUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("LocalData"),c=n("GameManager"),p=n("LocalSoundManager"),d=n("CommonMask"),u=n("GameState"),h=n("Connecting");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.descriptionRichText=null,e.endlessModel=!1,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.bindData=function(e,t){this.closeAction=t,this.endlessModel=e,this.endlessModel?this.descriptionRichText.string="<color=#ffffff>\u662f\u5426\u7ee7\u7eed\u6311\u6218\u65e0\u5c3d\u6a21\u5f0f\uff1f<br/>\u53d6\u6d88\u540e\u5c06\u91cd\u65b0\u5f00\u59cb</color>":this.descriptionRichText.string="<color=#ffffff>\u662f\u5426\u7ee7\u7eed\u4e0a\u6b21\u672a\u5b8c\u7684\u6218\u6597\uff1f</color>"},m.prototype.clickConfirm=function(){p.LocalSoundManager.playAudio("click"),this.close(),u.GameState.endlessModel=this.endlessModel,d.CommonMask.showMask();var e=JSON.parse(u.GameState.endlessModel?s.LocalData.data.lastEndlessDataJson:s.LocalData.data.lastBattleDataJson).lastChapter||1;h.Connecting.enterGameScene(u.GameState.endlessModel,e,function(){d.CommonMask.hideMask(),c.GameManager.beginGame(!0)})},m.prototype.clickCancel=function(){p.LocalSoundManager.playAudio("click"),this.close(),this.endlessModel?s.LocalData.data.lastEndlessDataJson=null:s.LocalData.data.lastBattleDataJson=null},m.prototype.close=function(){this.closeAction&&this.closeAction(),this.closeAction=null,r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u63cf\u8ff0",type:cc.RichText})],m.prototype,"descriptionRichText",void 0),n=__decorate([n],m),i.ContinueBattleUI=n,cc._RF.pop()},{}],ConvertManager:[function(e,t,a){"use strict";cc._RF.push(t,"ac8afriuKRNy46/GqZdSPxV","ConvertManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l=cc._decorator;function r(){}n=l.ccclass,l.property,(i=r).convertToWorldAngle=function(e,t,a){for(var n=e.parent,o=t*(0<e.scaleX?1:-1);n&&null!=n;)o+=n.angle,o*=0<n.scaleX?1:-1,n=n.parent,console.log("\u4e34\u65f6\u89d2\u5ea6",o);return o*(0<a?1:-1)},r.convertToLocalAngle=function(e,t){var a=[],n=e;a.push(n);for(var o=t;n&&null!=n;)n=n.parent,a.push(n);for(var i=a.length-1;0<=i;i--){var l=a[i];null!=l&&(o-=l.angle,o*=0<l.scaleX?1:-1)}return o},r.convertToWorldScale=function(e){for(var t=e.scaleX,a=e.scaleY,n=e.parent;n&&null!=n;)t/=n.scaleX,a/=n.scaleY,n=n.parent;return cc.v2(t,a)},r.convertToLocalScale=function(e,t){for(var a=t.x,n=t.y,o=e;o&&null!=o;)a/=o.scaleX,n/=o.scaleY,o=o.parent;return cc.v2(a,n)},r.setNodeParent=function(e,t){var a,n,o;null!=e&&null!=t&&(null!=(o=t.parent)&&o!=e?(n=i.convertToWorldScale(e),a=i.convertToLocalScale(t,n),o=e.angle,o=i.convertToWorldAngle(e,o,n.x),n=i.convertToLocalAngle(t,o),o=e.parent.convertToWorldSpaceAR(e.position),o=t.convertToNodeSpaceAR(o),e.setParent(t),e.setPosition(cc.v2(o.x,o.y)),e.scaleX=a.x,e.scaleY=a.y,e.angle=n):console.error("\u8bbe\u7f6e\u7236\u8282\u70b9\u64cd\u4f5c\u51fa\u9519\uff1a",e,t))},n=i=__decorate([n],r),o.ConvertManager=n,cc._RF.pop()},{}],CurrencyUI:[function(e,t,a){"use strict";cc._RF.push(t,"b97f6cJR9ZKFo98hOmC0NE2","CurrencyUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("UserData"),s=n("LocalData"),c=n("TimeController"),p=n("GameConfigData");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.coinLabel=null,e.energyLabel=null,e.gemLabel=null,e.timeLabel=null,e.lastCoinCount=null,e.lastGemCount=null,e.lastEnergyCount=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.update=function(){if(this.lastCoinCount==r.UserData.data.coin&&this.lastGemCount==s.LocalData.data.gemCount&&this.lastEnergyCount==s.LocalData.data.energyNum||this.refresh(),s.LocalData.data.energyNum>=p.GameConfigData.data.maxEnergy)return this.timeLabel.node.active=!1,void(s.LocalData.data.lastGetEnergyTime=null);this.timeLabel.node.active=!0,this.numberToTime(p.GameConfigData.data.getEnergyTime-c.TimeController.timePass)},d.prototype.refresh=function(){this.lastCoinCount=r.UserData.data.coin,this.lastGemCount=s.LocalData.data.gemCount,this.lastEnergyCount=s.LocalData.data.energyNum,this.coinLabel.string=this.lastCoinCount+"",this.gemLabel.string=this.lastGemCount+"",this.energyLabel.string=this.lastEnergyCount+"/"+p.GameConfigData.data.maxEnergy},d.prototype.numberToTime=function(e){var t;e>p.GameConfigData.data.getEnergyTime||(t=Math.floor(e/60),e=(e=Math.floor(e%60)).toString().length<2?"0"+e:e,this.timeLabel.string=t+":"+e)},__decorate([o({type:cc.Label,displayName:"\u91d1\u5e01"})],d.prototype,"coinLabel",void 0),__decorate([o({type:cc.Label,displayName:"\u4f53\u529b"})],d.prototype,"energyLabel",void 0),__decorate([o({type:cc.Label,displayName:"\u5b9d\u77f3"})],d.prototype,"gemLabel",void 0),__decorate([o({type:cc.Label,displayName:"\u5012\u8ba1\u65f6"})],d.prototype,"timeLabel",void 0),n=__decorate([n],d),i.CurrencyUI=n,cc._RF.pop()},{}],DailyLoginButton:[function(e,t,a){"use strict";cc._RF.push(t,"85972mwL6BOpayldzE9ZSnl","DailyLoginButton");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("UserData");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.dailyLoginIcon=null,e.dailyLoginTip=null,e.lastLoginRewardReceiveCount=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onEnable=function(){this.lastLoginRewardReceiveCount=null},s.prototype.update=function(){this.refreshDailyLoginTip()},s.prototype.refreshDailyLoginTip=function(){if(this.lastLoginRewardReceiveCount!=r.UserData.data.loginRewardRecievedCount){if(7<=r.UserData.data.loginRewardRecievedCount&&(this.node.active=!1),this.lastLoginRewardReceiveCount=r.UserData.data.loginRewardRecievedCount,this.lastLoginRewardReceiveCount<r.UserData.data.loginRewardCanRecieveCount)return this.dailyLoginIcon.stopAllActions(),this.dailyLoginIcon.angle=0,this.dailyLoginIcon.runAction(cc.repeatForever(cc.sequence(cc.rotateBy(.1,15),cc.rotateBy(.1,-30),cc.rotateBy(.1,30),cc.rotateBy(.1,-15),cc.delayTime(1)))),void(this.dailyLoginTip.active=!0);this.dailyLoginIcon.stopAllActions(),this.dailyLoginIcon.angle=0,this.dailyLoginTip.active=!1}},__decorate([o({displayName:"\u7b7e\u5230\u56fe\u6807",type:cc.Node})],s.prototype,"dailyLoginIcon",void 0),__decorate([o({displayName:"\u7b7e\u5230\u63d0\u793a\u70b9",type:cc.Node})],s.prototype,"dailyLoginTip",void 0),n=__decorate([n],s),i.DailyLoginButton=n,cc._RF.pop()},{}],DailyLoginRoleShow:[function(e,t,a){"use strict";cc._RF.push(t,"b2eeejbxEhEYoEk5xfRuH+z","DailyLoginRoleShow");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.effect1=null,e.effect2=null,e.roleAni=null,e.weapon=null,e.helmet=null,e.shield=null,e.cloakNode=null,e.centerBone=null,e.weaponBone=null,e.helmetBone=null,e.shieldBone=null,e.cloakBone=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onLoad=function(){this.centerBone=this.roleAni.findBone(r.BoneNameEnum.CENTER),this.weaponBone=this.roleAni.findBone(r.BoneNameEnum.WEAPON),this.helmetBone=this.roleAni.findBone(r.BoneNameEnum.HEAD),this.shieldBone=this.roleAni.findBone(r.BoneNameEnum.SHIELD),this.cloakBone=this.roleAni.findBone(r.BoneNameEnum.CLOAK),this.cloakNode.scaleX=.2},s.prototype.onEnable=function(){this.effactAction()},s.prototype.update=function(){this.refreshLocaltion()},s.prototype.refreshLocaltion=function(){var e=cc.v2(this.helmetBone.worldX,this.helmetBone.worldY);this.helmet.node.position=e,this.helmet.node.angle=this.centerBone.rotation,e=cc.v2(this.shieldBone.worldX,this.shieldBone.worldY),this.shield.node.position=e,this.shield.node.angle=this.centerBone.rotation,e=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY),this.weapon.node.position=e,this.weapon.node.angle=this.roleAni.node.angle-30,e=cc.v2(this.cloakBone.worldX,this.cloakBone.worldY),this.cloakNode.position=e,this.cloakNode.angle=this.roleAni.node.angle},s.prototype.effactAction=function(){var e=this;this.effect1.active=!0,this.effect2.active=!0,this.effect1.scale=.1,this.effect1.opacity=180,this.effect1.stopAllActions(),this.effect1.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(1.5,.4),cc.fadeOut(1.5)),cc.callFunc(function(){e.effect1.scale=.1,e.effect1.opacity=120})))),this.effect2.scale=.2,this.effect2.opacity=120,this.effect2.stopAllActions(),this.effect2.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(1.5,.6),cc.fadeOut(1.5)),cc.callFunc(function(){e.effect2.scale=.2,e.effect2.opacity=100}))))},__decorate([o({type:cc.Node,displayName:"\u89d2\u8272\u80cc\u666f\u7279\u65481"})],s.prototype,"effect1",void 0),__decorate([o({type:cc.Node,displayName:"\u89d2\u8272\u80cc\u666f\u7279\u65482"})],s.prototype,"effect2",void 0),__decorate([o({displayName:"\u9aa8\u9abc\u52a8\u753b",type:sp.Skeleton})],s.prototype,"roleAni",void 0),__decorate([o({displayName:"\u6b66\u5668",type:cc.Sprite})],s.prototype,"weapon",void 0),__decorate([o({displayName:"\u5934\u76d4",type:cc.Sprite})],s.prototype,"helmet",void 0),__decorate([o({displayName:"\u76fe\u724c",type:cc.Sprite})],s.prototype,"shield",void 0),__decorate([o({displayName:"\u62ab\u98ce",type:cc.Node})],s.prototype,"cloakNode",void 0),n=__decorate([n],s),i.DailyLoginRoleShow=n,cc._RF.pop()},{}],DamageUpEffect:[function(e,t,a){"use strict";cc._RF.push(t,"8ef6dX8MwZGGbJluStbB07Q","DamageUpEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.damageUpAni=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){this.damageUpAni.play("DamageUp"),this.damageUpAni.on("finished",this.close,this),r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this)},p.prototype.onDisable=function(){this.damageUpAni.off("finished",this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},p.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u4f24\u5bb3\u63d0\u5347\u52a8\u753b",type:cc.Animation})],p.prototype,"damageUpAni",void 0),n=__decorate([n],p),i.DamageUpEffect=n,cc._RF.pop()},{}],DayliLoginItem:[function(e,t,a){"use strict";cc._RF.push(t,"a078dA9s2lB5psGyL77v/wT","DayliLoginItem");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.todayReward=null,e.recievedReward=null,e.rewardSprite=null,e.rewardName=null,e.itemButton=null,e.itemData=null,e}i=cc.Component,__extends(r,i),r.prototype.onEnable=function(){this.itemButton.interactable=!1},r.prototype.bindData=function(e,t,a){null!=e&&(this.itemData=e,this.rewardSprite.spriteFrame=e.itemSpriteFrame,this.rewardName.string=e.itemName,this.rewardSprite.node.scale=e.itemScale,this.refresh(t,a))},r.prototype.refresh=function(e,t){null!=this.itemData&&(e?(this.recievedReward.active=!0,this.todayReward.active=!1,this.itemButton.interactable=!1):t?(this.recievedReward.active=!1,this.todayReward.active=!0,this.itemButton.interactable=!0):(this.recievedReward.active=!1,this.todayReward.active=!1,this.itemButton.interactable=!1))},__decorate([l(cc.Node)],r.prototype,"todayReward",void 0),__decorate([l(cc.Node)],r.prototype,"recievedReward",void 0),__decorate([l(cc.Sprite)],r.prototype,"rewardSprite",void 0),__decorate([l(cc.Label)],r.prototype,"rewardName",void 0),__decorate([l(cc.Button)],r.prototype,"itemButton",void 0),n=__decorate([n],r),o.DayliLoginItem=n,cc._RF.pop()},{}],DayliLoginManager:[function(e,t,a){"use strict";cc._RF.push(t,"2fefcmwX3FDaoaAN8OqRRL5","DayliLoginManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("DayliLogin"),p=n("UserData");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.dayliLoginprefab=null,e.loopReward=!0,e.dayliLogin=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),(r=d).prototype.onLoad=function(){r.instance=this},d.prototype.onEnable=function(){this.dayliLogin=null},d.isLoopReward=function(){var e=this.instance;return null!=e&&e.loopReward},d.showDayliLogin=function(e,t,a){var n=this.instance;if(null!=n&&null!=n.dayliLoginprefab){var o=p.UserData.data.loginRewardRecievedCount,i=p.UserData.data.loginRewardCanRecieveCount;if(n.loopReward&&7<i&&7<=o&&(p.UserData.data.loginRewardRecievedCount%=7,p.UserData.data.loginRewardCanRecieveCount%=7,o=p.UserData.data.loginRewardRecievedCount,i=p.UserData.data.loginRewardCanRecieveCount),null!=n.dayliLogin)return n.dayliLogin.node.active=!0,n.dayliLogin.bindData(o,i,e,t),void n.dayliLogin.bindCloseCall(a);var l=s.GameCommonPool.requestInstant(n.dayliLoginprefab);null!=l?(l.setParent(n.node),null!=(l=l.getComponent(c.DayliLogin))?(l.bindData(o,i,e,t),l.bindCloseCall(a),n.dayliLogin=l):a&&a()):a&&a()}else a&&a()},d.isShow=function(){var e=this.instance;return null!=e&&null!=e.dayliLogin&&e.dayliLogin.node.active},d.instance=null,__decorate([o({type:cc.Prefab,displayName:"\u6bcf\u65e5\u767b\u5f55\u754c\u9762"})],d.prototype,"dayliLoginprefab",void 0),__decorate([o({displayName:"\u5f00\u542f\u5faa\u73af\u767b\u9646\u5956\u52b1"})],d.prototype,"loopReward",void 0),n=r=__decorate([n],d),i.DayliLoginManager=n,cc._RF.pop()},{}],DayliLogin:[function(e,t,a){"use strict";cc._RF.push(t,"c7cb4/8zm9A+7PT21D3p9bw","DayliLogin");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("ShareManager"),s=n("DayliLoginItem"),c=n("UserData");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.boradNode=null,e.closeNode=null,e.doubbleRecieveBtnNode=null,e.items=new Array,e.itemDatas=null,e.recievedCount=0,e.canRecievedCount=0,e.clickRecieveAction=null,e.closeCallBack=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.bindCloseCall=function(e){this.closeCallBack=e},p.prototype.onEnable=function(){var e=this;this.boradNode.stopAllActions(),this.closeNode.stopAllActions(),this.doubbleRecieveBtnNode.stopAllActions(),this.closeNode.opacity=0,this.doubbleRecieveBtnNode.opacity=0,this.boradNode.opacity=0,this.boradNode.scale=0,this.boradNode.runAction(cc.sequence(cc.spawn(cc.scaleTo(.4,1),cc.fadeIn(.4)),cc.callFunc(function(){e.doubbleRecieveBtnNode.runAction(cc.fadeIn(.3))}),cc.delayTime(.3),cc.callFunc(function(){e.closeNode.runAction(cc.fadeIn(.3))}))),r.ShareManager.getShareControlType()==r.ShareControlType.ShareAndAdClose&&(this.doubbleRecieveBtnNode.active=!1)},p.prototype.bindData=function(e,t,a,n){this.recievedCount=e,this.canRecievedCount=t,this.itemDatas=a,this.clickRecieveAction=n,this.refresh()},p.prototype.refresh=function(){if(this.canRecievedCount<=this.recievedCount&&(this.doubbleRecieveBtnNode.active=!1),null!=this.itemDatas)for(var e=0;e<7;e++){var t=this.items[e];null!=t&&t.bindData(this.itemDatas[e],this.recievedCount>e,this.canRecievedCount>e)}},p.prototype.clickClose=function(){this.node.active=!1,this.closeCallBack&&this.closeCallBack(),this.closeCallBack=null},p.prototype.clickRecieve=function(){var e=this;this.canRecievedCount<=this.recievedCount||null==this.clickRecieveAction||this.clickRecieveAction(this.itemDatas[this.recievedCount],!1,function(){e.recievedCount++,e.refresh(),c.UserData.data.loginRewardRecievedCount++})},p.prototype.clcikNoThanks=function(){this.node.active=!1,this.closeCallBack&&this.closeCallBack(),this.closeCallBack=null},p.prototype.clickDoubbleRecieve=function(){var e=this;this.canRecievedCount<=this.recievedCount||null==this.clickRecieveAction||this.clickRecieveAction(this.itemDatas[this.recievedCount],!0,function(){e.recievedCount++,e.refresh(),c.UserData.data.loginRewardRecievedCount++})},__decorate([o(cc.Node)],p.prototype,"boradNode",void 0),__decorate([o(cc.Node)],p.prototype,"closeNode",void 0),__decorate([o(cc.Node)],p.prototype,"doubbleRecieveBtnNode",void 0),__decorate([o([s.DayliLoginItem])],p.prototype,"items",void 0),n=__decorate([n],p),i.DayliLogin=n,n=function(e,t,a,n,o){void 0===o&&(o=1),this.itemName=null,this.itemCount=0,this.itemSpriteFrame=null,this.itemScale=1,this.itemType=e,this.itemName=t,this.itemSpriteFrame=a,this.itemCount=n,this.itemScale=o},i.DayliLoginItemData=n,cc._RF.pop()},{}],DeadEffect:[function(e,t,a){"use strict";cc._RF.push(t,"b1d1cq/xQRNM5kHijr97ycX","DeadEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.deadEffectSprite=null,e.deadEffectFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this)},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},p.prototype.showDeadEffect=function(e){var t=this;this.deadEffectSprite.node.stopAllActions(),this.deadEffectSprite.node.opacity=255,this.deadEffectSprite.spriteFrame=this.deadEffectFrames[e],0==e?(this.deadEffectSprite.node.position=cc.v2(0,0),this.deadEffectSprite.node.runAction(cc.sequence(cc.moveTo(.5,cc.v2(0,55)),cc.fadeOut(1),cc.callFunc(function(){t.close()})))):1==e?(this.deadEffectSprite.node.position=cc.v2(5,0),this.deadEffectSprite.node.runAction(cc.sequence(cc.moveTo(.5,cc.v2(5,55)),cc.fadeOut(1),cc.callFunc(function(){t.close()})))):2==e&&(this.deadEffectSprite.node.position=cc.v2(0,0),this.deadEffectSprite.node.runAction(cc.sequence(cc.moveTo(.5,cc.v2(0,55)),cc.fadeOut(1),cc.callFunc(function(){t.close()}))))},p.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6b7b\u4ea1\u7279\u6548\u56fe\u7247",type:cc.Sprite})],p.prototype,"deadEffectSprite",void 0),__decorate([o({displayName:"\u6b7b\u4ea1\u7279\u6548\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],p.prototype,"deadEffectFrames",void 0),n=__decorate([n],p),i.DeadEffect=n,cc._RF.pop()},{}],DelayFadeOut:[function(e,t,a){"use strict";cc._RF.push(t,"f0648k3yX9D6bjRtGI/zEHE","DelayFadeOut");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.delay=1,e.liveTime=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onEnable=function(){this.node.stopAllActions(),this.node.opacity=255,this.liveTime=0,this.node.runAction(cc.sequence(cc.delayTime(this.delay-.5),cc.fadeOut(.5)))},s.prototype.update=function(e){this.liveTime+=e,this.liveTime>this.delay&&r.GameCommonPool.returnInstant(this.node)},__decorate([o],s.prototype,"delay",void 0),n=__decorate([n],s),i.DelayFadeOut=n,cc._RF.pop()},{}],DialItem:[function(e,t,a){"use strict";cc._RF.push(t,"6c5e7EnLiJCz5BLYhsYCDm4","DialItem");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.dialItemIcon=null,e.dialItemCount=null,e.dialItemName=null,e._data=null,e}i=cc.Component,__extends(r,i),r.prototype.bindData=function(e){null!=e&&(this._data=e,this.dialItemIcon.spriteFrame=e.itemSpriteFrame,this.dialItemIcon.node.scale=e.itemScale,this.dialItemCount&&(this.dialItemCount.string=e.itemCount+""),this.dialItemName&&(this.dialItemName.string=e.itemName))},Object.defineProperty(r.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),__decorate([l(cc.Sprite)],r.prototype,"dialItemIcon",void 0),__decorate([l(cc.Label)],r.prototype,"dialItemCount",void 0),__decorate([l(cc.Label)],r.prototype,"dialItemName",void 0),n=__decorate([n],r),o.DialItem=n,cc._RF.pop()},{}],DialManager:[function(e,t,a){"use strict";cc._RF.push(t,"f93abOHQ3dNzalQL7mOpxml","DialManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("Dial");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.dialPrefab=null,e.dialNode=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),(r=p).prototype.onLoad=function(){r.instance=this},p.showDial=function(e,t,a){void 0===a&&(a=null);var n,o=this.instance;null!=o&&(n=s.GameCommonPool.requestInstant(o.dialPrefab),null!=(o.dialNode=n)&&(n.setParent(o.node),null!=(n=n.getComponent(c.Dial))&&n.bindData(e,t,a)))},p.isDialShow=function(){var e=this.instance;return null!=e&&null!=e.dialNode&&e.dialNode.active},p.instance=null,__decorate([o({type:cc.Prefab,displayName:"\u8f6e\u76d8\u9884\u8bbe"})],p.prototype,"dialPrefab",void 0),n=r=__decorate([n],p),i.DialManager=n,n=function(e,t,a,n,o){void 0===o&&(o=1),this.itemSpriteFrame=null,this.itemCount=0,this.itemScale=1,this.itemType=e,this.itemName=t,this.itemSpriteFrame=a,this.itemCount=n,this.itemScale=o},i.DialItemData=n,cc._RF.pop()},{}],Dial:[function(e,t,a){"use strict";cc._RF.push(t,"96c75+Y55FEErkeskmMkMPY","Dial");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("DialItem"),c=n("UserData"),p=n("ShareManager"),d=n("TipManager"),u=n("AdManager");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.dialNode=null,e.freeBtn=null,e.freeLeftCount=null,e.shareBtn=null,e.shareLeftCount=null,e.videoBtn=null,e.videoLeftCount=null,e.dialItems=new Array,e.dialTittle=null,e.dialBoard=null,e.dialClose=null,e.rewardAction=null,e.animationRun=!1,e.currentIndex=0,e.leftTimes=0,e.randomAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onLoad=function(){},h.prototype.onEnable=function(){var e=this;this.resetLeftTimes(),this.dialTittle.stopAllActions(),this.dialBoard.stopAllActions(),this.dialClose.stopAllActions(),this.freeBtn.stopAllActions(),this.shareBtn.stopAllActions(),this.videoBtn.stopAllActions(),this.dialTittle.opacity=0,this.dialClose.opacity=0,this.freeBtn.opacity=0,this.shareBtn.opacity=0,this.videoBtn.opacity=0,this.dialBoard.opacity=0,this.dialBoard.scale=0,this.dialBoard.runAction(cc.sequence(cc.spawn(cc.scaleTo(.4,1),cc.fadeIn(.4)),cc.callFunc(function(){e.dialTittle.runAction(cc.fadeIn(.3))}),cc.delayTime(.3),cc.callFunc(function(){e.dialClose.runAction(cc.fadeIn(.3)),e.freeBtn.runAction(cc.fadeIn(.3)),e.shareBtn.runAction(cc.fadeIn(.3)),e.videoBtn.runAction(cc.fadeIn(.3))})))},h.prototype.resetLeftTimes=function(){if(this.freeLeftCount.string=c.UserData.data.freeDialCard+" / "+c.UserData.maxFreeDialCard,this.shareLeftCount.string=c.UserData.data.shareDialCard+" / "+c.UserData.maxShareDialCard,this.videoLeftCount.string=c.UserData.data.videoDialCard+" / "+c.UserData.maxVideoDialCard,p.ShareManager.getShareControlType()==p.ShareControlType.ShareAndAdClose)return this.freeBtn.active=!0,this.shareBtn.active=!1,void(this.videoBtn.active=!1);this.freeBtn.active=0<c.UserData.data.freeDialCard,0<c.UserData.data.freeDialCard?(this.shareBtn.active=!1,this.videoBtn.active=!1):(this.shareBtn.active=p.ShareManager.getShareControlType()!=p.ShareControlType.ShareCloseAndAdOpen,this.videoBtn.active=!0)},h.prototype.bindData=function(e,t,a){if(void 0===a&&(a=null),this.rewardAction=t,this.randomAction=a,null!=e)for(var n=0;n<this.dialItems.length;n++)this.dialItems[n].bindData(e[n])},h.prototype.clickClose=function(){this.animationRun||r.GameCommonPool.returnInstant(this.node)},h.prototype.clcikFree=function(){this.animationRun||(c.UserData.data.freeDialCard<=0?d.TipManager.showTip("\u62bd\u5956\u6b21\u6570\u4e0d\u8db3\uff0c\u8bf7\u660e\u5929\u518d\u6765~"):(c.UserData.data.freeDialCard--,this.gainReward(),this.shareBtn.runAction(cc.fadeIn(.3)),this.videoBtn.runAction(cc.fadeIn(.3))))},h.prototype.clcikShare=function(){var e=this;this.animationRun||(c.UserData.data.shareDialCard<=0?d.TipManager.showTip("\u62bd\u5956\u6b21\u6570\u4e0d\u8db3\uff0c\u8bf7\u660e\u5929\u518d\u6765~"):window.gameCommon.getSDK.share("\u8f6c\u76d8\u62bd\u5956",null,null,function(t,a){a&&(c.UserData.data.shareDialCard--,e.gainReward())},!0))},h.prototype.clcikVideo=function(){var e=this;this.animationRun||(c.UserData.data.videoDialCard<=0?d.TipManager.showTip("\u62bd\u5956\u6b21\u6570\u4e0d\u8db3\uff0c\u8bf7\u660e\u5929\u518d\u6765~"):u.AdManager.showVideoAd(function(){c.UserData.data.videoDialCard--,e.gainReward()},function(){d.TipManager.showTip("\u770b\u5b8c\u5e7f\u544a\uff0c\u624d\u53ef\u4ee5\u62bd\u5956\u54e6~")},null))},h.prototype.gainReward=function(){var e,t,a,n=this;this.animationRun||(this.resetLeftTimes(),this.animationRun=!0,e=this.dialItems.length,a=0,null!=this.randomAction?(a=(t=null==(t=this.randomAction())||t<0||e<=t?Math.floor(Math.random()*e):t)>=this.currentIndex?t-this.currentIndex:t+e-this.currentIndex,this.currentIndex=t):(a=Math.floor(Math.random()*e),this.currentIndex=(a+this.currentIndex)%e),this.dialNode.runAction(cc.sequence(cc.rotateBy(1.5,1440),cc.rotateBy(2,360-360*a/e).easing(cc.easeBackOut()),cc.callFunc(function(){var e;n.animationRun=!1,null!=n.rewardAction&&null!=(e=n.dialItems[n.currentIndex])&&null!=e.data&&n.rewardAction(e.data.itemType,e.data.itemCount)}))))},__decorate([o(cc.Node)],h.prototype,"dialNode",void 0),__decorate([o(cc.Node)],h.prototype,"freeBtn",void 0),__decorate([o(cc.Label)],h.prototype,"freeLeftCount",void 0),__decorate([o(cc.Node)],h.prototype,"shareBtn",void 0),__decorate([o(cc.Label)],h.prototype,"shareLeftCount",void 0),__decorate([o(cc.Node)],h.prototype,"videoBtn",void 0),__decorate([o(cc.Label)],h.prototype,"videoLeftCount",void 0),__decorate([o([s.DialItem])],h.prototype,"dialItems",void 0),__decorate([o(cc.Node)],h.prototype,"dialTittle",void 0),__decorate([o(cc.Node)],h.prototype,"dialBoard",void 0),__decorate([o(cc.Node)],h.prototype,"dialClose",void 0),n=__decorate([n],h),i.Dial=n,cc._RF.pop()},{}],DivineShieldEffect:[function(e,t,a){"use strict";cc._RF.push(t,"2914351SypFcKJONUJCC8gL","DivineShieldEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool"),p=n("PlayerState");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.lightNode=null,e.shieldNode=null,e.playerData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this);var e=p.PlayerState.playerData;null!=e&&(this.playerData=e,this.lightNode.scale=.9,this.lightNode.stopAllActions(),this.shieldNode.stopAllActions(),this.lightNode.runAction(cc.repeatForever(cc.spawn(cc.rotateBy(1.6,60),cc.sequence(cc.scaleTo(.8,1.2),cc.scaleTo(.8,.9))))),this.shieldNode.runAction(cc.repeatForever(cc.rotateBy(1,-360))))},d.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.update=function(){(null==this.playerData||this.playerData.isDead||this.playerData.invincibleTime<=0)&&this.close()},d.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5149",type:cc.Node})],d.prototype,"lightNode",void 0),__decorate([o({displayName:"\u62a4\u76fe",type:cc.Node})],d.prototype,"shieldNode",void 0),n=__decorate([n],d),i.DivineShieldEffect=n,cc._RF.pop()},{}],DropManager:[function(e,t,a){"use strict";cc._RF.push(t,"c9fc8V2I/9L+bo9H59dBxfp","DropManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("LocalData"),l=n("GameState"),r=n("ConfigData"),s=n("GameConfigData"),c=n("Util"),p=n("EffectCreate"),d=n("PlayerState"),u=n("SkillSystem"),h=n("EnumAndConst"),m=n("GameCommonPool"),f=n("UIManager"),g=n("LocalSoundManager"),y=n("DropedEquipment"),v=n("GameManager");function D(){}D.init=function(e){this.rewardBallMap=new Map,this.rewardCoinCountArray=[],this.hpUpBallArray=[],this.dropedEquipmentArray=[],null==e?(this.rewardBallMap=new Map,this.rewardCoinCountArray=[],this.hpUpBallArray=[],this.dropedEquipmentArray=[],this.equipmentDropPart=null,this.equipmentDropEnemy=null,this.dropedEquipmentData=null,this.bossDropedEquipmentData=null,this.dropedEquipmentDataArray=[]):(this.equipmentDropPart=e.equipmentDropPart,this.equipmentDropEnemy=e.equipmentDropEnemy,this.dropedEquipmentData=e.dropedEquipmentData,this.bossDropedEquipmentData=e.bossDropedEquipmentData,this.dropedEquipmentDataArray=e.dropedEquipmentDatas||[])},D.getEquipmentDropData=function(){if(null==this.equipmentDropPart||null==this.equipmentDropEnemy){if(l.GameState.endlessModel)return this.bossDropedEquipmentData=null,this.equipmentDropPart=null,this.equipmentDropEnemy=null,void(this.dropedEquipmentData=null);var e;l.GameState.currentPart%10==1&&(this.bossDropedEquipmentData=r.ConfigData.getDropedEquipmentData(l.GameState.currentChapter,l.GameState.heroModel),Math.random()<s.GameConfigData.data.equipmentDropChance&&(this.equipmentDropPart=c.Util.getRandomNum(l.GameState.currentPart,l.GameState.currentPart+8),e=r.ConfigData.getEnemyCount(l.GameState.currentChapter,this.equipmentDropPart),this.equipmentDropEnemy=c.Util.getRandomNum(1,e),this.dropedEquipmentData=r.ConfigData.getDropedEquipmentData(l.GameState.currentChapter,l.GameState.heroModel)))}},D.equipmentDrop=function(e,t,a){var n;if(a){if(l.GameState.heroModel&&p.EffectCreate.creatDropGem(e,d.PlayerState.playerData.logicPos,!1),null!=this.bossDropedEquipmentData&&!(null==(n=p.EffectCreate.createDropedEquipment(e,this.bossDropedEquipmentData))||n.length<=0)){for(var o=0,i=n;o<i.length;o++)null!=(r=i[o])&&this.dropedEquipmentArray.push(r);this.bossDropedEquipmentData=null}}else if(null!=this.dropedEquipmentData&&l.GameState.currentPart==this.equipmentDropPart&&t==this.equipmentDropEnemy&&!(null==(n=p.EffectCreate.createDropedEquipment(e,this.dropedEquipmentData))||n.length<=0)){for(var r,s=0,c=n;s<c.length;s++)null!=(r=c[s])&&this.dropedEquipmentArray.push(r);this.equipmentDropPart=null,this.equipmentDropEnemy=null,this.dropedEquipmentData=null}},D.rewardBallDrop=function(e,t){var a;e.isRevived||e.isSummon||null!=(a=p.EffectCreate.createRewardBall(e))&&(this.rewardBallMap.set(a,e.rewardExpCount),this.rewardCoinCountArray.push(e.rewardCoinCount),a=u.SkillSystem.getEquipedSkillData(h.SkillTypeEnum.STEAL),Math.random()<a&&!t&&e.killerData==d.PlayerState.playerData&&(t=p.EffectCreate.createRewardBall(e),this.rewardBallMap.set(t,e.rewardExpCount),this.rewardCoinCountArray.push(e.rewardCoinCount)))},D.hpUpBallDrop=function(e,t){function a(e){-1!=(e=o.hpUpBallArray.indexOf(e))&&o.hpUpBallArray.splice(e,1)}var n,o=this,i=null;if(1<t?i=p.EffectCreate.createHpUpBall(e,t,a):(n=l.GameState.endlessModel?.03:l.GameState.heroModel?.1:.05,Math.random()<n&&(i=p.EffectCreate.createHpUpBall(e,t,a))),!(null==i||i.length<=0))for(var r=0,s=i;r<s.length;r++){var c=s[r];null!=c&&this.hpUpBallArray.push(c)}},D.pickUpHpUpBall=function(){if(!(null==this.hpUpBallArray||this.hpUpBallArray.length<=0)){for(var e=0,t=this.hpUpBallArray;e<t.length;e++)!function(e){var t;null!=e&&(t=Math.abs(e.x-d.PlayerState.playerData.logicPos.x)/1e3,e.stopAllActions(),e.runAction(cc.sequence(cc.moveTo(t,d.PlayerState.playerData.logicPos),cc.callFunc(function(){m.GameCommonPool.returnInstant(e),d.PlayerState.playerData.isDead||d.PlayerState.player.restoreRoleStatus(!0,.05)}))))}(t[e]);this.hpUpBallArray=[]}},D.pickUpRewardBall=function(){function e(e,a){null==t.dropedEquipmentArray||t.dropedEquipmentArray.length<=0?t.pickUpFinish(a,e):t.pickUpEquipment(e,a)}for(var t=this,a=0,n=0,o=this.rewardCoinCountArray;n<o.length;n++){var i=o[n];a+=i}this.rewardCoinCountArray=[];var l,r,s=this.rewardBallMap.size;s<=0?e(a,a):(r=l=0,this.rewardBallMap.forEach(function(t,n){r+=t;var o=d.PlayerState.playerData.logicPos;t=Math.abs(n.x-d.PlayerState.playerData.logicPos.x)/1e3,n.stopAllActions(),n.runAction(cc.sequence(cc.moveTo(t,o),cc.callFunc(function(){g.LocalSoundManager.playCoinAudio(),l++,m.GameCommonPool.returnInstant(n),s<=l&&e(r,a)})))}),this.rewardBallMap.clear())},D.pickUpEquipment=function(e,t){var a=this,n=this.dropedEquipmentArray.length;if(n<=0)this.pickUpFinish(e,t);else{for(var o=this,i=0;i<n;i++)!function(i){var l,r=o.dropedEquipmentArray[i];null!=r&&(l=i,i=Math.abs(r.x-d.PlayerState.playerData.logicPos.x)/500,r.stopAllActions(),r.runAction(cc.sequence(cc.moveTo(i,d.PlayerState.playerData.logicPos.x,r.y),cc.callFunc(function(){var o=r.getComponent(y.DropedEquipment);null!=o&&(o=o.equipmentData,a.dropedEquipmentDataArray.push(o),m.GameCommonPool.returnInstant(r),n-1<=l&&a.pickUpFinish(e,t))}))))}(i);this.dropedEquipmentArray=[]}},D.pickUpFinish=function(e,t){function a(){d.PlayerState.playerData.rewardCoin+=t;var a=d.PlayerState.playerData.exp;d.PlayerState.playerData.addExp(e),v.GameManager.refreshExp(a)}10!=l.GameState.currentPart||l.GameState.endlessModel?a():f.UIManager.showDialUI(a,function(e,t){e?i.LocalData.changeCoin(t):i.LocalData.changeGem(t),p.EffectCreate.creatDropGem(null,d.PlayerState.playerData.logicPos,e)},function(e,t){null==t?(u.SkillSystem.equipSkill(e),u.SkillSystem.chooseSkill(e)):u.SkillSystem.useImmediateSkill(e,t)})},D.rewardBallMap=null,D.rewardCoinCountArray=[],D.hpUpBallArray=null,D.dropedEquipmentArray=null,D.equipmentDropPart=null,D.equipmentDropEnemy=null,D.dropedEquipmentData=null,D.bossDropedEquipmentData=null,D.dropedEquipmentDataArray=null,n=D,o.DropManager=n,cc._RF.pop()},{}],DropedEquipment:[function(e,t,a){"use strict";cc._RF.push(t,"0640eDz0W1AQp0dTxEmpPoj","DropedEquipment");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LocalData"),s=n("SpriteFrameManager");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.equipmentSprite=null,e.lightEffect=null,e.lightCross=null,e.equipmentData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.bindData=function(e){if(null!=e){this.lightEffect.stopAllActions(),this.lightEffect.scale=0,this.equipmentSprite.node.stopAllActions(),this.equipmentSprite.node.position=cc.Vec2.ZERO,this.equipmentData=e,this.equipmentSprite.node.angle=0,this.equipmentData.type==r.EquipmentType.weapon?(this.equipmentSprite.node.angle=-45,this.equipmentSprite.spriteFrame=s.SpriteFrameManager.getLaunchWeaponSpriteFrame(this.equipmentData.index,this.equipmentData.rank)):this.equipmentData.type==r.EquipmentType.helmet?this.equipmentSprite.spriteFrame=s.SpriteFrameManager.getHelmetSpriteFrame(this.equipmentData.index,this.equipmentData.rank):this.equipmentData.type==r.EquipmentType.shield&&(this.equipmentSprite.spriteFrame=s.SpriteFrameManager.getShieldSpriteFrame(this.equipmentData.index,this.equipmentData.rank));var t=null;switch(this.equipmentData.rank){case 1:t=cc.Color.WHITE;break;case 2:t=new cc.Color(193,247,193,255);break;case 3:t=new cc.Color(139,221,255,255);break;case 4:t=new cc.Color(163,144,246,255);break;case 5:t=new cc.Color(255,238,86,255)}this.lightCross.node.color=t,this.lightCross.node.active=!1,this.lightCross.node.scaleX=0,this.lightCross.node.stopAllActions(),this.lightEffect.color=t,this.lightEffect.runAction(cc.spawn(cc.rotateBy(1,180),cc.sequence(cc.scaleTo(.3,.6),cc.scaleTo(.7,0))))}},c.prototype.showLightCross=function(){this.lightCross.node.active=!0,this.lightCross.play("LightCross"),this.lightCross.node.runAction(cc.scaleTo(.2,1)),this.equipmentSprite.node.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.5,0,-20),cc.moveTo(.5,0,0))))},__decorate([o({displayName:"\u88c5\u5907\u56fe\u7247",type:cc.Sprite})],c.prototype,"equipmentSprite",void 0),__decorate([o({displayName:"\u95ea\u5149\u7279\u6548",type:cc.Node})],c.prototype,"lightEffect",void 0),__decorate([o({displayName:"\u5149\u67f1",type:cc.Animation})],c.prototype,"lightCross",void 0),n=__decorate([n],c),i.DropedEquipment=n,cc._RF.pop()},{}],EffectCreate:[function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"b953eSGzfFI26Li6bqFneq6","EffectCreate");var o=e,i=t,l=a;Object.defineProperty(l,"__esModule",{value:!0});var r,s,c=o("GameCommonPool"),p=o("BattleNodeManager"),d=o("EnumAndConst"),u=o("FrozenImmuneEffect"),h=o("ShareManager"),m=o("DeadEffect"),f=o("Util"),g=o("GameConfigData"),y=o("DropedEquipment"),v=o("LocalSoundManager"),D=o("CommonMask"),E=o("Timer"),S=o("ReviveEffect"),A=o("PlayerTip"),C=o("NpcRole"),M=o("PlayerState"),T=o("Portal"),_=o("ConfigData"),k=o("PrefabUrl");function P(){var e=null!==r&&r.apply(this,arguments)||this;return e.bloodPrefab=null,e.sparkPrefab=null,e.appearPrefab=null,e.deadEffectPrefab=null,e.rewardBallPrefab=null,e.dropedEquipmentPrefab=null,e.dropedGemPrefab=null,e.dropedCoinPrefab=null,e.hpUpBallPrefab=null,e.npcRolePrefab=null,e}o=(i=cc._decorator).ccclass,i=i.property,r=cc.Component,__extends(P,r),s=P,Object.defineProperty(P,"Instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),P.prototype.onEnable=function(){s._instance=this},P.createBlood=function(e,t){var a=s.Instance;if(null!=a){var n=c.GameCommonPool.requestInstant(a.bloodPrefab);if(null!=n&&null!=(a=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.PARTICLE_NODE)))return n.setParent(a),n.setPosition(e),n.scaleX=0<t?1:-1,n}},P.createSpark=function(e,t,a){var n,o=s.Instance;null!=o&&(null==(n=c.GameCommonPool.requestInstant(o.sparkPrefab))||null!=(o=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(e=a?o.convertToNodeSpaceAR(e):e,n.setParent(o),n.setPosition(e),n.scaleX=-(0<t?1:-1)))},P.createAppearEffect=function(e){var t,a=s.Instance;null!=a&&(null==(t=c.GameCommonPool.requestInstant(a.appearPrefab))||null!=(a=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(t.setParent(a),t.setPosition(e)))},P.createFrozenImmuneEffect=function(e){null!=s.Instance&&c.GameCommonPool.requestInstantByUrl(k.PrefabUrl.effectUrl+k.EffectPrefabNameEnum.frozenImmuneEffect,function(t,a){var n;null==a||null!=(n=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(a.setParent(n),a.setPosition(e.logicPos),a.getComponent(u.FrozenImmuneEffect).bindData(e))})},P.createDeadEffect=function(e,t){var a,n;!h.ShareManager.getViolenceControl()||null!=(a=s.Instance)&&(null==(n=c.GameCommonPool.requestInstant(a.deadEffectPrefab))||null!=(a=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(n.setParent(a),n.setPosition(t),null!=(n=n.getComponent(m.DeadEffect))&&n.showDeadEffect(e)))},P.createRewardBall=function(e){var t=s.Instance;if(null!=t){var a=c.GameCommonPool.requestInstant(t.rewardBallPrefab);if(null!=a){var n=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);if(null!=n)return a.setParent(n),a.setPosition(e.logicPos),t=.5<Math.random()?-1:1,440<=a.x&&(t=-1),t=(e=(n=a.x+f.Util.getRandomFloatNum(80,100)*t)+50*t)+10*t,a.stopAllActions(),a.runAction(cc.sequence(cc.jumpTo(.5,n,-172,100,1).easing(cc.easeIn(1)),cc.jumpTo(.3,e,-172,20,1),cc.jumpTo(.1,t,-172,10,1))),a}}},P.createDropedEquipment=function(e,t){var a=s.Instance;if(null==a)return[];var n=1;Math.random()<g.GameConfigData.data.equipmentDropDoubleChance&&(n=2);for(var o=[],i=0;i<n&&"break"!==function(i){if(null==t)return"break";var l=c.GameCommonPool.requestInstant(a.dropedEquipmentPrefab);if(null==l)return"break";var r=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);if(null==r)return"break";l.setParent(r),l.setPosition(e.logicPos);var s=l.getComponent(y.DropedEquipment);if(null==s)return"break";s.bindData(t),r=.5<Math.random()?-1:1,440<=l.x&&(r=-1),1<n&&(r=i<=0?1:-1),r=l.x+f.Util.getRandomFloatNum(80,100)*r,v.LocalSoundManager.playAudio("equipment"),l.stopAllActions(),l.runAction(cc.sequence(cc.jumpTo(1,r,-134,100,1).easing(cc.easeIn(1)),cc.callFunc(function(){null!=s&&s.showLightCross()}))),o.push(l)}(i);i++);return o},P.creatDropGem=function(e,t,a){var o=s.Instance;if(null!=o){var i=cc.v2();null!=e&&(i=e.logicPos),D.CommonMask.showMask(),E.TimerManager.addTimer(2.5,function(){D.CommonMask.hideMask()});for(var l,r,u,h=0;h<8;h++){var m=function(){var e=null;if(null==(e=a?c.GameCommonPool.requestInstant(o.dropedCoinPrefab):c.GameCommonPool.requestInstant(o.dropedGemPrefab)))return{value:void 0};var n=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);if(null==n)return{value:void 0};e.setParent(n),e.setPosition(i),n=i.add(cc.v2(f.Util.getRandomFloatNum(-50,100),f.Util.getRandomFloatNum(-50,100))),e.position=n,l=t.sub(n).normalize(),u=f.Util.getRandomFloatNum(-30,30),r=n.add(f.Util.rotateAngle(l,u).mul(150)),u=n.add(f.Util.rotateAngle(l,2*u).mul(200)),n=f.Util.getRandomFloatNum(1.8,2.5),e.stopAllActions(),e.runAction(cc.sequence(cc.bezierTo(n,[r,u,t]).easing(cc.easeBackIn()),cc.callFunc(function(){c.GameCommonPool.returnInstant(e)})))}();if("object"==n(m))return m.value}}},P.createHpUpBall=function(e,t,a){for(var o=[],i=0;i<t;i++){var l=function(n){var i=s.Instance;if(null==i)return{value:void 0};var l=c.GameCommonPool.requestInstant(i.hpUpBallPrefab);if(null==l)return{value:void 0};var r=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);if(null==r)return{value:void 0};l.setParent(r),l.setPosition(e.logicPos),o.push(l);var u=M.PlayerState.playerData;if(null==u)return{value:void 0};var h=.5<Math.random()?-1:1;440<=l.x&&(h=-1),i=0,1<t&&(i=l.x<440?0==n?-160:1==n?-40:2==n?40:160:0==n?-160:1==n?-120:2==n?80:40),i=(n=(r=1<t?l.x+i:l.x+f.Util.getRandomFloatNum(80,100)*h)+50*h)+10*h,h=Math.abs(i-u.logicPos.x)/1e3,l.stopAllActions(),l.runAction(cc.sequence(cc.jumpTo(1,r,-172,100,1).easing(cc.easeIn(1)),cc.jumpTo(.5,n,-172,20,1),cc.jumpTo(.2,i,-172,10,1),cc.delayTime(1),cc.moveTo(h,u.logicPos),cc.callFunc(function(){a&&a(l),c.GameCommonPool.returnInstant(l),u.isDead||M.PlayerState.player.restoreRoleStatus(!0,.05)})))}(i);if("object"==n(l))return l.value}return o},P.createReviveEffect=function(e){null!=s.Instance&&c.GameCommonPool.requestInstantByUrl(k.PrefabUrl.effectUrl+k.EffectPrefabNameEnum.reviveEffect,function(t,a){var n,o;null!=a&&(null==(n=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))||null!=(o=a.getComponent(S.ReviveEffect))&&(o.bindData(e),a.setParent(n),a.setPosition(e.logicPos)))})},P.createRoleTip=function(e,t){null!=s.Instance&&c.GameCommonPool.requestInstantByUrl(k.PrefabUrl.effectUrl+k.EffectPrefabNameEnum.roleTip,function(a,n){var o;null==n||null!=(o=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(n.setParent(o),n.setPosition(e),null!=(n=n.getComponent(A.PlayerTip))&&n.bindData(t))})},P.createNpcRole=function(e){var t=s.Instance;if(null!=t){var a=c.GameCommonPool.requestInstant(t.npcRolePrefab);if(null!=a&&null!=(t=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(a.setParent(t),a.setPosition(cc.v2(-190,-105)),null!=(t=a.getComponent(C.NpcRole))))return t.bindData(e),a}},P.createLightning=function(e,t){null!=s.Instance&&c.GameCommonPool.requestInstantByUrl(k.PrefabUrl.effectUrl+k.EffectPrefabNameEnum.lightningEffect,function(a,n){var o;null==n||null!=(o=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(n.setParent(o),n.setPosition(e.logicPos),t&&t())})},P.createPortal=function(e){c.GameCommonPool.requestInstantByUrl("Game/portal",function(t,a){var n=p.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);null!=n&&(a.setParent(n),a.setPosition(cc.v2(0,_.ConfigData.PLYAER_POS.y)),null!=(a=a.getComponent(T.Portal))?a.appear(e):e())})},P._instance=null,__decorate([i({displayName:"\u8840\u6db2\u9884\u8bbe",type:cc.Prefab})],P.prototype,"bloodPrefab",void 0),__decorate([i({displayName:"\u706b\u661f\u9884\u8bbe",type:cc.Prefab})],P.prototype,"sparkPrefab",void 0),__decorate([i({displayName:"\u70df\u96fe\u7279\u6548",type:cc.Prefab})],P.prototype,"appearPrefab",void 0),__decorate([i({displayName:"\u6b7b\u4ea1\u7279\u6548",type:cc.Prefab})],P.prototype,"deadEffectPrefab",void 0),__decorate([i({displayName:"\u5956\u52b1\u7403\u9884\u8bbe",type:cc.Prefab})],P.prototype,"rewardBallPrefab",void 0),__decorate([i({displayName:"\u6389\u843d\u88c5\u5907\u9884\u8bbe",type:cc.Prefab})],P.prototype,"dropedEquipmentPrefab",void 0),__decorate([i({displayName:"\u94bb\u77f3\u9884\u8bbe",type:cc.Prefab})],P.prototype,"dropedGemPrefab",void 0),__decorate([i({displayName:"\u91d1\u5e01\u9884\u8bbe",type:cc.Prefab})],P.prototype,"dropedCoinPrefab",void 0),__decorate([i({displayName:"\u56de\u8840\u7403\u9884\u8bbe",type:cc.Prefab})],P.prototype,"hpUpBallPrefab",void 0),__decorate([i({displayName:"npc\u9884\u8bbe",type:cc.Prefab})],P.prototype,"npcRolePrefab",void 0),o=s=__decorate([o],P),l.EffectCreate=o,cc._RF.pop()},{}],EggMachineUI:[function(e,t,a){"use strict";cc._RF.push(t,"84716MaCwNCxJ7jpZzB4Fpb","EggMachineUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("NumberImg"),c=n("BoxReward"),p=n("LocalData"),d=n("GameConfigData"),u=n("LocalSoundManager"),h=n("ShareManager"),m=n("ShareVideoControl"),f=n("Util"),g=n("WorldEventManager"),y=n("LocalWorldEventType"),v=n("Timer"),D=n("UIManager");function E(){var e=null!==l&&l.apply(this,arguments)||this;return e.eggSpine=null,e.gemCost=null,e.eggMachineTips=null,e.freeBtn=null,e.bottomLabel=null,e.leftCard=null,e.rightCard=null,e.btnNode=null,e.isOpen=!1,e.skinArray=["B","G","R","Y"],e.leftCardStartPos=null,e.rightCardStartPos=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(E,l),E.prototype.onLoad=function(){this.leftCardStartPos=this.leftCard.position,this.rightCardStartPos=this.rightCard.position,this.gemCost.value=d.GameConfigData.data.eggGemCost+""},E.prototype.bind=function(e){this.closeAction=e},E.prototype.onEnable=function(){this.refresh(),this.startAni()},E.prototype.refresh=function(){this.isOpen=!1,this.eggSpine.paused=!0,this.eggSpine.animation="AT";var e=d.GameConfigData.data.eggBottomTime-p.LocalData.data.eggMachineTimes,t=p.LocalData.data.eggMachineGetCloak?"\u88c5\u5907":"\u6781\u9f99\u62ab\u98ce";this.bottomLabel.string="<b><color=#003DFD>"+e+" </c></b><color=#000000>\u6b21\u5185\u5fc5\u5f97<color=#AC00FD><b> \u53f2\u8bd7\u7ea7 </b></c><color=#000000>"+t+"</c>",p.LocalData.data.eggMachineDailyTimes<1?(this.freeBtn.active=!1,this.eggMachineTips.string="\u4eca\u65e5\u514d\u8d39\u6b21\u6570\u5df2\u7528\u5b8c"):(this.freeBtn.active=!0,this.eggMachineTips.string=""),g.WorldEventManager.triggerEvent(y.LocalWorldEventType.RefreshActivity,null)},E.prototype.startAni=function(){var e=this;this.btnNode.active=!1,this.eggSpine.node.scale=.1,this.leftCard.position=this.leftCardStartPos.sub(cc.v2(800,0)),this.rightCard.position=this.rightCardStartPos.add(cc.v2(800,0)),this.eggSpine.node.stopAllActions(),this.leftCard.stopAllActions(),this.rightCard.stopAllActions(),this.eggSpine.node.runAction(cc.sequence(cc.scaleTo(.3,1),cc.callFunc(function(){e.cardAni()})))},E.prototype.cardAni=function(){var e=this;this.leftCard.runAction(cc.sequence(cc.moveTo(.3,this.leftCardStartPos),cc.callFunc(function(){e.btnNode.active=!0,e.btnNode.opacity=0,e.btnNode.stopAllActions(),e.btnNode.runAction(cc.fadeIn(.3))}))),this.rightCard.runAction(cc.moveTo(.3,this.rightCardStartPos))},E.prototype.clickVideoGet=function(){var e,t=this;u.LocalSoundManager.playAudio("click"),this.isOpen||(e=function(){t.isOpen=!0,t.eggSpine.paused=!1,t.eggSpine.animation="AT",t.eggSpine.setSkin(t.randomSkin()),v.TimerManager.addTimer(.8,function(){u.LocalSoundManager.playAudio("eggMachine")}),p.LocalData.data.eggMachineDailyTimes--,t.eggSpine.setCompleteListener(function(){c.BoxReward.eggMachineGet(!1,function(){t.refresh()})})},h.ShareManager.getShareControlType()!=h.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?m.ShareVideoControl.videoFunc("\u5f00\u542f\u626d\u86cb\u673a",e,null,e,null,null,m.VideoAdIdEnum.WEAPON_BOX_ID):e())},E.prototype.clickGemGet=function(){var e=this;u.LocalSoundManager.playAudio("click"),this.isOpen||(p.LocalData.data.gemCount>=d.GameConfigData.data.eggGemCost?(p.LocalData.changeGem(-d.GameConfigData.data.eggGemCost),this.isOpen=!0,this.eggSpine.paused=!1,this.eggSpine.animation="AT",this.eggSpine.setSkin(this.randomSkin()),v.TimerManager.addTimer(.8,function(){u.LocalSoundManager.playAudio("eggMachine")}),this.eggSpine.setCompleteListener(function(){c.BoxReward.eggMachineGet(!0,function(){e.refresh()})})):D.UIManager.showGetMoreGoldCoinUI(null))},E.prototype.randomSkin=function(){var e=f.Util.getRandomNum(0,this.skinArray.length-1);return this.skinArray[e]},E.prototype.clickClose=function(){u.LocalSoundManager.playAudio("click"),this.isOpen||this.close()},E.prototype.close=function(){this.closeAction&&this.closeAction(),this.closeAction=null,r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:sp.Skeleton,displayName:"\u626d\u86cb\u673aspine"})],E.prototype,"eggSpine",void 0),__decorate([o({type:s.NumberImg,displayName:"\u94bb\u77f3\u6d88\u8017"})],E.prototype,"gemCost",void 0),__decorate([o({type:cc.Label,displayName:"\u626d\u86cb\u673a\u63d0\u793a"})],E.prototype,"eggMachineTips",void 0),__decorate([o({type:cc.Node,displayName:"\u514d\u8d39\u5f00\u542f\u6309\u94ae"})],E.prototype,"freeBtn",void 0),__decorate([o({type:cc.RichText,displayName:"\u4fdd\u5e95\u5956\u52b1label"})],E.prototype,"bottomLabel",void 0),__decorate([o({type:cc.Node,displayName:"\u5de6\u5361\u7247"})],E.prototype,"leftCard",void 0),__decorate([o({type:cc.Node,displayName:"\u53f3\u5361\u7247"})],E.prototype,"rightCard",void 0),__decorate([o({type:cc.Node,displayName:"\u6309\u94ae\u8282\u70b9"})],E.prototype,"btnNode",void 0),n=__decorate([n],E),i.EggMachineUI=n,cc._RF.pop()},{}],EllipseAction:[function(e,t,a){"use strict";cc._RF.push(t,"7ab25NEMRlM3LtyjXgV2i5j","EllipseAction");var n=a;function o(e,t,a,n,o,i){this.targetNode=null,this.targetLastPos=null,this.centerPos=cc.Vec2.ZERO,this.longLine=0,this.shortLine=0,this.angleSpeed=0,this.currentAngle=0,this.targetNode=e,this.centerPos=t,this.longLine=a,this.shortLine=n,this.angleSpeed=o,this.currentAngle=i}Object.defineProperty(n,"__esModule",{value:!0}),o.prototype.setCurrentAnlge=function(e){this.currentAngle=e},o.prototype.runAction=function(e){this.targetLastPos=this.targetNode.position,this.currentAngle+=this.angleSpeed*e;var t=this.currentAngle*Math.PI/180;e=this.longLine*Math.cos(t)+this.centerPos.x,t=this.shortLine*Math.sin(t)+this.centerPos.y,this.targetNode.x=e,this.targetNode.y=t,0==(t=this.targetNode.position.sub(this.targetLastPos).normalize()).x&&0==t.y||(this.targetNode.angle=-180*cc.v2(t).signAngle(cc.Vec2.RIGHT)/Math.PI)},n.EllipseAction=o,cc._RF.pop()},{}],EmergencyEquipmentEffect:[function(e,t,a){"use strict";cc._RF.push(t,"d56a3QfTm1IbZe4WjMk9isV","EmergencyEquipmentEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("LocalData"),d=n("SkillSystem"),u=n("EnumAndConst"),h=n("PlayerState");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.aniNode=null,e.playerData=null,e.restorePoolMap=null,e.restoreCount=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this);var e=h.PlayerState.playerData;null!=e&&(this.playerData=e,this.restorePoolMap=new Map)},m.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},m.prototype.update=function(){var e,t,a;null!=this.playerData&&(this.playerData.isDead||this.playerData.hp<=0?this.close():null==this.restorePoolMap||this.restorePoolMap.size<=0||(e=this.restorePoolMap.has(0),t=this.restorePoolMap.has(1),a=this.restorePoolMap.has(2),(t&&a&&!e&&(this.playerData.helmetDroped||this.playerData.helmetDefense<=0)&&(this.playerData.shieldDroped||this.playerData.shieldDefense<=0)||t&&!a&&!e&&(this.playerData.helmetDroped||this.playerData.helmetDefense<=0)||!t&&a&&!e&&(this.playerData.shieldDroped||this.playerData.shieldDefense<=0))&&this.close()))},m.prototype.bindData=function(e,t,a){null!=e&&null!=t&&(this.closeAction=a,a=e*d.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.EMERGENCY_EQUIPMENT),this.restorePoolMap.has(t)?(null==(e=this.restorePoolMap.get(t))&&(e=0),e=Math.round(e*(this.restoreCount/5)),this.restorePoolMap.set(t,e+a)):this.restorePoolMap.set(t,a),this.restoreCount=5,this.playAnimation())},m.prototype.playAnimation=function(){var e=this;this.aniNode.y=-50,this.aniNode.opacity=0,this.aniNode.stopAllActions(),this.aniNode.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){e.restoreCount<=0||e.playerData.isDead?e.close():(e.restoreCount--,e.restorePoolMap.forEach(function(t,a){var n=Math.round(t/5);switch(a){case 0:return void(!e.playerData.isDead&&0<e.playerData.hp&&h.PlayerState.player.restoreHp(n,!1,!1));case 1:return void(!e.playerData.helmetDroped&&0<e.playerData.helmetDefense&&h.PlayerState.player.repairEquipment(p.EquipmentType.helmet,n,!1,!1));case 2:return void(!e.playerData.shieldDroped&&0<e.playerData.shieldDefense&&h.PlayerState.player.repairEquipment(p.EquipmentType.shield,n,!1,!1));default:return}}))}),cc.spawn(cc.sequence(cc.fadeIn(.2),cc.delayTime(.6),cc.fadeOut(.2)),cc.moveTo(1,0,70)),cc.callFunc(function(){e.aniNode.y=-35,e.aniNode.opacity=0}))))},m.prototype.close=function(){this.node.stopAllActions(),this.closeAction&&this.closeAction(),r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u8282\u70b9",type:cc.Node})],m.prototype,"aniNode",void 0),n=__decorate([n],m),i.EmergencyEquipmentEffect=n,cc._RF.pop()},{}],EndlessBackUI:[function(e,t,a){"use strict";cc._RF.push(t,"12c6bdW5FJFNrDaiT52SWH2","EndlessBackUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("LocalSoundManager"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("GameManager"),u=n("UIManager"),h=n("Connecting");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.allBg=null,e.continueAction=null,e.backAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.onEnable=function(){this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3)))},m.prototype.update=function(){u.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},m.prototype.bindData=function(e,t){this.continueAction=e,this.backAction=t},m.prototype.clickContinue=function(){s.LocalSoundManager.playAudio("click"),this.continueAction&&this.continueAction(),this.close()},m.prototype.clickBack=function(){s.LocalSoundManager.playAudio("click"),this.backAction&&this.backAction(),c.WorldEventManager.triggerEvent(p.LocalWorldEventType.BackHome,null),d.GameManager.backHome(),h.Connecting.enterMainScene(function(){u.UIManager.showMainBoard()}),this.close()},m.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Node,displayName:"\u80cc\u666f"})],m.prototype,"allBg",void 0),n=__decorate([n],m),i.EndlessBackUI=n,cc._RF.pop()},{}],EndlessModelConfigData:[function(e,t,a){"use strict";cc._RF.push(t,"8eb6b59+O5PUKecZovppeWW","EndlessModelConfigData");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("Util"),l=n("GameConfigData"),r=n("LocalData"),s=n("ConfigData");function c(){}n=n("EnumAndConst"),c.getEndlessBossHp=function(e){return null==e?2e4:2e4*Math.ceil(e/this.partInterval)},c.getEndlessBossAtk=function(e){return null==e?this.endlessBossInitAtk:(e=Math.ceil(e/this.partInterval),this.endlessBossInitAtk+75*(e-1))},c.getEndlessEnemyChance=function(e){return(e%=70)<=0&&(e=70),((e=Math.ceil(e/5)-1)<0||e>=this.endlessEnemyChance.length)&&(e=0),this.endlessEnemyChance[e]},c.getEndlessTotalEnemyCount=function(e){return s.ConfigData.isBossPart(e)?0:(e%=this.partInterval,e=4*Math.min(c.endlessMaxPartMul,e),Math.min(c.endlessMaxEnemyCount,e))},c.getEndlessWaveEnemyCount=function(e){if(!(s.ConfigData.isBossPart(e)||(e%=this.partInterval,(e=Math.min(c.endlessMaxPartMul,e)-1)<0||e>=c.endlessWaveEnemyCount.length)))return c.endlessWaveEnemyCount[e]},c.getEndlessEnemyHp=function(e){var t=Math.ceil(e/this.partInterval);return t=this.endlessEnemyInitHp+100*(t-1),(e%=this.partInterval)<=0&&(e=this.partInterval),t+50*(Math.ceil(e/5)+1)},c.getEndlessEnemyDefense=function(e){var t=Math.ceil(e/this.partInterval);return t=this.endlessEnemyInitDefense+50*(t-1),(e%=this.partInterval)<=0&&(e=this.partInterval),t+25*(Math.ceil(e/5)+1)},c.getEndlessEnemyAtk=function(e){var t=Math.ceil(e/this.partInterval);return t=this.endlessEnemyInitAtk+50*(t-1),(e%=this.partInterval)<=0&&(e=this.partInterval),t+25*(Math.ceil(e/5)+1)},c.getEndlessEnemyAttackFrequency=function(e){return e=1+.05*Math.ceil(e/5),Math.min(e,c.endlessMaxAttackFrequency)},c.getEndlessEnemyEquipmentIndex=function(){return i.Util.getRandomNum(0,4)},c.getEndlessEnemyEqeuipmentRank=function(e){return e>this.endlessPartLine?4:1},c.getEndlessSkillArrayIndex=function(e,t,a){if(null!=e)return e>l.GameConfigData.data.skillChanceConfig.length&&(e=l.GameConfigData.data.skillChanceConfig.length),e=l.GameConfigData.data.skillChanceConfig[(e=e<1?1:e)-1],2==a&&(e=[.4,.3,.3]),3==a&&(e=[.5,.5]),i.Util.getRandomIndexInChanceArray(e=t?[0,.1,.4,.5]:e)},c.getEndlessLevelUpExp=function(e){return null==e||--e<0||e>=l.GameConfigData.data.levelUpExp.length?20:l.GameConfigData.data.levelUpExp[e]},c.endlessEnergyCost=10,c.endlessMaxLevel=20,c.endlessMaxPartMul=7,c.endlessMaxEnemyCount=28,c.endlessPartLine=60,c.endlessWaveEnemyCount=[[4],[4,4],[4,4,4],[4,4,8],[6,6,8],[4,6,6,8],[6,6,8,8]],c.endlessEnemyChance=[[.2,.5,0,.7,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,.2,0,0,.4,.6,0,0,.8,1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,.2,0,.4,.6,0,.8,0,1,0,0,0,0,0,0,0,0,0],[0,0,.1,.2,.3,.4,0,.5,0,.6,.8,1,0,0,0,0,0,0,0,0,0],[0,0,0,.1,0,.3,0,.5,0,.6,0,.7,.8,1,0,0,0,0,0,0,0],[0,0,0,.2,0,0,.4,0,0,0,0,.6,.8,0,1,0,0,0,0,0,0],[0,0,0,0,.2,0,0,0,0,.4,.5,.6,0,.7,.9,0,1,0,0,0,0],[0,0,0,0,.2,0,0,.3,0,0,.5,0,.6,0,.7,.8,0,1,0,0,0],[0,0,0,0,0,.1,0,0,0,.2,0,.3,.5,0,.6,.7,.8,1,0,0,0],[0,0,0,0,0,.1,0,0,0,.2,0,.3,.5,0,.6,.7,.8,1,0,0,0],[0,0,0,0,0,.1,0,0,0,.3,0,0,0,.5,0,.6,.8,0,1,0,0],[0,0,0,0,0,0,0,0,0,.1,0,0,.2,.3,.4,0,0,.5,.6,.8,1],[0,0,0,0,0,0,0,0,0,.1,0,0,0,.3,.4,0,0,.5,.6,0,.7,.8,.9,1],[0,0,0,0,0,0,0,0,0,.1,0,0,.3,.4,0,0,.6,0,0,.7,0,.8,.9,1]],c.endlessBossExtraHitRate=.1,c.endlessBossInitAtk=250,c.endlessEnemyInitHp=450,c.endlessEnemyInitDefense=200,c.endlessEnemyInitAtk=175,c.endlessMaxAttackFrequency=2,c.endlessUpdateEnemyInterval=.25,c.partInterval=10,c.endlessRewardMinRank=500,c.endlessLastMonthRankingRewards=[{highestRank:1,lowestRank:3,rankStr:"1-3",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:5,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:2e3}],rewardDescriptions:["\u82e6\u65e0(\u4f20\u8bf4)","\u94bb\u77f32000"]},{highestRank:4,lowestRank:10,rankStr:"4-10",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:7,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:1600}],rewardDescriptions:["\u7687\u5bb6\u5de8\u65a7(\u4f20\u8bf4)","\u94bb\u77f31600"]},{highestRank:11,lowestRank:50,rankStr:"11-50",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:6,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:1200}],rewardDescriptions:["\u88c2\u53e3\u5de8\u5251(\u4f20\u8bf4)","\u94bb\u77f31200"]},{highestRank:50,lowestRank:200,rankStr:"51-\n200",rewardDatas:[{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:800}],rewardDescriptions:["\u94bb\u77f3800"]},{highestRank:201,lowestRank:500,rankStr:"201-\n500",rewardDatas:[{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:400}],rewardDescriptions:["\u94bb\u77f3400"]}],c.endlessRankingRewards=[{highestRank:1,lowestRank:3,rankStr:"1-3",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:5,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:2e3}],rewardDescriptions:["\u82e6\u65e0(\u4f20\u8bf4)","\u94bb\u77f32000"]},{highestRank:4,lowestRank:10,rankStr:"4-10",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:7,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:1600}],rewardDescriptions:["\u7687\u5bb6\u5de8\u65a7(\u4f20\u8bf4)","\u94bb\u77f31600"]},{highestRank:11,lowestRank:50,rankStr:"11-50",rewardDatas:[{rewardType:n.RewardTypeEnum.EQUIPMENT,equipmentData:{type:r.EquipmentType.weapon,index:6,rank:5,level:1,isNew:!0,equipped:!1},rewardCount:1},{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:1200}],rewardDescriptions:["\u88c2\u53e3\u5de8\u5251(\u4f20\u8bf4)","\u94bb\u77f31200"]},{highestRank:50,lowestRank:200,rankStr:"51-\n200",rewardDatas:[{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:800}],rewardDescriptions:["\u94bb\u77f3800"]},{highestRank:201,lowestRank:500,rankStr:"201-\n500",rewardDatas:[{rewardType:n.RewardTypeEnum.GEM,equipmentData:null,rewardCount:400}],rewardDescriptions:["\u94bb\u77f3400"]}],n=c,o.EndlessModelConfigData=n,cc._RF.pop()},{}],EndlessRankingRewardItem:[function(e,t,a){"use strict";cc._RF.push(t,"2fb3fxtRn9Aiojo2I8Y3sWG","EndlessRankingRewardItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RewardItem"),s=n("GameCommonPool");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.rewardItemPrefab=null,e.rankLabel=null,e.rewarContent=null,e.rewardDescription=null,e.rewardItems=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.onDisable=function(){if(!(null==this.rewardItems||this.rewardItems.length<=0)){for(var e=0;e<this.rewardItems.length;e++){if(null==this.rewardItems[e])return;s.GameCommonPool.returnInstant(this.rewardItems[e].node),e--}this.rewardItems=[]}},c.prototype.bindData=function(e,t,a){if(!(null==e||null==t||t.length<=0||null==a)){this.rankLabel.string=e;for(var n=0,o=t;n<o.length;n++){var i=o[n],l=s.GameCommonPool.requestInstant(this.rewardItemPrefab);if(null==l)return;if(l.setParent(this.rewarContent),l.y=0,null==(l=l.getComponent(r.RewardItem)))return;l.bindData(i)}for(var c="",p=0;p<a.length;p++)0==p?c+=a[p]:c=c+"\n"+a[p];this.rewardDescription.string=c}},__decorate([o({displayName:"\u5956\u52b1item\u9884\u8bbe",type:cc.Prefab})],c.prototype,"rewardItemPrefab",void 0),__decorate([o({displayName:"\u6392\u540d",type:cc.Label})],c.prototype,"rankLabel",void 0),__decorate([o({displayName:"\u5956\u52b1\u5185\u5bb9\u8282\u70b9",type:cc.Node})],c.prototype,"rewarContent",void 0),__decorate([o({displayName:"\u5956\u52b1\u63cf\u8ff0",type:cc.Label})],c.prototype,"rewardDescription",void 0),n=__decorate([n],c),i.EndlessRankingRewardItem=n,cc._RF.pop()},{}],EndlessRankingRewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"b3b7cAJJBNAA6eDF4xha97B","EndlessRankingRewardUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EndlessRankingRewardItem"),s=n("EndlessModelConfigData"),c=n("GameCommonPool"),p=n("LocalSoundManager");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.endlessRewardItemPrefab=null,e.rewardContent=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onLoad=function(){this.showEndlessRewards()},d.prototype.showEndlessRewards=function(){for(var e=s.EndlessModelConfigData.endlessRankingRewards,t=0;t<e.length;t++){var a=c.GameCommonPool.requestInstant(this.endlessRewardItemPrefab);if(null==a)return;if(a.setParent(this.rewardContent),a.setPosition(cc.Vec2.ZERO),null==(a=a.getComponent(r.EndlessRankingRewardItem)))return;a.bindData(e[t].rankStr,e[t].rewardDatas,e[t].rewardDescriptions)}},d.prototype.clickClose=function(){p.LocalSoundManager.playAudio("click"),c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u65e0\u5c3d\u6a21\u5f0f\u6392\u884c\u5956\u52b1item\u9884\u8bbe",type:cc.Prefab})],d.prototype,"endlessRewardItemPrefab",void 0),__decorate([o({displayName:"\u5956\u52b1\u5185\u5bb9\u8282\u70b9",type:cc.Node})],d.prototype,"rewardContent",void 0),n=__decorate([n],d),i.EndlessRankingRewardUI=n,cc._RF.pop()},{}],EndlessRankingUI:[function(e,t,a){"use strict";cc._RF.push(t,"4e85bnCoIlFzagFsYr4SoIL","EndlessRankingUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RankingItem"),s=n("LocalSoundManager"),c=n("RankingManager"),p=n("EnumAndConst"),d=n("WorldRankingManager"),u=n("GameCommonPool"),h=n("LocalData"),m=n("AuthorizationManager"),f=n("UIManager"),g=n("TipManager"),y=n("EndlessModelConfigData");function v(){var e=null!==l&&l.apply(this,arguments)||this;return e.worldButtonSprite=null,e.friendButtonSprite=null,e.worldButtonSpriteFrames=[],e.friendButtonSpriteFrames=[],e.rankContent=null,e.userContent=null,e.rankItem=null,e.worldRankingNode=null,e.friendRankingNode=null,e.authorTip=null,e.isShowingWorldRanking=!0,e.rankingItems=[],e.userRankingItem=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(v,l),v.prototype.onEnable=function(){this.isShowingWorldRanking=!0,this.worldButtonSprite.spriteFrame=this.worldButtonSpriteFrames[0],this.friendButtonSprite.spriteFrame=this.friendButtonSpriteFrames[1],this.showWorldRanking()},v.prototype.showWorldRanking=function(){var e=this;if(c.RankingManager.closeRankListSlide(),this.worldRankingNode.active=!0,this.friendRankingNode.active=!1,null==h.LocalData.data.userInfo)return this.authorTip.node.active=!0,this.authorTip.string="\u6388\u6743\u540e\u624d\u80fd\u663e\u793a\u4e16\u754c\u6392\u884c\u54e6~\n\u70b9\u51fb\u6b64\u5904\u8fdb\u884c\u6388\u6743",void this.createUserInfoButton();function t(){null==e.userRankingItem&&(e.userRankingItem=e.createRankingItem(!0)),e.getRankingReward();var t=d.WorldRankingManager.worldDatas;if(null==t||t.length<=0)return e.authorTip.node.active=!0,e.authorTip.string="\u6b63\u5728\u7b49\u5f85\u73a9\u5bb6\u51b2\u51fb\u6392\u540d~",void e.userRankingItem.bindData(1e4,h.LocalData.data.userInfo.avatarUrl,h.LocalData.data.userInfo.nickName,0);for(var a=20<=t.length?20:t.length,n=0;n<a;n++){var o,i=t[n];null!=i&&null!=i.nickname&&null!=i.head&&null!=i.part&&null!=i.num&&(null==(o=e.rankingItems[n])&&(e.rankingItems[n]=e.createRankingItem(!1),o=e.rankingItems[n]),o.bindData(n+1,i.head,i.nickname,i.part))}var l=d.WorldRankingManager.userWorldData;null==l?e.userRankingItem.bindData(1e4,h.LocalData.data.userInfo.avatarUrl,h.LocalData.data.userInfo.nickName,0):e.userRankingItem.bindData(l.num,l.head,l.nickname,l.part)}this.authorTip.node.active=!1,null==d.WorldRankingManager.worldDatas?d.WorldRankingManager.getWorldData(t):t()},v.prototype.showFriendRanking=function(){this.worldRankingNode.active=!1,this.friendRankingNode.active=!0,null==h.LocalData.data.userInfo&&m.AuthorizationManager.destroyAuthorizationButton(),c.RankingManager.showRankList(p.OpenDataKeyEnum.ENDLESS_PART),c.RankingManager.openRankListSlide()},v.prototype.getRankingReward=function(){var e=new Date,t=e.getFullYear(),a=e.getMonth();if(h.LocalData.data.getRankRewardYear!=t||h.LocalData.data.getRankRewardMonth!=a){h.LocalData.data.getRankRewardYear=t,h.LocalData.data.getRankRewardMonth=a;var n=d.WorldRankingManager.lastMonthRank;if(!(null==n||n<=0))if(n>y.EndlessModelConfigData.endlessRewardMinRank)f.UIManager.showEndlessReceiveRewardUI(a,n,null,null);else{for(var o=y.EndlessModelConfigData.endlessLastMonthRankingRewards,i=null,l=0;l<o.length;l++){var r=o[l];if(null!=r&&null!=r.highestRank&&null!=r.lowestRank&&n>=r.highestRank&&n<=r.lowestRank){i=r;break}}null!=i&&null!=i.rewardDatas&&null!=i.rewardDescriptions&&(e=i.rewardDatas,t=i.rewardDescriptions,f.UIManager.showEndlessReceiveRewardUI(a,n,e,t))}}},v.prototype.createRankingItem=function(e){var t=u.GameCommonPool.requestInstant(this.rankItem);if(null!=t){var a=t.getComponent(r.RankingItem);if(null!=a)return e?(t.setParent(this.userContent),t.setPosition(cc.Vec2.ZERO)):t.setParent(this.rankContent),a}},v.prototype.createUserInfoButton=function(){var e,t=this,a=window.gameCommon.getSDK.getSystemInfo();null!=a&&(e=a.screenHeight/640,e={left:(a.screenWidth-1136*e)/2+258*e,top:142*e,width:654*e,height:413*e},m.AuthorizationManager.popWxAuthorization(function(e){null!=e&&(h.LocalData.data.userInfo=e),t.showWorldRanking()},"img/authorizationButton.png",e))},v.prototype.clickWorldRanking=function(){this.isShowingWorldRanking||(this.isShowingWorldRanking=!0,s.LocalSoundManager.playAudio("click"),this.worldButtonSprite.spriteFrame=this.worldButtonSpriteFrames[0],this.friendButtonSprite.spriteFrame=this.friendButtonSpriteFrames[1],this.showWorldRanking())},v.prototype.clickFriendRanking=function(){this.isShowingWorldRanking&&(this.isShowingWorldRanking=!1,s.LocalSoundManager.playAudio("click"),this.worldButtonSprite.spriteFrame=this.worldButtonSpriteFrames[1],this.friendButtonSprite.spriteFrame=this.friendButtonSpriteFrames[0],this.showFriendRanking())},v.prototype.clickShowReward=function(){s.LocalSoundManager.playAudio("click"),null!=h.LocalData.data.userInfo?f.UIManager.showEndlessRankingRewardUI():g.TipManager.showTip("\u6388\u6743\u4e4b\u540e\u624d\u80fd\u67e5\u770b\u4e16\u754c\u6392\u540d\u5956\u52b1\u54e6~")},v.prototype.clickClose=function(){s.LocalSoundManager.playAudio("click"),null==h.LocalData.data.userInfo&&m.AuthorizationManager.destroyAuthorizationButton(),this.close()},v.prototype.close=function(){u.GameCommonPool.returnInstant(this.node),c.RankingManager.closeRankListSlide()},__decorate([o({displayName:"\u4e16\u754c\u6392\u884c\u6309\u94ae",type:cc.Sprite})],v.prototype,"worldButtonSprite",void 0),__decorate([o({displayName:"\u597d\u53cb\u6392\u884c\u6309\u94ae",type:cc.Sprite})],v.prototype,"friendButtonSprite",void 0),__decorate([o({displayName:"\u4e16\u754c\u6392\u884c\u6309\u94ae\u56fe\u96c6\u5408",type:cc.SpriteFrame})],v.prototype,"worldButtonSpriteFrames",void 0),__decorate([o({displayName:"\u597d\u53cb\u6392\u884c\u6309\u94ae\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],v.prototype,"friendButtonSpriteFrames",void 0),__decorate([o({displayName:"\u6392\u540dcontent",type:cc.Node})],v.prototype,"rankContent",void 0),__decorate([o({displayName:"\u81ea\u5df1\u6392\u540d\u8282\u70b9F",type:cc.Node})],v.prototype,"userContent",void 0),__decorate([o({displayName:"\u6392\u540ditem",type:cc.Prefab})],v.prototype,"rankItem",void 0),__decorate([o({displayName:"\u4e16\u754c\u6392\u884c\u8282\u70b9",type:cc.Node})],v.prototype,"worldRankingNode",void 0),__decorate([o({displayName:"\u597d\u53cb\u6392\u884c\u8282\u70b9",type:cc.Node})],v.prototype,"friendRankingNode",void 0),__decorate([o({displayName:"\u63d0\u793a",type:cc.Label})],v.prototype,"authorTip",void 0),n=__decorate([n],v),i.EndlessRankingUI=n,cc._RF.pop()},{}],EndlessReceiveRewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"bc47bHt/nlBcIeh3H2w5LVV","EndlessReceiveRewardUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameCommonPool"),c=n("RewardItem"),p=n("LocalData"),d=n("LocalSoundManager"),u=n("EndlessModelConfigData");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.rewardItemPrefab=null,e.tittleSprite=null,e.tittleSpriteFrames=[],e.rankLabel=null,e.rewarContent=null,e.rewardDescription=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.bindData=function(e,t,a,n){if(null!=e&&null!=t){if(this.rankLabel.string="\u65e0\u5c3d\u6a21\u5f0f"+(e=0==e?12:e)+"\u6708  \u7b2c"+t+"\u540d!",t>u.EndlessModelConfigData.endlessRewardMinRank)return this.tittleSprite.spriteFrame=this.tittleSpriteFrames[1],void(this.rewardDescription.string="\u4f60\u6ca1\u6709\u8fdb\u5165"+u.EndlessModelConfigData.endlessRewardMinRank+"\u540d\u4e4b\u524d\u54e6\uff0c\u8bf7\u4e0b\u6b21\u52a0\u6cb9!");if(null!=a&&null!=a.length){this.tittleSprite.spriteFrame=this.tittleSpriteFrames[0];for(var o=0,i=a;o<i.length;o++){var l=i[o];this.receiveReward(l);var r=s.GameCommonPool.requestInstant(this.rewardItemPrefab);if(null==r)return;if(r.setParent(this.rewarContent),null==(r=r.getComponent(c.RewardItem)))return;r.bindData(l)}for(var p="",d=0;d<n.length;d++)0==d?p+=n[d]:p=p+"+"+n[d];this.rewardDescription.string=p}}},h.prototype.receiveReward=function(e){null!=e&&(e.rewardType==r.RewardTypeEnum.COIN?p.LocalData.changeCoin(e.rewardCount):e.rewardType==r.RewardTypeEnum.GEM?p.LocalData.changeGem(e.rewardCount):e.rewardType!=r.RewardTypeEnum.EQUIPMENT||null!=(e=e.equipmentData)&&p.LocalData.rewardEquipment(e.type,e.index,e.rank))},h.prototype.clickClose=function(){d.LocalSoundManager.playAudio("click"),s.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5956\u52b1item\u9884\u8bbe",type:cc.Prefab})],h.prototype,"rewardItemPrefab",void 0),__decorate([o({displayName:"\u6807\u9898",type:cc.Sprite})],h.prototype,"tittleSprite",void 0),__decorate([o({displayName:"\u6807\u9898\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],h.prototype,"tittleSpriteFrames",void 0),__decorate([o({displayName:"\u6392\u540d",type:cc.Label})],h.prototype,"rankLabel",void 0),__decorate([o({displayName:"\u5956\u52b1\u5185\u5bb9\u8282\u70b9",type:cc.Node})],h.prototype,"rewarContent",void 0),__decorate([o({displayName:"\u5956\u52b1\u63cf\u8ff0",type:cc.Label})],h.prototype,"rewardDescription",void 0),n=__decorate([n],h),i.EndlessReceiveRewardUI=n,cc._RF.pop()},{}],EnemyArea:[function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"60c44fyxERCSKukP8Q5Xczm","EnemyArea");var o=e,i=t,l=a;Object.defineProperty(l,"__esModule",{value:!0});var r,s,c,p=o("RoleData"),d=o("EnumAndConst"),u=o("ConfigData"),h=o("Util"),m=o("GameCommonPool"),f=o("BattleNodeManager"),g=o("Necromancer"),y=o("WorldEventManager"),v=o("LocalWorldEventType"),D=o("ShieldWizard"),E=o("GameConfigData"),S=o("RoleManager"),A=o("SkillSystem"),C=o("GameCommonUtil"),M=o("SpecailSkill"),T=o("GameState"),_=o("EffectCreate"),k=o("PlayerState"),P=o("Timer"),R=o("EndlessModelConfigData"),I=o("BroadcastManager"),w=o("RoleBase"),b=o("PrefabUrl"),N=o("SkillData"),B=o("RoleBody"),L=cc._decorator,G=L.ccclass;function x(){this.enemyName="",this.prefession=d.ProfessionEnum.LAUNCHER,this.enemyBody=null,this.enemyHead=null}function F(){this.bossType=r.BOOS1,this.bossBody=null,this.bossHead=null}function U(){var e=null!==s&&s.apply(this,arguments)||this;return e.enemyInfoArray=[],e.bossInfoArray=[],e.magicBallBlastPrefab=null,e.enemyPrefabMap=new Map,e.enemyBodyMap=new Map,e.enemyHeadMap=new Map,e.bossPrefabMap=new Map,e.bossBodyMap=new Map,e.bossHeadMap=new Map,e.maxEnemyCount=0,e.currentEnemyCount=0,e.enemyChance=[],e.intervalTime=3,e.longEnemyMap=new Map,e.waveCount=0,e.waveEnemyCount=[],e.loadEnemySucc=!1,e.createBossWait=!1,e.endlessModelWait=!1,e}i=L.property,(o=r=l.BossType||(l.BossType={}))[o.BOOS1=1]="BOOS1",o[o.BOSS2=2]="BOSS2",o[o.BOSS3=3]="BOSS3",o[o.BOSS4=4]="BOSS4",o[o.BOSS5=5]="BOSS5",o[o.BOSS6=6]="BOSS6",o[o.BOSS7=7]="BOSS7",__decorate([i({displayName:"\u654c\u4eba\u540d\u79f0"})],x.prototype,"enemyName",void 0),__decorate([i({displayName:"\u654c\u4eba\u804c\u4e1a",type:cc.Enum(d.ProfessionEnum)})],x.prototype,"prefession",void 0),__decorate([i({displayName:"\u654c\u4eba\u8eab\u4f53\u78b0\u649e\u5668\u9884\u8bbe",type:cc.Prefab})],x.prototype,"enemyBody",void 0),__decorate([i({displayName:"\u654c\u4eba\u5934\u90e8\u78b0\u649e\u5668\u9884\u8bbe",type:cc.Prefab})],x.prototype,"enemyHead",void 0),L=__decorate([G("EnemyPrefabInfo")],x),l.EnemyPrefabInfo=L,__decorate([i({displayName:"boss\u7c7b\u578b",type:cc.Enum(r)})],F.prototype,"bossType",void 0),__decorate([i({displayName:"boss\u8eab\u4f53\u78b0\u649e\u5668\u9884\u8bbe",type:cc.Prefab})],F.prototype,"bossBody",void 0),__decorate([i({displayName:"boss\u5934\u90e8\u78b0\u649e\u5668\u9884\u8bbe",type:cc.Prefab})],F.prototype,"bossHead",void 0),o=__decorate([G("BossPrefabInfo")],F),l.BossPrefabInfo=o,s=cc.Component,__extends(U,s),(c=U).prototype.onLoad=function(){for(var e=this,t=this.enemyInfoArray.length,a=this.bossInfoArray.length,o=0,i=0,l=!1,r=!1,s=0,p=this.enemyInfoArray;s<p.length;s++)!function(a){null!=a&&cc.loader.loadRes(b.PrefabUrl.roleUrl+a.enemyName,cc.Prefab,function(n,i){n?console.log(n):(e.enemyPrefabMap.set(a.enemyName,i),e.enemyBodyMap.set(a.enemyName,a.enemyBody),e.enemyHeadMap.set(a.enemyName,a.enemyHead),(l=++o>=t||l)&&r&&(e.loadEnemySucc=!0,e.endlessModelWait&&e.endlessCreateWaveEnemies(),e.createBossWait&&c.createBoss()))})}(p[s]);for(var d=0,u=this.bossInfoArray;d<u.length;d++){var h=function(t){return null==t?{value:void 0}:void cc.loader.loadRes(b.PrefabUrl.bossUrl+"boss"+t.bossType,cc.Prefab,function(n,o){n?console.log(n):(e.bossPrefabMap.set(t.bossType,o),e.bossBodyMap.set(t.bossType,t.bossBody),e.bossHeadMap.set(t.bossType,t.bossHead),++i>=a&&(r=!0),l&&r&&(e.loadEnemySucc=!0,e.endlessModelWait&&e.endlessCreateWaveEnemies(),e.createBossWait&&c.createBoss()))})}(u[d]);if("object"==n(h))return h.value}},U.prototype.onEnable=function(){c.instance=this},U.prototype.update=function(e){this.loadEnemySucc&&T.GameState.isGaming&&(T.GameState.endlessModel||(0<this.intervalTime?this.intervalTime-=e:this.updateEnemy()))},U.init=function(){var e=c.instance;if(null!=e){e.longEnemyMap.clear();for(var t=0;t<8;t++)e.longEnemyMap.set(t,null);this.enemyDataArray=[],e.enemyChance=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyChance(T.GameState.currentPart):u.ConfigData.getEnemyChance(T.GameState.currentChapter,T.GameState.currentPart),T.GameState.endlessModel?(this.totalEnemyCount=R.EndlessModelConfigData.getEndlessTotalEnemyCount(T.GameState.currentPart),e.waveEnemyCount=R.EndlessModelConfigData.getEndlessWaveEnemyCount(T.GameState.currentPart)):this.totalEnemyCount=u.ConfigData.getEnemyCount(T.GameState.currentChapter,T.GameState.currentPart),this.killEnemyCount=0,e.currentEnemyCount=0,this.turnedEnemyCount=0,c.necromancer=null,c.shieldWizard=null,c.reviveReady=!1,e.waveCount=0}},U.close=function(){var e=c.instance;null!=e&&m.GameCommonPool.returnInstant(e.node)},U.startBattle=function(){var e=c.instance;if(null!=e){if(this.init(),e.createBossWait=!1,e.endlessModelWait=!1,this.bossAlive=T.GameState.isBossPart,this.bossAlive&&(e.loadEnemySucc?c.createBoss():e.createBossWait=!0),e.maxEnemyCount=this.bossAlive?u.ConfigData.MAX_ENEMY_COUNT-1:u.ConfigData.MAX_ENEMY_COUNT,T.GameState.endlessModel)return e.loadEnemySucc?void e.endlessCreateWaveEnemies():void(e.endlessModelWait=!0);e.intervalTime=1}},U.prototype.endlessCreateWaveEnemies=function(){var e=this;if(!(null==this.waveEnemyCount||this.waveEnemyCount.length<=0)){this.waveCount++;for(var t=this.waveEnemyCount[this.waveCount-1],a=0;a<t;a++)P.TimerManager.addTimer(a*R.EndlessModelConfigData.endlessUpdateEnemyInterval+2,function(){e.updateEnemy()});P.TimerManager.addTimer(1,function(){3<=e.waveCount&&e.waveCount>=e.waveEnemyCount.length?y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBroadcast,{type:I.BroadCastTypeEnum.LAST_WAVE}):8<=t&&y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBroadcast,{type:I.BroadCastTypeEnum.BIG_WAVE})})}},U.prototype.updateEnemy=function(){var e;this.currentEnemyCount>=this.maxEnemyCount||this.currentEnemyCount+c.killEnemyCount>=c.totalEnemyCount||(null==(e=this.getEnemyConfig())&&(e=u.ConfigData.getEnemyConfig(0)),c.createEnemy(e))},U.prototype.getEnemyConfig=function(){for(var e=null,t=null,a=0;a<1e3;a++){for(var n=Math.random(),o=0;o<this.enemyChance.length;o++)if(n<this.enemyChance[o]){e=o;break}if(null!=e){!T.GameState.endlessModel&&T.GameState.heroModel&&(e=u.ConfigData.getEnhanceEnemyIndex(e));var i=(t=u.ConfigData.getEnemyConfig(e)).locationStartIndex,l=t.locationEndIndex,r=c.hasEmptyPosition(i,l);if(i=t.enemyProfession==d.ProfessionEnum.SHIELD_WIZARD&&(null!=c.shieldWizard||null==c.enemyDataArray||c.enemyDataArray.length<=0),l=t.enemyProfession==d.ProfessionEnum.NECROMANCER&&(null!=c.necromancer||null==c.enemyDataArray||c.enemyDataArray.length<=0),r&&!i&&!l)break;999<=a&&(t=u.ConfigData.getEnemyConfig(0))}}return t},U.createEnemy=function(e,t,a){void 0===t&&(t=!1),void 0===a&&(a=null);var n=c.instance;if(null!=n){t&&this.totalEnemyCount++;var o=n.createEnemyData(e,t,a);if(null!=o){var i=n.createEnemyNode(o);if(null!=i&&null!=(e=n.createRoleBody(o))&&null!=(t=c.createRoleHead(o))){switch(o.profession){case d.ProfessionEnum.LAUNCHER:n.createLongEnemy(i,o);break;case d.ProfessionEnum.WARRIOR:n.createShortEnemy(i,o);break;case d.ProfessionEnum.FIRE_WIZARD:case d.ProfessionEnum.ICE_WIZARD:n.createWizardEnemy(i,o);break;case d.ProfessionEnum.LONG_ZOMBIE:n.createLongZombieEnemy(i,o);break;case d.ProfessionEnum.SHORT_ZOMBIE:n.createShortZombieEnemy(i,o,a);break;case d.ProfessionEnum.FLY_HEAD_GHOST:n.createFHGEnemy(i,o);break;case d.ProfessionEnum.SHIELD_DEFENDER:n.createSDefenderEnemy(i,o);break;case d.ProfessionEnum.SHARKER:n.createSharker(i,o);break;case d.ProfessionEnum.NECROMANCER:n.createNecromancer(i,o);break;case d.ProfessionEnum.SHIELD_WIZARD:n.createShieldWizard(i,o);break;case d.ProfessionEnum.ROBOT_MIXED:n.createRobotMixed(i,o);break;case d.ProfessionEnum.ROBOT_BURROW:n.createRobotBurrow(i,o);break;case d.ProfessionEnum.ROBOT_AIMED:n.createRobotAimed(i,o);break;case d.ProfessionEnum.FIRE_DRAGON:n.createFireDragon(i,o);break;case d.ProfessionEnum.ICE_DRAGON:n.createIceDragon(i,o);break;case d.ProfessionEnum.RUN_DRAGON:n.createRunDragon(i,o)}return n.bindEnemyBody(i,e,t,o,!0),n.intervalTime=3*(1-.2*Math.floor(T.GameState.currentPart/6)),n.intervalTime=Math.max(1.2,n.intervalTime),n.currentEnemyCount++,this.enemyDataArray.push(o),6<=n.currentEnemyCount&&y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:19}),o}}}},U.createBoss=function(e){void 0===e&&(e=null);var t=c.instance;if(null!=t){var a=T.GameState.currentChapter,n=T.GameState.currentPart;if(!(a<=0||a>E.GameConfigData.data.MAX_CHAPTER_COUNT)){var o=7==a?u.ConfigData.rightGroundBornPos.add(cc.v2(-100,600)):c.getEmptyPosition(e);if(null!=o){var i=a-1,l=null;if(null!=e?l=e:((l=new p.RoleData).orientation=1,l.id=C.GameCommonUtil.uuid(),l.isPlayer=!1,l.isEnemy=!0,l.isBoss=!0,l.isUltimateBoss=T.GameState.endlessModel||20<=T.GameState.currentPart,l.profession=d.ProfessionEnum.LAUNCHER,l.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,l.weaponIndex=i,l.hp=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessBossHp(T.GameState.currentPart):u.ConfigData.getBossHp(a,n,T.GameState.heroModel),l.atk=T.GameState.endlessModel?2*R.EndlessModelConfigData.getEndlessBossAtk(T.GameState.currentPart):u.ConfigData.getEnemyAtk(a,l,T.GameState.heroModel),l.isMoveModel=!1,l.rewardExpCount=50,l.rewardCoinCount=E.GameConfigData.data.bossRewardCoin[a-1],(T.GameState.endlessModel&&120<T.GameState.currentPart||T.GameState.heroModel)&&l.getEnemyRandomSkill(),l.maxHp=l.hp,l.logicPos=o,5==a&&(l.isFireArrow=!0),(T.GameState.endlessModel||T.GameState.heroModel||1<a)&&l.enemyEquipSkills.addSkill(d.SkillTypeEnum.DODGE)),c.setEnemyPostionMap(l.logicPos.x,l),null!=(e=t.createEnemyNode(null,T.GameState.currentChapter))&&null!=(i=t.createRoleBody(null,T.GameState.currentChapter))&&null!=(n=c.createRoleHead(null,T.GameState.currentChapter))&&null!=(o=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.BOSS_SPINE_NODE))){e.setParent(o),e.setPosition(l.logicPos),t.bindEnemyBody(e,i,n,l,!0);var r=null;switch(a){case 1:r=33;break;case 2:r=35;break;case 3:r=37;break;case 4:r=39;break;case 5:r=41;break;case 7:r=46}y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:r}),-1==this.enemyDataArray.indexOf(l)&&this.enemyDataArray.push(l)}}}}},U.killEnemy=function(e){var t=c.instance;if(null!=t)return e?null:(this.killEnemyCount++,t.currentEnemyCount--,this.killEnemyCount)},U.judgePassWave=function(){var e=c.instance;if(null!=e&&!(null==e.waveEnemyCount||e.waveEnemyCount.length<=0)){for(var t=0,a=0;a<e.waveCount;a++)t+=e.waveEnemyCount[a];this.killEnemyCount>=t&&e.endlessCreateWaveEnemies()}},U.isKillAllEnemy=function(){return this.killEnemyCount>=this.totalEnemyCount&&!this.bossAlive},U.prototype.createLongEnemy=function(e,t,a){null!=(a=null==(a=void 0===a?null:a)?c.getEmptyPosition(t):a)&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_SPINE_NODE))&&(e.setParent(a),e.setPosition(t.logicPos)))},U.prototype.createShortEnemy=function(e,t,a){var n=null==(a=void 0===a?null:a)?u.ConfigData.rightGroundBornPos:a;t.isReviving&&(n=t.logicPos),a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_SPINE_NODE),e.setParent(a),e.setPosition(n),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=e.position},U.prototype.createWizardEnemy=function(e,t){var a=c.getEmptyPosition(t);null!=a&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_SPINE_NODE))&&(e.setParent(a),e.setPosition(t.logicPos)))},U.prototype.createLongZombieEnemy=function(e,t,a){null!=(a=null==(a=void 0===a?null:a)?c.getEmptyPosition(t):a)&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_SPINE_NODE))&&(e.setParent(a),e.setPosition(t.logicPos),y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:28})))},U.prototype.createShortZombieEnemy=function(e,t,a){var n=null==(a=void 0===a?null:a)?u.ConfigData.getRightAirBornPos():a;t.isReviving&&(n=t.logicPos),a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHORT_Z_NODE),e.setParent(a),e.setPosition(n),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=e.position,y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:28})},U.prototype.createFHGEnemy=function(e,t){var a=c.getEmptyPosition(t);null!=a&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.FHG_NODE))&&(e.setParent(a),e.setPosition(t.logicPos),y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:29})))},U.prototype.createSDefenderEnemy=function(e,t,a){null!=(a=null==(a=void 0===a?null:a)?c.getEmptyPosition(t):a)&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_SPINE_NODE))&&(e.setParent(a),e.setPosition(t.logicPos)))},U.prototype.createSharker=function(e,t,a){var n=null==(a=void 0===a?null:a)?u.ConfigData.rightGroundBornPos:a;t.isReviving&&(n=t.logicPos),a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHARKER_NODE),e.setParent(a),e.setPosition(n),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=e.position,t.isEnemy&&y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:30})},U.prototype.createNecromancer=function(e,t){var a;null!=c.necromancer||null==c.enemyDataArray||c.enemyDataArray.length<=0||null!=(a=c.getEmptyPosition(t,5,7))&&(t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.NECROMANCER_NODE),e.setParent(t),e.setPosition(a),(e=e.getComponent(g.Necromancer))&&(c.necromancer=e,y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:31})))},U.prototype.createShieldWizard=function(e,t){var a;null!=c.shieldWizard||null==c.enemyDataArray||c.enemyDataArray.length<=0||null!=(a=c.getEmptyPosition(t,3,5))&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHIELD_WIZARD_NODE),e.setParent(t),e.setPosition(a),(e=e.getComponent(D.ShieldWizard))&&(c.shieldWizard=e,y.WorldEventManager.triggerEvent(v.LocalWorldEventType.ShowBubble,{type:32})))},U.prototype.createRobotMixed=function(e,t,a){var n=null==(a=void 0===a?null:a)?u.ConfigData.getRightAirBornPos():a;t.isReviving&&(n=t.logicPos),a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROBOT_MIXED_NODE),e.setParent(a),e.setPosition(n),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=e.position},U.prototype.createRobotBurrow=function(e,t,a){var n=null==(a=void 0===a?null:a)?u.ConfigData.rightGroundBornPos:a;t.isReviving&&(n=t.logicPos),a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROBOT_BURROW_NODE),e.setParent(a),e.setPosition(n),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=e.position},U.prototype.createRobotAimed=function(e,t,a){null!=(a=null==(a=void 0===a?null:a)?c.getEmptyPosition(t):a)&&(t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,c.setEnemyPostionMap(t.logicPos.x,t),t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROBOT_AIMED_NODE),e.setParent(t),e.setPosition(a))},U.prototype.createFireDragon=function(e,t,a){a=null==(a=void 0===a?null:a)?u.ConfigData.getRightAirBornPos():a,t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.FLY_DRAGON_NODE),e.setParent(t),e.setPosition(a)},U.prototype.createIceDragon=function(e,t,a){a=null==(a=void 0===a?null:a)?u.ConfigData.getRightAirBornPos():a,t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK,t.logicPos=a,t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.FLY_DRAGON_NODE),e.setParent(t),e.setPosition(a)},U.prototype.createRunDragon=function(e,t,a){a=null==(a=void 0===a?null:a)?u.ConfigData.rightGroundBornPos:a,t.isReviving&&(a=t.logicPos),t.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,t.logicPos=a,t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.RUN_DRAGON_NODE),e.setParent(t),e.setPosition(a)},U.prototype.createEnemyData=function(e,t,a){var n=new p.RoleData;return n.orientation=1,n.id=C.GameCommonUtil.uuid(),n.isPlayer=!1,n.isEnemy=!0,n.profession=e.enemyProfession,n.hp=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyHp(T.GameState.currentPart):u.ConfigData.getEnemyHp(T.GameState.currentChapter,T.GameState.currentPart,T.GameState.heroModel),n.atk=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyAtk(T.GameState.currentPart):u.ConfigData.getEnemyAtk(T.GameState.currentChapter,n,T.GameState.heroModel),n.isMoveModel=e.isMoveModel,n.rewardExpCount=T.GameState.endlessModel?e.endlessExpCount:e.expCount,T.GameState.heroModel&&(n.rewardExpCount+=u.ConfigData.getEnemyExtraExp(T.GameState.currentChapter)),T.GameState.heroModel?n.rewardCoinCount=e.heroModelCoinCount:(n.rewardCoinCount=e.coinCount,T.GameState.endlessModel&&(n.rewardCoinCount=Math.round(e.coinCount/2))),(T.GameState.endlessModel&&120<T.GameState.currentPart||T.GameState.heroModel)&&n.getEnemyRandomSkill(),n.maxHp=n.hp,n.bodyHurtReduction=e.bodyHurtReduction,n.headHurtReduction=e.headHurtReduction,n.profession!=d.ProfessionEnum.LAUNCHER&&n.profession!=d.ProfessionEnum.LONG_ZOMBIE&&n.profession!=d.ProfessionEnum.ROBOT_MIXED||(n.weaponIndex=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyEquipmentIndex():u.ConfigData.getEnemyWeaponIndex(T.GameState.currentChapter)),e.carryHelmet&&(n.helmetIndex=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyEquipmentIndex():u.ConfigData.getEnemyHelmetIndex(T.GameState.currentChapter),n.helmetDefense=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyDefense(T.GameState.currentPart):u.ConfigData.getEnemyInitDefense(T.GameState.currentChapter,T.GameState.currentPart),n.maxHelmetDefense=n.helmetDefense,n.initHelmetDefense=n.maxHelmetDefense),e.carryShield&&(n.shieldIndex=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyEquipmentIndex():u.ConfigData.getEnemyShieldIndex(T.GameState.currentChapter),n.shieldDefense=T.GameState.endlessModel?R.EndlessModelConfigData.getEndlessEnemyDefense(T.GameState.currentPart):u.ConfigData.getEnemyInitDefense(T.GameState.currentChapter,T.GameState.currentPart),n.maxShieldDefense=n.shieldDefense,n.initShieldDefense=n.maxShieldDefense),n.isSummon=t,n.logicPos=a,n.profession==d.ProfessionEnum.LAUNCHER?n.attackModel=d.AttackModelTypeEnum.LONG_RANGE_ATTACK:n.attackModel=d.AttackModelTypeEnum.MELEE_ATTACK,n},U.prototype.getEnemyPrefab=function(e,t){if(void 0===t&&(t=null),null!=e||null!=t){if(null!=e){var a=this.enemyPrefabMap.get(e);return null==a?void console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2a\u654c\u4eba:"+e):a}if(null!=(a=this.bossPrefabMap.get(t)))return a;console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2aboss:"+t)}},U.prototype.getEnemyBody=function(e,t){if(void 0===t&&(t=null),null!=e||null!=t){if(null!=e){var a=this.enemyBodyMap.get(e);return null==a?void console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2a\u654c\u4eba:"+e):a}if(null!=(a=this.bossBodyMap.get(t)))return a;console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2aboss:"+t)}},U.prototype.getEnemyHead=function(e,t){if(void 0===t&&(t=null),null!=e||null!=t){if(null!=e){var a=this.enemyHeadMap.get(e);return null==a?void console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2a\u654c\u4eba:"+e):a}if(null!=(a=this.bossHeadMap.get(t)))return a;console.error("\u8be5\u7ae0\u8282\u6ca1\u6709\u914d\u7f6e\u8fd9\u4e2aboss:"+t)}},U.prototype.createEnemyNode=function(e,t){var a=null;if(null!=(t=void 0===t?null:t))a=this.getEnemyPrefab(null,t);else{for(var n=null,o=0,i=this.enemyInfoArray;o<i.length;o++){var l=i[o];null!=l&&l.prefession==e.profession&&(n=l.enemyName)}a=this.getEnemyPrefab(n)}if(null!=a&&null!=(a=m.GameCommonPool.requestInstant(a)))return a},U.prototype.createRoleBody=function(e,t){void 0===t&&(t=null);var a=null,n=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_BODY_NODE);if(null!=n){if(null!=t)a=this.getEnemyBody(null,t);else{for(var o=null,i=0,l=this.enemyInfoArray;i<l.length;i++){var r=l[i];null!=r&&r.prefession==e.profession&&(o=r.enemyName)}a=this.getEnemyBody(o)}if(null!=a&&null!=(a=cc.instantiate(a)))return a.setParent(n),a.setPosition(cc.v2(9999,9999)),a}},U.createRoleHead=function(e,t){void 0===t&&(t=null);var a=c.instance;if(null!=a){var n=null,o=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.ROLE_HEAD_NODE);if(null!=o){if(null!=t)n=a.getEnemyHead(null,t);else{for(var i=null,l=0,r=a.enemyInfoArray;l<r.length;l++){var s=r[l];null!=s&&s.prefession==e.profession&&(i=s.enemyName)}n=a.getEnemyHead(i)}if(null!=n&&null!=(n=cc.instantiate(n)))return n.setParent(o),n.setPosition(cc.v2(9999,9999)),n}}},U.prototype.bindEnemyBody=function(e,t,a,n,o){null==(e=e.getComponent(w.RoleBase))||null!=(t=t.getComponent(B.RoleBody))&&(t.bindData(n),null!=(t=t.getBodyColliders())&&(e.bindData(n,t,a),S.RoleManager.addRole(n.id,e),o&&_.EffectCreate.createAppearEffect(n.logicPos)))},U.createTurnedEnemy=function(e){var t=c.instance;if(null!=t&&null!=e){var a=new p.RoleData;a.orientation=-1,a.id=C.GameCommonUtil.uuid(),a.isPlayer=!1,a.isEnemy=!1,a.profession=e.profession,a.weaponIndex=e.weaponIndex,a.shieldIndex=e.shieldIndex,a.helmetIndex=e.helmetIndex,a.maxHp=e.maxHp,a.hp=a.maxHp,a.initMaxHp=e.initMaxHp,a.helmetDefense=e.helmetDefense,a.shieldDefense=e.shieldDefense,a.maxHelmetDefense=e.maxHelmetDefense,a.maxShieldDefense=e.maxShieldDefense,a.logicPos=e.logicPos,a.bodyHurtReduction=e.bodyHurtReduction,a.headHurtReduction=e.headHurtReduction;var n=new N.SkillData,o=e.enemyEquipSkills.getSkills();n.addSkills(o),a.enemyEquipSkills=n,a.isTurnEnemy=!0,a.atk=k.PlayerState.playerData.atk;var i=t.createEnemyNode(e);if(null!=i&&null!=(n=t.createRoleBody(e))&&null!=(e=c.createRoleHead(e))){switch(a.profession){case d.ProfessionEnum.LAUNCHER:a.isMoveModel=!1,t.createLongEnemy(i,a,a.logicPos);break;case d.ProfessionEnum.WARRIOR:a.isMoveModel=!0,t.createShortEnemy(i,a,a.logicPos);break;case d.ProfessionEnum.LONG_ZOMBIE:a.isMoveModel=!1,t.createLongZombieEnemy(i,a,a.logicPos);break;case d.ProfessionEnum.SHORT_ZOMBIE:a.isMoveModel=!0,t.createShortZombieEnemy(i,a,a.logicPos);break;case d.ProfessionEnum.SHIELD_DEFENDER:a.isMoveModel=!0,t.createSDefenderEnemy(i,a,a.logicPos);break;case d.ProfessionEnum.SHARKER:a.isMoveModel=!0,t.createSharker(i,a,a.logicPos)}this.turnedEnemyCount++,c.friendDatas.push(a),M.SpecailSkill.createSkillEffectInEnemy(d.SkillTypeEnum.TURN_HEART,k.PlayerState.playerData,a),t.bindEnemyBody(i,n,e,a,!1)}}},U.createPlayerFriendSharker=function(){var e,t,a,n,o,i=c.instance;null==i||null!=(n=k.PlayerState.playerData)&&((e=new p.RoleData).orientation=-1,e.id=C.GameCommonUtil.uuid(),e.isPlayer=!1,e.isEnemy=!1,e.profession=d.ProfessionEnum.SHARKER,e.hp=T.GameState.endlessModel?2*R.EndlessModelConfigData.getEndlessEnemyAtk(T.GameState.currentPart):2*u.ConfigData.getEnemyAtk(T.GameState.currentChapter,e,T.GameState.heroModel),o=A.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.SHAKER_SPRINT),o=Math.min(1,o),e.atk=Math.round(n.atk*o),e.isMoveModel=!0,t=Math.random()<.7?cc.v2(-700,h.Util.getRandomFloatNum(u.ConfigData.longEnemyMinPosY-30,u.ConfigData.longEnemyMaxPosY)):cc.v2(-u.ConfigData.rightGroundBornPos.x,u.ConfigData.rightGroundBornPos.y),null!=(a=i.createEnemyNode(e))&&(null==(n=i.createRoleBody(e))||null!=(o=c.createRoleHead(e))&&(i.createSharker(a,e,t),i.bindEnemyBody(a,n,o,e,!0),c.friendDatas.push(e))))},U.reviveEnemy=function(e,t){var a=c.instance;if(null!=a){if(t)return e.isBoss?this.bossAlive=!0:(this.killEnemyCount--,a.currentEnemyCount++),_.EffectCreate.createReviveEffect(e),void(e.isReviving=!0);e.resetData(!0),y.WorldEventManager.triggerEvent(v.LocalWorldEventType.EnemyRevive,{roleData:e});var n=a.createEnemyNode(e);if(null!=n){var o=a.createRoleBody(e);if(null!=o&&null!=(t=c.createRoleHead(e))){switch(e.profession){case d.ProfessionEnum.LAUNCHER:a.createLongEnemy(n,e,null);break;case d.ProfessionEnum.WARRIOR:a.createShortEnemy(n,e,null);break;case d.ProfessionEnum.FIRE_WIZARD:case d.ProfessionEnum.ICE_WIZARD:a.createWizardEnemy(n,e);break;case d.ProfessionEnum.LONG_ZOMBIE:a.createLongZombieEnemy(n,e,null);break;case d.ProfessionEnum.SHORT_ZOMBIE:a.createShortZombieEnemy(n,e,null);break;case d.ProfessionEnum.FLY_HEAD_GHOST:a.createFHGEnemy(n,e);break;case d.ProfessionEnum.SHIELD_DEFENDER:a.createSDefenderEnemy(n,e,null);break;case d.ProfessionEnum.SHARKER:a.createSharker(n,e,null);break;case d.ProfessionEnum.NECROMANCER:a.createNecromancer(n,e);break;case d.ProfessionEnum.SHIELD_WIZARD:c.shieldWizard=null,a.createShieldWizard(n,e);break;case d.ProfessionEnum.ROBOT_MIXED:a.createRobotMixed(n,e,null);break;case d.ProfessionEnum.ROBOT_BURROW:a.createRobotBurrow(n,e,null);break;case d.ProfessionEnum.ROBOT_AIMED:a.createRobotAimed(n,e,null);break;case d.ProfessionEnum.FIRE_DRAGON:a.createFireDragon(n,e,null);break;case d.ProfessionEnum.ICE_DRAGON:a.createIceDragon(n,e,null);break;case d.ProfessionEnum.RUN_DRAGON:a.createRunDragon(n,e,null)}a.bindEnemyBody(n,o,t,e,!1),e.isReviving=!1}}}},U.hasEmptyPosition=function(e,t){var a=c.instance;if(null!=a){if(e<0||t<0)return!0;var n=[],o=[];if(a.longEnemyMap.forEach(function(a,i){var l=null!=a&&a.isDestroy;a=null==a,l&&o.push(i),(a||l)&&e<=i&&i<=t&&n.push(i)}),0<o.length)for(var i=0,l=o;i<l.length;i++){var r=l[i];r&&a.longEnemyMap.set(r,null)}return!(n.length<=0)}},U.getEmptyPosition=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=7);var n=c.instance;if(null!=n){var o=[],i=[];if(n.longEnemyMap.forEach(function(n,l){var r=null!=n&&(n.isDestroy||e==n);n=null==n,r&&i.push(l),(n||r)&&t<=l&&l<=a&&o.push(l)}),0<i.length)for(var l=0,r=i;l<r.length;l++){var s=r[l];s&&n.longEnemyMap.set(s,null)}if(o.length<=0)return null;var p=h.Util.getRandomNum(0,o.length-1),d=o[p];return p=u.ConfigData.longEnemyPosX[d],d=h.Util.getRandomFloatNum(u.ConfigData.longEnemyMinPosY,u.ConfigData.longEnemyMaxPosY),cc.v2(p,d)}},U.setEnemyPostionMap=function(e,t){var a=c.instance;null==a||-1!=(e=u.ConfigData.longEnemyPosX.indexOf(e))&&a.longEnemyMap.set(e,t)},U.createMaigcBallBlast=function(){var e=c.instance;if(null!=e&&null!=(e=m.GameCommonPool.requestInstant(e.magicBallBlastPrefab)))return e},U.instance=null,U.totalEnemyCount=0,U.killEnemyCount=0,U.bossAlive=!1,U.turnedEnemyCount=0,U.enemyDataArray=null,U.necromancer=null,U.shieldWizard=null,U.reviveReady=!1,U.friendDatas=[],__decorate([i({displayName:"\u654c\u4eba\u914d\u7f6e",type:L})],U.prototype,"enemyInfoArray",void 0),__decorate([i({displayName:"boss\u914d\u7f6e",type:o})],U.prototype,"bossInfoArray",void 0),__decorate([i({displayName:"\u9b54\u6cd5\u7403\u7206\u70b8\u7279\u6548",type:cc.Prefab})],U.prototype,"magicBallBlastPrefab",void 0),G=c=__decorate([G],U),l.EnemyArea=G,cc._RF.pop()},{}],EnemyShield:[function(e,t,a){"use strict";cc._RF.push(t,"39469gSwhtIWKdGtftkqi+/","EnemyShield");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("LocalSoundManager"),d=n("GameState");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.shieldNode=null,e.breakAnimation=null,e.collider=null,e.shield2=null,e.shield3=null,e.shield4=null,e.roleData=null,e.isClose=!1,e.duration=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){this.shieldNode.active=!0,this.collider.enabled=!0,this.isClose=!1,this.breakAnimation.stop(),this.playAnimation(),s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.NextPart,this.close,this)},u.prototype.onDisable=function(){this.breakAnimation.off("finished",this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.NextPart,this.close,this)},u.prototype.update=function(e){null!=this.roleData&&(this.roleData.isTeleporting?this.node.opacity=0:this.node.opacity=255,this.roleData.isDead||!this.roleData.hasEnemyShield||this.roleData.isBoss&&0<this.duration&&(this.duration-=e,this.duration<=0)?this.breaking():this.roleData.isBoss?this.node.position=this.roleData.logicPos.add(cc.v2(-16,175)):this.node.position=this.roleData.logicPos.add(cc.v2(0,15)))},u.prototype.bindData=function(e){null!=e&&(this.roleData=e,this.roleData.hasEnemyShield=!0,this.breakAnimation.on("finished",this.close,this),this.roleData.isBoss?(this.node.scale=4,this.duration=d.GameState.heroModel?5:3):(this.node.scale=1,this.duration=0))},u.prototype.breaking=function(){this.isClose||(this.isClose=!0,this.roleData.hasEnemyShield=!1,this.collider.enabled=!1,this.shieldNode.active=!1,p.LocalSoundManager.playAudio("sheildBroke"),this.breakAnimation.play("EnemyShield"))},u.prototype.playAnimation=function(){var e=this;p.LocalSoundManager.playAudio("revive"),this.node.scale=0,this.node.stopAllActions(),this.node.runAction(cc.scaleTo(.2,this.roleData.isBoss?4:1)),this.shield2.stopAllActions(),this.shield3.stopAllActions(),this.shield4.stopAllActions(),this.shield4.opacity=0,this.shield4.scale=.1,this.shield2.runAction(cc.repeatForever(cc.rotateBy(1,60))),this.shield3.runAction(cc.repeatForever(cc.rotateBy(1,-60))),this.shield4.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.sequence(cc.fadeTo(.3,120),cc.fadeOut(.7)),cc.scaleTo(1,1)),cc.callFunc(function(){e.shield4.opacity=0,e.shield4.scale=.1}),cc.delayTime(.5))))},u.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u9632\u62a4\u7f69\u8282\u70b9",type:cc.Node})],u.prototype,"shieldNode",void 0),__decorate([o({displayName:"\u7834\u788e\u52a8\u753b\u8282\u70b9",type:cc.Animation})],u.prototype,"breakAnimation",void 0),__decorate([o({displayName:"\u78b0\u649e\u76d2",type:cc.CircleCollider})],u.prototype,"collider",void 0),__decorate([o({displayName:"\u9632\u62a4\u7f692",type:cc.Node})],u.prototype,"shield2",void 0),__decorate([o({displayName:"\u9632\u62a4\u7f693",type:cc.Node})],u.prototype,"shield3",void 0),__decorate([o({displayName:"\u9632\u62a4\u7f694",type:cc.Node})],u.prototype,"shield4",void 0),n=__decorate([n],u),i.EnemyShield=n,cc._RF.pop()},{}],EnumAndConst:[function(e,t,a){"use strict";cc._RF.push(t,"c82ffOia0JE8KSh+6S6EDqy","EnumAndConst");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),(n=o.BattleNodeEnum||(o.BattleNodeEnum={}))[n.ROLE_SPINE_NODE=0]="ROLE_SPINE_NODE",n[n.BOSS_SPINE_NODE=1]="BOSS_SPINE_NODE",n[n.FOOT_REST_NODE=2]="FOOT_REST_NODE",n[n.ROLE_HEAD_NODE=3]="ROLE_HEAD_NODE",n[n.HELMET_NODE=4]="HELMET_NODE",n[n.SHIRLD_NODE=5]="SHIRLD_NODE",n[n.ROLE_BODY_NODE=6]="ROLE_BODY_NODE",n[n.ARROW_NODE=7]="ARROW_NODE",n[n.SWORD_NODE=8]="SWORD_NODE",n[n.EFFECT_NODE=9]="EFFECT_NODE",n[n.PARTICLE_NODE=10]="PARTICLE_NODE",n[n.Long_Z_NODE=11]="Long_Z_NODE",n[n.SHORT_Z_NODE=12]="SHORT_Z_NODE",n[n.FHG_NODE=13]="FHG_NODE",n[n.BATTLE_NUM_NODE=14]="BATTLE_NUM_NODE",n[n.SHARKER_NODE=15]="SHARKER_NODE",n[n.NECROMANCER_NODE=16]="NECROMANCER_NODE",n[n.SHIELD_WIZARD_NODE=17]="SHIELD_WIZARD_NODE",n[n.BOTTOM_EFFECT_NODE=18]="BOTTOM_EFFECT_NODE",n[n.ROBOT_MIXED_NODE=19]="ROBOT_MIXED_NODE",n[n.ROBOT_BURROW_NODE=20]="ROBOT_BURROW_NODE",n[n.ROBOT_AIMED_NODE=21]="ROBOT_AIMED_NODE",n[n.FLY_DRAGON_NODE=22]="FLY_DRAGON_NODE",n[n.RUN_DRAGON_NODE=23]="RUN_DRAGON_NODE",(n=o.BattleNumTypeEnum||(o.BattleNumTypeEnum={})).HP_UP="\u56de\u8840",n.HP_REDUCE="\u6263\u8840",n.EQUIPMENT_UP="\u88c5\u5907\u4fee\u590d",n.EQUIPMENT_REDUCE="\u524a\u51cf\u62a4\u7532",n.HEAD_SHOOT="\u7206\u5934",n.SECKILL="\u79d2\u6740",n.BROKE_EQUIPMENT="\u7834\u7532",n.CRIT="\u66b4\u51fb",n.ABSORB="\u5438\u6536",n.HEAD_SHOOT_CRIT="\u7206\u5934\u66b4\u51fb",(n=o.BoneNameEnum||(o.BoneNameEnum={})).WEAPON="WP",n.HEAD="HEAD2",n.SHIELD="SHIELD",n.BODY="BODY",n.ARM_R_TOP="ARM_R_TOP",n.ARM_L_TOP="ARM_L_TOP",n.LEG_L_TOP="LEG_L_TOP",n.LEG_R_TOP="LEG_R_TOP",n.ARM_L_BELOW="ARM_L_BELOW",n.ARM_R_BELOW="ARM_R_BELOW",n.CENTER="bone",n.MAGIC_E_M="MAGIC_E_M",n.CLOAK="BODY2",n.F_N_PLUS_L="F_N_PLUS_L",n.F_N_PLUS_R="F_N_PLUS_R",n.Rotate="Rotate",(n=o.LaunchWeaponTypeEnum||(o.LaunchWeaponTypeEnum={})).ROTATE="\u65cb\u8f6c\u7c7b\u578b",n.SHOOT="\u76f4\u5c04\u7c7b\u578b",(n=o.ProfessionEnum||(o.ProfessionEnum={}))[n.LAUNCHER=0]="LAUNCHER",n[n.WARRIOR=1]="WARRIOR",n[n.ICE_WIZARD=2]="ICE_WIZARD",n[n.FIRE_WIZARD=3]="FIRE_WIZARD",n[n.LONG_ZOMBIE=4]="LONG_ZOMBIE",n[n.SHORT_ZOMBIE=5]="SHORT_ZOMBIE",n[n.FLY_HEAD_GHOST=6]="FLY_HEAD_GHOST",n[n.SHIELD_DEFENDER=7]="SHIELD_DEFENDER",n[n.SHARKER=8]="SHARKER",n[n.NECROMANCER=9]="NECROMANCER",n[n.SHIELD_WIZARD=10]="SHIELD_WIZARD",n[n.ROBOT_MIXED=11]="ROBOT_MIXED",n[n.ROBOT_BURROW=12]="ROBOT_BURROW",n[n.ROBOT_AIMED=13]="ROBOT_AIMED",n[n.FIRE_DRAGON=14]="FIRE_DRAGON",n[n.ICE_DRAGON=15]="ICE_DRAGON",n[n.RUN_DRAGON=16]="RUN_DRAGON",(n=o.AttackModelTypeEnum||(o.AttackModelTypeEnum={}))[n.MELEE_ATTACK=0]="MELEE_ATTACK",n[n.LONG_RANGE_ATTACK=1]="LONG_RANGE_ATTACK",(n=o.SpineAniNameEnum||(o.SpineAniNameEnum={})).Hero_st_nwp_a="Hero_st_nwp_a",n.Hero_atk_nwp_a_lance="Hero_atk_nwp_a_lance",n.Hero_st="Hero_st",n.Melee_cut="Melee_cut",n.D="D",n.D2="D2",n.Fankui="Fankui",n.Run="Run",n.Run2="Run2",n.Magic_atk="Magic_atk",n.Magic_st="Magic_st",n.Win="Win",n.Ghost_atk="Ghost_atk",n.Hero_st_nh="Hero_st_nh",n.Def="Def",n.Zb_run="Zb_run",n.Zb_atk="Zb_atk",n.St="St",n.Atk="Atk",n.Atk_run="Atk_run",n.Cut="Cut",n.Run_ug="Run_ug",n.Down="Down",n.Up="Up",n.Atk_Zuantou="Atk_Zuantou",n.Aim2="Aim2",n.Aim="Aim",n.Aim3="Aim3",n.chuxian="chuxian",n.xunhuan="xunhuan",n.xiaoshi="xiaoshi",n.Hero_atk_nwp_a_blade="Hero_atk_nwp_a_blade",(n=o.GroupNameEnum||(o.GroupNameEnum={})).HEAD="head",n.BODY="body",n.SHIELD="shield",n.ARROW="arrow",n.SWORD="sword",n.FOOT_REST="footRest",n.BLAST="blast",n.THUNDER="thund",n.WALL="wall",(n=o.SkillTypeEnum||(o.SkillTypeEnum={}))[n.DIVISION=0]="DIVISION",n[n.BLAST=1]="BLAST",n[n.IGNITE=2]="IGNITE",n[n.FROZEN=3]="FROZEN",n[n.THUNDER=4]="THUNDER",n[n.CATAPULT=5]="CATAPULT",n[n.FAST_ATTACK=6]="FAST_ATTACK",n[n.SUKBLOOD=7]="SUKBLOOD",n[n.PENETRATE=8]="PENETRATE",n[n.RUNNINGFIRE=9]="RUNNINGFIRE",n[n.SECKILL=10]="SECKILL",n[n.SHIELD_UP=11]="SHIELD_UP",n[n.HP_UP=12]="HP_UP",n[n.MAX_HP_UP=13]="MAX_HP_UP",n[n.HELMET_UP=14]="HELMET_UP",n[n.DAMAGE_UP=15]="DAMAGE_UP",n[n.REPEL=16]="REPEL",n[n.CRIT=17]="CRIT",n[n.REBOUND=18]="REBOUND",n[n.STEAL=19]="STEAL",n[n.WEAPON_BIG=20]="WEAPON_BIG",n[n.REVIVE_HALO=21]="REVIVE_HALO",n[n.DODGE=22]="DODGE",n[n.THORNS_CHAINS=23]="THORNS_CHAINS",n[n.DIVINE_SHIELD=24]="DIVINE_SHIELD",n[n.EMERGENCY_EQUIPMENT=25]="EMERGENCY_EQUIPMENT",n[n.TURN_HEART=26]="TURN_HEART",n[n.THUNDERBOLT=27]="THUNDERBOLT",n[n.SHAKER_SPRINT=28]="SHAKER_SPRINT",n[n.SPOTTING_ARROW=29]="SPOTTING_ARROW",n[n.FURY=30]="FURY",n[n.LIFE_MEACHINE=31]="LIFE_MEACHINE",n[n.INSPIRE_WALL=32]="INSPIRE_WALL",n[n.SMART_ARROW=33]="SMART_ARROW",(n=o.StrengthenTypeEnum||(o.StrengthenTypeEnum={})).HP_STRONGER="\u751f\u547d\u503c\u4e0a\u9650\u63d0\u5347",n.ATk_STRONGER="\u653b\u51fb\u529b\u63d0\u5347",(n=o.ArrowStateEnum||(o.ArrowStateEnum={})).HOLDING="\u624b\u6301",n.WAITING="\u7b49\u5f85\u53d1\u5c04",n.LAUNCHING="\u53d1\u5c04",n.REBOUNDING="\u53cd\u5f39",n.INSERTING="\u63d2\u5165",(n=o.RewardTypeEnum||(o.RewardTypeEnum={}))[n.COIN=1]="COIN",n[n.GEM=2]="GEM",n[n.EQUIPMENT=3]="EQUIPMENT",(n=o.RandomIncidentTypeEnum||(o.RandomIncidentTypeEnum={}))[n.ANGEL=0]="ANGEL",n[n.DEMON=1]="DEMON",n[n.RECLUSE=2]="RECLUSE",n[n.PROFITEER=3]="PROFITEER",n[n.NEWRECLUSE=4]="NEWRECLUSE",o.RewardData=function(){this.rewardType=null,this.equipmentData=null,this.rewardCount=1},(n=o.ShieldDefenderState||(o.ShieldDefenderState={})).DEFENDING="\u9632\u5fa1",n.FALLING="\u4e0b\u843d",n.MOVING="\u79fb\u52a8",(n=o.AimDirectionEnum||(o.AimDirectionEnum={})).RIGHT="\u5411\u53f3",n.LEFT="\u5411\u5de6",(n=o.sectType||(o.sectType={}))[n.recoveryAndBeatBackSect=0]="recoveryAndBeatBackSect",n[n.ummonSect=1]="ummonSect",n[n.berserkSect=2]="berserkSect",n[n.fireSuppressionSect=3]="fireSuppressionSect",(n=o.gameFailUIType||(o.gameFailUIType={}))[n.needNotPop=0]="needNotPop",n[n.PopShop=1]="PopShop",n[n.PopEquip=2]="PopEquip",(n=o.InheritTypeEnum||(o.InheritTypeEnum={}))[n.SKILL=0]="SKILL",n[n.ATK=1]="ATK",n[n.MAX_HP=2]="MAX_HP",n[n.MAX_HELMET_DEFENSE=3]="MAX_HELMET_DEFENSE",n[n.MAX_SHIELD_DEFENSE=4]="MAX_SHIELD_DEFENSE",n[n.RESTORE=5]="RESTORE",(o=o.OpenDataKeyEnum||(o.OpenDataKeyEnum={})).PART="part",o.ENDLESS_PART="endless_part",cc._RF.pop()},{}],EquipmentCombineUI:[function(e,t,a){"use strict";cc._RF.push(t,"3b3c3Q+OsVPWaE4e4oaehk4","EquipmentCombineUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EquipmentItem"),s=n("GameCommonPool"),c=n("ConfigData"),p=n("EquipmentListUI"),d=n("UIManager"),u=n("LocalSoundManager"),h=n("WorldEventManager"),m=n("LocalWorldEventType");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.combineResult=null,e.equipmentItems=[],e.bgCircle=null,e.shareBtn=null,e.rankEffectAni=null,e.isAwaken=!1,e.result=null,e.combineFinish=!1,e.newEquipmentGet=!1,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),f.prototype.onEnable=function(){this.shareBtn.active=!1,this.combineFinish=!1},f.prototype.bindData=function(e,t,a,n){if(null!=this.rankEffectAni&&(this.rankEffectAni.node.active=!1),null==e||e.length<1||null==t)this.close();else{this.newEquipmentGet=a,4==t.rank?this.isAwaken=!0:this.isAwaken=!1,this.closeAction=n;for(var o=c.ConfigData.upgradeEquipmentNeedCount,i=0;i<o;i++){var l=this.equipmentItems[i];null!=l&&(i>c.ConfigData.upgradeEquipmentNeedCount||l.bindData(e[i],!1,!1,!1,!1),l.node.active=!1)}this.combineResult.bindData(t,!1,!1,!1,!0),this.combineResult.node.active=!1,this.result=t,a?this.resultAnimation(t):this.combineAnimation(t)}},f.prototype.combineAnimation=function(e){var t=this;this.bgCircle.opacity=0,this.bgCircle.angle=0,this.combineResult.node.opacity=0,this.equipmentItems[0].node.active=!0,this.equipmentItems[0].node.stopAllActions(),this.equipmentItems[0].node.position=cc.v2(-180,-30),this.equipmentItems[0].node.scale=1.5,this.equipmentItems[0].node.runAction(cc.sequence(cc.scaleTo(.2,1.8),cc.scaleTo(.2,1),cc.scaleTo(.1,1.5),cc.delayTime(.3),cc.spawn(cc.moveTo(.2,0,0),cc.scaleTo(.2,.1)),cc.callFunc(function(){t.equipmentItems[0].node.active=!1}))),this.equipmentItems[1].node.active=!0,this.equipmentItems[1].node.stopAllActions(),this.equipmentItems[1].node.position=cc.v2(0,170),this.equipmentItems[1].node.scale=1.5,this.equipmentItems[1].node.runAction(cc.sequence(cc.delayTime(.1),cc.scaleTo(.2,1.8),cc.scaleTo(.2,1),cc.scaleTo(.1,1.5),cc.delayTime(.3),cc.spawn(cc.moveTo(.2,0,0),cc.scaleTo(.2,.1)),cc.callFunc(function(){t.equipmentItems[1].node.active=!1}))),this.equipmentItems[2].node.active=!0,this.equipmentItems[2].node.stopAllActions(),this.equipmentItems[2].node.position=cc.v2(180,-30),this.equipmentItems[2].node.scale=1.5,this.equipmentItems[2].node.runAction(cc.sequence(cc.delayTime(.2),cc.scaleTo(.2,1.8),cc.scaleTo(.2,1),cc.scaleTo(.1,1.5),cc.delayTime(.3),cc.spawn(cc.moveTo(.2,0,0),cc.scaleTo(.2,.1)),cc.callFunc(function(){t.equipmentItems[2].node.active=!1,t.combineResult.node.opacity=255,t.resultAnimation(e)})))},f.prototype.resultAnimation=function(e){if(this.combineFinish=!0,null==this.rankEffectAni){var t=d.UIManager.createEquipmentRankSpecialEffect();if(null==t)return;t.node.setParent(this.node),t.node.setPosition(cc.Vec2.ZERO),this.rankEffectAni=t}this.rankEffectAni.node.active=!1,(!this.newEquipmentGet||this.newEquipmentGet&&1<this.result.rank)&&u.LocalSoundManager.playAudio("equipment"),null!=e&&6==e.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect3")),null!=e&&5==e.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect2")),null!=e&&4==e.rank&&(this.rankEffectAni.node.active=!0,this.rankEffectAni.play("EquipmentRankEffect1")),this.bgCircle.opacity=255,this.bgCircle.stopAllActions(),this.bgCircle.runAction(cc.repeatForever(cc.rotateBy(3,360))),this.combineResult.node.active=!0,this.combineResult.node.opacity=255,this.combineResult.node.stopAllActions(),this.combineResult.node.position=cc.v2(0,0),this.combineResult.node.scale=.1,this.combineResult.node.runAction(cc.scaleTo(.2,1.5)),null!=e&&3<=e.rank&&(this.shareBtn.active=!0)},f.prototype.clickJump=function(){if(this.newEquipmentGet)return d.UIManager.showEquipmentPop(this.result,this.closeAction),this.closeAction=null,void this.close();if(null==this.result||this.result.rank<3||this.combineFinish)return this.close(),void p.EquipmentListUI.combine();for(var e=0,t=this.equipmentItems;e<t.length;e++){var a=t[e];null!=a&&null!=a.node&&(a.node.active=!1)}this.combineResult.node.opacity=255,this.resultAnimation(this.result)},f.prototype.close=function(){this.isAwaken&&h.WorldEventManager.triggerEvent(m.LocalWorldEventType.ShowBubble,{type:4}),s.GameCommonPool.returnInstant(this.node)},f.prototype.clickShare=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)try{wx.shareAppMessage({title:"\u5feb\u770b\uff01\u6211\u7ec8\u4e8e\u5408\u6210\u4e86\u8fd9\u4ef6\u65e0\u654c\u7684\u795e\u5668\uff01",imageUrl:canvas.toTempFilePathSync({x:(canvas.width-.55*canvas.height)/2,y:.28*canvas.height,width:.55*canvas.height,height:.44*canvas.height,destWidth:500,destHeight:400})})}catch(n){console.error(n)}},__decorate([o({displayName:"\u5408\u6210\u7ed3\u679citem",type:r.EquipmentItem})],f.prototype,"combineResult",void 0),__decorate([o({displayName:"\u5408\u6210\u7d20\u6750item\u96c6\u5408",type:r.EquipmentItem})],f.prototype,"equipmentItems",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f\u5149\u5708"})],f.prototype,"bgCircle",void 0),__decorate([o({type:cc.Node,displayName:"\u5206\u4eab\u6309\u94ae"})],f.prototype,"shareBtn",void 0),n=__decorate([n],f),i.EquipmentCombineUI=n,cc._RF.pop()},{}],EquipmentConfigData:[function(e,t,a){"use strict";cc._RF.push(t,"b2e4eO5pfdKzL6aWrUD9l/A","EquipmentConfigData");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.helmetConfigDatas=[{anchorX:.45,anchorY:.4,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.47,anchorY:.4,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.47,anchorY:.37,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.45,anchorY:.37,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.48,anchorY:.39,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.42,anchorY:.35,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.43,anchorY:.37,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.45,anchorY:.39,hasEffect:!1,effectAnchorX:null,effectAnchorY:null}],o.awakeningHelmetConfigDatas=[{anchorX:.5,anchorY:.4,hasEffect:!1,effectAnchorX:-.04,effectAnchorY:.21},{anchorX:.49,anchorY:.41,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.48,anchorY:.39,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.49,anchorY:.43,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.49,anchorY:.43,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.47,anchorY:.39,hasEffect:!1,effectAnchorX:null,effectAnchorY:null},{anchorX:.41,anchorY:.33,hasEffect:!0,effectAnchorX:-.04,effectAnchorY:.21},{anchorX:.4,anchorY:.32,hasEffect:!1,effectAnchorX:null,effectAnchorY:null}],n.EquipmentConfigData=o,n.HelmetConfig=function(){this.anchorX=null,this.anchorY=null,this.hasEffect=!1,this.effectAnchorX=null,this.effectAnchorY=null},cc._RF.pop()},{}],EquipmentEffectSystem:[function(e,t,a){"use strict";cc._RF.push(t,"50090TgisNLLrjIEkIeAgFC","EquipmentEffectSystem");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("SkillSystem"),l=n("GameConfigData"),r=n("EnumAndConst"),s=n("ConfigData"),c=n("LocalData"),p=n("PlayerState");function d(){}d.getEquipmentEffect=function(e,t,a,n){this.currentShieldEffectData=[],this.currentWeaponEffectData=[],this.currentHelmetEffectData=[],this.currentCloakEffectData=[],this.getWeaponEffect(null==e?null:e.index,null==e?null:e.rank),this.getShieldEffect(null==a?null:a.index,null==a?null:a.rank),this.getHelmetEffect(null==t?null:t.index,null==t?null:t.rank),this.getCloakEffect(null==n?null:n.index,null==n?null:n.rank)},d.getWeaponEffect=function(e,t){if(null!=e&&null!=t){if(e=l.GameConfigData.data.weaponEffectIndex[e],5<=t)return this.getAtkEffect(e[0],2),this.getAtkEffect(e[1],1),void this.getAtkEffect(e[2],1);2<=t&&this.getAtkEffect(e[0],1),3<=t&&this.getAtkEffect(e[1],1),4<=t&&this.getAtkEffect(e[2],1)}},d.getShieldEffect=function(e,t){if(null!=e&&null!=t&&!(null==(e=l.GameConfigData.data.shieldEffectIndex[e])||e.length<3)){if(5<=t)return this.getShieldDefenseEffect(e[0],2),this.getShieldDefenseEffect(e[1],1),void this.getShieldDefenseEffect(e[2],1);2<=t&&this.getShieldDefenseEffect(e[0],1),3<=t&&this.getShieldDefenseEffect(e[1],1),4<=t&&this.getShieldDefenseEffect(e[2],1)}},d.getHelmetEffect=function(e,t){if(null!=e&&null!=t){if(e=l.GameConfigData.data.helmetEffectIndex[e],5<=t)return this.getHelmetDefenseEffect(e[0],2),this.getHelmetDefenseEffect(e[1],1),void this.getHelmetDefenseEffect(e[2],1);2<=t&&this.getHelmetDefenseEffect(e[0],1),3<=t&&this.getHelmetDefenseEffect(e[1],1),4<=t&&this.getHelmetDefenseEffect(e[2],1)}},d.getCloakEffect=function(e,t){null!=e&&(e=l.GameConfigData.data.colakEffectIndex[e],4<=t&&this.getCloakAllEffect(e[0]),5<=t&&this.getCloakAllEffect(e[1]))},d.getAtkEffect=function(e,t){switch(void 0===t&&(t=1),null==this.currentWeaponEffectData[e]&&(this.currentWeaponEffectData[e]=0),this.currentWeaponEffectData[e]=l.GameConfigData.data.weaponEffectData[e]*t,e){case 0:i.SkillSystem.equipEquipmentSkill(7),2==t&&i.SkillSystem.equipEquipmentSkill(7);break;case 3:i.SkillSystem.equipEquipmentSkill(2),2==t&&i.SkillSystem.equipEquipmentSkill(2);break;case 4:i.SkillSystem.equipEquipmentSkill(4),2==t&&i.SkillSystem.equipEquipmentSkill(4);break;case 6:i.SkillSystem.equipEquipmentSkill(10),2==t&&i.SkillSystem.equipEquipmentSkill(10);break;case 7:i.SkillSystem.equipEquipmentSkill(17),2==t&&i.SkillSystem.equipEquipmentSkill(17);break;case 10:i.SkillSystem.equipEquipmentSkill(8),2==t&&i.SkillSystem.equipEquipmentSkill(8);break;case 11:i.SkillSystem.equipEquipmentSkill(16),2==t&&i.SkillSystem.equipEquipmentSkill(16)}},d.getCloakAllEffect=function(e){switch(null==this.currentCloakEffectData[e]&&(this.currentCloakEffectData[e]=0),this.currentCloakEffectData[e]=l.GameConfigData.data.cloakEffectData[e],e){case 6:i.SkillSystem.equipEquipmentSkill(7);break;case 3:i.SkillSystem.equipEquipmentSkill(17);break;case 9:i.SkillSystem.equipEquipmentSkill(10)}},d.getShieldDefenseEffect=function(e,t){5===(void 0===t&&(t=1),null==this.currentShieldEffectData[e]&&(this.currentShieldEffectData[e]=0),this.currentShieldEffectData[e]=l.GameConfigData.data.denfenseEffectData[e]*t,e)&&(i.SkillSystem.equipEquipmentSkill(22),2==t&&i.SkillSystem.equipEquipmentSkill(22))},d.getHelmetDefenseEffect=function(e,t){5===(void 0===t&&(t=1),null==this.currentHelmetEffectData[e]&&(this.currentHelmetEffectData[e]=0),this.currentHelmetEffectData[e]=l.GameConfigData.data.denfenseEffectData[e]*t,e)&&(i.SkillSystem.equipEquipmentSkill(22),2==t&&i.SkillSystem.equipEquipmentSkill(22))},d.getAtkEffectData=function(e,t){var a=0;return t==r.AttackModelTypeEnum.MELEE_ATTACK?a+=null==d.currentWeaponEffectData[1]?0:d.currentWeaponEffectData[1]:a+=null==d.currentWeaponEffectData[2]?0:d.currentWeaponEffectData[2],s.ConfigData.isZombieProfession(e)&&(a+=null==d.currentWeaponEffectData[9]?0:d.currentWeaponEffectData[9]),s.ConfigData.isWizardProfession(e)&&(a+=null==d.currentWeaponEffectData[8]?0:d.currentWeaponEffectData[8]),a},d.getDefenseEffectData=function(e,t){var a=(null==d.currentHelmetEffectData[9]?0:d.currentHelmetEffectData[9])+(null==d.currentShieldEffectData[9]?0:d.currentShieldEffectData[9])+(null==d.currentCloakEffectData[4]?0:d.currentCloakEffectData[4]),n=0;return t==r.AttackModelTypeEnum.MELEE_ATTACK?n+=(null==d.currentHelmetEffectData[1]?0:d.currentHelmetEffectData[1])+(null==d.currentShieldEffectData[1]?0:d.currentShieldEffectData[1])+(null==d.currentCloakEffectData[5]?0:d.currentCloakEffectData[5]):n+=(null==d.currentHelmetEffectData[2]?0:d.currentHelmetEffectData[2])+(null==d.currentShieldEffectData[2]?0:d.currentShieldEffectData[2])+(null==d.currentCloakEffectData[8]?0:d.currentCloakEffectData[8]),s.ConfigData.isZombieProfession(e)&&(n+=(null==d.currentHelmetEffectData[8]?0:d.currentHelmetEffectData[8])+(null==d.currentShieldEffectData[8]?0:d.currentShieldEffectData[8])),s.ConfigData.isWizardProfession(e)&&(n+=(null==d.currentHelmetEffectData[7]?0:d.currentHelmetEffectData[7])+(null==d.currentShieldEffectData[7]?0:d.currentShieldEffectData[7])),a+n},d.killEnemyRestore=function(e){var t,a;null!=e&&e.isPlayer&&(a=null==d.currentShieldEffectData[0]?0:d.currentShieldEffectData[0],Math.random()<a&&0<e.shieldDefense&&(t=.05*e.maxShieldDefense,p.PlayerState.player.repairEquipment(c.EquipmentType.shield,t)),a=null==d.currentHelmetEffectData[0]?0:d.currentHelmetEffectData[0],Math.random()<a&&0<e.helmetDefense&&(t=.05*e.maxHelmetDefense,p.PlayerState.player.repairEquipment(c.EquipmentType.helmet,t)))},d.currentWeaponEffectData=[],d.currentShieldEffectData=[],d.currentHelmetEffectData=[],d.currentCloakEffectData=[],n=d,o.EquipmentEffectSystem=n,cc._RF.pop()},{}],EquipmentItem:[function(e,t,a){"use strict";cc._RF.push(t,"e511017d9JBFYv0H4NCr3br","EquipmentItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SpriteFrameManager"),s=n("LocalData"),c=n("UIManager"),p=n("WorldEventManager"),d=n("LocalWorldEventType"),u=n("ConfigData"),h=n("NumberImg"),m=n("GameCommonPool"),f=n("LocalSoundManager");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.equipmentSprite=null,e.rankSprite=null,e.levelNum=null,e.equipBtnSprite=null,e.equipmentTip=null,e.equipmentRankEffectNode=null,e.buttonMask=null,e.upgradeTipNode=null,e.equipmentRankEffect=null,e.equipmentIndex=null,e.equipmentType=null,e.lastEquipmentData=null,e.isInList=!1,e.isShowMaxLevel=!1,e.isButton=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.onEnable=function(){p.WorldEventManager.addListener(d.LocalWorldEventType.ChangeEquipment,this.equip,this),p.WorldEventManager.addListener(d.LocalWorldEventType.UpgradeEquipment,this.updateData,this),this.ShowUpgradeTip()},g.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.ChangeEquipment,this.equip,this),p.WorldEventManager.removeListener(d.LocalWorldEventType.UpgradeEquipment,this.updateData,this),null!=this.lastEquipmentData&&this.isInList&&(this.lastEquipmentData.isNew=!1),null!=this.upgradeTipNode&&(this.upgradeTipNode.active=!1)},g.prototype.bindData=function(e,t,a,n,o){if(null!=this.equipmentRankEffect&&(m.GameCommonPool.returnInstant(this.equipmentRankEffect.node),this.equipmentRankEffect=null),null==e)return this.equipmentSprite.spriteFrame=null,this.rankSprite.spriteFrame=null,this.levelNum.value="",this.equipBtnSprite.active=!1,void(this.equipmentTip.active=!1);if(null!=this.lastEquipmentData&&this.lastEquipmentData!=e&&t&&(this.lastEquipmentData.isNew=!1),this.lastEquipmentData=e,this.isInList=t,this.isShowMaxLevel=a,this.buttonMask.active=!n,e.level>5*u.ConfigData.maxEquipmentRank&&(e.level=5*u.ConfigData.maxEquipmentRank),e.rank>u.ConfigData.maxEquipmentRank&&(e.rank=u.ConfigData.maxEquipmentRank),this.updateData(e),o){if(null==this.equipmentRankEffect){if(null==(o=c.UIManager.createEquipmentRankNormalEffect()))return;o.node.setParent(this.equipmentRankEffectNode),o.node.setPosition(cc.Vec2.ZERO),this.equipmentRankEffect=o}this.equipmentRankEffect.node.active=!0,this.equipmentRankEffect.bindData(e.rank,1.15)}this.isButton=n,this.ShowUpgradeTip()},g.prototype.updateData=function(e){if(this.lastEquipmentData==e){this.lastEquipmentData=e;var t=this.lastEquipmentData.rank,a=this.lastEquipmentData.level;if(this.rankSprite.spriteFrame=r.SpriteFrameManager.getEquipmentRankSpriteFrame(t-1),this.isShowMaxLevel?this.levelNum.value=e.type==s.EquipmentType.cloak?"lv"+a+"/"+5*(t-3):"lv"+a+"/"+5*t:this.levelNum.value="lv."+a,this.equipmentSprite.node.y=-4,this.equipmentType=this.lastEquipmentData.type,this.equipmentIndex=this.lastEquipmentData.index,this.equipmentType==s.EquipmentType.weapon?(this.equipmentSprite.spriteFrame=r.SpriteFrameManager.getLaunchWeaponSpriteFrame(this.equipmentIndex,t),5==this.equipmentIndex?this.equipmentSprite.node.scale=.5:this.equipmentSprite.node.scale=.28,this.equipmentSprite.node.angle=-45):this.equipmentType==s.EquipmentType.helmet?(this.equipmentSprite.spriteFrame=r.SpriteFrameManager.getHelmetSpriteFrame(this.equipmentIndex,t),this.equipmentSprite.node.scale=.5,0==this.equipmentIndex&&4<=t&&(this.equipmentSprite.node.scale=.4),5==this.equipmentIndex&&4<=t&&(this.equipmentSprite.node.scale=.4),this.equipmentSprite.node.angle=0):this.equipmentType==s.EquipmentType.shield?(this.equipmentSprite.spriteFrame=r.SpriteFrameManager.getShieldSpriteFrame(this.equipmentIndex,t),0==this.equipmentIndex&&t<4?this.equipmentSprite.node.scale=.5:this.equipmentSprite.node.scale=.3,5==this.equipmentIndex&&4<=t&&(this.equipmentSprite.node.y=-15),this.equipmentSprite.node.angle=-45):this.equipmentType==s.EquipmentType.cloak&&(this.equipmentSprite.spriteFrame=r.SpriteFrameManager.getCloakSpriteFrame(this.equipmentIndex),this.equipmentSprite.node.scaleX=-.3,this.equipmentSprite.node.scaleY=.3,this.equipmentSprite.node.angle=0),!this.isInList)return this.equipBtnSprite.active=!1,void(this.equipmentTip.active=!1);this.equipBtnSprite.active=this.lastEquipmentData.equipped,this.equipmentTip.active=e.isNew,this.ShowUpgradeTip()}},g.prototype.equip=function(){this.isInList&&(this.lastEquipmentData.equipped?this.equipBtnSprite.active=!0:this.equipBtnSprite.active=!1,this.ShowUpgradeTip())},g.prototype.clickSelect=function(){f.LocalSoundManager.playAudio("click"),c.UIManager.showEquipmentPop(this.lastEquipmentData,null)},g.prototype.ShowUpgradeTip=function(){var e=this.lastEquipmentData;null!=e&&(this.isShowMaxLevel||this.isButton&&null!=this.upgradeTipNode&&(e.equipped?e.type==s.EquipmentType.cloak?e.level<5*(e.rank-3)?this.upgradeTipNode.active=!0:this.upgradeTipNode.active=!1:e.level<5*e.rank?this.upgradeTipNode.active=!0:this.upgradeTipNode.active=!1:this.upgradeTipNode.active=!1))},__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u56fe\u7247"})],g.prototype,"equipmentSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u7b49\u7ea7\u56fe\u7247"})],g.prototype,"rankSprite",void 0),__decorate([o({type:h.NumberImg,displayName:"\u7b49\u7ea7"})],g.prototype,"levelNum",void 0),__decorate([o({type:cc.Node,displayName:"\u5df2\u88c5\u5907\u6309\u94ae\u56fe\u7247"})],g.prototype,"equipBtnSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u88c5\u5907\u63d0\u793a"})],g.prototype,"equipmentTip",void 0),__decorate([o({displayName:"\u88c5\u5907\u54c1\u7ea7\u7279\u6548\u8282\u70b9",type:cc.Node})],g.prototype,"equipmentRankEffectNode",void 0),__decorate([o({displayName:"\u6309\u94ae\u906e\u7f69",type:cc.Node})],g.prototype,"buttonMask",void 0),__decorate([o({displayName:"\u5347\u7ea7\u63d0\u793a",type:cc.Node})],g.prototype,"upgradeTipNode",void 0),n=__decorate([n],g),i.EquipmentItem=n,cc._RF.pop()},{}],EquipmentListUI:[function(e,t,a){"use strict";cc._RF.push(t,"cff31hGL4VK+pdlMv1SoCZg","EquipmentListUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("LocalData"),c=n("ConfigData"),p=n("MainUI"),d=n("LocalSoundManager"),u=n("UIManager"),h=n("LocalWorldEventType"),m=n("WorldEventManager");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.equipmentSelectBg=null,e.equipmentContent=null,e.weaponBtn=null,e.weaponBtnSprite=[],e.helmetBtn=null,e.helmetBtnSprite=[],e.shieldBtn=null,e.shieldBtnSprite=[],e.cloakBtn=null,e.cloakBtnSprite=[],e.weaponTip=null,e.helmetTip=null,e.shieldTip=null,e.cloakTip=null,e.equipmentItems=[],e.currentEquipmentType=0,e.lastSelectEquipmentType=null,e.lastData=null,e.noCombine=!1,e.weaponLooked=!0,e.helmetLooked=!0,e.shieldLooked=!0,e.cloakLooked=!0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),(r=f).prototype.onLoad=function(){r.instance=this},f.prototype.onEnable=function(){this.equipmentSelectBg.position=cc.v2(0,-1e3),this.equipmentSelectBg.stopAllActions(),this.equipmentSelectBg.runAction(cc.sequence(cc.moveTo(.4,0,20),cc.moveTo(.1,0,-20),cc.moveTo(.1,0,0))),this.lastSelectEquipmentType=null,this.autoCombine(this.currentEquipmentType),this.createListItem(this.currentEquipmentType),m.WorldEventManager.addListener(h.LocalWorldEventType.SellEquipment,this.refresh,this)},f.prototype.onDisable=function(){m.WorldEventManager.removeListener(h.LocalWorldEventType.SellEquipment,this.refresh,this),this.weaponLooked&&this.helmetLooked&&this.shieldLooked&&this.cloakLooked&&(p.MainUI.instance.equipmentTip.active=!1)},f.prototype.update=function(){this.weaponTip.active||this.helmetTip.active||this.shieldTip.active||this.cloakTip.active?p.MainUI.instance.equipmentTip.active=!0:p.MainUI.instance.equipmentTip.active=!1},f.prototype.refresh=function(){this.createListItem(this.currentEquipmentType)},f.combine=function(){var e=r.instance;null!=e&&(e.autoCombine(e.currentEquipmentType),e.createListItem(e.currentEquipmentType),e.noCombine&&u.UIManager.showEquipmentPop(e.lastData,null))},f.prototype.checkTipsActive=function(){var e=r.instance;if(null!=e){e.weaponTip.active=!1,e.helmetTip.active=!1,e.shieldTip.active=!1,e.cloakTip.active=!1;for(var t=0,a=s.LocalData.data.newEquipmentDatas;t<a.length;t++){var n=a[t];if(null!=n&&(n.isNew&&(n.type==s.EquipmentType.weapon?(e.weaponTip.active=!0,e.weaponLooked=!1):n.type==s.EquipmentType.helmet?(e.helmetTip.active=!0,e.helmetLooked=!1):n.type==s.EquipmentType.shield?(e.shieldTip.active=!0,e.shieldLooked=!1):n.type==s.EquipmentType.cloak&&(e.cloakTip.active=!0,e.cloakLooked=!1)),e.weaponTip.active&&e.helmetTip.active&&e.shieldTip.active&&e.cloakTip.active))break}}},f.prototype.clickWeaponBtn=function(){this.lastSelectEquipmentType!=s.EquipmentType.weapon&&(d.LocalSoundManager.playAudio("click"),this.autoCombine(s.EquipmentType.weapon),this.createListItem(s.EquipmentType.weapon))},f.prototype.clickHelmetBtn=function(){this.lastSelectEquipmentType!=s.EquipmentType.helmet&&(d.LocalSoundManager.playAudio("click"),this.autoCombine(s.EquipmentType.helmet),this.createListItem(s.EquipmentType.helmet))},f.prototype.clickShieldBtn=function(){this.lastSelectEquipmentType!=s.EquipmentType.shield&&(d.LocalSoundManager.playAudio("click"),this.autoCombine(s.EquipmentType.shield),this.createListItem(s.EquipmentType.shield))},f.prototype.clickCloakBtn=function(){this.lastSelectEquipmentType!=s.EquipmentType.cloak&&(d.LocalSoundManager.playAudio("click"),this.autoCombine(s.EquipmentType.cloak),this.createListItem(s.EquipmentType.cloak))},f.prototype.selectEquipment=function(e){switch(this.currentEquipmentType=e,this.lastSelectEquipmentType=e,this.weaponBtn.spriteFrame=this.weaponBtnSprite[0],this.helmetBtn.spriteFrame=this.helmetBtnSprite[0],this.shieldBtn.spriteFrame=this.shieldBtnSprite[0],this.cloakBtn.spriteFrame=this.cloakBtnSprite[0],this.checkTipsActive(),this.weaponLooked&&(this.weaponTip.active=!1),this.helmetLooked&&(this.helmetTip.active=!1),this.shieldLooked&&(this.shieldTip.active=!1),this.cloakLooked&&(this.cloakTip.active=!1),e){case s.EquipmentType.weapon:this.weaponBtn.spriteFrame=this.weaponBtnSprite[1],this.weaponLooked=!0;break;case s.EquipmentType.helmet:this.helmetBtn.spriteFrame=this.helmetBtnSprite[1],this.helmetLooked=!0;break;case s.EquipmentType.shield:this.shieldBtn.spriteFrame=this.shieldBtnSprite[1],this.shieldLooked=!0;break;case s.EquipmentType.cloak:this.cloakBtn.spriteFrame=this.cloakBtnSprite[1],this.cloakLooked=!0}},f.prototype.createListItem=function(e){var t=s.LocalData.getEquipmentTotalCount(e);s.LocalData.orderEquipmentData();for(var a,n,o=s.LocalData.getEquipmentTypeData(e),i=t>this.equipmentItems.length?t:this.equipmentItems.length,l=0;l<i;l++)t<=l?null!=(n=this.equipmentItems[l])&&(n.node.active=!1):null!=(a=o[l])&&(null==(n=this.equipmentItems[l])?(n=u.UIManager.createEquipmentItem(this.equipmentContent,a,!0,!1,!0,!1),this.equipmentItems[l]=n):(n.node.active=!0,n.bindData(a,!0,!1,!0,!1)));this.selectEquipment(e)},f.prototype.autoCombine=function(e){this.noCombine=!0;var t=0;e==s.EquipmentType.weapon?t=c.ConfigData.weaponName.length:e==s.EquipmentType.helmet?t=c.ConfigData.helmetName.length:e==s.EquipmentType.shield?t=c.ConfigData.shieldName.length:e==s.EquipmentType.cloak&&(t=c.ConfigData.cloakName.length);for(var a=0;a<t;a++)for(var n=1;n<c.ConfigData.maxEquipmentRank;n++){var o=s.LocalData.getEquipmentData(e,a,n);if(null!=o&&3<=o.length)return void this.combine(o)}},f.prototype.combine=function(e){for(var t=!1,a=0,n=1,o=!1,i=[],l=0;l<e.length;l++){var r=e[l];if(null!=r&&(r.equipped&&(o=r.equipped),r.level>n&&(n=r.level),i.push(r),s.LocalData.removeEquipmentData(r),3<=++a))return this.lastData=s.LocalData.rewardEquipment(r.type,r.index,r.rank+1,n),m.WorldEventManager.triggerEvent(h.LocalWorldEventType.GetNewEquipment,null),this.lastData.equipped=o,t=t||o,u.UIManager.showEquipmentCombinePop(i,this.lastData,!1,null),t&&m.WorldEventManager.triggerEvent(h.LocalWorldEventType.ChangeEquipment,this.lastData),void(this.noCombine=!1)}},f.instance=null,__decorate([o({type:cc.Node,displayName:"\u88c5\u5907\u9009\u62e9\u80cc\u666f"})],f.prototype,"equipmentSelectBg",void 0),__decorate([o({type:cc.Node,displayName:"\u5b58\u653e\u88c5\u5907\u5bb9\u5668"})],f.prototype,"equipmentContent",void 0),__decorate([o({type:cc.Sprite,displayName:"\u6b66\u5668\u6309\u94ae"})],f.prototype,"weaponBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u6b66\u5668\u6309\u94ae\u56fe\u7247"})],f.prototype,"weaponBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5934\u76d4\u6309\u94ae"})],f.prototype,"helmetBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5934\u76d4\u6309\u94ae\u56fe\u7247"})],f.prototype,"helmetBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u76fe\u724c\u6309\u94ae"})],f.prototype,"shieldBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u76fe\u724c\u6309\u94ae\u56fe\u7247"})],f.prototype,"shieldBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u62ab\u98ce\u6309\u94ae"})],f.prototype,"cloakBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u62ab\u98ce\u6309\u94ae\u56fe\u7247"})],f.prototype,"cloakBtnSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u63d0\u793a"})],f.prototype,"weaponTip",void 0),__decorate([o({type:cc.Node,displayName:"\u5934\u76d4\u63d0\u793a"})],f.prototype,"helmetTip",void 0),__decorate([o({type:cc.Node,displayName:"\u76fe\u724c\u63d0\u793a"})],f.prototype,"shieldTip",void 0),__decorate([o({type:cc.Node,displayName:"\u62ab\u98ce\u63d0\u793a"})],f.prototype,"cloakTip",void 0),n=r=__decorate([n],f),i.EquipmentListUI=n,cc._RF.pop()},{}],EquipmentPopUI:[function(e,t,a){"use strict";cc._RF.push(t,"8a102pszrRBIb76KV0VWWJW","EquipmentPopUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("LocalData"),c=n("SpriteFrameManager"),p=n("ConfigData"),d=n("WorldEventManager"),u=n("LocalWorldEventType"),h=n("GameCommonPool"),m=n("LocalSoundManager"),f=n("TipManager"),g=n("UserData"),y=n("GameConfigData"),v=n("UIManager");function D(){var e=null!==l&&l.apply(this,arguments)||this;return e.allBg=null,e.equipmentName=null,e.equipmentProperty=null,e.equipmentRankName=null,e.upgradeCost=null,e.equipBtn=null,e.equipedBtn=null,e.upgradeMarkBtn=null,e.upgradeMarkBtnSprite=[],e.progressSprite=null,e.equipmentProgress=null,e.equipmentProgressText=null,e.awakenSprite=null,e.awakenSpriteFrames=[],e.equipmentEffectText=[],e.equipmentItem=null,e.equipmentData=null,e.isEquipNewEquipment=!1,e.isUpGradeDefense=!1,e.oldMaxLevel=25,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(D,l),D.prototype.onEnable=function(){this.isEquipNewEquipment=!1,this.isUpGradeDefense=!1,this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3)))},D.prototype.bindData=function(e,t){null!=e&&(this.equipmentData=e,this.closeAction=t,this.refreshEquipment(),this.updateData(e),e.equipped?(this.equipBtn.active=!1,this.equipedBtn.active=!0):(this.equipBtn.active=!0,this.equipedBtn.active=!1))},D.prototype.clickUpgradeBtn=function(){m.LocalSoundManager.playAudio("click");var e=this.equipmentData.type==s.EquipmentType.cloak?5*(this.equipmentData.rank-3):5*this.equipmentData.rank;if(this.equipmentData.level>=e)f.TipManager.showTip("\u5df2\u5230\u6700\u5927\u7b49\u7ea7");else{var t=this.equipmentData.level;if(t<(e=this.equipmentData.type==s.EquipmentType.cloak?this.oldMaxLevel-15:this.oldMaxLevel)){if(t=this.equipmentData.type==s.EquipmentType.cloak?y.GameConfigData.data.upNeedCoin[t-1+15]:y.GameConfigData.data.upNeedCoin[t-1],g.UserData.data.coin<t)return v.UIManager.showGetMoreGoldCoinUI(this.equipmentData),void this.clickClose();s.LocalData.changeCoin(-t)}else{if(e=y.GameConfigData.data.upNeedGem[this.equipmentData.level-e],s.LocalData.data.gemCount<e)return v.UIManager.showGetMoreGoldCoinUI(this.equipmentData),void this.clickClose();s.LocalData.changeGem(-e)}this.equipmentData.level++,this.updateData(this.equipmentData),d.WorldEventManager.triggerEvent(u.LocalWorldEventType.UpgradeEquipment,this.equipmentData),this.equipmentData.type!=s.EquipmentType.shield&&this.equipmentData.type!=s.EquipmentType.helmet||(this.isEquipNewEquipment=!1,this.isUpGradeDefense=!0)}},D.prototype.refreshEquipment=function(){var e;null!=this.equipmentItem?this.equipmentItem.bindData(this.equipmentData,!1,!0,!1,!1):null!=(e=v.UIManager.createEquipmentItem(this.allBg,this.equipmentData,!1,!0,!1,!1,cc.v2(-164,89)))&&(this.equipmentItem=e)},D.prototype.updateData=function(e){if(null!=e){var t=e.level,a=e.index,n=e.rank;if(null!=t&&null!=a&&null!=n){this.awakenSprite.spriteFrame=this.awakenSpriteFrames[1],4<=n&&(this.awakenSprite.spriteFrame=this.awakenSpriteFrames[0]),this.equipmentRankName.spriteFrame=c.SpriteFrameManager.getEquipmentLevelNameSpriteFrame(n-1);for(var o,i,l=0,r=this.equipmentEffectText;l<r.length;l++){var d=r[l];null!=d&&(d.string="")}e.type==s.EquipmentType.weapon?(o=p.ConfigData.getWeaponAtk(a,t,n),this.equipmentProperty.string="\u653b\u51fb\u529b\uff1a"+o+"(<color=#00ff00>+"+(p.ConfigData.getWeaponAtk(a,t+1,n)-o)+"</color>)",this.equipmentName.string=p.ConfigData.weaponName[a],4<=n&&(this.equipmentName.string=p.ConfigData.weaponName[a]+"\xb7\u5229\u5203"),this.getWeaponEffect(a,n)):e.type==s.EquipmentType.helmet?(i=p.ConfigData.getDefense(s.EquipmentType.helmet,a,t,n),this.equipmentProperty.string="\u62a4\u7532\u503c\uff1a"+i+"(<color=#00ff00>+"+(p.ConfigData.getDefense(s.EquipmentType.helmet,a,t+1,n)-i)+"</color>)",this.equipmentName.string=p.ConfigData.helmetName[a],4<=n&&(this.equipmentName.string=p.ConfigData.helmetName[a]+"\xb7\u65e0\u754f"),this.getHelmetEffect(a,n)):e.type==s.EquipmentType.shield?(i=p.ConfigData.getDefense(s.EquipmentType.shield,a,t,n),this.equipmentProperty.string="\u62a4\u7532\u503c\uff1a"+i+"(<color=#00ff00>+"+(p.ConfigData.getDefense(s.EquipmentType.shield,a,t+1,n)-i)+"</color>)",this.equipmentName.string=p.ConfigData.shieldName[a],4<=n&&(this.equipmentName.string=p.ConfigData.shieldName[a]+"\xb7\u94c1\u58c1"),this.getShieldEffect(a,n)):(u=p.ConfigData.getCloakHp(a,n,t),this.equipmentProperty.string="\u751f\u547d\u503c"+u+"(<color=#00ff00>+"+(p.ConfigData.getCloakHp(a,n,t+1)-u)+"</color>)",this.equipmentName.string=p.ConfigData.cloakName[a],this.getCloakEffect(a,n));var u=e.type==s.EquipmentType.cloak?this.oldMaxLevel-15:this.oldMaxLevel;t<u?(a=this.equipmentData.type==s.EquipmentType.cloak?y.GameConfigData.data.upNeedCoin[t-1+15]:y.GameConfigData.data.upNeedCoin[t-1],this.upgradeCost.value=a+"",this.upgradeMarkBtn.spriteFrame=this.upgradeMarkBtnSprite[0]):(u=y.GameConfigData.data.upNeedGem[t-u],this.upgradeCost.value=u+"",this.upgradeMarkBtn.spriteFrame=this.upgradeMarkBtnSprite[1]),e=s.LocalData.getEquipmentData(e.type,e.index,e.rank).length,this.equipmentProgress.value=e+"/"+p.ConfigData.upgradeEquipmentNeedCount,this.progressSprite.node.scaleX=Math.min(e/p.ConfigData.upgradeEquipmentNeedCount,1),this.equipmentProgressText.string="\u8fd8\u5dee"+Math.max(0,p.ConfigData.upgradeEquipmentNeedCount-e)+"\u4e2a\u53ef\u4ee5\u5408\u6210",n>=p.ConfigData.maxEquipmentRank?this.progressSprite.node.parent.active=!1:this.progressSprite.node.parent.active=!0}}},D.prototype.getWeaponEffect=function(e,t){e=y.GameConfigData.data.weaponEffectIndex[e],this.equipmentEffectText[0].node.color=cc.color(200,239,210,255),2<=t&&(this.equipmentEffectText[0].string=p.ConfigData.weaponEffect[e[0]]),3<=t&&(this.equipmentEffectText[1].string=p.ConfigData.weaponEffect[e[1]]),4<=t&&(this.equipmentEffectText[2].string=p.ConfigData.weaponEffect[e[2]]),5<=t&&(this.equipmentEffectText[0].node.color=cc.color(255,232,152,255),this.equipmentEffectText[0].string=p.ConfigData.doubleWeaponEffect[e[0]],this.equipmentEffectText[1].string=p.ConfigData.weaponEffect[e[1]],this.equipmentEffectText[2].string=p.ConfigData.weaponEffect[e[2]])},D.prototype.getShieldEffect=function(e,t){e=y.GameConfigData.data.shieldEffectIndex[e],this.equipmentEffectText[0].node.color=cc.color(200,239,210,255),2<=t&&(this.equipmentEffectText[0].string=p.ConfigData.denfenseEffect[e[0]]),3<=t&&(this.equipmentEffectText[1].string=p.ConfigData.denfenseEffect[e[1]]),4<=t&&(this.equipmentEffectText[2].string=p.ConfigData.denfenseEffect[e[2]]),5<=t&&(this.equipmentEffectText[0].node.color=cc.color(255,232,152,255),this.equipmentEffectText[0].string=p.ConfigData.doubleDenfenseEffect[e[0]],this.equipmentEffectText[1].string=p.ConfigData.denfenseEffect[e[1]],this.equipmentEffectText[2].string=p.ConfigData.denfenseEffect[e[2]])},D.prototype.getHelmetEffect=function(e,t){e=y.GameConfigData.data.helmetEffectIndex[e],this.equipmentEffectText[0].node.color=cc.color(200,239,210,255),2<=t&&(this.equipmentEffectText[0].string=p.ConfigData.denfenseEffect[e[0]]),3<=t&&(this.equipmentEffectText[1].string=p.ConfigData.denfenseEffect[e[1]]),4<=t&&(this.equipmentEffectText[2].string=p.ConfigData.denfenseEffect[e[2]]),5<=t&&(this.equipmentEffectText[0].node.color=cc.color(255,232,152,255),this.equipmentEffectText[0].string=p.ConfigData.doubleDenfenseEffect[e[0]],this.equipmentEffectText[1].string=p.ConfigData.denfenseEffect[e[1]],this.equipmentEffectText[2].string=p.ConfigData.denfenseEffect[e[2]])},D.prototype.getCloakEffect=function(e,t){e=y.GameConfigData.data.colakEffectIndex[e],4<=t&&(this.equipmentEffectText[0].node.color=cc.color(168,156,254,255),this.equipmentEffectText[0].string=p.ConfigData.cloakEffect[e[0]]),5<=t&&(this.equipmentEffectText[0].node.color=cc.color(255,232,152,255),this.equipmentEffectText[0].string=p.ConfigData.cloakEffect[e[1]],this.equipmentEffectText[1].node.color=cc.color(168,156,254,255),this.equipmentEffectText[1].string=p.ConfigData.cloakEffect[e[0]])},D.prototype.clickEquip=function(){m.LocalSoundManager.playAudio("equip");for(var e=0,t=s.LocalData.data.newEquipmentDatas;e<t.length;e++){var a=t[e];if(a.type==this.equipmentData.type&&a.equipped){a.equipped=!1;break}}this.equipmentData.equipped=!0,this.equipBtn.active=!1,this.equipedBtn.active=!0,d.WorldEventManager.triggerEvent(u.LocalWorldEventType.ChangeEquipment,this.equipmentData),this.isUpGradeDefense=!1,this.isEquipNewEquipment=!0},D.prototype.clickClose=function(){m.LocalSoundManager.playAudio("click"),this.closeAction&&this.closeAction(),this.closeAction=null,this.close()},D.prototype.clickSellBtn=function(){m.LocalSoundManager.playAudio("click"),this.close(),v.UIManager.showEquipmentSellPop(this.equipmentData,this.closeAction),this.closeAction=null},D.prototype.close=function(){this.isEquipNewEquipment&&d.WorldEventManager.triggerEvent(u.LocalWorldEventType.ShowBubble,{type:3}),this.isUpGradeDefense&&d.WorldEventManager.triggerEvent(u.LocalWorldEventType.ShowBubble,{type:5}),h.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Node,displayName:"\u6574\u4f53"})],D.prototype,"allBg",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u540d\u5b57"})],D.prototype,"equipmentName",void 0),__decorate([o({type:cc.RichText,displayName:"\u88c5\u5907\u5c5e\u6027"})],D.prototype,"equipmentProperty",void 0),__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u54c1\u7ea7\u540d\u79f0"})],D.prototype,"equipmentRankName",void 0),__decorate([o({type:r.NumberImg,displayName:"\u5347\u7ea7\u82b1\u8d39"})],D.prototype,"upgradeCost",void 0),__decorate([o({type:cc.Node,displayName:"\u88c5\u5907\u6309\u94ae"})],D.prototype,"equipBtn",void 0),__decorate([o({displayName:"\u5df2\u88c5\u5907\u6309\u94ae",type:cc.Node})],D.prototype,"equipedBtn",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5347\u7ea7\u6309\u94ae\u89d2\u6807"})],D.prototype,"upgradeMarkBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5347\u7ea7\u6309\u94ae\u89d2\u6807\u56fe\u96c6"})],D.prototype,"upgradeMarkBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u8fdb\u5ea6\u56fe\u7247"})],D.prototype,"progressSprite",void 0),__decorate([o({type:r.NumberImg,displayName:"\u88c5\u5907\u8fdb\u5ea6"})],D.prototype,"equipmentProgress",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u8fdb\u5ea6\u63cf\u8ff0"})],D.prototype,"equipmentProgressText",void 0),__decorate([o({type:cc.Sprite,displayName:"\u89c9\u9192\u63cf\u8ff0"})],D.prototype,"awakenSprite",void 0),__decorate([o({displayName:"\u89c9\u9192\u63cf\u8ff0\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],D.prototype,"awakenSpriteFrames",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u6548\u679c"})],D.prototype,"equipmentEffectText",void 0),n=__decorate([n],D),i.EquipmentPopUI=n,cc._RF.pop()},{}],EquipmentRankEffect:[function(e,t,a){"use strict";cc._RF.push(t,"e8d96GRGttIgIXgRX4/k9oR","EquipmentRankEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.effect1=null,e.effect3=[],e.effect1SpriteFrames=[],e.effect2SpriteFrames=[],e.effect3SpriteFrames=[],e.equipmentRankEffectParticleNode=null,e.equipmentRankEffectParticle=null,e.particleEffect=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.bindData=function(e,t){var a,n;null!=e&&(null!=this.particleEffect&&(this.particleEffect.destroy(),this.particleEffect=null),this.effect1.node.scale=t,this.effect1.node.active=!1,this.effect3[0].node.active=!1,this.effect3[1].node.active=!1,(a=e-2)<0||a>=this.effect1SpriteFrames.length||(2<=e&&(this.effect1.node.active=!0,this.effect1.spriteFrame=this.effect1SpriteFrames[a],(n=r.GameCommonPool.requestInstant(this.equipmentRankEffectParticle)).setParent(this.equipmentRankEffectParticleNode),n.setPosition(cc.Vec2.ZERO),null!=(t=n.getComponent(cc.ParticleSystem))&&(t.spriteFrame=this.effect2SpriteFrames[a],this.particleEffect=n)),3<=e&&(this.effect3[0].node.active=!0,this.effect3[1].node.active=!0,this.effect3[0].spriteFrame=this.effect3SpriteFrames[a],this.effect3[1].spriteFrame=this.effect3SpriteFrames[a],this.effectsAni())))},s.prototype.effectsAni=function(){var e=this;this.effect3[0].node.stopAllActions(),this.effect3[1].node.stopAllActions(),this.effect3[0].node.scale=1,this.effect3[1].node.scale=1,this.effect3[0].node.opacity=0,this.effect3[1].node.opacity=0,this.effect3[0].node.angle=0,this.effect3[1].node.angle=0,this.effect3[0].node.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(1.5,4),cc.sequence(cc.fadeIn(.3),cc.fadeOut(1.2)),cc.rotateBy(1.5,-135)),cc.callFunc(function(){e.effect3[0].node.scale=1,e.effect3[0].node.opacity=0,e.effect3[0].node.angle=0}),cc.delayTime(.3)))),this.effect3[1].node.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.5),cc.spawn(cc.scaleTo(1.3,4),cc.sequence(cc.fadeIn(.2),cc.fadeOut(1.1)),cc.rotateBy(1.3,-135)),cc.callFunc(function(){e.effect3[1].node.scale=1,e.effect3[1].node.opacity=0,e.effect3[1].node.angle=0}))))},__decorate([o({displayName:"\u7279\u65481",type:cc.Sprite})],s.prototype,"effect1",void 0),__decorate([o({displayName:"\u7279\u65483",type:cc.Sprite})],s.prototype,"effect3",void 0),__decorate([o({displayName:"\u7279\u65481\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"effect1SpriteFrames",void 0),__decorate([o({displayName:"\u7279\u65482\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"effect2SpriteFrames",void 0),__decorate([o({displayName:"\u7279\u65483\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"effect3SpriteFrames",void 0),__decorate([o({displayName:"\u5f00\u7bb1\u7c92\u5b50\u7279\u6548\u8282\u70b9",type:cc.Node})],s.prototype,"equipmentRankEffectParticleNode",void 0),__decorate([o({displayName:"\u5f00\u7bb1\u7c92\u5b50\u7279\u6548",type:cc.Prefab})],s.prototype,"equipmentRankEffectParticle",void 0),n=__decorate([n],s),i.EquipmentRankEffect=n,cc._RF.pop()},{}],EquipmentSellUI:[function(e,t,a){"use strict";cc._RF.push(t,"aad4aySvNhEg6diqNjno/AV","EquipmentSellUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("LocalData"),c=n("ConfigData"),p=n("SpriteFrameManager"),d=n("GameConfigData"),u=n("WorldEventManager"),h=n("LocalWorldEventType"),m=n("TipManager"),f=n("LocalSoundManager"),g=n("UIManager"),y=n("GameCommonPool");function v(){var e=null!==l&&l.apply(this,arguments)||this;return e.allBg=null,e.equipmentName=null,e.equipmentRankName=null,e.sellCoin=null,e.equipmentItem=null,e.equipmentData=null,e.sellCoinCount=0,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(v,l),v.prototype.onEnable=function(){this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3)))},v.prototype.bindData=function(e,t){var a,n;null!=e&&(this.equipmentData=e,this.closeAction=t,this.refreshEquipment(),a=e.level,n=e.index,t=e.rank,this.equipmentRankName.spriteFrame=p.SpriteFrameManager.getEquipmentLevelNameSpriteFrame(t-1),this.sellCoinCount=this.getSellCoin(t,a),this.sellCoin.value=this.sellCoinCount+"",e.type==s.EquipmentType.weapon?(this.equipmentName.string=c.ConfigData.weaponName[n],4<=t&&(this.equipmentName.string=c.ConfigData.weaponName[n]+"\xb7\u5229\u5203")):e.type==s.EquipmentType.helmet?(this.equipmentName.string=c.ConfigData.helmetName[n],4<=t&&(this.equipmentName.string=c.ConfigData.helmetName[n]+"\xb7\u65e0\u754f")):e.type==s.EquipmentType.shield?(this.equipmentName.string=c.ConfigData.shieldName[n],4<=t&&(this.equipmentName.string=c.ConfigData.shieldName[n]+"\xb7\u94c1\u58c1")):this.equipmentName.string=c.ConfigData.cloakName[n])},v.prototype.refreshEquipment=function(){var e;null!=this.equipmentItem?this.equipmentItem.bindData(this.equipmentData,!1,!1,!1,!1):null!=(e=g.UIManager.createEquipmentItem(this.allBg,this.equipmentData,!1,!1,!1,!1,cc.v2(0,51)))&&(this.equipmentItem=e)},v.prototype.getSellCoin=function(e,t){var a=0;switch(e){case 1:a=250;break;case 2:a=500;break;case 3:a=800;break;case 4:a=1200;break;case 5:a=2e3;break;case 6:a=5e3}for(var n=d.GameConfigData.data.upNeedCoin,o=0,i=0;i<t-1&&!(i>=n.length-1);i++)o+=n[i];return a+Math.round(.2*o)},v.prototype.clickSellBtn=function(){f.LocalSoundManager.playAudio("click"),this.equipmentData.equipped?m.TipManager.showTip("\u5df2\u88c5\u5907\uff0c\u65e0\u6cd5\u51fa\u552e\uff01"):(m.TipManager.showTip("\u51fa\u552e\u83b7\u5f97"+this.sellCoinCount+"\u91d1\u5e01"),s.LocalData.changeCoin(this.sellCoinCount),s.LocalData.removeEquipmentData(this.equipmentData),u.WorldEventManager.triggerEvent(h.LocalWorldEventType.SellEquipment,this.equipmentData),this.close())},v.prototype.clickClose=function(){f.LocalSoundManager.playAudio("click"),this.close()},v.prototype.close=function(){this.closeAction&&this.closeAction(),this.closeAction=null,y.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Node,displayName:"\u6574\u4f53"})],v.prototype,"allBg",void 0),__decorate([o({type:cc.Label,displayName:"\u88c5\u5907\u540d\u5b57"})],v.prototype,"equipmentName",void 0),__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u54c1\u7ea7\u540d\u79f0"})],v.prototype,"equipmentRankName",void 0),__decorate([o({type:r.NumberImg,displayName:"\u51fa\u552e\u91d1\u5e01"})],v.prototype,"sellCoin",void 0),n=__decorate([n],v),i.EquipmentSellUI=n,cc._RF.pop()},{}],EquipmentUI:[function(e,t,a){"use strict";cc._RF.push(t,"fdde2L/xB5KEohETge3CoUR","EquipmentUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("LocalData"),u=n("UIManager"),h=n("PrefabUrl"),m=n("CommonMask");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.weaponNode=null,e.cloakNode=null,e.helmetNode=null,e.shieldNode=null,e.currentBoard=null,e.weaponItem=null,e.cloakItem=null,e.helmetItem=null,e.shieldItem=null,e.weaponData=null,e.helmetData=null,e.shieldData=null,e.cloakData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),(r=f).prototype.onLoad=function(){r.instance=this,r.showWeaponListUI(),u.UIManager.createBubbleText(this.node,cc.v2(-240,106),!1,0)},f.prototype.onEnable=function(){this.weaponData=d.LocalData.getEquippedEquipment(d.EquipmentType.weapon),this.equip(this.weaponData),this.helmetData=d.LocalData.getEquippedEquipment(d.EquipmentType.helmet),this.equip(this.helmetData),this.shieldData=d.LocalData.getEquippedEquipment(d.EquipmentType.shield),this.equip(this.shieldData),this.cloakData=d.LocalData.getEquippedEquipment(d.EquipmentType.cloak),this.equip(this.cloakData),c.WorldEventManager.addListener(p.LocalWorldEventType.ChangeEquipment,this.equip,this),c.WorldEventManager.addListener(p.LocalWorldEventType.UpgradeEquipment,this.updateData,this)},f.prototype.onDisable=function(){c.WorldEventManager.removeListener(p.LocalWorldEventType.ChangeEquipment,this.equip,this),c.WorldEventManager.removeListener(p.LocalWorldEventType.UpgradeEquipment,this.updateData,this)},f.prototype.equip=function(e){if(null!=e)if(e.type==d.EquipmentType.weapon){if(this.weaponData=e,null==this.weaponItem){var t=u.UIManager.createEquipmentItem(this.weaponNode,e,!1,!1,!0,!1);return null==t?void 0:void(this.weaponItem=t)}this.weaponItem.bindData(e,!1,!1,!0,!1)}else if(e.type==d.EquipmentType.helmet){if(this.helmetData=e,null==this.helmetItem)return null==(t=u.UIManager.createEquipmentItem(this.helmetNode,e,!1,!1,!0,!1))?void 0:void(this.helmetItem=t);this.helmetItem.bindData(e,!1,!1,!0,!1)}else if(e.type==d.EquipmentType.shield){if(this.shieldData=e,null==this.shieldItem){var a=u.UIManager.createEquipmentItem(this.shieldNode,e,!1,!1,!0,!1);return null==a?void 0:void(this.shieldItem=a)}this.shieldItem.bindData(e,!1,!1,!0,!1)}else if(e.type==d.EquipmentType.cloak){if(this.cloakData=e,null==this.cloakItem)return null==(a=u.UIManager.createEquipmentItem(this.cloakNode,e,!1,!1,!0,!1))?void 0:void(this.cloakItem=a);this.cloakItem.bindData(e,!1,!1,!0,!1)}},f.prototype.updateData=function(e){null!=e&&(e==this.weaponData?this.weaponItem.bindData(e,!1,!1,!0,!1):e==this.helmetData?this.helmetItem.bindData(e,!1,!1,!0,!1):e==this.shieldData?this.shieldItem.bindData(e,!1,!1,!0,!1):e==this.cloakData&&this.cloakItem.bindData(e,!1,!1,!0,!1))},f.prototype.clickWeapon=function(){u.UIManager.showEquipmentPop(this.weaponData,null)},f.prototype.clickHelmet=function(){u.UIManager.showEquipmentPop(this.helmetData,null)},f.prototype.clickShield=function(){u.UIManager.showEquipmentPop(this.shieldData,null)},f.prototype.clickCloak=function(){u.UIManager.showEquipmentPop(this.cloakData,null)},f.showWeaponListUI=function(){var e=r.instance;null!=e&&(m.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(h.PrefabUrl.equipmentListUI,function(t,a){m.CommonMask.hideMask(),null==t&&null!=a&&(a.setParent(e.node),e.currentBoard&&e.currentBoard.active&&s.GameCommonPool.returnInstant(e.currentBoard),e.currentBoard=a)}))},f.instance=null,__decorate([o({displayName:"\u5df2\u88c5\u5907\u6b66\u5668\u8282\u70b9",type:cc.Node})],f.prototype,"weaponNode",void 0),__decorate([o({displayName:"\u5df2\u88c5\u5907\u62ab\u98ce\u8282\u70b9",type:cc.Node})],f.prototype,"cloakNode",void 0),__decorate([o({displayName:"\u5df2\u88c5\u5907\u5934\u76d4\u8282\u70b9",type:cc.Node})],f.prototype,"helmetNode",void 0),__decorate([o({displayName:"\u5df2\u88c5\u5907\u76fe\u724c\u8282\u70b9",type:cc.Node})],f.prototype,"shieldNode",void 0),n=r=__decorate([n],f),i.EquipmentUI=n,cc._RF.pop()},{}],EvilDragonSpineController:[function(e,t,a){"use strict";cc._RF.push(t,"b6d5aPekJ9PnZnEHsKoo7sj","EvilDragonSpineController");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SpineController"),s=n("BattleNodeManager"),c=n("EnumAndConst");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.dragonSpine=null,e.eyeCollider=null,e.neckCollider=null,e.bellyCollider=null,e.leftClawCollider=null,e.rightClawCollider=null,e.eyeBone=null,e.neckBone=null,e.bellyBone=null,e.leftTopClawBone=null,e.leftBelowClawBone=null,e.rightTopClawBone=null,e.rightBelowClawBone=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.SpineController,__extends(p,l),p.prototype.onEnable=function(){l.prototype.onEnable.call(this),this.headBone=null,this.bodyBone=null,this.eyeBone=null,this.neckBone=null,this.bellyBone=null,this.leftTopClawBone=null,this.leftBelowClawBone=null,this.rightTopClawBone=null,this.rightBelowClawBone=null,this.eyeCollider=null,this.neckCollider=null,this.bellyCollider=null,this.leftClawCollider=null,this.rightClawCollider=null,this.headBone=this.dragonSpine.findBone("HEAD2"),this.bodyBone=this.dragonSpine.findBone("BODY_BELOW"),this.eyeBone=this.dragonSpine.findBone("EYE_O"),this.neckBone=this.dragonSpine.findBone("BODY_TOP2"),this.bellyBone=this.dragonSpine.findBone("BODY_TOP2"),this.leftTopClawBone=this.dragonSpine.findBone("ARM_L_TOP"),this.leftBelowClawBone=this.dragonSpine.findBone("ARM_L_BELOW"),this.rightTopClawBone=this.dragonSpine.findBone("ARM_R_TOP"),this.rightBelowClawBone=this.dragonSpine.findBone("ARM_R_BELOW")},p.prototype.update=function(){null==this.roleData||this.roleData.isDestroy||(this.bodyNode.scaleX=this.roleData.orientation,this.refreshHead(),this.refreshEye(),this.refreshBody(),this.refreshNeck(),this.refreshBelly(),this.refreshLeftClaw(),this.refreshRightClaw())},p.prototype.bindData=function(e,t,a,n){this.roleData=e,null!=t&&0<t.length&&(this.bodyCollider=t[0],this.neckCollider=t[1],this.bellyCollider=t[2],this.rightClawCollider=t[3],this.leftClawCollider=t[4]),null!=a&&(this.headCollider=a),null!=n&&(this.eyeCollider=n),this.bodyNode=this.bodyCollider.node.parent},p.prototype.refreshHead=function(){var e,t;this.headBone&&this.headCollider&&(e=cc.v2(this.headBone.worldX,this.headBone.worldY),t=this.dragonSpine.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.HELMET_NODE))&&(t=e.convertToNodeSpaceAR(t),this.headCollider.node.position=t,this.headCollider.node.angle=this.headBone.rotation))},p.prototype.refreshBody=function(){var e;this.bodyBone&&this.bodyCollider&&(e=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY),this.bodyCollider.node.position=e,this.bodyCollider.node.angle=this.bodyBone.rotation)},p.prototype.refreshEye=function(){var e,t;this.eyeBone&&this.eyeCollider&&this.headBone&&(e=cc.v2(this.eyeBone.worldX,this.eyeBone.worldY),t=this.dragonSpine.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE))&&(t=e.convertToNodeSpaceAR(t),this.eyeCollider.node.position=t,this.eyeCollider.node.angle=this.eyeBone.rotation+this.headBone.rotation))},p.prototype.refreshNeck=function(){var e;this.neckBone&&this.neckCollider&&(e=cc.v2(this.neckBone.worldX,this.neckBone.worldY),this.neckCollider.node.position=e,this.neckCollider.node.angle=-this.neckBone.rotation-30)},p.prototype.refreshBelly=function(){var e;this.bellyBone&&this.bellyCollider&&(e=cc.v2(this.bellyBone.worldX,this.bellyBone.worldY),this.bellyCollider.node.position=e,this.bellyCollider.node.angle=30-this.bellyBone.rotation)},p.prototype.refreshLeftClaw=function(){var e,t;this.leftBelowClawBone&&this.leftTopClawBone&&this.leftClawCollider&&(0==(t=cc.v2(this.leftTopClawBone.worldX,this.leftTopClawBone.worldY).sub(cc.v2(this.leftBelowClawBone.worldX,this.leftBelowClawBone.worldY))).x&&0==t.y||(e=cc.v2(this.leftBelowClawBone.worldX,this.leftBelowClawBone.worldY).add(t.mul(1)),e=this.dragonSpine.node.convertToWorldSpaceAR(e),e=this.bodyNode.convertToNodeSpaceAR(e),t=180*-t.signAngle(cc.Vec2.RIGHT)/Math.PI,this.leftClawCollider.node.position=e,this.leftClawCollider.node.angle=135-t))},p.prototype.refreshRightClaw=function(){var e,t;this.rightBelowClawBone&&this.rightTopClawBone&&this.rightClawCollider&&(0==(t=cc.v2(this.rightTopClawBone.worldX,this.rightTopClawBone.worldY).sub(cc.v2(this.rightBelowClawBone.worldX,this.rightBelowClawBone.worldY))).x&&0==t.y||(e=cc.v2(this.rightBelowClawBone.worldX,this.rightBelowClawBone.worldY).add(t.mul(1)),e=this.dragonSpine.node.convertToWorldSpaceAR(e),e=this.bodyNode.convertToNodeSpaceAR(e),t=180*-t.signAngle(cc.Vec2.RIGHT)/Math.PI,this.rightClawCollider.node.position=e,this.rightClawCollider.node.angle=110-t))},p.prototype.isInEnemyAttackRange=function(e,t,a){if(null!=e&&null!=t&&null!=a){var n=this.getEyeBoneLocalPos(),o=this.roleData.headPosition,i=this.getBodyBoneLocalPos(),l=this.getBellyBoneLocalPos(),r=this.getLeftClawBoneLocalPos(),s=this.getRightClawBoneLocalPos();return null!=n&&Math.abs(n.x-e.logicPos.x)<=t&&Math.abs(n.y-e.logicPos.y)<=a||null!=o&&Math.abs(o.x-e.logicPos.x)<=t+50&&Math.abs(o.y-e.logicPos.y)<=a+50||null!=i&&Math.abs(i.x-e.logicPos.x)<=t+100&&Math.abs(i.y-e.logicPos.y)<=a||null!=l&&Math.abs(l.x-e.logicPos.x)<=t&&Math.abs(l.y-e.logicPos.y)<=a+50||null!=r&&Math.abs(r.x-e.logicPos.x)<=t&&Math.abs(r.y-e.logicPos.y)<=a||null!=s&&Math.abs(s.x-e.logicPos.x)<=t&&Math.abs(s.y-e.logicPos.y)<=a}},p.prototype.getEyeBoneLocalPos=function(){if(this.eyeBone){var e=cc.v2(this.eyeBone.worldX,this.eyeBone.worldY),t=this.dragonSpine.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE)))return e.convertToNodeSpaceAR(t).add(cc.v2(0,29))}},p.prototype.getBodyBoneLocalPos=function(){if(this.bodyBone){var e=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY),t=this.dragonSpine.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE)))return e.convertToNodeSpaceAR(t).add(cc.v2(0,29))}},p.prototype.getBellyBoneLocalPos=function(){if(this.bellyBone){var e=cc.v2(this.bellyBone.worldX,this.bellyBone.worldY),t=this.dragonSpine.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE)))return e.convertToNodeSpaceAR(t).add(cc.v2(0,29))}},p.prototype.getLeftClawBoneLocalPos=function(){if(this.leftBelowClawBone&&(0!=(t=cc.v2(this.leftTopClawBone.worldX,this.leftTopClawBone.worldY).sub(cc.v2(this.leftBelowClawBone.worldX,this.leftBelowClawBone.worldY))).x||0!=t.y)){var e=cc.v2(this.leftBelowClawBone.worldX,this.leftBelowClawBone.worldY).add(t.mul(1)),t=this.dragonSpine.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE)))return e.convertToNodeSpaceAR(t).add(cc.v2(0,29))}},p.prototype.getRightClawBoneLocalPos=function(){if(this.rightBelowClawBone&&(0!=(t=cc.v2(this.rightTopClawBone.worldX,this.rightTopClawBone.worldY).sub(cc.v2(this.rightBelowClawBone.worldX,this.rightBelowClawBone.worldY))).x||0!=t.y)){var e=cc.v2(this.rightBelowClawBone.worldX,this.rightBelowClawBone.worldY).add(t.mul(1)),t=this.dragonSpine.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.ROLE_HEAD_NODE)))return e.convertToNodeSpaceAR(t).add(cc.v2(0,29))}},__decorate([o({displayName:"\u9f99spine",type:sp.Skeleton})],p.prototype,"dragonSpine",void 0),n=__decorate([n],p),i.DragonSpineController=n,cc._RF.pop()},{}],Eye:[function(e,t,a){"use strict";cc._RF.push(t,"791d3xb9IZPyY24/IGCshoC","Eye");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("WorldEventManager"),s=o("LocalWorldEventType"),c=o("Head");function p(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=c.Head,__extends(p,l),p.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this)},p.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},p.prototype.update=function(){null!=this.roleData&&this.roleData.isDestroy&&this.close()},p.prototype.bindData=function(e){this.roleData=e},o=__decorate([o],p),i.Eye=o,cc._RF.pop()},{}],FailTipUI:[function(e,t,a){"use strict";cc._RF.push(t,"ae8b4k6zJRHLY57mRIR+iYr","FailTipUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LocalSoundManager"),s=n("GameCommonPool"),c=n("MainUI");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.topTip=null,e.topTipSpFrame=[],e.talkSp=null,e.talkSpFrame=[],e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.bindIndex=function(e,t){switch(this.closeAction=t,this.failUIIndex=e){case 1:this.topTip.spriteFrame=this.topTipSpFrame[0],this.talkSp.spriteFrame=this.talkSpFrame[0];break;case 2:this.topTip.spriteFrame=this.topTipSpFrame[1],this.talkSp.spriteFrame=this.talkSpFrame[1];break;default:this.close()}},p.prototype.btnSure=function(){r.LocalSoundManager.playAudio("click"),this.close();var e=c.MainUI.instance;null!=e&&e.clickBtnByPop(this.failUIIndex)},p.prototype.btnCancel=function(){r.LocalSoundManager.playAudio("click"),this.close()},p.prototype.close=function(){this.closeAction&&this.closeAction(),this.closeAction=null,s.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Sprite,displayName:"\u9876\u90e8\u6807\u7b7e"})],p.prototype,"topTip",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u9876\u90e8\u6807\u7b7e\u7cbe\u7075\u5e27"})],p.prototype,"topTipSpFrame",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5bf9\u8bdd\u7cbe\u7075"})],p.prototype,"talkSp",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5bf9\u8bdd\u7cbe\u7075\u5e27"})],p.prototype,"talkSpFrame",void 0),n=__decorate([n],p),i.FailTipUI=n,cc._RF.pop()},{}],FeedBackManager:[function(e,t,a){"use strict";cc._RF.push(t,"412abGWtZlOHKXkRU8/h0L+","FeedBackManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l,r=cc._decorator;function s(){return null!==i&&i.apply(this,arguments)||this}n=r.ccclass,r.property,i=cc.Component,__extends(s,i),(l=s).prototype.onEnable=function(){l.showFeedBackButton()},s.prototype.onDisable=function(){l.destroyFeedBackButton()},s.showFeedBackButton=function(){var e,t,a;cc.sys.platform!==cc.sys.WECHAT_GAME||null!=(a=window.gameCommon.getSDK.getSystemInfo())&&(e=a.screenHeight/640,t=a.screenHeight,a=a.screenWidth/2+175*e,window.gameCommon.getSDK.showFeedbackButton(a,.60625*t,45*e,72*e,"img/complain.png"))},s.destroyFeedBackButton=function(){cc.sys.platform===cc.sys.WECHAT_GAME&&window.gameCommon.getSDK.destroyFeedbackButton()},n=l=__decorate([n],s),o.FeedBackManager=n,cc._RF.pop()},{}],FitIphoneX:[function(e,t,a){"use strict";cc._RF.push(t,"83c36IYpKlO27yrrpQz/HEB","FitIphoneX");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.widget=null,e.topOffset=0,e.bottomOffset=0,e.leftOffset=0,e.rightOffset=0,e}i=cc.Component,__extends(r,i),r.prototype.onLoad=function(){this.widget&&window.gameCommon.getSDK.isPhoneXScreen()&&(this.widget.top+=this.topOffset,this.widget.bottom+=this.bottomOffset,this.widget.left+=this.leftOffset,this.widget.right+=this.rightOffset)},__decorate([l(cc.Widget)],r.prototype,"widget",void 0),__decorate([l],r.prototype,"topOffset",void 0),__decorate([l],r.prototype,"bottomOffset",void 0),__decorate([l],r.prototype,"leftOffset",void 0),__decorate([l],r.prototype,"rightOffset",void 0),n=__decorate([n],r),o.FitIphoneX=n,cc._RF.pop()},{}],FlyDragonSpineController:[function(e,t,a){"use strict";cc._RF.push(t,"569970D/ERBRqUOTIudJWaq","FlyDragonSpineController");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("SpineController"),s=o("BattleNodeManager"),c=o("EnumAndConst");function p(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=r.SpineController,__extends(p,l),p.prototype.lateUpdate=function(){null==this.roleData||this.roleData.isDestroy||(this.bodyNode.scaleX=this.roleData.orientation,this.refreshHead(),this.refreshBody(),this.refreshMagicBalls())},p.prototype.refreshHead=function(){var e,t;this.headBone&&this.headCollider&&(e=cc.v2(this.headBone.worldX,this.headBone.worldY),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.HELMET_NODE))&&(t=e.convertToNodeSpaceAR(t),this.headCollider.node.position=t,this.headCollider.node.angle=this.headBone.rotation*this.roleData.orientation))},p.prototype.refreshBody=function(){var e;this.bodyBone&&this.bodyCollider&&(e=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY),this.bodyCollider.node.position=e,this.bodyCollider.node.angle=this.bodyBone.rotation)},o=__decorate([o],p),i.FlyDragonSpineController=o,cc._RF.pop()},{}],FlyDragon:[function(e,t,a){"use strict";cc._RF.push(t,"fc9f5AMuTpO+p/x3iF8ycY+","FlyDragon");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RoleBase"),s=n("Timer"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("Head"),u=n("GameState"),h=n("EnumAndConst"),m=n("EndlessModelConfigData"),f=n("GameConfigData"),g=n("BattleNodeManager"),y=n("MagicBall"),v=n("GameCommonPool"),D=n("RoleManager"),E=n("GameManager"),S=n("EquipmentEffectSystem"),A=n("EnemyArea"),C=n("SpecailSkill"),M=n("Util"),T=n("PlayerState"),_=n("ConfigData");function k(){var e=null!==l&&l.apply(this,arguments)||this;return e.fireBallPrefab=null,e.iceBallPrefab=null,e.moveSpeed=300,e.attackCd=2,e.moveDirection=null,e.moveTime=null,e.isMagicShooting=!1,e.attackTimer=null,e.isFireDragon=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.RoleBase,__extends(k,l),k.prototype.onEnable=function(){c.WorldEventManager.addListener(p.LocalWorldEventType.BackHome,this.close,this),c.WorldEventManager.addListener(p.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),c.WorldEventManager.addListener(p.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.isMagicShooting=!1,this.isHitAniRunning=!1,this.attackTimer=null,this.isWaitingRevive=!1},k.prototype.onDisable=function(){c.WorldEventManager.removeListener(p.LocalWorldEventType.BackHome,this.close,this),c.WorldEventManager.removeListener(p.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),c.WorldEventManager.removeListener(p.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},k.prototype.update=function(e){null!=this.roleData&&(this.refreshDeadState(),this.refresReviveState(),this.move(e))},k.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},k.prototype.bindData=function(e,t,a){var n;this.roleData=e,null!=this.roleData&&(null!=(n=a.getComponent(d.Head))&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.isFireDragon=this.roleData.profession==h.ProfessionEnum.FIRE_DRAGON,this.isFireDragon&&this.roleData.enemyEquipSkills.addSkill(h.SkillTypeEnum.IGNITE),this.setRandomMoveAction(!0),this.attack())},k.prototype.setRandomMoveAction=function(e){var t=e?cc.v2(M.Util.getRandomFloatNum(350,440),M.Util.getRandomFloatNum(0,160)):cc.v2(M.Util.getRandomFloatNum(-190,440),M.Util.getRandomFloatNum(0,160)),a=this.moveSpeed;e=M.Util.getDistance(this.node.position,t),this.moveTime=e/a,this.moveDirection=t.sub(this.roleData.logicPos).normalize(),this.roleData.orientation=0<this.moveDirection.x?-1:1,this.roleUp.scaleX=this.roleData.orientation},k.prototype.attackMove=function(){160<=this.node.position.y?this.moveDirection=cc.v2(0,-1):this.node.position.y<=0&&(this.moveDirection=cc.v2(0,1))},k.prototype.move=function(e){if(!(null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.roleData.isTeleporting))return this.isMagicShooting?(this.moveTime=0,this.attackMove(),void(this.node.position=this.node.position.add(this.moveDirection.mul(this.moveSpeed*e/2)))):void(null==this.moveTime||null==this.moveDirection||0==this.moveDirection.x&&0==this.moveDirection.y||(this.node.position=this.node.position.add(this.moveDirection.mul(this.moveSpeed*e)),this.moveTime-=e,this.moveTime<=0&&this.setRandomMoveAction(!1)))},k.prototype.attack=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.isHitAniRunning=!1,this.spineController.playAnimation(h.SpineAniNameEnum.St,!1,!0,null),!u.GameState.isGaming||this.roleData.isFrozening)||(e=this.attackCd,u.GameState.endlessModel?e/=m.EndlessModelConfigData.getEndlessEnemyAttackFrequency(u.GameState.currentPart):u.GameState.heroModel&&(e/=f.GameConfigData.data.heroEnemyAttackFrequency),this.attackTimer=s.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.shootMagicBall(),t.attackTimer=null)},this.node))},k.prototype.shootMagicBall=function(){var e,t,a=this;null==this.roleData||this.roleData.isDead||this.roleData.isTeleporting||null!=(e=g.BattleNodeManager.getParentNode(h.BattleNodeEnum.PARTICLE_NODE))&&(this.moveDirection=cc.v2(0,M.Util.getRandomValueFromArray([-1,1])),this.roleData.orientation=1,this.roleUp.scaleX=this.roleData.orientation,this.isMagicShooting=!0,(t=this.createMaigcBall(this.isFireDragon)).setParent(e),t.scale=0,t.runAction(cc.scaleTo(.5,.8)),this.spineController.magicBalls=[t],this.spineController.refreshMagicBalls(),s.TimerManager.addTimer(.7,function(){var e,t,n;null==a.roleData||a.roleData.isDead||a.roleData.isDestroy||null!=(n=a.spineController.magicBalls.shift())&&(null==(e=n.getComponent(y.MagicBall))||null!=(t=T.PlayerState.playerData)&&(t=t.logicPos,n=[n=cc.v2((t.x+n.x)/3,(t.y+n.y)/3),n.mul(2)],e.bindData(0,a.isFireDragon,a.roleData,400,null,n)))},this.node),this.isHitAniRunning=!1,this.spineController.playAnimation(h.SpineAniNameEnum.Atk,!1,!1,function(){a.spineController.playAnimation(h.SpineAniNameEnum.St,!1,!0,null),s.TimerManager.addTimer(1,function(){a.isMagicShooting=!1,a.attack()},a.node)}))},k.prototype.createMaigcBall=function(e){if(e=e?this.fireBallPrefab:this.iceBallPrefab,null!=(e=v.GameCommonPool.requestInstant(e)))return e},k.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isMagicShooting?this.isHitAniRunning=!1:this.isHitAniRunning||(this.node.stopAllActions(),this.attackTimer&&this.attackTimer.pauseTimer(),this.isHitAniRunning=!0,this.spineController.playAnimation(h.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,e.spineController.playAnimation(h.SpineAniNameEnum.St,!1,!0,null),e.attackTimer&&e.attackTimer.resumeTimer()}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},k.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.spineController.pauseAnimation(!0),s.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,s.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),s.TimerManager.resumeAllTimers(t.node))},this.node))},k.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.attack(),D.RoleManager.hitRole(this.roleData))},k.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&this.close()},k.prototype.die=function(){var e,t,a,n=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,this.node.stopAllActions(),this.spineController.pauseAnimation(!1),s.TimerManager.removeAllTimers(this.node),E.GameManager.killEnemy(this.roleData),S.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),a=(t=(e=this.node.x+M.Util.getRandomFloatNum(160,200))+100)+20,this.node.runAction(cc.sequence(cc.jumpTo(.8,e,_.ConfigData.rightGroundBornPos.y,100,1).easing(cc.easeIn(.8)),cc.jumpTo(.4,t,_.ConfigData.rightGroundBornPos.y,20,1),cc.jumpTo(.1,a,_.ConfigData.rightGroundBornPos.y,10,1),cc.delayTime(.1),cc.callFunc(function(){var e=null!=A.EnemyArea.necromancer&&A.EnemyArea.reviveReady&&null==A.EnemyArea.necromancer.targetData;if(n.roleData.isEnemy&&e)return n.isWaitingRevive=!0,void A.EnemyArea.necromancer.reviveEnemy(n.roleData);C.SpecailSkill.killBlast(n.roleData),n.roleData.isDestroy=!0,n.close()}))),this.spineController.playAnimation(h.SpineAniNameEnum.D,!1,!1,null))},k.prototype.close=function(){this.node.stopAllActions(),null==this.head||this.roleData.headDroped||(null!=this.head.helmet&&this.head.helmet.close(),null!=this.head.node&&this.head.node.destroy()),v.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u706b\u7403",type:cc.Prefab})],k.prototype,"fireBallPrefab",void 0),__decorate([o({displayName:"\u51b0\u7403",type:cc.Prefab})],k.prototype,"iceBallPrefab",void 0),n=__decorate([n],k),i.FlyDragon=n,cc._RF.pop()},{}],FlyHeadGhost:[function(e,t,a){"use strict";cc._RF.push(t,"29878WRGPVMEarkfwKW1rFl","FlyHeadGhost");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Head"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameManager"),d=n("EnumAndConst"),u=n("Timer"),h=n("BattleNodeManager"),m=n("GameCommonPool"),f=n("FlyHead"),g=n("EnemyArea"),y=n("RoleBase"),v=n("RoleManager"),D=n("EffectCreate"),E=n("PlayerState"),S=n("SpecailSkill"),A=n("EquipmentEffectSystem");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.flyHead=null,e.isShootingHead=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=y.RoleBase,__extends(C,l),C.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.isHitAniRunning=!1,this.isShootingHead=!1,this.isWaitingRevive=!1},C.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},C.prototype.update=function(){null!=this.roleData&&(this.refreshDeadState(),this.refresReviveState(),this.holdingHead())},C.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},C.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.attack()},C.prototype.attack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||(this.isHitAniRunning=!1,this.spineController.playAnimation(d.SpineAniNameEnum.Hero_st,!1,!0,null),null==E.PlayerState.playerData)||u.TimerManager.addTimer(2,function(){null==e.roleData||e.roleData.isDead||e.roleData.isDestroy||e.shootFlyHead()},this.node)},C.prototype.shootFlyHead=function(){var e,t=this;null==this.roleData||this.roleData.isDead||null!=(e=h.BattleNodeManager.getParentNode(d.BattleNodeEnum.PARTICLE_NODE))&&(this.isShootingHead=!0,this.node.runAction(cc.sequence(cc.delayTime(.7),cc.callFunc(function(){t.roleData.headDroped=!0,t.roleData.holdHead=!0}),cc.delayTime(1.1),cc.callFunc(function(){var a,n;null!=t.head&&t.head.node.isValid&&(null==(a=t.createFlyHead())||null!=(n=a.getComponent(f.FlyHead))&&(a.setParent(e),a.setPosition(t.roleData.headPosition),n.bindData(t.roleData,t.head.node,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.isShootingHead=!1,t.spineController.playAnimation(d.SpineAniNameEnum.Hero_st,!1,!0,null),t.equipHead())}),t.roleData.holdHead=!1,t.head=null,t.roleData.headDroped=!0))}))),this.isHitAniRunning=!1,this.spineController.playAnimation(d.SpineAniNameEnum.Ghost_atk,!1,!1,null))},C.prototype.createFlyHead=function(){var e=m.GameCommonPool.requestInstant(this.flyHead);if(null!=e)return e},C.prototype.holdingHead=function(){var e;null!=this.roleData&&this.roleData.headDroped&&this.roleData.holdHead&&null!=this.head&&(e=this.spineController.getShieldBoneLocalPos(),this.head.node.position=e)},C.prototype.teleport=function(){var e,t=this;null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||(this.roleData.isTeleporting=!0,D.EffectCreate.createAppearEffect(this.roleData.logicPos),e=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),u.TimerManager.addTimer(.8,function(){if(null!=t.roleData&&!t.roleData.isDead&&!t.roleData.isDestroy){g.EnemyArea.setEnemyPostionMap(e.x,null);var a=g.EnemyArea.getEmptyPosition(t.roleData);if(null==a)return t.node.position=t.roleData.logicPos,void(t.footRest&&t.footRest.updatePosition());t.roleData.logicPos=a,D.EffectCreate.createAppearEffect(t.roleData.logicPos),t.node.position=t.roleData.logicPos,t.footRest&&t.footRest.updatePosition(),g.EnemyArea.setEnemyPostionMap(t.roleData.logicPos.x,t.roleData),t.roleData.isTeleporting=!1,t.attack()}},this.node))},C.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isShootingHead?this.isHitAniRunning=!1:this.isHitAniRunning||(this.node.stopAllActions(),this.isHitAniRunning=!0,this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,e.spineController.playAnimation(d.SpineAniNameEnum.Hero_st,!1,!0,null)}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},C.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.node.pauseAllActions(),this.spineController.pauseAnimation(!0),u.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,u.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.node.resumeAllActions(),t.spineController.pauseAnimation(!1),u.TimerManager.resumeAllTimers(t.node))},this.node))},C.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||v.RoleManager.hitRole(this.roleData)},C.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.close())},C.prototype.equipHead=function(){var e,t,a=this;null==this.roleData||this.roleData.isDead||null!=(t=g.EnemyArea.createRoleHead(this.roleData))&&(t.setPosition(this.roleData.logicPos),null==(e=t.getComponent(r.Head))||null!=(t=t.getComponent(cc.Collider))&&(this.roleData.headDroped=!1,this.head=e,this.head.bindData(this.roleData),this.spineController.bindData(this.roleData,null,t),u.TimerManager.addTimer(1,function(){null==a.roleData||a.roleData.isDead||a.roleData.isDestroy||a.teleport()},this.node)))},C.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,this.node.stopAllActions(),this.spineController.pauseAnimation(!1),u.TimerManager.removeAllTimers(this.node),p.GameManager.killEnemy(this.roleData),A.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?d.SpineAniNameEnum.D2:d.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){var e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady&&null==g.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void g.EnemyArea.necromancer.reviveEnemy(t.roleData);u.TimerManager.addTimer(.1,function(){if(null!=t.roleData){if(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,S.SpecailSkill.killBlast(t.roleData))return t.roleData.isDestroy=!0,void t.close();t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))}},t.node)}))},__decorate([o({displayName:"\u98de\u5934",type:cc.Prefab})],C.prototype,"flyHead",void 0),n=__decorate([n],C),i.FlyHeadGhost=n,cc._RF.pop()},{}],FlyHead:[function(e,t,a){"use strict";cc._RF.push(t,"7dabdeImYxC/IcuAniv+hQn","FlyHead");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NewBezier"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("Util"),d=n("EnumAndConst"),u=n("Body"),h=n("Head"),m=n("Shield"),f=n("BattleNodeManager"),g=n("MagicBallBlast"),y=n("LocalSoundManager"),v=n("EquipmentEffectSystem"),D=n("EnemyArea"),E=n("GameCommonPool"),S=n("SingleEffectManager"),A=n("RoleManager"),C=n("LocalData"),M=n("GameState"),T=n("PlayerState");function _(){var e=null!==l&&l.apply(this,arguments)||this;return e.partical=null,e.roleData=null,e.targetPos=null,e.head=null,e.moveBezier=null,e.isDestroy=!1,e.destroyAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(_,l),_.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.NextPart,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.targetPos=null,this.head=null,this.moveBezier=null,this.isDestroy=!1,this.destroyAction=null},_.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.NextPart,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},_.prototype.update=function(e){null!=this.targetPos&&(this.roleData.isDead||p.Util.getDistance(this.node.position,this.targetPos)<100*e?this.blast(null):null!=this.moveBezier&&(e=this.moveBezier.update(e),this.node.position=e,null!=this.head&&this.head.isValid&&(this.head.position=this.node.position)))},_.prototype.bindData=function(e,t,a){this.roleData=e,this.head=t,this.destroyAction=a;var n,o=T.PlayerState.playerData;null!=o&&(n=o.logicPos,this.targetPos=n,t=(e=cc.v2((n.x+this.node.x)/3,(n.y+this.node.y)/3)).mul(2),a=n.sub(this.node.position).normalize(),o=p.Util.rotateAngle(a,90),a=M.GameState.endlessModel?p.Util.getRandomFloatNum(-100,300):300,e=e.add(o.mul(a)),a=t.add(o.mul(a)),e.x<=-200&&(e.x=-200),a.x<=-200&&(a.x=-200),this.partical.resetSystem(),n=new r.NewBezier(this.node.position,e,a,n,160),this.moveBezier=n)},_.prototype.onCollisionEnter=function(e){if(null!=this.roleData)if(e.node.group!=d.GroupNameEnum.BODY)if(e.node.group!=d.GroupNameEnum.HEAD){if(e.node.group==d.GroupNameEnum.SHIELD&&null!=(n=e.getComponent(m.Shield))&&null!=(i=n.roleData)&&!i.isTeleporting&&i!=this.roleData&&i.isEnemy!=this.roleData.isEnemy){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);o=this.roleData.atk,i.isPlayer&&(l=0,o*=1-(l+=(null==v.EquipmentEffectSystem.currentHelmetEffectData[3]?0:v.EquipmentEffectSystem.currentHelmetEffectData[3])+(null==v.EquipmentEffectSystem.currentShieldEffectData[3]?0:v.EquipmentEffectSystem.currentShieldEffectData[3]))),A.RoleManager.equipmentIsDamaged(i,C.EquipmentType.shield,this.roleData,o,this.node.position),i.shieldDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),n.drop(200*a.x,200*a.y)),this.blast(null)}}else{var t=e.getComponent(h.Head);if(null!=t&&null!=(i=t.roleData)&&!i.isTeleporting&&i!=this.roleData&&i.isEnemy!=this.roleData.isEnemy&&!i.headDroped){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);if(0<i.helmetDefense){var a,n=this.roleData.atk;return i.isPlayer&&(l=0,n*=1-(l+=(null==v.EquipmentEffectSystem.currentHelmetEffectData[3]?0:v.EquipmentEffectSystem.currentHelmetEffectData[3])+(null==v.EquipmentEffectSystem.currentShieldEffectData[3]?0:v.EquipmentEffectSystem.currentShieldEffectData[3]))),A.RoleManager.equipmentIsDamaged(i,C.EquipmentType.helmet,this.roleData,n,this.node.position),null!=t.helmet&&t.helmet.node.active&&i.helmetDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),t.helmet.drop(200*a.x,200*a.y),t.helmet=null),void this.blast(null)}var o=this.roleData.atk;i.isPlayer&&(l=0,o*=1-(l+=(null==v.EquipmentEffectSystem.currentHelmetEffectData[3]?0:v.EquipmentEffectSystem.currentHelmetEffectData[3])+(null==v.EquipmentEffectSystem.currentShieldEffectData[3]?0:v.EquipmentEffectSystem.currentShieldEffectData[3]))),A.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0&&(r=this.node.x>i.logicPos.x?1:-1,S.SingleEffectManager.showBloodEffect(i.logicPos,r,i)),this.blast(i)}}else{var i;if(null!=(e=e.getComponent(u.Body))&&null!=(i=e.roleData)&&!i.isTeleporting&&i!=this.roleData&&i.isEnemy!=this.roleData.isEnemy){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);var l,r;o=this.roleData.atk,i.isPlayer&&(l=0,o*=1-(l+=(null==v.EquipmentEffectSystem.currentHelmetEffectData[3]?0:v.EquipmentEffectSystem.currentHelmetEffectData[3])+(null==v.EquipmentEffectSystem.currentShieldEffectData[3]?0:v.EquipmentEffectSystem.currentShieldEffectData[3]))),A.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0&&(r=this.node.x>i.logicPos.x?1:-1,S.SingleEffectManager.showBloodEffect(i.logicPos,r,i)),this.blast(i)}}},_.prototype.blast=function(e,t){var a,n,o;void 0===t&&(t=!1),this.isDestroy||(this.isDestroy=!0,null!=(a=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(null==(n=D.EnemyArea.createMaigcBallBlast())||null!=(o=n.getComponent(g.MagicBallBlast))&&(t||y.LocalSoundManager.playBlastAudio(),n.setParent(a),n.setPosition(this.node.position),o.showBlast(this.roleData,e,!0),null!=this.destroyAction&&(this.destroyAction(),this.destroyAction=null),this.close())))},_.prototype.isReviveKnocked=function(){null!=this.roleData&&this.blast(T.PlayerState.playerData,!0)},_.prototype.close=function(){null!=this.head&&this.head.destroy(),E.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7c92\u5b50",type:cc.ParticleSystem})],_.prototype,"partical",void 0),n=__decorate([n],_),i.FlyHead=n,cc._RF.pop()},{}],FootRest:[function(e,t,a){"use strict";cc._RF.push(t,"38146mndABIxr5EGitwIgZt","FootRest");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("EnumAndConst"),s=o("GameCommonPool");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.roleData=null,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(c,l),c.prototype.lateUpdate=function(){null==this.roleData||this.roleData.isFeignDeath||(this.roleData.isDestroy?this.close():this.roleData.profession!=r.ProfessionEnum.SHORT_ZOMBIE&&this.roleData.profession!=r.ProfessionEnum.SHARKER&&this.roleData.profession!=r.ProfessionEnum.SHIELD_DEFENDER&&this.roleData.profession!=r.ProfessionEnum.ROBOT_MIXED||this.roleData.profession==r.ProfessionEnum.SHIELD_DEFENDER&&this.roleData.isEnemy||this.updatePosition())},c.prototype.bindData=function(e){null!=e&&(this.roleData=e,this.node.opacity=this.roleData.isEnemy?255:153,this.node.scale=this.roleData.isBoss?2:1,this.updatePosition())},c.prototype.updatePosition=function(e){null!=this.roleData&&(this.node.position=null!=e?e:cc.v2(this.roleData.logicPos.x,this.roleData.logicPos.y-(this.roleData.isBoss?65:35)))},c.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},o=__decorate([o],c),i.FootRest=o,cc._RF.pop()},{}],FrozenEffect:[function(e,t,a){"use strict";cc._RF.push(t,"6249aO9sMFKkp7yV9ajWDNO","FrozenEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("LocalSoundManager"),d=n("SkillSystem"),u=n("EnumAndConst"),h=n("SingleEffectManager"),m=n("RoleManager"),f=n("EffectCreate");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.iceCircle=null,e.rotateLight=null,e.snow=null,e.targetData=null,e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.onEnable=function(){p.LocalSoundManager.playFrozenAudio(),s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.iceCircle.stopAllActions(),this.rotateLight.stopAllActions(),this.snow.stopAllActions(),this.iceCircle.runAction(cc.repeatForever(cc.rotateBy(5,-360))),this.rotateLight.runAction(cc.repeatForever(cc.rotateBy(5,360))),this.snow.runAction(cc.repeatForever(cc.rotateBy(5,360)))},g.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},g.prototype.update=function(){if(null!=this.targetData)return this.targetData.isDead||this.targetData.isFeignDeath?(this.targetData.isFrozening=!1,void this.close()):void(this.targetData.isDead||this.targetData.isFrozening||(f.EffectCreate.createFrozenImmuneEffect(this.targetData),this.close()));this.close()},g.prototype.lateUpdate=function(){null!=this.targetData&&(this.targetData.profession==u.ProfessionEnum.LAUNCHER&&!this.targetData.isBoss||this.targetData.profession==u.ProfessionEnum.NECROMANCER||this.targetData.profession==u.ProfessionEnum.SHIELD_WIZARD||this.updatePosition())},g.prototype.bindData=function(e,t,a){void 0===a&&(a=null),this.targetData=t,this.roleData=e,null==a&&(a=this.roleData.isPlayer?d.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.FROZEN):d.SkillSystem.getEquipedSkillInitData(u.SkillTypeEnum.FROZEN)),this.targetData.isBoss&&(a/=2),this.targetData.frozenTime=a,m.RoleManager.frozeRole(t)},g.prototype.updatePosition=function(e){null!=this.targetData&&(this.node.position=null==e?this.targetData.logicPos:e)},g.prototype.close=function(){h.SingleEffectManager.deleteEffect(this.targetData,h.SingleEffectTypeEnum.FROZEN_EFFCT),r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u51b0\u5708",type:cc.Node})],g.prototype,"iceCircle",void 0),__decorate([o({displayName:"\u65cb\u8f6c\u5149",type:cc.Node})],g.prototype,"rotateLight",void 0),__decorate([o({displayName:"\u96ea\u82b1",type:cc.Node})],g.prototype,"snow",void 0),n=__decorate([n],g),i.FrozenEffect=n,cc._RF.pop()},{}],FrozenImmuneEffect:[function(e,t,a){"use strict";cc._RF.push(t,"32abfZxumtMEpvr2DdQKzJp","FrozenImmuneEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool"),p=n("EnumAndConst");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.snowNode=null,e.targetData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){this.snowNode.stopAllActions(),this.snowNode.runAction(cc.repeatForever(cc.rotateBy(1,180))),r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.update=function(e){if(null!=this.targetData){if(this.targetData.isTeleporting?this.node.opacity=0:this.node.opacity=162,this.targetData.isDead||this.targetData.frozenImmuneTime<=0)return this.targetData.frozenImmuneTime=0,void this.close();this.targetData.isTeleporting||(this.targetData.frozenImmuneTime-=e)}},d.prototype.lateUpdate=function(){null!=this.targetData&&(this.targetData.profession==p.ProfessionEnum.LAUNCHER&&!this.targetData.isBoss||this.targetData.profession==p.ProfessionEnum.NECROMANCER||this.targetData.profession==p.ProfessionEnum.SHIELD_WIZARD||this.updatePosition())},d.prototype.bindData=function(e){this.targetData=e,this.targetData.frozenImmuneTime=this.targetData.isBoss?6:3},d.prototype.updatePosition=function(e){null!=this.targetData&&(this.node.position=null==e?this.targetData.logicPos:e)},d.prototype.close=function(){this.targetData=null,c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u96ea\u82b1",type:cc.Node})],d.prototype,"snowNode",void 0),n=__decorate([n],d),i.FrozenImmuneEffect=n,cc._RF.pop()},{}],FuryEffect:[function(e,t,a){"use strict";cc._RF.push(t,"70660iN7IdEnJJSrmQo2rUD","FuryEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("PlayerState");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.furyEffectAni=null,e.playerData=null,e.lastPlayerHp=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.furyEffectAni.play("Fury"),this.playerData=p.PlayerState.playerData},d.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},d.prototype.update=function(){null!=this.playerData&&this.lastPlayerHp!=this.playerData.hp&&(this.lastPlayerHp=this.playerData.hp,this.node.scale=Math.max(1,2.5*(1-this.lastPlayerHp/this.playerData.maxHp)))},d.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u72c2\u6012\u7279\u6548\u52a8\u753b",type:cc.Animation})],d.prototype,"furyEffectAni",void 0),n=__decorate([n],d),i.FuryEffect=n,cc._RF.pop()},{}],GameClub:[function(e,t,a){"use strict";cc._RF.push(t,"94dfdtImGVAPpGQcLztGJl9","GameClub");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.gameClubBtn=null,e.widget=null,e.target=null,e._width=null,e._height=null,e._left=null,e._top=null,e._orignalPosition=null,e}i=cc.Component,__extends(r,i),r.prototype.onLoad=function(){null!=this.widget&&null!=this.target&&(this.widget.updateAlignment(),this._width=this.target.width,this._height=this.target.height,this._orignalPosition=this.target.convertToWorldSpaceAR(cc.v2(0,0)),this._left=this._orignalPosition.x-.5*this._width,this._top=640-this._orignalPosition.y-.5*this._height)},r.prototype.onEnable=function(){var e;null==this.gameClubBtn?cc.sys.platform!==cc.sys.WECHAT_GAME||null==wx||null==wx.createGameClubButton||"function"!=typeof wx.createGameClubButton||null!=(e=window.gameCommon.getSDK.getSystemInfo())&&(e=e.screenHeight/640,this.gameClubBtn=wx.createGameClubButton({icon:"green",style:{left:this._left*e,top:this._top*e,width:this._width*e,height:this._height*e}})):this.gameClubBtn.show()},r.prototype.onDisable=function(){cc.sys.platform===cc.sys.WECHAT_GAME&&null!=this.gameClubBtn&&this.gameClubBtn.hide()},__decorate([l(cc.Widget)],r.prototype,"widget",void 0),__decorate([l(cc.Node)],r.prototype,"target",void 0),n=__decorate([n],r),o.GameClub=n,cc._RF.pop()},{}],GameCommonHttp:[function(e,t,a){"use strict";cc._RF.push(t,"04d50iw/0BNaoSDBinKdzSL","GameCommonHttp");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.httpGets=function(e,t){e=encodeURI(e);var a=!1;try{var n=cc.loader.getXMLHttpRequest();n.onreadystatechange=function(){var e;4===n.readyState&&200<=n.status&&n.status<300&&(a||(a=!0,e=n.responseText,null!=t&&t(0,e),console.log("httpGet succ")))},n.open("GET",e,!0),cc.sys.isNative&&n.setRequestHeader("Accept-Encoding","gzip,deflate"),n.timeout=5e3,n.send()}catch(e){if(a)return;a=!0,console.log("httpPost fail:"+e),null!=t&&t(1,null)}setTimeout(function(){a||(a=!0,null!=t&&t(-1,null))},5e3)},o.httpPost=function(e,t,a){e=encodeURI(e);var n=!1;try{var o=cc.loader.getXMLHttpRequest();o.onreadystatechange=function(){var e;4===o.readyState&&200<=o.status&&o.status<300&&(n||(n=!0,e=o.responseText,null!=a&&a(0,e),console.log("httpPost succ:"+this.response)))},o.open("POST",e,!0),cc.sys.isNative&&o.setRequestHeader("Accept-Encoding","gzip,deflate"),o.setRequestHeader("Content-Type","application/json"),o.timeout=5e3,o.send(t)}catch(e){if(n)return;n=!0,console.log("httpPost fail:"+e),null!=a&&a(1,null)}setTimeout(function(){n||(n=!0,null!=a&&a(-1,null))},5e3)},o.wxHttpGet=function(e,t){null!=e&&(-1==e.indexOf("mcachenum")&&(-1<e.indexOf("?")?e+="&mcachenum="+Date.now():e+="?mcachenum="+Date.now()),console.log(e),cc.sys.platform===cc.sys.WECHAT_GAME?wx.request({url:e,success:function(e){console.log(e),t&&t(e&&e.resultCode?e.resultCode:0,e.data)},fail:function(e){console.error(e),t&&t(e&&e.resultCode?e.resultCode:-1,null)}}):this.httpGets(e,function(e,a){t&&t(e,a&&JSON.parse(a))}))},o.wxHttpPost=function(e,t,a,n){void 0===n&&(n=!0),null!=e&&(n&&-1==e.indexOf("mcachenum")&&(-1<e.indexOf("?")?e+="&mcachenum="+Date.now():e+="?mcachenum="+Date.now()),console.log(e,t),cc.sys.platform===cc.sys.WECHAT_GAME?wx.request({url:e,data:t,method:"POST",header:{"content-type":"application/json",charset:"utf-8"},success:function(e){console.log(e),a&&a(e&&e.resultCode?e.resultCode:0,e.data)},fail:function(e){console.error(e),a&&a(e&&e.resultCode?e.resultCode:-1,null)}}):this.httpPost(e,t&&JSON.stringify(t),function(e,t){a&&a(e,t&&JSON.parse(t))}))},n.GameCommonHttp=o,cc._RF.pop()},{}],GameCommonPool:[function(e,t,a){"use strict";cc._RF.push(t,"68a52npuJpB5rVaWiOFM/zP","GameCommonPool");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.addUrlToPrefab=function(e,t){null!=e&&null!=t&&this.urlToPrefab.set(e,t)},o.addPrefabPool=function(e){var t;this.currentPool.has(e)||(t=new Array,this.currentPool.set(e,t))},o.addAndPopInstant=function(e){var t=cc.instantiate(e);return null==t?null:(this.pool.add(t),this.instantToPrefab.set(t,e),t)},o.requestInstantWithArgs=function(e,t,a,n){this.addPrefabPool(e);var o=this.currentPool.get(e);return null==o||null==(o=null==(o=o.pop())?this.addAndPopInstant(e):o)?null:(o.angle=a,o.position=t,o.active=!0,o.setParent(n),o)},o.requestInstant=function(e){this.addPrefabPool(e);var t=this.currentPool.get(e);return null==t||null==(t=null==(t=t.pop())?this.addAndPopInstant(e):t)?null:(t.active=!0,t)},o.requestInstantByUrl=function(e,t){var a;null!=e?this.urlToPrefab.has(e)?(a=this.urlToPrefab.get(e),a=this.requestInstant(a),null!=t&&t(null,a)):cc.loader.loadRes(e,function(a,n){null==a&&null!=n?(o.addUrlToPrefab(e,n),n=o.requestInstant(n),null!=t&&t(a,n)):t(a,null)}):null!=t&&t("null url",null)},o.returnInstant=function(e,t){var a;void 0===t&&(t=!0),null!=e&&e.isValid&&(e.active=!1,e.removeFromParent(t),null!=(a=this.instantToPrefab.get(e))&&(null==(t=this.currentPool.get(a))&&(this.addPrefabPool(a),t=this.currentPool.get(a)),null!=t&&-1==t.indexOf(e)&&t.push(e)))},o.reset=function(){this.pool.forEach(function(e){e&&e.isValid&&e.destroy()}),this.pool.clear(),this.currentPool.clear(),this.instantToPrefab.clear(),this.urlToPrefab.clear(),cc.sys.platform===cc.sys.WECHAT_GAME&&wx.triggerGC()},o.onMemoryWarning=function(){var e=this;cc.sys.platform===cc.sys.WECHAT_GAME&&wx.onMemoryWarning(function(){e.currentPool.forEach(function(t){null!=t&&t.forEach(function(t){t&&t.isValid&&t.destroy(),e.instantToPrefab.delete(t)})}),e.currentPool.clear(),wx.triggerGC()})},o.pool=new Set,o.currentPool=new Map,o.instantToPrefab=new Map,o.urlToPrefab=new Map,n.GameCommonPool=o,cc._RF.pop()},{}],GameCommonUtil:[function(e,t,a){"use strict";cc._RF.push(t,"66c01RHrNlPeLG+tgBL6CEg","GameCommonUtil");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.uuid=function(){for(var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=[],a=0;a<32;a++)t[a]=e[0|16*Math.random()];return t.join("")},o.getShotNumberStr=function(e){return e<1e4?""+e:(e=Math.floor(e/1e3))<1e4?e+"K":(e=Math.floor(e/1e3))<1e4?e+"M":(e=Math.floor(e/1e3))<1e4?e+"G":(e=Math.floor(e/1e3))<1e4?e+"A":(e=Math.floor(e/1e3))<1e4?e+"B":(e=Math.floor(e/1e3))<1e4?e+"C":(e=Math.floor(e/1e3))<1e4?e+"D":(e=Math.floor(e/1e3))<1e4?e+"F":(e=Math.floor(e/1e3))<1e4?e+"AA":(e=Math.floor(e/1e3))<1e4?e+"BB":(e=Math.floor(e/1e3))<1e4?e+"CC":(e=Math.floor(e/1e3))<1e4?e+"DD":(e=Math.floor(e/1e3))<1e4?e+"EE":(e=Math.floor(e/1e3))<1e4?e+"FF":void 0},o.getLongNumberStr=function(e){return e<1e3?""+e:e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3):(e=Math.floor(e/1e3))<1e3?e+"K":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"K":(e=Math.floor(e/1e3))<1e3?e+"M":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"M":(e=Math.floor(e/1e3))<1e3?e+"G":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"G":(e=Math.floor(e/1e3))<1e3?e+"A":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"A":(e=Math.floor(e/1e3))<1e3?e+"B":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"B":(e=Math.floor(e/1e3))<1e3?e+"C":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"C":(e=Math.floor(e/1e3))<1e3?e+"D":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"D":(e=Math.floor(e/1e3))<1e3?e+"E":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"E":(e=Math.floor(e/1e3))<1e3?e+"F":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"F":(e=Math.floor(e/1e3))<1e3?e+"AA":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"AA":(e=Math.floor(e/1e3))<1e3?e+"BB":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"BB":(e=Math.floor(e/1e3))<1e3?e+"CC":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"CC":(e=Math.floor(e/1e3))<1e3?e+"DD":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"DD":(e=Math.floor(e/1e3))<1e3?e+"EE":e<1e6?Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"EE":(e=Math.floor(e/1e3))<1e3?e+"FF":Math.floor(e/1e3)+","+("00"+e%1e3).slice(-3)+"FF"},o.getFloatNumberStr=function(e){var t=".";return e<1e4?""+e:(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"K":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"M":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"G":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"A":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"B":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"C":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"D":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"F":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"AA":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"BB":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"CC":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"DD":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"EE":(t="."+e%1e3,(e=Math.floor(e/1e3))<1e4?""+e+t+"FF":void 0))))))))))))))},o.isToday=function(e){return console.log(new Date(e).toDateString()),console.log((new Date).toDateString()),new Date(e).toDateString()===(new Date).toDateString()},o.getTextureByUrl=function(e,t){null!=e&&null!=t&&cc.loader.load({url:e,type:"png"},function(e,a){t(a)})},o.compareVersion=function(e,t){if(null==e||null==t)return 0;for(var a=e.split("."),n=t.split("."),o=Math.max(a.length,n.length);a.length<o;)a.push("0");for(;n.length<o;)n.push("0");for(var i=0;i<o;i++){var l=parseInt(a[i]),r=parseInt(n[i]);if(r<l)return 1;if(l<r)return-1}return 0},n.GameCommonUtil=o,cc._RF.pop()},{}],GameCommon:[function(e,t,a){"use strict";cc._RF.push(t,"9061ded53FI2aoazA6ACjyi","GameCommon");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("WxSDK"),c=n("WebSDK"),p=n("ShareManager"),d=n("AdManager"),u=n("UserData"),h=n("WorldEventManager"),m=n("WorldEventType"),f=n("GameCommonPool");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.wxAppId="",e.appName="",e.versionCode="1.0.0",e.versionSuffix="0",e.domainName="dcgstd.cn",e.videoAdUnitId="",e.bannerAdUnitId="",e.interstitialAdUnitId="",e.saveRemoteData=!1,e._sdk=null,e.storageDataInterval=0,e.userDataInit=!1,e.shareManagerInit=!1,e.sdkLanch=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),(r=g).prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),window.gameCommon=this,cc.sys.platform==cc.sys.WECHAT_GAME&&wx.$$Rangers.event("enter_scene_succ"),y.wxAppId=this.wxAppId,y.wxAppName=this.appName,y.saveRemoteData=this.saveRemoteData,y.versionCode=this.versionCode,y.versionSuffix=this.versionSuffix,null!=this.domainName&&""!=this.domainName&&p.ShareManager.resetDomainName(this.domainName),null!=this.videoAdUnitId&&""!=this.videoAdUnitId&&(y.videoAdUnitId=this.videoAdUnitId),null!=this.bannerAdUnitId&&""!=this.bannerAdUnitId&&(y.bannerAdUnitId=this.bannerAdUnitId),null!=this.interstitialAdUnitId&&""!=this.interstitialAdUnitId&&(y.interstitialAdUnitId=this.interstitialAdUnitId),r.isWechat()?(this._sdk=new s.WxSDK,this._sdk.wxInitData(),d.AdManager.initVideoAd(),d.AdManager.initInterstitialAD()):this._sdk=new c.WebSDK;var e=this;p.ShareManager.init(function(){console.log("ShareManager Init Call"),e.shareManagerInit=!0,h.WorldEventManager.triggerEvent(m.WorldEventType.GetShareFlagFinish,null),e.appGameLaunch()}),f.GameCommonPool.onMemoryWarning()},g.prototype.start=function(){var e=this;h.WorldEventManager.addListener(m.WorldEventType.GetUserDataFinish,function(){e.userDataInit=!0,e.appGameLaunch()},this)},g.prototype.update=function(e){u.UserData.init&&null!=this._sdk&&(this.storageDataInterval+=e,60<=this.storageDataInterval&&(this._sdk.setStorage(u.UserData.storageKey,u.UserData.getJsonStr()),this.storageDataInterval=0))},g.prototype.appGameLaunch=function(){this.shareManagerInit&&!this.sdkLanch&&(this._sdk&&this._sdk.appGameOnLanch(),this.sdkLanch=!0),this.userDataInit&&this.shareManagerInit&&h.WorldEventManager.triggerEvent(m.WorldEventType.GetAllFinish,null)},Object.defineProperty(g.prototype,"getSDK",{get:function(){return this._sdk},enumerable:!0,configurable:!0}),g.isQQ=function(){return CC_QQPLAY},g.isWechat=function(){return cc.sys.platform===cc.sys.WECHAT_GAME},g.isWeb=function(){return cc.sys.isBrowser},__decorate([o({displayName:"wxAppId"})],g.prototype,"wxAppId",void 0),__decorate([o({displayName:"\u6e38\u620f\u540d\u79f0\u7f29\u5199"})],g.prototype,"appName",void 0),__decorate([o({displayName:"\u6e38\u620f\u7248\u672c\u53f7"})],g.prototype,"versionCode",void 0),__decorate([o({displayName:"\u7248\u672c\u540e\u7f00"})],g.prototype,"versionSuffix",void 0),__decorate([o({displayName:"\u4e8c\u7ea7\u57df\u540d"})],g.prototype,"domainName",void 0),__decorate([o({displayName:"\u89c6\u9891\u5e7f\u544aid"})],g.prototype,"videoAdUnitId",void 0),__decorate([o({displayName:"banner\u5e7f\u544aid"})],g.prototype,"bannerAdUnitId",void 0),__decorate([o({displayName:"\u63d2\u5c4f\u5e7f\u544aid"})],g.prototype,"interstitialAdUnitId",void 0),__decorate([o({displayName:"\u662f\u5426\u4fdd\u5b58\u6570\u636e\u5230\u670d\u52a1\u5668"})],g.prototype,"saveRemoteData",void 0),n=r=__decorate([n],g),i.GameCommon=n;var y=(v.DefaultChannelId="dmm",v.wxAppId="exzample_id",v.wxAppName="exzample_name",v.versionCode="1.0.0",v.versionSuffix="0",v.videoAdUnitId=null,v.bannerAdUnitId=null,v.interstitialAdUnitId=null,v.saveRemoteData=!0,v);function v(){}i.GameConfig=y,cc._RF.pop()},{}],GameConfigData:[function(e,t,a){"use strict";cc._RF.push(t,"29fb5oO9vtIbYswUhptYNrL","GameConfigData");var n=a;function o(){this.MAX_CHAPTER_COUNT=7,this.normalEnergyCost=5,this.endlessEnergyCost=10,this.bossInitHp=[[1500,2e3],[3750,6375],[8400,14400],[15300,26350],[25300,43700],[39e3,67500],[57200,99e3]],this.heroBossInitHp=[[2500,3e3],[6e3,9750],[13200,21600],[23800,39100],[39100,64400],[6e4,99e3],[88e3,145200]],this.enemyInitHp=[[100,150,200,250],[150,150,225,225],[240,300,360,420],[340,425,510,595],[460,575,690,805],[600,750,900,1050],[880,1100,1320,1540]],this.enemyInitDefense=[[100,100,100,100],[50,75,100,125],[75,100,125,210],[100,125,210,290],[125,200,290,580],[290,580,780,780],[320,640,980,980]],this.enemyCount=[3,4,4,6,6,8,8,10,10,0,12,12,12,12,12,12,12,12,12,0,4,6,6,8,8,10,10,12,12,0,16,16,18,18,20,20,20,20,20,0,4,6,6,8,8,10,10,12,12,0,16,16,18,18,20,20,20,20,20,0,4,6,6,8,8,10,10,12,12,0,16,16,18,18,20,20,20,20,20,0,6,8,8,10,10,12,12,14,14,0,18,18,20,20,20,20,20,20,20,0,8,8,10,10,12,12,14,14,16,0,16,16,18,18,20,20,20,20,20,0,8,8,10,10,12,12,14,14,16,0,16,16,18,18,20,20,20,20,20,0],this.enemyChanceConfig=[[.3,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[.2,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[.1,.6,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[0,.3,.6,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0],[.1,.5,.6,0,.7,0,0,1,0,0,0,0,0,0,0,0,0,0],[.1,.3,.4,0,0,0,0,.6,.7,0,0,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.6,.7,0,0,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.6,.7,0,0,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.6,.7,0,0,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,.3,.4,0,.5,0,0,.6,.7,0,1,0,0,0,0,0,0,0],[0,.3,.4,0,.5,0,0,.6,.7,0,1,0,0,0,0,0,0,0],[0,.3,.4,0,.5,0,0,.6,.7,0,1,0,0,0,0,0,0,0],[0,.3,.4,0,.5,0,0,.6,.7,0,1,0,0,0,0,0,0,0],[0,.3,.4,0,.5,0,0,.6,.7,0,0,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.5,.6,0,.8,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.5,.6,0,.8,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.5,.6,0,.8,1,0,0,0,0,0,0],[0,.2,.3,0,.4,0,0,.5,.6,0,.8,1,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,.2,.4,0,0,0,.7,1,0,0,0,0,0,0,0,0,0],[0,.1,.3,.5,0,0,0,.7,1,0,0,0,0,0,0,0,0,0],[0,0,.2,.4,0,0,0,.7,1,0,0,0,0,0,0,0,0,0],[0,.1,.3,.5,0,0,0,.7,1,0,0,0,0,0,0,0,0,0],[0,.1,.3,.5,0,0,0,.7,1,0,0,0,0,0,0,0,0,0],[0,0,.2,.4,0,0,0,.6,0,.7,0,0,1,0,0,0,0,0],[0,0,.2,.4,0,0,0,.6,0,.7,0,0,1,0,0,0,0,0],[0,0,.2,.4,0,0,0,.6,0,.7,0,0,1,0,0,0,0,0],[0,0,.2,.4,0,0,0,.6,0,.7,0,0,1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,.2,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,.2,0,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,0,.2,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,.2,0,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,0,.2,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,.2,0,0,0,.4,0,.6,.8,0,0,1,0,0,0,0],[0,0,0,0,.2,0,0,.4,0,.6,0,0,.8,1,0,0,0,0],[0,0,0,.2,0,0,0,.4,0,.6,0,0,.8,1,0,0,0,0],[0,0,0,0,.2,0,0,.4,0,.6,0,0,.8,1,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,.2,.4,.7,0,0,0,0,0,0,1,0,0,0,0,0,0],[.1,0,0,.3,.5,0,0,.7,0,0,0,1,0,0,0,0,0,0],[0,0,.2,.4,.7,0,0,0,0,0,0,1,0,0,0,0,0,0],[.1,0,0,.3,.5,0,0,.7,0,0,0,0,1,0,0,0,0,0],[.1,0,0,.3,.5,0,0,.7,0,0,0,0,0,1,0,0,0,0],[0,0,0,.2,.4,0,0,.6,0,.7,0,0,0,0,1,0,0,0],[0,0,0,.2,.4,.6,0,0,0,.7,0,0,0,1,0,0,0,0],[0,0,0,.2,.4,0,0,.6,0,.7,0,0,0,0,1,0,0,0],[0,0,0,.2,.4,.6,0,0,0,.7,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,1,0,0,0],[0,0,0,.2,0,0,0,0,.4,.6,.8,0,0,1,0,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,.8,0,0,1,0,0,0],[0,0,0,.2,0,0,0,0,.4,.6,.8,0,0,1,0,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,1,0,0,0],[0,0,0,.2,0,0,0,0,.4,.6,0,0,0,.8,1,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,1,0,0,0],[0,0,0,.2,0,0,0,0,.4,.6,0,0,0,.8,1,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,1,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,.2,0,0,.4,.7,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,.3,.5,0,0,0,0,.7,0,0,1,0,0,0,0,0],[0,0,.2,0,0,.4,.7,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,.3,.5,0,0,0,0,.7,0,0,0,0,0,1,0,0],[0,0,.3,0,0,.5,.7,0,0,0,0,0,0,0,0,1,0,0],[0,0,0,.2,.4,0,0,.6,0,0,0,0,0,0,0,.7,1,0],[0,0,.2,0,0,.4,.6,0,0,0,0,0,0,.7,0,0,1,0],[0,0,0,.2,.4,0,0,.6,0,0,0,0,0,0,.7,0,1,0],[0,0,.2,0,0,.4,.6,0,0,0,0,0,0,0,0,.7,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,0,1,0,0],[0,0,0,.2,0,0,0,0,.4,.6,.8,0,0,0,0,0,1,0],[0,0,0,0,0,.2,0,.4,0,.6,.8,0,0,0,0,1,0,0],[0,0,0,.2,0,0,0,0,.4,0,.6,0,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,.4,0,.6,0,0,.8,0,0,1,0,0],[0,0,0,.2,0,0,0,0,0,.4,.6,0,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,.4,0,0,0,0,.6,.8,0,0,1,0],[0,0,0,.2,0,0,0,0,0,.4,.6,0,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,.4,0,0,0,0,.6,.8,0,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,.2,0,.4,0,0,0,.4,0,0,0,0,0,0,1,0],[0,0,0,.2,0,.4,0,0,0,.4,0,0,0,0,0,0,1,0],[0,0,.2,0,0,0,.4,0,0,0,0,0,.6,0,0,0,1,0],[0,0,.2,0,0,0,.4,0,0,0,0,0,.6,0,0,0,1,0],[0,0,0,.2,0,.4,0,0,0,.6,0,.7,0,.9,0,0,1,0],[0,0,0,.2,0,.4,0,0,0,.6,0,.7,0,.9,0,0,0,1],[0,0,.2,0,0,0,.4,0,0,.5,.6,0,.8,.9,0,0,0,1],[0,0,.2,0,0,0,.4,0,0,.5,.6,0,.8,.9,0,0,0,1],[0,0,.2,0,0,0,.4,0,0,.5,.6,0,.8,.9,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,.2,0,0,0,0,.4,0,0,0,.6,0,0,.8,1],[0,0,0,0,0,.2,0,0,0,0,0,.4,.6,0,.8,0,0,1],[0,0,0,0,.2,0,0,0,0,.4,0,0,0,.6,0,0,.8,1],[0,0,0,0,0,.2,0,0,0,0,0,.4,.6,0,.8,0,0,1],[0,0,0,0,.2,0,0,0,0,.4,0,0,0,.6,0,0,.8,1],[0,0,0,0,0,.2,0,0,0,0,0,.4,.6,0,.8,0,0,1],[0,0,0,0,.2,0,0,0,0,.4,0,0,0,.6,0,0,.8,1],[0,0,0,0,0,.2,0,0,0,0,0,.4,.6,0,0,0,.8,1],[0,0,0,0,.2,0,0,0,0,.4,0,0,0,.6,0,0,.8,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,.2,0,.4,0,.6,0,0,0,0,.8,1,0,0,0],[0,0,0,0,0,0,0,0,.2,.4,0,0,.6,0,0,0,.8,1,0,0,0],[0,0,0,0,0,0,0,.2,0,.4,0,.6,0,0,0,0,.8,1,0,0,0],[0,0,0,0,0,0,0,.2,0,0,0,0,.4,0,0,0,0,.6,0,1,0],[0,0,0,0,0,0,0,0,.2,0,0,0,0,.4,.6,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,.6,0,0,0,0,1,0],[0,0,0,0,0,0,.2,0,0,0,0,0,.4,0,0,0,.6,0,1,0,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,.6,0,0,0,1,0,0],[0,0,0,0,0,0,0,.2,0,0,0,0,.4,0,0,0,0,.6,1,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,.6,0,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,0,.7,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,.2,.4,0,0,0,.6,0,1],[0,0,0,0,0,0,.2,0,0,0,0,0,0,0,0,0,0,.4,.7,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,.2,.4,0,0,0,.7,0,1],[0,0,0,0,0,0,0,0,0,.2,0,0,.4,0,0,0,0,.6,0,1,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,.2,0,0,.4,0,.6,.8,1],[0,0,0,0,0,0,0,0,0,0,0,0,.2,0,.4,0,0,0,.6,.8,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,.6,.8,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,.2,0,0,.4,.6,0,0,0,.8,0,0,0,1,0,0],[0,0,0,0,0,.2,0,0,0,.4,0,0,.6,0,0,0,.8,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,.2,0,0,.4,.6,0,0,0,.8,0,0,0,1,0,0],[0,0,0,0,0,.2,0,0,0,.4,0,0,.6,0,0,0,.8,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,0,0,0,.6,0,0,0,.8,0,1],[0,0,0,0,0,.2,0,0,0,0,0,0,.4,0,0,0,.6,0,0,0,0,.8,1,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,0,0,0,.6,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,0,0,0,0,0,.4,0,0,0,.6,0,0,0,0,0,.8,1],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,0,0,0,.6,0,0,0,.8,0,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,.2,0,0,0,0,0,0,.4,.6,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,0,0,0,0,0,.4,0,0,0,.6,0,0,0,0,.8,0,1],[0,0,0,0,0,0,0,0,0,.2,0,0,0,0,0,0,.4,.6,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,0,0,0,0,0,.4,0,0,0,.6,0,0,0,0,.8,0,1],[0,0,0,0,0,0,0,0,0,.2,0,0,0,.4,0,0,0,.6,0,0,0,.8,1,0],[0,0,0,0,0,.2,0,0,0,0,0,0,0,0,0,0,.4,0,0,0,0,.6,.8,1],[0,0,0,0,0,0,0,0,0,.2,0,0,0,0,0,0,0,.4,0,0,0,.6,.8,1],[0,0,0,0,0,.2,0,0,0,0,0,0,0,0,0,0,.4,0,0,0,0,.6,.8,1],[0,0,0,0,0,0,0,0,0,.2,0,0,0,0,0,0,0,.4,0,0,0,.6,.8,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],this.bossRewardCoin=[60,70,80,90,100,120,150],this.dropRankChance=[[.9,.1,0,0,0],[.85,.1,.05,0,0],[.75,.17,.08,0,0],[.6,.25,.1,0,0],[.5,.33,.15,.02,0],[.5,.28,.19,.03,0],[.44,.27,.22,.07,0]],this.enemySkillChance=[[.6,.25,.15],[.55,.1,.2,.15],[.5,.1,.2,.15,.05],[.5,.1,.2,.15,.05],[.5,.1,.2,.15,.05],[.5,.1,.2,.15,.05],[.5,.1,.2,.15,.05]],this.enemySkill=[[4,22,0],[2,22,6,0],[3,22,6,0,9],[3,4,22,6,0,9],[4,2,22,6,0,9],[4,2,22,6,0,9],[4,2,22,6,0,9]],this.enemyInitAtk=[50,75,100,150,200,250,300],this.heroAddAtk=[25,50,75,100,125,150,200],this.heroAddHp=[50,100,150,200,300,400,500],this.bossAddAtk=[50,75,100,125,150,175,200],this.heroBossAddAtk=[100,150,200,250,300,350,400],this.heroDropRankChance=[[.3,.6,.1,0,0],[.25,.53,.2,.02,0],[.15,.5,.3,.05,0],[.05,.45,.4,.1,0],[0,.35,.515,.13,.005],[0,.312,.54,.14,.008],[0,.27,.56,.16,.01]],this.dropMinGem=[15,20,25,30,40,50,50],this.dropMaxGem=[30,40,50,60,70,80,80],this.heroEnemyAttackFrequency=2,this.heroBossArrakFrequency=1.5,this.heroAddHitRate=.1,this.levelUpExp=[20,30,40,50,60,70,90,110,130,150,170,200,230,260,290,320,360,400,440,480],this.skillMaxLevel=[2,3,3,2,3,2,3,3,1,1,3,99,99,99,99,3,3,3,1,3,3,1,3,3,1,3,3,1,3,3,3,3,1,1],this.skillInitData=[1,.2,4,1.5,2,1,.1,1,1,1,.05,1,1,1,1,.1,150,.1,1,.1,.2,1,.1,.6,1,.4,1,1,.3,.2,.1,.6,1,1],this.skillUpOffsetData=[1,.15,2,.5,1,1,.1,1,0,0,.025,0,0,0,0,.1,75,.1,0,.05,.1,0,.1,.4,0,.2,1,0,.4,.2,.1,.4,0,0],this.noobSkillArray=[0,1,2,3,4,5,6,7,8,9,10,15,16,17],this.recoveryAndBeatBackSectArray=[7,23,24,25],this.ummonSectArray=[26,29,27,28],this.berSerkSectArray=[32,30,24,31],this.fireSuppressionSectArray=[0,5,8,9],this.noSectSkillArray=[1,2,3,4,6,10,11,12,13,14,15,16,17,18,19,20,21,22,33],this.initialSkillArray=[1,6,15,7,8,29,23,33],this.middleSkillArray=[5,28,25,31,16,17,3,2,19,22],this.heighSkillArray=[0,24,30,4,10,2,16,18,20,21,26],this.exHeightSkillArray=[9,27,7,32],this.skillChanceConfig=[[.5,.3,.2],[.4,.3,.1,.2],[.3,.4,.2,.1],[.2,.3,.2,.3],[.4,.3,.2,.1],[.3,.2,.3,.2],[.3,.4,.2,.1],[.2,.3,.2,.3],[.4,.3,.2,.1],[.3,.2,.3,.2],[.3,.4,.2,.1],[.2,.3,.2,.3],[.4,.3,.2,.1],[.3,.2,.3,.2],[.3,.4,.2,.1],[.3,.4,.2,.1],[.3,.4,.2,.1],[.3,.4,.2,.1],[.3,.4,.2,.1],[.3,.4,.2,.1]],this.coin1Cost=30,this.coin2Cost=100,this.normalBoxCost=60,this.legendBoxCost=200,this.coin1Get=960,this.coin2Get=3840,this.gemNumGet=50,this.maxGetGemTimes=5,this.maxOpenNormalBoxTimes=3,this.legendBoxTime=43200,this.maxEnergy=20,this.getEnergyTime=360,this.maxWeaponBoxTime=1,this.weaponChance=.3,this.shieldChance=.25,this.helmetChance=.25,this.normalMinCoin=800,this.normalMaxCoin=1500,this.legendMinCoin=2500,this.legendMaxCoin=6e3,this.normalBoxChance=[.2,.3,.25,.15,.2,.1,.35,.25,.2,.15,.05,.35,.25,.2,.15,.05],this.legendBoxChance=[.2,.1,.15,.25,.3,.2,.1,.15,.25,.3,.2,.15,.15,.2,.25,.25],this.normalCountChance=[.65,.35],this.legendCountChance=[0,.7,.3],this.weaponCountChance=[.7,.3],this.normalRankChance=[.75,.2,.05],this.legendRankChance=[.3,.39,.2,.1,.01],this.weaponRankChance=[0,.55,.295,.15,.05],this.eggMachineDailyMaxTime=5,this.eggBottomTime=20,this.eggGemCost=100,this.eggTypeChance=[.15,.2,.25,.15,.25],this.eggGemRankChance=[.595,.34,.06,.005],this.eggVideoRankChance=[.86,.12,.02],this.eggCoinChance=[.38,.34,.18,.1],this.eggGemMinCoinChance=[1800,2301,2801,3501],this.eggGemMaxCoinChance=[2300,2800,3500,4e3],this.eggVideoMinCoinChance=[800,901,1001,1101],this.eggVideoMaxCoinChance=[900,1e3,1100,1200],this.talentData=[50,.2,5,.03,.05],this.talentMaxLevel=[10,10,10,10,10,1],this.talentCost=800,this.maxTalentCount=6,this.weaponMaxForce=1600,this.weaponEffectData=[1,.05,.05,1,1,.05,1,1,.05,.05,1,1],this.denfenseEffectData=[.05,.05,.05,.05,.05,1,.05,.05,.05,.05],this.cloakEffectData=[.1,.2,.1,1,.05,.1,1,.2,.1],this.weaponEffectIndex=[[0,8,3],[2,4,6],[7,3,5],[1,9,6],[5,8,9],[5,0,10],[7,8,2],[1,11,3],[5,2,6],[4,7,0],[7,3,6]],this.shieldEffectIndex=[[2,9,4],[1,8,9],[6,0,7],[3,4,0],[5,7,8],[1,6,9],[1,0,6],[9,6,4]],this.helmetEffectIndex=[[4,7,0],[1,2,9],[6,8,7],[3,2,0],[5,9,8],[7,1,0],[6,9,7],[6,2,5]],this.colakEffectIndex=[[0,1],[2,3],[4,5],[6,7],[0,8],[0,9],[2,9],[0,6]],this.weaponStartAtk=[50,55,55,60,50,45,60,65,60,60,60],this.helmetStartDefense=[100,100,150,100,150,150,150,150],this.shieldStartDefense=[150,150,200,150,200,200,250,250],this.cloakStartHp=[100,120,120,100,120,120,120,120],this.upNeedCoin=[300,350,400,450,500,575,650,725,800,875,975,1075,1175,1275,1375,1500,1625,1750,1875,2e3,2200,2400,2600,2800,3e3],this.upNeedGem=[120,150,200,270,360,470],this.equipmentDropChance=.7,this.equipmentDropDoubleChance=.05,this.arrowIndexDropChance=[.25,.25,.2,.15,.15],this.helmetIdexDropChance=[.25,.25,.2,.15,.15],this.shieldIndexDropChance=[.25,.25,.2,.15,.15],this.defeatText=["\u6253\u4e0d\u8fc7\u7684\u8bdd\u591a\u8bd5\u8bd5\u9009\u62e9\u5176\u4ed6\u6280\u80fd\uff1f","\u770b\u4f60\u8fd9\u4e48\u5403\u529b\uff0c\u53bb\u5347\u7ea7\u4e00\u4e0b\u88c5\u5907\u5427\uff01","\u591a\u9009\u62e9\u4e00\u4e9b\u5f3a\u529b\u6280\u80fd\u642d\u914d\u770b\u770b\u5427\uff01"],this.victoryText=["\u606d\u559c\u901a\u5173\uff01\u63a5\u4e0b\u6765\u8fd8\u6709\u65b0\u7684\u6311\u6218\u54e6\uff01","\u7ec8\u4e8e\u901a\u5173\u4e86\u5462\uff01","\u524d\u65b9\u8fd8\u6709\u66f4\u591a\u6311\u6218\uff0c\u4e0d\u8981\u61c8\u6020\u54e6\uff01"],this.equipmentUIBubbleText=["\u8fd9\u88c5\u5907\u611f\u89c9\u771f\u4e0d\u9519\uff0c\u6211\u559c\u6b22\uff01","\u6211\u770b\u522b\u4eba\u5bb6\u7684\u706b\u67f4\u4eba\u90fd\u6709\u795e\u8bdd\u88c5\u5907\uff0c\u4f60\u5565\u65f6\u5019\u7ed9\u6211\u4e5f\u6574\u4e00\u4e2a\uff01","\u82f1\u59ff\uff01\u98d2\u723d\uff01","\u8fd9\u73a9\u610f\u513f\u4e5f\u592a\u6c89\u4e86\u5427\uff01\u8fd8\u597d\u6211\u8eab\u677f\u6bd4\u8f83\u786c\u6717","\u591a\u7ed9\u88c5\u5907\u5347\u5347\u7ea7\u5457\uff0c\u4e0d\u7136\u6253\u8d77\u6765\u592a\u7d2f\u4e86\uff01","\u611f\u89c9\u6253\u4e0d\u8fc7\u4e86\u5c31\u591a\u7ed9\u88c5\u5907\u5347\u5347\u7ea7\u5427\uff01"],this.battleStartUIBubbleText=["\u591a\u7ed9\u88c5\u5907\u5347\u5347\u7ea7\u5457\uff0c\u4e0d\u7136\u6253\u8d77\u6765\u592a\u7d2f\u4e86\uff01","\u611f\u89c9\u6253\u4e0d\u8fc7\u4e86\u5c31\u591a\u7ed9\u88c5\u5907\u5347\u5347\u7ea7\u5427\uff01"],this.talentUIBubbleText=["\u6211\u5728\u53d8\u5f3a\u7684\u9053\u8def\u4e0a\u4e00\u53bb\u4e0d\u8fd4\uff01"],this.equipNewEquipmentText=["\u6211\u611f\u53d7\u5230\u4e86\uff01\u6e90\u6e90\u4e0d\u65ad\u7684\u529b\u91cf\uff01"],this.equipmentAwakenText=["\u4ec0\u4e48\u53eb\u89c9\u9192\uff01\u8fd9\u5c31\u53eb\uff01\u89c9\u9192\uff01"],this.defendEquipmentUpGradeText=["\u62a4\u7532\u8d8a\u9ad8\u5b89\u5168\u611f\u8d8a\u5f3a\uff01"],this.powerUpGradeText=["\u6211\u611f\u53d7\u5230\u4e86\uff01\u6e90\u6e90\u4e0d\u65ad\u7684\u529b\u91cf\uff01"],this.defendUpGradeText=["\u91d1\u949f\u7f69\u94c1\u5e03\u886b\u513f~\uff01"],this.agilityUpGradeText=["\u5929\u4e0b\u6b66\u529f\uff01\u552f\u5feb\u4e0d\u7834\uff01"],this.healthUpGradeText=["\u65e9\u7761\u65e9\u8d77\u8eab\u4f53\u597d\uff01"],this.recoverUpGradeText=["\u5c11\u559d\u70b9\u836f\u591a\u56de\u70b9\u8840\uff01"],this.giftUpGradeText=["\u90a3\u6211\u4e5f\u592a\u806a\u660e\u4e86\u5427\uff01"],this.passNormalChapterText=["\u666e\u901a\u6a21\u5f0f\u5df2\u7ecf\u6ee1\u8db3\u4e0d\u4e86\u6211\u4e86\uff0c\u6765\u6311\u6218\u82f1\u96c4\u6a21\u5f0f\u5427\uff01","\u82f1\u96c4\u6a21\u5f0f\u7684\u5956\u52b1\u66f4\u52a0\u4e30\u539a\uff01"],this.chooseChapter1Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u591c\u9690\u6c99\u6f20\uff01"],this.chooseChapter2Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u5e7d\u9759\u7af9\u6797\uff01"],this.chooseChapter3Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u8352\u6f20\u6218\u573a\uff01"],this.chooseChapter4Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u6781\u5730\u51b0\u539f\uff01"],this.chooseChapter5Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u7194\u5ca9\u6838\u5fc3\uff01"],this.chooseChapter6Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u9057\u5fd8\u5de5\u5382\uff01"],this.chooseChapter7Text=["\u4eca\u5929\u7684\u76ee\u6807\u662f\u901a\u5173\u9f99\u5cad\u8ff7\u7a9f\uff01"],this.attackMissText=["\u6254\u51c6\u70b9\u554a\u54e5\uff01","\u671d\u5934\u6253\u671d\u5934\u6253\uff01"],this.manyEnemyText=["\u5feb\u70b9\u6254\uff01\u654c\u4eba\u592a\u591a\u4e86\uff01"],this.hitBubbleText=["\u6253\u4e00\u4e0b\u600e\u4e48\u8ddf\u6320\u75d2\u75d2\u4f3c\u7684\uff1f"],this.headShootText=["\u4f60\u5df2\u7ecf\u6b7b\u4e86\uff01"],this.continueHeadShootText=["\u6211\u8fd9\u6ce2\u6709\u70b9\u5e05\u5427\uff01"],this.shieldDropedText=["\u62a4\u76fe\u4e00\u4e22\uff0c\u5b89\u5168\u611f\u5c3d\u5931\uff01","\u66ff\u6211\u906e\u98ce\u6321\u96e8\u7684\u76fe\u724c\u5c31\u8fd9\u4e48\u6ca1\u4e86\u2026"],this.helmetDropedText=["\u611f\u89c9\u5934\u9876\u6709\u70b9\u51c9\u2026","\u540e\u8111\u52fa\u4f20\u6765\u4e00\u9635\u6076\u5bd2\u2026"],this.lowHpText=["\u6211\u53ef\u80fd\u8d70\u4e0d\u8fdc\u4e86\u2026"],this.deadText=["\u7ed9\u88c5\u5907\u5347\u5347\u7ea7\u518d\u5e26\u6211\u6765\u6253\u5427\u545c\u545c\u545c","\u554a\u6211\u6b7b\u4e86","\u5144\u5f1f\uff0c\u4e0b\u4e00\u5c40\u518d\u89c1"],this.parryEnemyArrowText=["\u5c31\u8fd9\u8fd8\u60f3\u653b\u51fb\u6211\u5462\uff01","\u60f3\u6253\u6211\uff1f\u6ca1\u95e8\u513f\uff01"],this.meetZombieText=["\u662f\u771f\u7684\u50f5\u5c38\u554a\u554a\u554a\u554a\uff01","\u50f5\u5c38\u8981\u7784\u51c6\u5934\u90e8\u6253\uff0c\u4ed6\u4eec\u7684\u8eab\u4f53\u611f\u77e5\u4e0d\u5230\u75bc\u75db\uff01"],this.meetFlyHeadGhostText=["\u522b\u76ef\u7740\u98de\u5934\u9b3c\u7684\u8eab\u4f53\u6253\uff0c\u8981\u6253\u4ed6\u6254\u51fa\u6765\u7684\u5934\uff01","\u600e\u4e48\u628a\u5934\u7ed9\u6254\u51fa\u6765\u4e86\u554a\uff01"],this.meetSharkerText=["\u9ca8\u9c7c\u6765\u4e86\u554a\u554a\u554a\uff01"],this.meetNecromanceText=["\u6b7b\u7075\u6cd5\u5e08\u4f1a\u590d\u6d3b\u5bf9\u4eba\uff0c\u4f18\u5148\u5e72\u6389\u4ed6\uff01"],this.meetShieldWizardText=["\u62a4\u76fe\u6cd5\u5e08\u4f1a\u7ed9\u654c\u4eba\u63d0\u4f9b\u62a4\u76fe\uff0c\u5148\u6253\u4ed6\uff01"],this.meetBoss1Text=["\u4e00\u6b21\u6254\u8fd9\u4e48\u591a\u628a\u5200\uff0c\u5bb6\u91cc\u6709\u77ff\u554a\uff01"],this.boss1SkillText=["\u5feb\u628a\u5929\u4e0a\u7684\u706b\u7403\u6253\u6389\uff01"],this.meetBoss2Text=["\u4e0d\u8981\u6253\u4ed6\u7684\u5f71\u5206\u8eab\uff01\u4f1a\u5e2e\u4ed6\u56de\u8840\u7684\uff01"],this.boss2SkillText=["\u770b\u4ed4\u7ec6\uff01\u522b\u6253\u9519\u4e86\uff01"],this.meetBoss3Text=["\u4e0d\u8981\u6389\u4ee5\u8f7b\u5fc3\uff0c\u4ed6\u53ef\u662f\u4e2a\u6076\u7075\uff01"],this.boss3SkillText=["\u8fd9\u5c31\u662f\u6076\u7075\u7684\u6028\u5ff5\uff01"],this.meetBoss4Text=["\u600e\u4e48\u52a8\u7269\u6210\u4e86BOSS\u554a\uff01"],this.boss4SkillText=["\u5c0f\u5fc3\u4ed6\u7684\u5927\u51b0\u7403\uff01"],this.meetBoss5Text=["\u4e00\u5b9a\u8981\u5148\u7834\u574f\u4ed6\u7684\u6fc0\u5149\uff01"],this.boss5SkillText=["\u8fd9\u6fc0\u5149\u8c01\u80fd\u9876\u5f97\u4f4f\u554a\uff01"],this.meetBoss7Text=["\u5bf9\u51c6\u5b83\u5934\u4e0a\u7684\u773c\u775b\u6253\uff01"],this.boss7SkillText=["\u51fa\u73b0\u62a4\u76fe\u65f6\u4e0d\u8981\u4e71\u6253\uff0c\u4f1a\u4f24\u5230\u81ea\u5df1\uff01"],this.boss7FirstBornText=["\u53c8\u662f\u4e00\u4e2a\u65e0\u77e5\u7684\u4eba\u7c7b\uff01"],this.boss7FirstFailText=["\u4f60\u7ed9\u6211\u7b49\u7740\uff01"],this.boss7SecondBornText=["\u7237\u53c8\u56de\u6765\u4e86\uff01"],this.boss7FireSkillText=["\u89c1\u8bc6\u4e00\u4e0b\u6211\u7684\u6124\u6012\u5427\uff01"],this.enemyAttackEnemyText=["\u75db\u51fb\u6211\u7684\u961f\u53cb\uff01","\u4f60\u4eec\u81ea\u5df1\u4eba\u4e0b\u624b\u4e5f\u8fd9\u4e48\u91cd\u554a\uff01"],this.shildWithstandText=["\u62ff\u6700\u786c\u7684\u76fe\uff0c\u5403\u6700\u6bd2\u7684\u6253\uff01","\u6211\u7684\u5927\u76fe\u65e9\u5df2\u9965\u6e34\u96be\u8010\u4e86\uff01"],this.helmetWithstandText=["\u5728\u4e0b\u5934\u5f88\u94c1\uff01","\u94c1\u5934\u5a03\u8bf4\u7684\u5c31\u662f\u6211\uff01"],this.recluseChance=[.5,.35,.15],this.recluseStartText=["\u5c0f\u4f19\u6c41\uff0c\u6211\u770b\u4f60\u9aa8\u9abc\u60ca\u5947\uff0c\u8981\n\u4e0d\u8981\u6765\u8ddf\u6211\u5b66\u4e60\u4e0a\u4e58\u7684\u6b66\u6797\u7edd\u5b66\uff1f","\u5c0f\u670b\u53cb\uff0c\u6211\u8fd9\u91cc\u6709\u4e00\u672c\u5982\u6765\u795e\n\u638c\uff0c\u6211\u770b\u4e0e\u4f60\u6709\u7f18\uff0c[\u5f53\u524d\u83b7\u5f97\u91d1\u989d\u768420%]\u5356\u7ed9\u4f60\uff0c\n\u597d\u4e0d\u597d\u54c7","\u54ce\u54ce\u54ce\uff0c\u770b\u89c1\u6211\u4e0d\u8010\u70e6\u5566\uff0c\u6211\n\u60f3\u7ed9\u4f60\u52a0\u4e2a\u653b\u51fb\u529b\u5bb9\u6613\u5417\u6211\uff01"],this.recluseFailResultText=["\u54ce\uff01\u61c2\u4e0d\u61c2\u5c0a\u8001\u7231\u5e7c\u554a\uff01","\u884c\u884c\u884c\uff01\u4e0d\u8981\u94b1\uff01\u9001\u4f60\u597d\u4e86\u5427","\u6211\u54ea\u5f97\u7f6a\u4f60\u4e86\u561b\uff01\u8001\u592b\u4e0d\u4f3a\u5019\u4e86\uff01\t"],this.recluseSuccessResultText=["\u679c\u7136\u662f\u4e2a\u6b66\u5b66\u5947\u624d\uff01\u8001\u592b\u7684\u773c\n\u5149\u786e\u5b9e\u4e0d\u9519\uff01","\u8001\u592b\u4e0d\u4f1a\u9a97\u4f60\u7684\uff01\u5feb\u56de\u53bb\u591a\u591a\n\u7ec3\u4e60\u5427\uff01[\u8138\u4e0a\u9732\u51fa\u4e86\u72e1\u733e\u7684\u7b11\u5bb9]","\u5e74\u8f7b\u4eba\u5c31\u8be5\u8fd9\u6837\uff01\u597d\u597d\u770b\u597d\u597d\n\u5b66\uff01\t"],this.recluseRefuseText=["\u5feb\u6b65\u6e9c\u8d70","\u795e\u7ecf\u75c5","\u5c11\u5e9f\u8bdd"],this.recluseSelectText=["\u5b66\u5b66\u770b\u5457","\u4e70\u4e70\u4e70","\u522b\u8bf4\u4e86\u6211\u5168\u90fd\u5b66"],this.recluseEffect=[.15,.2,.3],this.recluseRefuseEffect=.1,this.recluseCost=.2,this.angelStartText=["\u82f1\u52c7\u7684\u6218\u58eb\uff0c\u4f60\u53d7\u4f24\u4e86\u5417","\u524d\u65b9\u9053\u8def\u8270\u9669\uff0c\u8981\u4e0d\u8981\u4f11\u606f\u4e00\n\u4e0b\u518d\u8d70\uff1f","\u9664\u4e86\u76fe\u574f\u4e86\u4ee5\u5916\uff0c\u770b\u8d77\u6765\u5f88\u7cbe\n\u795e\u561b\uff01","\u4f24\u5f97\u8fd9\u4e48\u91cd\uff0c\u540e\u9762\u7684\u6218\u6597\u80fd\u6491\n\u5f97\u4f4f\u5417\uff1f","\u770b\u8d77\u6765\u5f88\u7cbe\u795e\u561b\uff01"],this.angelSelect1Text=["\u6211\u7684\u76fe\u574f\u4e86","\u8bf7\u5e2e\u6211\u6cbb\u7597\u4e00\u4e0b\uff01","\u8bf7\u5e2e\u6211\u4fee\u590d\u4e00\u4e0b\uff01","\u6551\u6551\u6211\uff01"],this.angelSelect1ResultText=["\u90a3\u5c31\u8ba9\u6211\u6765\u5e2e\u4f60\u4fee\u590d\u5427\uff01","\u90a3\u5c31\u8ba9\u6211\u6765\u5e2e\u4f60\u6cbb\u7597\u5427\uff01","\u90a3\u5c31\u8ba9\u6211\u6765\u5e2e\u4f60\u4fee\u590d\u5427\uff01","\u73b0\u5728\u5c31\u8ba9\u4f60\u6062\u590d\u5143\u6c14\uff01"],this.angel1Effect=[.5,.3,.5,.5],this.angelSelect2Text=["\u8111\u888b\u90fd\u88ab\u6253\u6655\u4e86","\u6211\u60f3\u53d8\u5f97\u66f4\u5f3a","\u60f3\u8981\u66f4\u52a0\u5f3a\u58ee","\u6211\u80fd\u9876\u5f97\u4f4f","\u597d\u5f97\u5f88\u5462"],this.angelSelect2ResultText=["\u8111\u888b\u6211\u4e5f\u80fd\u4fee\u7684\uff01","\u90a3\u4f60\u518d\u5f80\u524d\u8d70\u8d70\u5427\uff0c\u4f60\u4f1a\u9047\u5230\n\u90a3\u4e2a\u7537\u4eba\u7684\u3002","\u90a3\u5c31\u6ee1\u8db3\u4f60\uff01\u6210\u4e3a\u808c\u8089\u6218\u795e\u5427\uff01","\u90a3\u5c31\u8ba9\u6211\u6765\u5b88\u62a4\u4f60","\u4e0d\u59a8\u518d\u66f4\u597d\u70b9\uff1f"],this.angel2effect=[.3,.1,.2],this.devilStartText=["\u60f3\u8981\u53d8\u5f3a\u603b\u8981\u4ed8\u51fa\u4e00\u70b9\u4ee3\u4ef7\n\u7684\uff0c\u4f60\u613f\u610f\u4ed8\u51fa\u8fd9\u5c0f\u5c0f\u7684\u4ee3\u4ef7\u5417\uff1f","\u53ea\u8981\u4f60\u613f\u610f\u8ba9\u6211\u5438\u4e00\u70b9\u8840\uff0c\n\u6211\u5c31\u4f1a\u5e2e\u52a9\u4f60\u53d8\u4e3a\u66f4\u5f3a\u7684\u6218\u58eb\uff1f","\u53ea\u662f\u4e00\u70b9\u5fae\u4e0d\u8db3\u9053\u7684\u4ea4\u6613\u7f62\n\u4e86\uff0c\u4f60\u613f\u610f\u548c\u6211\u8c08\u8c08\u5417\uff1f","\u4f60\u77e5\u9053\u7684\uff0c\u6076\u9b54\u603b\u662f\u7231\u548c\u5f31\n\u5c0f\u7684\u4eba\u7c7b\u6253\u4ea4\u9053\uff0c\u8fd8\u662f\u8bf4\uff0c\u4f60\u5e76\u4e0d\u5f31\u5c0f\uff1f","\u6211\u5411\u6765\u90fd\u79c9\u6301\u7740\u516c\u5e73\u4ea4\u6613\u7684\n\u539f\u5219\uff0c\u4f60\u7ed9\u6211\u8840\uff0c\u6211\u7ed9\u4f60\u6280\u80fd\u2026\u2026","\u4f60\u60f3\u8981\u53d8\u5f3a\uff0c\u6211\u60f3\u8981\u5438\u8840\uff0c\n\u96be\u9053\u4e0d\u662f\u6b63\u597d\u4e92\u76f8\u7d22\u53d6\u5417\uff1f"],this.devilSelect1Text=["\u53ea\u8981\u80fd\u53d8\u5f3a\uff01","\u5438\u5427\u5438\u5427","\u8fd8\u6709\u5565\u8c08\u7684\uff1f\u8840\u62ff\u53bb\uff01","\u4f60\u60f3\u5438\u8840\u5c31\u76f4\u8bf4","\u5c11\u5e9f\u8bdd\u8be5\u5438\u5438","\u6765\u554a\u4e92\u76f8\u4f24\u5bb3\u554a"],this.devilSelect1ResultText=["\u4eba\u7c7b\u771f\u662f\u6709\u8da3\u554a~","\u554a~\u723d\u5230","\u6211\u5c31\u559c\u6b22\u548c\u4f60\u8fd9\u79cd\u723d\u5feb\u7684\u4eba\n\u8c08\u751f\u610f~","\u65e2\u7136\u4f60\u90fd\u8fd9\u4e48\u8bf4\u4e86\uff0c\u90a3\u6211\u5c31\n\u4e0d\u5ba2\u6c14\u4e86","\u6211\u53ef\u771f\u662f\u4e2a\u5584\u826f\u7684\u6076\u9b54","\u6765\u6765\u6765\u7b49\u7684\u5c31\u662f\u4f60\u8fd9\u53e5\u8bdd"],this.devilSelect2Text=["\u6211\u5df2\u7ecf\u591f\u5f3a\u4e86","\u4f60\u5728\u60f3\u5c41\u5403","\u4e0d\u8c08\uff0c\u518d\u89c1","\u7406\u90fd\u4e0d\u60f3\u7406\u4f60","\u5feb\u6b65\u6e9c\u8d70","\u8c01\u8ddf\u4f60\u7d22\u53d6\u5462\uff0c\u8d70\u4e86"],this.devilSelect2ResultText=["\u771f\u662f\u628a\u7237\u7ed9\u7b11\u6b7b","\u8fd8\u80fd\u4e0d\u80fd\u597d\u597d\u8bf4\u8bdd\u4e86\uff01","\u8fde\u62d2\u7edd\u90fd\u8fd9\u4e48\u76f4\u63a5\uff0c\u662f\u4e2a\u72e0\u4eba","\u2026\u2026\u2026\u2026","\u4f60\u597d\u6b79\u8ba9\u6211\u628a\u8bdd\u8bf4\u5b8c\u2026","\u4f60\u8fd8\u662f\u8fd9\u4e48\u65e0\u60c5"]}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(o,"data",{get:function(){return null==this._data&&(this._data=new o),this._data},enumerable:!0,configurable:!0}),o.loadConfigData=function(){},o._data=null,n.GameConfigData=o,cc._RF.pop()},{}],GameGuardSystem:[function(e,t,a){"use strict";cc._RF.push(t,"fbc78hLWFNDqLaoWqLypJkf","GameGuardSystem");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=o("WorldEventManager"),c=o("WorldEventType"),p=o("UserData"),d=o("LocalData");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.isGuarding=!1,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(u,l),r=u,Object.defineProperty(u,"lastCoin",{get:function(){return this._lastCoin},set:function(e){this._lastCoin=e+1},enumerable:!0,configurable:!0}),Object.defineProperty(u,"lastGem",{get:function(){return this._lastGem},set:function(e){this._lastGem=e+1},enumerable:!0,configurable:!0}),u.prototype.start=function(){var e=this;s.WorldEventManager.addListener(c.WorldEventType.GetUserDataFinish,function(){e.isGuarding=!0},this)},u.prototype.update=function(){this.isGuarding&&(this.guardCoin(),this.guardGem())},u.prototype.guardCoin=function(){null!=r.lastCoin?r.lastCoin-p.UserData.data.coin!=1&&(p.UserData.data.coin=r.lastCoin-1):r.lastCoin=p.UserData.data.coin},u.prototype.guardGem=function(){null!=r.lastGem?r.lastGem-d.LocalData.data.gemCount!=1&&(d.LocalData.data.gemCount=r.lastGem-1):r.lastGem=d.LocalData.data.gemCount},u._lastCoin=null,u._lastGem=null,o=r=__decorate([o],u),i.GameGuardSystem=o,cc._RF.pop()},{}],GameManager:[function(e,t,a){"use strict";cc._RF.push(t,"db63e/wCd5N0ZILTJTen1DR","GameManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("EnemyArea"),c=n("SkillSystem"),p=n("UIManager"),d=n("RoleData"),u=n("EnumAndConst"),h=n("ConfigData"),m=n("LocalData"),f=n("GameCommonPool"),g=n("Timer"),y=n("Util"),v=n("LocalSoundManager"),D=n("WorldEventManager"),E=n("LocalWorldEventType"),S=n("BattleNodeManager"),A=n("UserData"),C=n("BattleNumManager"),M=n("SpecailSkill"),T=n("GameConfigData"),_=n("SingleEffectManager"),k=n("RoleManager"),P=n("RandomIncidentManager"),R=n("GameState"),I=n("EffectCreate"),w=n("PlayerManager"),b=n("MapManager"),N=n("PlayerState"),B=n("GameCommonUtil"),L=n("EquipmentEffectSystem"),G=n("BroadcastManager"),x=n("EndlessModelConfigData"),F=n("CommonMask"),U=n("RankingManager"),q=n("WorldRankingManager"),H=n("DropManager"),W=n("AdManager"),O=n("StatisticsManager");function z(){var e=null!==l&&l.apply(this,arguments)||this;return e.gravityAcc=-640,e.opreateNode=null,e.playerPrefab=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(z,l),r=z,Object.defineProperty(z,"Instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),z.prototype.onEnable=function(){r._instance=this},z.beginGame=function(e){var t,a=r.Instance;null!=a&&(s.EnemyArea.init(),k.RoleManager.init(),_.SingleEffectManager.initSingleEffects(),p.UIManager.showBattleBoard(),a.showGameNode(),a.opreateNode.active=!1,s.EnemyArea.friendDatas=[],C.BattleNumManager.resetBattleNum(),m.LocalData.temp_pass_chapter=!1,m.LocalData.temp_hero_model=!1,R.GameState.reclusePart=-1,R.GameState.angel12Appear=!1,t=function(){function e(){r.startBattle()}var t;N.PlayerState.player.playRunOrStayAni(!1),!R.GameState.endlessModel&&R.GameState.currentChapter<=1?p.UIManager.showNoobGuidePop(function(){var t;A.UserData.newUser&&R.GameState.currentPart<=1?0<m.LocalData.getTalentLevel(5)?p.UIManager.showSelectSkillPop(e):e():(I.EffectCreate.createAppearEffect(cc.v2(-190,-105)),t=I.EffectCreate.createNpcRole(u.RandomIncidentTypeEnum.RECLUSE),g.TimerManager.addTimer(1,function(){p.UIManager.showRandomIncidentPop(u.RandomIncidentTypeEnum.RECLUSE,function(){null!=t&&g.TimerManager.addTimer(.5,function(){I.EffectCreate.createAppearEffect(cc.v2(-195,-105)),f.GameCommonPool.returnInstant(t)})})}))}):(I.EffectCreate.createAppearEffect(cc.v2(-190,-105)),t=I.EffectCreate.createNpcRole(u.RandomIncidentTypeEnum.RECLUSE),g.TimerManager.addTimer(1,function(){p.UIManager.showRandomIncidentPop(u.RandomIncidentTypeEnum.RECLUSE,function(){null!=t&&g.TimerManager.addTimer(.5,function(){I.EffectCreate.createAppearEffect(cc.v2(-195,-105)),f.GameCommonPool.returnInstant(t)})})}))},e?a.continueGame(t):a.startNewGame(t))},z.prototype.continueGame=function(e){var t=JSON.parse(R.GameState.endlessModel?m.LocalData.data.lastEndlessDataJson:m.LocalData.data.lastBattleDataJson);R.GameState.currentChapter=t.lastChapter||1,R.GameState.currentPart=t.lastPart||1,R.GameState.totalPart=20,R.GameState.isGaming=!1,R.GameState.isSettling=!1,R.GameState.isBossPart=h.ConfigData.isBossPart(R.GameState.currentPart),H.DropManager.init(t),N.PlayerState.reviveCount=t.lastReviveCount||0,R.GameState.profiteerPartArray=t.lastProfiteerPartArray||[],R.GameState.heroModel=t.heroModel||!1,r.partBubbleCount=t.lastPartBubbleCount||0,r.chapterBubbleCount=t.lastChapterBubbleCount||0,r.partBubbleText=[],R.GameState.newIncidentTimes=t.newIncidentTimes||0,R.GameState.skillPool=t.lastSkillPool||h.ConfigData.getSkillPoolWithSect(),R.GameState.endlessModel&&(R.GameState.chapterOrder=t.chapterOrder||[],R.GameState.inheritSkillCount=t.inheritSkillCount||0,R.GameState.inheritAtkCount=t.inheritAtkCount||0,R.GameState.inheritMaxHpCount=t.inheritMaxHpCount||0,R.GameState.inheritMaxHelmetDefenseCount=t.inheritMaxHelmetDefenseCount||0,R.GameState.inheritMaxShieldDefenseCount=t.inheritMaxShieldDefenseCount||0),c.SkillSystem.initSkill(t.lastEquipSkills,t.lastChooseSkills,null,t.inheritSkillLevels,!1);var a,n=t.isReorganize||!1;this.createPlayer(!1,t.lastRoleData,n),null!=t.lastIsBegining&&t.lastIsBegining?(b.MapManager.setMap(R.GameState.currentChapter,!1),this.playerMove(e)):(b.MapManager.stopMoveMap(),b.MapManager.setMap(R.GameState.currentChapter,!0),N.PlayerState.player.playRunOrStayAni(!1),a=function(){r.startBattle()},R.GameState.endlessModel&&t.isReorganize?p.UIManager.showInheritUI(function(){0<m.LocalData.getTalentLevel(5)?p.UIManager.showSelectSkillPop(a):a()}):a()),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_ENTER)},z.prototype.startNewGame=function(e){R.GameState.skillPool=h.ConfigData.getSkillPoolWithSect(),R.GameState.currentChapter=R.GameState.endlessModel?1:m.LocalData.data.selectChapter,R.GameState.currentPart=1,R.GameState.totalPart=20,R.GameState.isGaming=!1,R.GameState.isSettling=!1,R.GameState.isBossPart=h.ConfigData.isBossPart(R.GameState.currentPart),H.DropManager.init(null),N.PlayerState.reviveCount=0,R.GameState.profiteerPartArray=[];var t=[6,7,8,9,11,12,13,14,16,17,18,19],a=y.Util.getRandomValueFromArray(t);t.splice(t.indexOf(a),1),t=y.Util.getRandomValueFromArray(t),R.GameState.profiteerPartArray.push(a),R.GameState.profiteerPartArray.push(t),r.partBubbleCount=0,r.chapterBubbleCount=0,r.partBubbleText=[],R.GameState.newIncidentTimes=0,R.GameState.endlessModel&&(R.GameState.inheritSkillCount=0,R.GameState.inheritAtkCount=0,R.GameState.inheritMaxHpCount=0,R.GameState.inheritMaxHelmetDefenseCount=0,R.GameState.inheritMaxShieldDefenseCount=0),c.SkillSystem.initSkill(null,null,null,null,!1),this.createPlayer(!1),r.storageBattleData(!0,!1),b.MapManager.setMap(R.GameState.currentChapter,!1),this.playerMove(e),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_ENTER)},z.prototype.createPlayer=function(e,t,a){void 0===a&&(a=!1);var n,o,i,l,r,s,p,g,y,v,D=null;null==(t=void 0===t?null:t)?e?((D=N.PlayerState.playerData).orientation=-1,D.resetData(e),M.SpecailSkill.createSkillEffectInPlayer(u.SkillTypeEnum.DIVINE_SHIELD,D),D.logicPos=h.ConfigData.PLYAER_POS,(c.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REVIVE_HALO)<=0||0<(D.skillRevive<=0&&c.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REVIVE_HALO)))&&N.PlayerState.reviveCount++,0<c.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REVIVE_HALO)&&0<D.skillRevive&&D.skillRevive--):((D=new d.RoleData).orientation=-1,D.id=B.GameCommonUtil.uuid(),D.isPlayer=!0,D.isEnemy=!1,D.profession=u.ProfessionEnum.LAUNCHER,D.attackModel=u.AttackModelTypeEnum.LONG_RANGE_ATTACK,n=m.LocalData.getEquippedEquipment(m.EquipmentType.weapon),o=m.LocalData.getEquippedEquipment(m.EquipmentType.shield),i=m.LocalData.getEquippedEquipment(m.EquipmentType.helmet),l=m.LocalData.getEquippedEquipment(m.EquipmentType.cloak),D.weaponIndex=null==n?null:n.index,D.shieldIndex=null==o?null:o.index,D.helmetIndex=null==i?null:i.index,L.EquipmentEffectSystem.getEquipmentEffect(n,i,o,l),r=T.GameConfigData.data.talentData[0]*m.LocalData.getTalentLevel(0),s=null==l?0:h.ConfigData.getCloakHp(l.index,l.rank,l.level),p=null==L.EquipmentEffectSystem.currentCloakEffectData[2]?0:L.EquipmentEffectSystem.currentCloakEffectData[2],D.hp=Math.round((500+r+s)*(1+p)),D.maxHp=D.hp,D.initMaxHp=D.maxHp,g=T.GameConfigData.data.talentData[2]*m.LocalData.getTalentLevel(2),y=null==L.EquipmentEffectSystem.currentWeaponEffectData[5]?0:L.EquipmentEffectSystem.currentWeaponEffectData[5],v=null==L.EquipmentEffectSystem.currentCloakEffectData[0]?0:L.EquipmentEffectSystem.currentCloakEffectData[0],D.atk=Math.round((h.ConfigData.getWeaponAtk(D.weaponIndex,null,null)+g)*(1+y+v)),D.initAtk=D.atk,E=null==L.EquipmentEffectSystem.currentHelmetEffectData[6]?0:L.EquipmentEffectSystem.currentHelmetEffectData[6],A=null==L.EquipmentEffectSystem.currentShieldEffectData[6]?0:L.EquipmentEffectSystem.currentShieldEffectData[6],D.helmetDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.helmet,D.helmetIndex,null,null)*(1+E)),D.shieldDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.shield,D.shieldIndex,null,null)*(1+A)),D.maxHelmetDefense=D.helmetDefense,D.initHelmetDefense=D.maxHelmetDefense,D.maxShieldDefense=D.shieldDefense,D.initShieldDefense=D.maxShieldDefense,D.logicPos=h.ConfigData.PLYAER_POS):((D=new d.RoleData).orientation=-1,D.id=B.GameCommonUtil.uuid(),D.isPlayer=!0,D.isEnemy=!1,D.profession=u.ProfessionEnum.LAUNCHER,D.attackModel=u.AttackModelTypeEnum.LONG_RANGE_ATTACK,n=m.LocalData.getEquippedEquipment(m.EquipmentType.weapon),o=m.LocalData.getEquippedEquipment(m.EquipmentType.shield),i=m.LocalData.getEquippedEquipment(m.EquipmentType.helmet),l=m.LocalData.getEquippedEquipment(m.EquipmentType.cloak),R.GameState.endlessModel&&a?(D.weaponIndex=null==n?null:n.index,D.shieldIndex=null==o?null:o.index,D.helmetIndex=null==i?null:i.index):(D.weaponIndex=t.weaponIndex,D.shieldIndex=t.shieldIndex,D.helmetIndex=t.helmetIndex),L.EquipmentEffectSystem.getEquipmentEffect(n,i,o,l),D.hp=t.hp,D.maxHp=t.maxHp,D.atk=t.atk,D.helmetDefense=t.helmetDefense,null!=D.helmetIndex&&D.helmetDefense<=0&&(D.helmetDroped=!0),D.shieldDefense=t.shieldDefense,null!=D.shieldIndex&&D.shieldDefense<=0&&(D.shieldDroped=!0),D.maxHelmetDefense=t.maxHelmetDefense,null==D.maxHelmetDefense&&(null==D.helmetIndex?D.maxHelmetDefense=0:(E=null==L.EquipmentEffectSystem.currentHelmetEffectData[6]?0:L.EquipmentEffectSystem.currentHelmetEffectData[6],D.maxHelmetDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.helmet,D.helmetIndex,null,null)*(1+E)))),D.maxShieldDefense=t.maxShieldDefense,null==D.maxShieldDefense&&(null==D.shieldIndex?D.maxShieldDefense=0:(A=null==L.EquipmentEffectSystem.currentShieldEffectData[6]?0:L.EquipmentEffectSystem.currentShieldEffectData[6],D.maxShieldDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.shield,D.shieldIndex,null,null)*(1+A)))),D.extraHp=t.extraHp||0,D.extraAtk=t.extraAtk||0,D.retainExtraHp=t.retainExtraHp||0,D.retainExtraAk=t.retainExtraAk||0,D.retainExtraHelmetDefense=t.retainExtraHelmetDefense||0,D.retainExtraShieldDefense=t.retainExtraShieldDefense||0,R.GameState.endlessModel&&a&&(r=T.GameConfigData.data.talentData[0]*m.LocalData.getTalentLevel(0),s=null==l?0:h.ConfigData.getCloakHp(l.index,l.rank,l.level),p=null==L.EquipmentEffectSystem.currentCloakEffectData[2]?0:L.EquipmentEffectSystem.currentCloakEffectData[2],D.maxHp=Math.round((500+r+s)*(1+p)+D.extraHp+D.retainExtraHp),D.hp=Math.min(D.hp,D.maxHp),g=T.GameConfigData.data.talentData[2]*m.LocalData.getTalentLevel(2),y=null==L.EquipmentEffectSystem.currentWeaponEffectData[5]?0:L.EquipmentEffectSystem.currentWeaponEffectData[5],v=null==L.EquipmentEffectSystem.currentCloakEffectData[0]?0:L.EquipmentEffectSystem.currentCloakEffectData[0],D.atk=Math.round((h.ConfigData.getWeaponAtk(D.weaponIndex,null,null)+g)*(1+y+v)+D.extraAtk+D.retainExtraAk),E=null==L.EquipmentEffectSystem.currentHelmetEffectData[6]?0:L.EquipmentEffectSystem.currentHelmetEffectData[6],A=null==L.EquipmentEffectSystem.currentShieldEffectData[6]?0:L.EquipmentEffectSystem.currentShieldEffectData[6],D.maxHelmetDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.helmet,D.helmetIndex,null,null)*(1+E)+D.retainExtraHelmetDefense),D.maxShieldDefense=Math.round(h.ConfigData.getDefense(m.EquipmentType.shield,D.shieldIndex,null,null)*(1+A)+D.retainExtraShieldDefense),D.helmetDefense=Math.min(D.helmetDefense,D.maxHelmetDefense),D.shieldDefense=Math.min(D.shieldDefense,D.maxShieldDefense)),D.initMaxHp=D.maxHp-D.extraHp-D.retainExtraHp,D.initAtk=D.atk-D.extraAtk-D.retainExtraAk,D.initHelmetDefense=D.maxHelmetDefense-D.retainExtraHelmetDefense,D.initShieldDefense=D.maxShieldDefense-D.retainExtraShieldDefense,D.level=t.level,D.exp=t.exp,D.logicPos=t.logicPos,D.rewardCoin=t.rewardCoin,D.skillRevive=t.skillRevive);var E=S.BattleNodeManager.getParentNode(u.BattleNodeEnum.ROLE_SPINE_NODE),A=S.BattleNodeManager.getParentNode(u.BattleNodeEnum.ROLE_BODY_NODE);null==E||null==A||null!=(t=f.GameCommonPool.requestInstant(this.playerPrefab))&&(t.setParent(E),t.setPosition(D.logicPos),null!=(A=w.PlayerManager.createRoleBody(!0))&&(A.bindData(D),null==(E=A.getBodyColliders())||null!=(A=w.PlayerManager.createRoleHead())&&(N.PlayerState.playerData=D,N.PlayerState.bindPlayer(t,D,E,A),0<D.skillRevive&&_.SingleEffectManager.showReviveHoleEffect(),null!=(D=c.SkillSystem.getSkillLevel(u.SkillTypeEnum.THORNS_CHAINS))&&0<D&&_.SingleEffectManager.showThornsChainsEffect(!1),null!=(D=c.SkillSystem.getSkillLevel(u.SkillTypeEnum.FURY))&&0<D&&_.SingleEffectManager.showFuryEffect(),null!=(D=c.SkillSystem.getSkillLevel(u.SkillTypeEnum.SPOTTING_ARROW))&&0<D&&_.SingleEffectManager.showSpottingArrow())))},z.prototype.playerMove=function(e,t){if(t=void 0!==t&&t)return N.PlayerState.player.playRunOrStayAni(!0,450/350),b.MapManager.moveMap(R.GameState.currentChapter,450/350),void g.TimerManager.addTimer(450/350,e);N.PlayerState.player.playRunOrStayAni(!0),b.MapManager.moveMap(R.GameState.currentChapter),g.TimerManager.addTimer(2,e),R.GameState.endlessModel&&(e=R.GameState.currentPart+1,h.ConfigData.isBossPart(e)&&D.WorldEventManager.triggerEvent(E.LocalWorldEventType.ShowBroadcast,{type:G.BroadCastTypeEnum.DANGEROUS}))},z.startBattle=function(){var e=r.Instance;null!=e&&(R.GameState.isGaming=!0,e.opreateNode.active=!0,C.BattleNumManager.resetBattleNum(),H.DropManager.getEquipmentDropData(),s.EnemyArea.startBattle(),this.storageBattleData(!1,!1),R.GameState.currentPart%5==1&&(c.SkillSystem.isGotDoubleSkill=!1),2<=R.GameState.currentPart&&R.GameState.currentPart%10==1&&R.GameState.currentPart<=600&&(U.RankingManager.submitData(u.OpenDataKeyEnum.ENDLESS_PART,R.GameState.currentPart-1),q.WorldRankingManager.postUserWorldData(R.GameState.currentPart-1)))},z.storageBattleData=function(e,t){var a,n,o,i,l,s,p,h,f,g,y,v,D,E,S,A,C,M,T,_,k;null==r.Instance||null!=(k=N.PlayerState.playerData)&&(a=R.GameState.currentChapter,n=R.GameState.currentPart,(o=new d.RoleData).isPlayer=!0,o.isEnemy=!1,o.profession=u.ProfessionEnum.LAUNCHER,o.weaponIndex=k.weaponIndex,o.shieldIndex=k.shieldIndex,o.helmetIndex=k.helmetIndex,o.hp=k.hp,o.maxHp=k.maxHp,o.extraHp=k.extraHp,o.retainExtraHp=k.retainExtraHp,o.atk=k.atk,o.extraAtk=k.extraAtk,o.retainExtraAk=k.retainExtraAk,o.helmetDefense=k.helmetDefense,o.shieldDefense=k.shieldDefense,o.maxHelmetDefense=k.maxHelmetDefense,o.retainExtraHelmetDefense=k.retainExtraHelmetDefense,o.maxShieldDefense=k.maxShieldDefense,o.retainExtraShieldDefense=k.retainExtraShieldDefense,o.logicPos=k.logicPos,o.level=k.level,o.exp=k.exp,o.rewardCoin=k.rewardCoin,o.skillRevive=k.skillRevive,i=c.SkillSystem.getSkillsExceptEquipmentSkillLevels(),l=c.SkillSystem.chooseSkills,s=N.PlayerState.reviveCount,p=R.GameState.heroModel,h=R.GameState.profiteerPartArray,f=H.DropManager.equipmentDropPart,g=H.DropManager.equipmentDropEnemy,y=H.DropManager.dropedEquipmentData,v=H.DropManager.bossDropedEquipmentData,D=H.DropManager.dropedEquipmentDataArray,E=R.GameState.skillPool,S=R.GameState.inheritSkillCount,A=R.GameState.inheritAtkCount,C=R.GameState.inheritMaxHpCount,M=R.GameState.inheritMaxHelmetDefenseCount,T=R.GameState.inheritMaxShieldDefenseCount,_=c.SkillSystem.inheritSkillLevels,k=R.GameState.chapterOrder,k=new m.LastBattleData(a,n,o,i,l,s,h,f,g,y,v,D,p,e,E,t,S,A,C,M,T,_,k),R.GameState.endlessModel?m.LocalData.data.lastEndlessDataJson=JSON.stringify(k):m.LocalData.data.lastBattleDataJson=JSON.stringify(k))},z.playerDead=function(){var e=r.Instance;if(null!=e){if(R.GameState.isGaming=!1,D.WorldEventManager.triggerEvent(E.LocalWorldEventType.PlayerDead,null),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_DEATH),e.opreateNode.active=!1,0<N.PlayerState.playerData.skillRevive&&0<c.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REVIVE_HALO))return O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_REVIVE,"skill"),void I.EffectCreate.createReviveEffect(N.PlayerState.playerData);0<N.PlayerState.reviveCount?this.endGame(!1):(R.GameState.endlessModel?(m.LocalData.TEMP_BATTLE_DATA=m.LocalData.data.lastEndlessDataJson,m.LocalData.data.lastEndlessDataJson=null):(m.LocalData.TEMP_BATTLE_DATA=m.LocalData.data.lastBattleDataJson,m.LocalData.data.lastBattleDataJson=null),p.UIManager.showRevivePop())}},z.revivePlayer=function(){var e=r.Instance;null!=e&&(N.PlayerState.player&&N.PlayerState.player.close(),w.PlayerManager.playerBody&&w.PlayerManager.playerBody.destroy(),e.createPlayer(!0),R.GameState.isGaming=!0,e.opreateNode.active=!0,D.WorldEventManager.triggerEvent(E.LocalWorldEventType.PlayerRevive,null),R.GameState.endlessModel?null==m.LocalData.data.lastEndlessDataJson&&(m.LocalData.data.lastEndlessDataJson=m.LocalData.TEMP_BATTLE_DATA,m.LocalData.TEMP_BATTLE_DATA=null):null==m.LocalData.data.lastBattleDataJson&&(m.LocalData.data.lastBattleDataJson=m.LocalData.TEMP_BATTLE_DATA,m.LocalData.TEMP_BATTLE_DATA=null),s.EnemyArea.isKillAllEnemy()&&this.passPart())},z.killEnemy=function(e,t){var a,n;void 0===t&&(t=!1),null!=r.Instance&&(t&&(R.GameState.isBossPartPass=!0),a=s.EnemyArea.killEnemy(t),H.DropManager.equipmentDrop(e,a,t),H.DropManager.rewardBallDrop(e,t),s.EnemyArea.isKillAllEnemy()?(this.passPart(),n=R.GameState.currentPart+1,a=h.ConfigData.isBossPart(n),n=!R.GameState.endlessModel&&1==R.GameState.currentChapter&&(n-1==1||n-1==3||n-7==1),R.GameState.endlessModel||!a&&!n||H.DropManager.hpUpBallDrop(e,4)):(!t&&R.GameState.endlessModel&&s.EnemyArea.judgePassWave(),H.DropManager.hpUpBallDrop(e,1)))},z.passPart=function(){var e=r.Instance;null!=e&&s.EnemyArea.isKillAllEnemy()&&(R.GameState.isGaming=!1,e.opreateNode.active=!1,N.PlayerState.player.cancelAttack(),N.PlayerState.player.win(),null!=s.EnemyArea.friendDatas&&0<s.EnemyArea.friendDatas.length&&s.EnemyArea.friendDatas.forEach(function(e){e.isRecycled=!0,k.RoleManager.recyvleRole(e)}),s.EnemyArea.friendDatas=[],g.TimerManager.addTimer(1,function(){H.DropManager.pickUpHpUpBall(),H.DropManager.pickUpRewardBall()}),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_PASS))},z.refreshExp=function(e){var t,a,n,o,i,l=this,s=r.Instance;null==s||null!=(t=N.PlayerState.playerData)&&(a=t.level,t.level>=x.EndlessModelConfigData.endlessMaxLevel?s.addExpSuccess():(n=R.GameState.endlessModel?x.EndlessModelConfigData.getEndlessLevelUpExp(t.level):h.ConfigData.getLevelUpExp(t.level,R.GameState.currentChapter),e!=(o=t.exp)?(e/=n,i=o/n,e=(i=Math.min(1,i))-e,D.WorldEventManager.triggerEvent(E.LocalWorldEventType.AddExp,{lastlevel:a,currentExpPercent:i,addTime:e,isSlide:!0}),g.TimerManager.addTimer(e,function(){1<=i?(v.LocalSoundManager.playAudio("upgrade"),t.level++,t.level<x.EndlessModelConfigData.endlessMaxLevel&&(t.exp-=n),R.GameState.endlessModel||!r.isPassChapter()?(3!=t.level&&6!=t.level&&9!=t.level&&11!=t.level||(W.AdManager.canShowInterstitial=!0),p.UIManager.showSelectSkillPop(function(){l.refreshExp(0)})):l.refreshExp(0)):s.addExpSuccess()})):s.addExpSuccess()))},z.prototype.addExpSuccess=function(){r.isPassChapter()?R.GameState.endlessModel?r.switchChapter():r.endGame(!0):r.showRandomIncident()},z.showRandomIncident=function(){var e,t=P.RandomIncidentManager.getRandomIncidentType(R.GameState.currentPart,R.GameState.endlessModel);null==t?this.nextPart():(I.EffectCreate.createAppearEffect(cc.v2(-190,-105)),e=I.EffectCreate.createNpcRole(t),g.TimerManager.addTimer(1,function(){p.UIManager.showRandomIncidentPop(t,function(){null!=e&&g.TimerManager.addTimer(.5,function(){I.EffectCreate.createAppearEffect(cc.v2(-195,-105)),f.GameCommonPool.returnInstant(e)})})}))},z.nextPart=function(e){var t=this;void 0===e&&(e=!1);var a=r.Instance;null!=a&&(D.WorldEventManager.triggerEvent(E.LocalWorldEventType.NextPart,null),a.opreateNode.active=!1,r.partBubbleCount=0,r.partBubbleText=[],a.playerMove(function(){R.GameState.currentPart++,R.GameState.isBossPart=h.ConfigData.isBossPart(R.GameState.currentPart),R.GameState.isBossPart&&(R.GameState.isBossPartPass=!1);var a=N.PlayerState.player;null!=a&&a.equipWeapon(),a.playRunOrStayAni(!1),e?(s.EnemyArea.init(),p.UIManager.showInheritUI(function(){function e(){t.startBattle()}0<m.LocalData.getTalentLevel(5)?p.UIManager.showSelectSkillPop(e):e()})):(t.startBattle(),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_ENTER))}))},z.isPassChapter=function(){if(null!=r.Instance)return R.GameState.endlessModel?R.GameState.currentPart%x.EndlessModelConfigData.partInterval==0:R.GameState.currentPart>=R.GameState.totalPart},z.endGame=function(e){e||O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_FAIL);var t=r.Instance;null!=t&&((R.GameState.win=e)&&(m.LocalData.temp_last_pass_chapter=m.LocalData.data.passChapter,m.LocalData.temp_hero_model=R.GameState.heroModel,m.LocalData.temp_pass_chapter=!0),R.GameState.isGaming=!1,t.opreateNode.active=!1,R.GameState.isSettling=!0,p.UIManager.showSettlementPop(),R.GameState.endlessModel?m.LocalData.data.lastEndlessDataJson=null:m.LocalData.data.lastBattleDataJson=null,R.GameState.endlessModel||e&&m.LocalData.passChapter(R.GameState.currentChapter))},z.switchChapter=function(){var e=this,t=r.Instance;if(null!=t){var a=R.GameState.currentChapter,n=R.GameState.currentPart+1;console.warn("\u5f53\u524d"+a+"\u7ae0,"+R.GameState.currentPart+"\u5173");var o=1;if(n<=7*x.EndlessModelConfigData.partInterval)o=Math.ceil(n/x.EndlessModelConfigData.partInterval);else{if(null==R.GameState.chapterOrder||R.GameState.chapterOrder.length<=0){R.GameState.chapterOrder=[];for(var i=[],l=1;l<=h.ConfigData.MAP_NAME_ARRAY.length;l++)l!=a&&i.push(l);var s=y.Util.getRandomValueFromArray(i);R.GameState.chapterOrder[0]=s,s=i.indexOf(s),i.splice(s,1),i.push(a),i.sort(function(e,t){return Math.random()<.5?e-t:t-e}),R.GameState.chapterOrder=R.GameState.chapterOrder.concat(i),console.warn("\u65b0\u7684\u7ae0\u8282\u987a\u5e8f:"+R.GameState.chapterOrder)}else o=a;o=R.GameState.chapterOrder.shift()}p.UIManager.showEndlessBackPop(function(){I.EffectCreate.createPortal(function(){t.playerMove(function(){N.PlayerState.player.playRunOrStayAni(!1),F.CommonMask.showMask(!0),g.TimerManager.addTimer(.2,function(){R.GameState.currentChapter=o,b.MapManager.setMap(R.GameState.currentChapter,!1),_.SingleEffectManager.stopMoveThornsChainsEffects(),_.SingleEffectManager.deleteMoveThornsChainsEffect(),e.nextPart(!0),F.CommonMask.hideMask(!0)})},!0)})},function(){R.GameState.currentPart=n,R.GameState.currentChapter=o,e.storageBattleData(!1,!0),2<=R.GameState.currentPart&&R.GameState.currentPart<=600&&(U.RankingManager.submitData(u.OpenDataKeyEnum.ENDLESS_PART,R.GameState.currentPart-1),q.WorldRankingManager.postUserWorldData(R.GameState.currentPart-1))}),O.StatisticsManager.sendPartEvent(O.StatisticsCode.PART_ENTER)}},z.backHome=function(){null!=r.Instance&&(R.GameState.isGaming=!1,s.EnemyArea.close())},z.friendDie=function(e){null==e||null==s.EnemyArea.friendDatas||s.EnemyArea.friendDatas.length<=0||(e.isTurnEnemy&&s.EnemyArea.turnedEnemyCount--,-1!=(e=s.EnemyArea.friendDatas.indexOf(e))&&s.EnemyArea.friendDatas.splice(e,1))},z.prototype.showGameNode=function(){this.opreateNode.active=!0,b.MapManager.init(),S.BattleNodeManager.showAllNodes(!0)},z.getBossData=function(){if(null!=r.Instance){var e=s.EnemyArea.enemyDataArray;if(null!=e){for(var t=null,a=0;a<e.length;a++){var n=e[a];if(n.isBoss){t=n;break}}return t}}},z.shakeEffect=function(e){var t=r.Instance;null!=t&&(g.TimerManager.removeAllTimers(t.node),t.node.stopAllActions(),t.node.setPosition(0,0),e<=0||(t.node.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.02,cc.v2(2,4)),cc.moveTo(.02,cc.v2(-3,4)),cc.moveTo(.02,cc.v2(-4,3)),cc.moveTo(.02,cc.v2(3,-1)),cc.moveTo(.02,cc.v2(-2,4)),cc.moveTo(.02,cc.v2(2,-3)),cc.moveTo(.02,cc.v2(-3,-5)),cc.moveTo(.02,cc.v2(3,3)),cc.moveTo(.02,cc.v2(0,0))))),g.TimerManager.addTimer(e,function(){t.node.stopAllActions(),t.node.setPosition(0,0)},t.node)))},z.getGravity=function(){return this._instance?this._instance.gravityAcc:0},z.getFailPopUI=function(){if(!R.GameState.gameFail)return u.gameFailUIType.needNotPop;var e,t=R.GameState.gameFail=!1,a=Date.now()/1e3,n=(a=null==m.LocalData.data.lastOpenLegendBoxTime||a-m.LocalData.data.lastOpenLegendBoxTime>=T.GameConfigData.data.legendBoxTime,0<m.LocalData.data.normalBoxTimes||0<m.LocalData.data.weaponBoxTime||a);for(e in m.EquipmentType)if(isNaN(e)){var o=m.EquipmentType[e],i=m.LocalData.getEquippedEquipment(o);if(n&&(null==i||i.rank<R.GameState.currentChapter))return u.gameFailUIType.PopShop;null!=i&&(o=i.type==m.EquipmentType.cloak?5*(i.rank-3):5*i.rank,i.level<o&&(t=!0))}return t?u.gameFailUIType.PopEquip:u.gameFailUIType.needNotPop},z.playerAutoAtk=function(){var e,t,a,n,o,i,l;null==r.Instance||!R.GameState.isGaming||null!=(n=s.EnemyArea.enemyDataArray)&&(o=N.PlayerState.playerData.logicPos,t=N.PlayerState.player.getCurWeaponData("maxForce"),Math.random(),null==(e=t)||null!=(l=h.ConfigData.findNearestEnemyHeadPos(n))&&(a=null,(t=10*Math.random())<=.8?a=l:6<=t?(i=y.Util.getRandomFloatNum(l.y,l.y-60),a=cc.v2(l.x,i)):t<6&&(i=y.Util.getRandomFloatNum(l.y+70,l.y+150),2*Math.random()<1&&(i=y.Util.getRandomFloatNum(l.y-80,l.y-100)),a=cc.v2(l.x,i)),null!=a&&(n=-(o.x-a.x),l=a.y-o.y,o=n/(i=e),null!=(n=N.PlayerState.player.getCurWeaponData("gravity"))&&(l=(l-.5*n*Math.pow(o,2))/o,o=cc.v2(i,l),l=-y.Util.getVectorsAngle(o.normalize(),cc.Vec2.RIGHT)-30,N.PlayerState.player.roleUp.angle=l,N.PlayerState.player.playerRefreshWeapon(),null!=(o=N.PlayerState.player.currentArrow.node.position)&&(l=-(o.x-a.x)/i,l=(a.y-o.y-.5*n*Math.pow(l,2))/l,i=cc.v2(i,l),l=-y.Util.getVectorsAngle(i.normalize(),cc.Vec2.RIGHT),N.PlayerState.player.targetForceMagnitude=t<6?e:i.mag(),N.PlayerState.player.currentArrow.node.angle=l,0<c.SkillSystem.getSkillLevel(u.SkillTypeEnum.SHAKER_SPRINT)&&Math.random()<.2&&s.EnemyArea.createPlayerFriendSharker(),N.PlayerState.player.continuousEmission(),N.PlayerState.player.launch())))))},z._instance=null,z.partBubbleCount=0,z.chapterBubbleCount=0,z.partBubbleText=[],__decorate([o({displayName:"\u91cd\u529b\u52a0\u901f\u5ea6"})],z.prototype,"gravityAcc",void 0),__decorate([o({displayName:"\u753b\u7ebf\u8282\u70b9",type:cc.Node})],z.prototype,"opreateNode",void 0),__decorate([o({displayName:"\u73a9\u5bb6\u9884\u8bbe",type:cc.Prefab})],z.prototype,"playerPrefab",void 0),n=r=__decorate([n],z),i.GameManager=n,cc._RF.pop()},{}],GamePauseUI:[function(e,t,a){"use strict";cc._RF.push(t,"507982lnyFFVKm8Q4F363dH","GamePauseUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("UIManager"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("SkillSystem"),u=n("SkillItem"),h=n("LocalSoundManager"),m=n("AdManager"),f=n("BattleUI"),g=n("StatisticsManager");function y(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillContent=null,e.skillItem=null,e.widget=null,e.layout=null,e.skillItems=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(y,l),y.prototype.onEnable=function(){f.BattleUI.bannerShow=!1,m.AdManager.hideBannerAd(),this.refrsh(),this.widget.updateAlignment(),this.layout.updateLayout(),cc.director.pause(),c.WorldEventManager.addListener(p.LocalWorldEventType.BackHome,this.close,this)},y.prototype.onDisable=function(){for(var e=0;e<this.skillItems.length;e++){var t=this.skillItems[e];null!=t&&r.GameCommonPool.returnInstant(t),this.skillItems.splice(e,1),e--}c.WorldEventManager.removeListener(p.LocalWorldEventType.BackHome,this.close,this)},y.prototype.update=function(){s.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},y.prototype.refrsh=function(){for(var e=d.SkillSystem.chooseSkills,t=0;t<e.length;t++){var a=e[t],n=r.GameCommonPool.requestInstant(this.skillItem);if(null==n)return;var o=n.getComponent(u.SkillItem);if(null==o)return;o.bindInfo(a,1,!1,null,null),n.setParent(this.skillContent),this.skillItems.push(n)}},y.prototype.clickBackHome=function(){h.LocalSoundManager.playAudio("click"),g.StatisticsManager.sendPartEvent(g.StatisticsCode.PART_QUIT),s.UIManager.showBackHomeWarnPop()},y.prototype.clockBackGame=function(){h.LocalSoundManager.playAudio("click"),this.close(),cc.director.resume()},y.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Node,displayName:"\u4f7f\u7528\u6280\u80fd"})],y.prototype,"skillContent",void 0),__decorate([o({displayName:"\u6280\u80fditem",type:cc.Prefab})],y.prototype,"skillItem",void 0),__decorate([o({type:cc.Widget})],y.prototype,"widget",void 0),__decorate([o({type:cc.Layout})],y.prototype,"layout",void 0),n=__decorate([n],y),i.GamePauseUI=n,cc._RF.pop()},{}],GameState:[function(e,t,a){"use strict";cc._RF.push(t,"f875cCAnulEZZN05zJYcbFk","GameState");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.isGaming=!1,o.currentPart=1,o.totalPart=1,o.currentChapter=1,o.isSettling=!1,o.isBossPart=!1,o.heroModel=!1,o.endlessModel=!1,o.reclusePart=-1,o.newIncidentTimes=0,o.angel12Appear=!1,o.isBossPartPass=!1,o.gameFail=!1,o.profiteerPartArray=[],o.win=!1,o.skillPool=null,o.inheritSkillCount=0,o.inheritAtkCount=0,o.inheritMaxHpCount=0,o.inheritMaxHelmetDefenseCount=0,o.inheritMaxShieldDefenseCount=0,o.chapterOrder=[],n.GameState=o,cc._RF.pop()},{}],GetSkillUI:[function(e,t,a){"use strict";cc._RF.push(t,"44af8A3vD9M047RBLvZ/VKP","GetSkillUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("LocalSoundManager"),c=n("PlayerState"),p=n("SkillSystem"),d=n("ShareManager"),u=n("ShareVideoControl"),h=n("ConfigData"),m=n("SpriteFrameManager"),f=n("GameConfigData"),g=n("UIManager"),y=n("AdManager");function v(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillNameLabel=null,e.skillIconSprite=null,e.levelStars=[],e.doubleGetButton=null,e.immediatlyGetButton=null,e.getButton=null,e.lightNode=null,e.skillDescription=null,e.skillIndex=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(v,l),v.prototype.update=function(){g.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},v.prototype.bindData=function(e,t,a){if(null!=e&&null!=t){this.skillIndex=e,this.skillIconSprite.spriteFrame=m.SpriteFrameManager.getSkillSpriteFrame(e);var n,o=f.GameConfigData.data.skillMaxLevel[e],i=p.SkillSystem.getSkillLevel(e);if(null!=this.levelStars&&0<this.levelStars.length)if(99==o)for(var l=0;l<this.levelStars.length;l++)null!=(n=this.levelStars[l])&&(n.active=!1);else for(l=0;l<this.levelStars.length;l++)null!=(n=this.levelStars[l])&&(n.active=l+1<=i);null!=(e=h.ConfigData.getSkillName(e))&&(this.skillNameLabel&&(this.skillNameLabel.string=e),this.skillDescription.string=h.ConfigData.skillDescribe[this.skillIndex],t?(this.doubleGetButton.active=!0,this.getButton.active=!1,this.immediatlyGetButton.active=!0,this.immediatlyGetButton.opacity=0,this.immediatlyGetButton.stopAllActions(),this.immediatlyGetButton.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(1)))):(this.doubleGetButton.active=!1,this.getButton.active=!0,this.immediatlyGetButton.active=!1),this.closeAction=a,this.lightNode.stopAllActions(),this.lightNode.runAction(cc.repeatForever(cc.rotateBy(4,360))))}},v.prototype.clickDoubleGet=function(){var e=this;function t(){var t,a=c.PlayerState.playerData;null!=a&&(y.AdManager.canShowInterstitial=!1,t=p.SkillSystem.isImmediateSkill(e.skillIndex),p.SkillSystem.chooseSkill(e.skillIndex),t?p.SkillSystem.useImmediateSkill(e.skillIndex,null):(p.SkillSystem.equipSkill(e.skillIndex),21==e.skillIndex&&(a.skillRevive=1)),null!=(a=c.PlayerState.player)&&a.changeWeapon(),e.close())}s.LocalSoundManager.playAudio("click"),d.ShareManager.getShareControlType()!=d.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?u.ShareVideoControl.videoFunc("\u83b7\u53d6\u53cc\u500d\u6280\u80fd",t,null,t,null,null,u.VideoAdIdEnum.PROFITEER_ID):t()},v.prototype.clickClose=function(){s.LocalSoundManager.playAudio("click"),this.close()},v.prototype.close=function(){y.AdManager.canShowInterstitial&&(y.AdManager.showInterstitialAd(function(){y.AdManager.hideBannerAd(),cc.director.pause()},function(){y.AdManager.showBannerAd(),cc.director.resume()}),y.AdManager.canShowInterstitial=!1),this.closeAction&&this.closeAction(),this.closeAction=null,r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6280\u80fd\u540d\u5b57",type:cc.Label})],v.prototype,"skillNameLabel",void 0),__decorate([o({displayName:"\u6280\u80fd\u56fe\u6807",type:cc.Sprite})],v.prototype,"skillIconSprite",void 0),__decorate([o({displayName:"\u6280\u80fd\u7b49\u7ea7\u661f\u661f",type:cc.Node})],v.prototype,"levelStars",void 0),__decorate([o({displayName:"\u53cc\u500d\u9886\u53d6\u6309\u94ae",type:cc.Node})],v.prototype,"doubleGetButton",void 0),__decorate([o({displayName:"\u76f4\u63a5\u9886\u53d6\u6309\u94ae",type:cc.Node})],v.prototype,"immediatlyGetButton",void 0),__decorate([o({displayName:"\u7acb\u5373\u9886\u53d6\u6309\u94ae",type:cc.Node})],v.prototype,"getButton",void 0),__decorate([o({displayName:"\u5149\u8292",type:cc.Node})],v.prototype,"lightNode",void 0),__decorate([o({displayName:"\u6280\u80fd\u63cf\u8ff0",type:cc.Label})],v.prototype,"skillDescription",void 0),n=__decorate([n],v),i.GetSkillUI=n,cc._RF.pop()},{}],Head:[function(e,t,a){"use strict";cc._RF.push(t,"63dbbnQm+xILr8eYWd08+so","Head");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("EnumAndConst"),p=n("GameState"),d=n("ConfigData");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.roleData=null,e.helmet=null,e.headCollider=null,e.head=null,e.enemyHeads=[],e.bossHeads=[],e.isEye=!1,e.headScale=null,e.isShowHeadSpriteFrame=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),this.head.spriteFrame=null,this.helmet&&(this.helmet.node.angle=this.node.angle,this.helmet.node.setPosition(this.node.position))},u.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},u.prototype.update=function(){null!=this.roleData&&(this.roleData.headPosition=this.node.position,this.node.scaleX=this.headScale*this.roleData.orientation,null!=this.helmet&&null!=this.helmet.node&&(this.helmet.node.scaleX=d.ConfigData.equipmentInitScale*this.headScale*this.roleData.orientation),(this.roleData.isDestroy&&!this.roleData.headDroped||this.roleData.profession==c.ProfessionEnum.FLY_HEAD_GHOST&&this.roleData.isDestroy&&this.headCollider.enabled)&&this.close())},u.prototype.bindData=function(e,t,a){void 0===t&&(t=null),void 0===a&&(a=!0),this.roleData=e,this.isEye||(this.headScale=null==t?1:t,this.node.scale=this.headScale,this.isShowHeadSpriteFrame=a)},u.prototype.beHitedFly=function(){if(null!=this.roleData&&!this.isEye){if(this.isShowHeadSpriteFrame)if(this.roleData.isBoss){var e=p.GameState.currentChapter-1;if(e<0||e>=this.bossHeads.length)return;this.head.spriteFrame=this.bossHeads[e]}else e=this.roleData.profession,this.head.spriteFrame=this.enemyHeads[e];this.headCollider.enabled=!1,this.roleData.headDroped=!0,this.roleData.holdHead=!1,this.roleData=null}},u.prototype.close=function(){this.node.destroy()},__decorate([o({displayName:"\u5934\u90e8\u78b0\u649e\u76d2",type:cc.Collider})],u.prototype,"headCollider",void 0),__decorate([o({displayName:"\u5934\u90e8\u56fe",type:cc.Sprite})],u.prototype,"head",void 0),__decorate([o({displayName:"\u654c\u4eba\u5934\u90e8",type:cc.SpriteFrame})],u.prototype,"enemyHeads",void 0),__decorate([o({displayName:"boss\u5934\u90e8",type:cc.SpriteFrame})],u.prototype,"bossHeads",void 0),__decorate([o({displayName:"\u662f\u5426\u662f\u773c\u775b"})],u.prototype,"isEye",void 0),n=__decorate([n],u),i.Head=n,cc._RF.pop()},{}],Helmet:[function(e,t,a){"use strict";cc._RF.push(t,"9371avNF+pOB7S9Q6ydfPBZ","Helmet");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameManager"),s=n("Util"),c=n("SpriteFrameManager"),p=n("WorldEventManager"),d=n("LocalWorldEventType"),u=n("LocalData"),h=n("GameCommonPool"),m=n("ConfigData"),f=n("GameState"),g=n("EndlessModelConfigData"),y=n("EquipmentConfigData");function v(){var e=null!==l&&l.apply(this,arguments)||this;return e.helmetSprite=null,e.helmetEffect=null,e.isDroping=!1,e.horizontalSpeed=0,e.verticalSpeed=0,e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(v,l),v.prototype.onEnable=function(){p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this),this.roleData=null,this.isDroping=!1,this.horizontalSpeed=0,this.verticalSpeed=0},v.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},v.prototype.update=function(e){this.isDroping&&(800<=this.node.x||this.node.x<=-800||this.node.y<=-300)||null!=this.roleData&&!this.isDroping&&this.roleData.isDestroy?this.close():this.isDroping&&this.deltaMove(e)},v.prototype.bindData=function(e){this.roleData=e;var t=this.roleData.isPlayer?u.LocalData.getEquippedEquipment(u.EquipmentType.helmet).rank:f.GameState.endlessModel?g.EndlessModelConfigData.getEndlessEnemyEqeuipmentRank(f.GameState.currentPart):m.ConfigData.getEnemyEquipmentRank(f.GameState.currentChapter);this.helmetSprite.spriteFrame=c.SpriteFrameManager.getHelmetSpriteFrame(e.helmetIndex,t),t=(4<=t?y.EquipmentConfigData.awakeningHelmetConfigDatas:y.EquipmentConfigData.helmetConfigDatas)[e.helmetIndex],this.node.anchorX=t.anchorX,this.node.anchorY=t.anchorY,t.hasEffect?(e="HelmetEffect"+e.helmetIndex,this.helmetEffect.node.active=!0,this.helmetEffect.node.anchorX=t.effectAnchorX,this.helmetEffect.node.anchorY=t.effectAnchorY,this.helmetEffect.play(e)):this.helmetEffect.node.active=!1},v.prototype.deltaMove=function(e){var t=r.GameManager.getGravity(),a=this.node.position;this.verticalSpeed=this.verticalSpeed+t*e,t=this.verticalSpeed*e,e=this.horizontalSpeed*e,t=cc.v2(e,t),this.node.setPosition(a.add(t))},v.prototype.drop=function(e,t){this.verticalSpeed=t,this.horizontalSpeed=e,this.isDroping=!0,this.roleData.helmetDroped=!0,this.roleData=null,t=s.Util.getRandomFloatNum(.5,2),e=.5<Math.random()?360:-360,this.node.runAction(cc.repeatForever(cc.rotateBy(t,e)))},v.prototype.close=function(){h.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5934\u76d4\u56fe\u7247",type:cc.Sprite})],v.prototype,"helmetSprite",void 0),__decorate([o({displayName:"\u5934\u76d4\u7279\u6548\u52a8\u753b",type:cc.Animation})],v.prototype,"helmetEffect",void 0),n=__decorate([n],v),i.Helmet=n,cc._RF.pop()},{}],HomeGameItem:[function(e,t,a){"use strict";cc._RF.push(t,"d58f0qOb45LPq7qkOnC942R","HomeGameItem");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.gameName=null,e.gameIcon=null,e.clickAction=null,e.moreGameInfo=null,e.itemOrder=1,e}i=cc.Component,__extends(r,i),r.prototype.bindData=function(e,t,a){var n;null!=e&&(this.itemOrder=t,this.gameName.string=e.gameName,t=e.gameName.length,this.gameName.fontSize=t<=5?21:17,(n=this).gameIcon.spriteFrame=null,cc.loader.load({url:e.gameIconUrl,type:"png"},function(e,t){null!=t&&(n.gameIcon.spriteFrame=new cc.SpriteFrame(t))}),this.clickAction=a,this.moreGameInfo=e)},r.prototype.clickItem=function(){null!=this.clickAction&&this.clickAction(this.moreGameInfo,this.itemOrder)},__decorate([l({type:cc.Label,displayName:"\u6e38\u620f\u540d\u79f0"})],r.prototype,"gameName",void 0),__decorate([l({type:cc.Sprite,displayName:"\u6e38\u620ficon"})],r.prototype,"gameIcon",void 0),n=__decorate([n],r),o.HomeGameItem=n,cc._RF.pop()},{}],HorizontaBoxItem:[function(e,t,a){"use strict";cc._RF.push(t,"27dbbXtzWVHXqhDenxTqKM9","HorizontaBoxItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("StatisticsManager"),s=n("UserData"),c=n("ShareManager");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.icon=null,e.light=null,e.new=null,e.moreGameInfo=null,e.interval=0,e.blockExportType=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),this.light.x=-this.light.width},p.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},p.prototype.update=function(e){if(null!=this.moreGameInfo&&!this.moreGameInfo.redPoint)if(0<this.interval)this.interval-=e;else{if(this.light.x>=this.light.width)return this.light.x=-this.light.width,void(this.interval=1);this.light.x=this.light.x+200*e}},p.prototype.touchEnd=function(e){null!=e&&(null==(e=e.getLocation())||null!=(e=this.node.convertToNodeSpaceAR(e))&&(Math.abs(e.x)>this.node.width/2||Math.abs(e.y)>this.node.height/2||this.clickItem()))},p.prototype.bindData=function(e,t){var a;null!=e&&(this.moreGameInfo=e,this.blockExportType=t,this.light.active=!e.redPoint,this.new.active=e.redPoint,this.new.stopAllActions(),e.redPoint&&this.new.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.1,1,1.2),cc.scaleTo(.15,1,.9),cc.delayTime(.35)))),a=this,cc.loader.load({url:e.gameIconUrl,type:"png"},function(e,t){null!=t&&(a.icon.spriteFrame=new cc.SpriteFrame(t))}))},p.prototype.clickItem=function(){var e=this;null!=this.moreGameInfo&&(this.blockExportType==c.BlockExportType.EQUIPMENT_UI?r.StatisticsManager.thirdSendEvent("equip_block_click"):this.blockExportType==c.BlockExportType.SETTLEMENT_UI?r.StatisticsManager.thirdSendEvent("settle_block_click"):this.blockExportType==c.BlockExportType.REVIVE_UI?r.StatisticsManager.thirdSendEvent("revive_block_click"):this.blockExportType==c.BlockExportType.SELL_EQUIP_UI&&r.StatisticsManager.thirdSendEvent("sell_block_click"),r.StatisticsManager.uploadJumpRecord(this.moreGameInfo.gameAppId,this.moreGameInfo.gameName,"playerClick",s.ExportTypeEnum.HORIZONTA_GAME_BOX),window.gameCommon.getSDK.navigateToMiniProgram(this.moreGameInfo.gameAppId,this.moreGameInfo.jumpPath,function(t){return t?(e.blockExportType==c.BlockExportType.EQUIPMENT_UI?r.StatisticsManager.thirdSendEvent("equip_block_navigate_succ"):e.blockExportType==c.BlockExportType.SETTLEMENT_UI?r.StatisticsManager.thirdSendEvent("settle_block_navigate_succ"):e.blockExportType==c.BlockExportType.REVIVE_UI?r.StatisticsManager.thirdSendEvent("revive_block_navigate_succ"):e.blockExportType==c.BlockExportType.SELL_EQUIP_UI&&r.StatisticsManager.thirdSendEvent("sell_block_navigate_succ"),void r.StatisticsManager.uploadJumpRecord(e.moreGameInfo.gameAppId,e.moreGameInfo.gameName,"jumpSuccess",s.ExportTypeEnum.HORIZONTA_GAME_BOX)):(e.blockExportType==c.BlockExportType.EQUIPMENT_UI?r.StatisticsManager.thirdSendEvent("equip_block_navigate_fail"):e.blockExportType==c.BlockExportType.SETTLEMENT_UI?r.StatisticsManager.thirdSendEvent("settle_block_navigate_fail"):e.blockExportType==c.BlockExportType.REVIVE_UI?r.StatisticsManager.thirdSendEvent("revive_block_navigate_fail"):e.blockExportType==c.BlockExportType.SELL_EQUIP_UI&&r.StatisticsManager.thirdSendEvent("sell_block_navigate_fail"),void(e.moreGameInfo.switchQRCode&&window.gameCommon.getSDK.previewImage(e.moreGameInfo.QRCode)))}))},__decorate([o(cc.Sprite)],p.prototype,"icon",void 0),__decorate([o(cc.Node)],p.prototype,"light",void 0),__decorate([o(cc.Node)],p.prototype,"new",void 0),n=__decorate([n],p),i.HorizontaBoxItem=n,cc._RF.pop()},{}],HorizontaGameBox:[function(e,t,a){"use strict";cc._RF.push(t,"4a465oFHVdHf5Lhb+oz6ppG","HorizontaGameBox");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("MoreGameManager"),s=n("GameCommonPool"),c=n("HorizontaBoxItem"),p=n("ShareManager"),d=n("UserData");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.gameItemPrefab=null,e.layout=null,e.init=!1,e.itemArrays=new Array,e.moreGameInfos=null,e.moveDistance=0,e.moveSpeed=35,e.touchPoint=null,e.currentGender=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){p.ShareManager.getHorizontalControl()?(this.node.on(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this),d.UserData.addModuleShows(d.ExportTypeEnum.HORIZONTA_GAME_BOX,1)):this.node.active=!1},u.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.touchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.touchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.touchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.touchEnd,this)},u.prototype.update=function(e){this.init?(this.currentGender!=d.UserData.data.gender&&1==d.UserData.data.gender&&(this.initBodyMoreGameInfo(),this.currentGender=d.UserData.data.gender),this.move(e)):this.initMoreGameInfo()},u.prototype.touchStart=function(e){null!=e&&(this.touchPoint=e.getLocation())},u.prototype.touchMove=function(e){var t;null==e||null!=(t=e.getLocation())&&(null!=this.touchPoint?(e=this.touchPoint.x-t.x,this.touchPoint=t,this.moveByScroll(e)):this.touchPoint=t)},u.prototype.touchEnd=function(e){null!=e&&(this.touchMove(e),this.touchPoint=null)},u.prototype.initMoreGameInfo=function(){var e,t=this,a=r.MoreGameManager.getHorizontalMoreGameInfo();null!=a&&0!=a.length&&(this.moreGameInfos=a,this.init=!0,e=-250,a.forEach(function(a){var n;null==a||a.boyGame||null!=(n=s.GameCommonPool.requestInstant(t.gameItemPrefab))&&(n.setParent(t.layout),n.x=e,e+=120,t.itemArrays.push(n),null!=(n=n.getComponent(c.HorizontaBoxItem))&&n.bindData(a))}))},u.prototype.initBodyMoreGameInfo=function(){var e,t,a=this;null!=this.moreGameInfos&&0!=this.moreGameInfos.length&&(e=0==this.itemArrays.length?null:this.itemArrays[this.itemArrays.length-1],t=null==e?-250:e.x+120,this.moreGameInfos.forEach(function(e){var n;null==e||!e.boyGame||null!=(n=s.GameCommonPool.requestInstant(a.gameItemPrefab))&&(n.setParent(a.layout),n.x=t,t+=120,a.itemArrays.push(n),null!=(n=n.getComponent(c.HorizontaBoxItem))&&n.bindData(e))}))},u.prototype.move=function(e){var t;this.init&&null==this.touchPoint&&null!=this.itemArrays&&0!=this.itemArrays.length&&(t=e*this.moveSpeed,this.moveDistance+=t,this.itemArrays.forEach(function(e){e.x-=t}),120<=this.moveDistance&&(this.moveDistance-=120,e=this.itemArrays.shift(),this.itemArrays.push(e),e.x+=120*this.itemArrays.length))},u.prototype.moveByScroll=function(e){var t;this.init&&(this.moveDistance+=e,this.itemArrays.forEach(function(t){t.x-=e}),120<=this.moveDistance)&&(this.moveDistance-=120,t=this.itemArrays.shift(),this.itemArrays.push(t),t.x+=120*this.itemArrays.length)},__decorate([o(cc.Prefab)],u.prototype,"gameItemPrefab",void 0),__decorate([o(cc.Node)],u.prototype,"layout",void 0),n=__decorate([n],u),i.HorizontaGameBox=n,cc._RF.pop()},{}],HpSlider:[function(e,t,a){"use strict";cc._RF.push(t,"a9a9aNl+ghEiY2QqSINsuhY","HpSlider");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.hpTopSprite=null,e.hpBottomSprite=null,e.totalSlideTime=1,e.slideDelayTime=0,e.hpBottomTween=null,e}i=cc.Component,__extends(r,i),r.prototype.initHpSlider=function(){this.hpBottomSprite.fillRange=1,this.hpTopSprite.fillRange=1},r.prototype.updateHpSlider=function(e,t){var a,n=this;null!=e&&null!=t&&(a=this.hpBottomSprite.fillRange,t=e/t,t=Math.max(0,t),a<=(this.hpTopSprite.fillRange=t)?this.hpBottomSprite.fillRange=t:(null!=this.hpBottomTween&&this.hpBottomTween.stop(),this.totalSlideTime<=0||((a=(a-t)*this.totalSlideTime)<=0?this.hpBottomSprite.fillRange=t:(this.hpBottomTween=new cc.Tween,this.hpBottomTween.target(this.hpBottomSprite),this.hpBottomTween.delay(this.slideDelayTime),this.hpBottomTween.to(a,{fillRange:t},null),this.hpBottomTween.call(function(){n.hpBottomTween=null}),this.hpBottomTween.start()))))},__decorate([l({displayName:"\u4e0a\u5c42\u8840\u6761",type:cc.Sprite,tooltip:"\u663e\u793a\u5b9e\u65f6\u8840\u91cf\u7684\u8840\u6761"})],r.prototype,"hpTopSprite",void 0),__decorate([l({displayName:"\u4e0b\u5c42\u8840\u6761",type:cc.Sprite,tooltip:"\u52a8\u6001\u5c55\u793a\u8840\u91cf\u524a\u51cf\u7684\u8840\u6761"})],r.prototype,"hpBottomSprite",void 0),__decorate([l({displayName:"\u4e0b\u5c42\u8840\u6761\u6ed1\u52a8\u603b\u65f6\u95f4",tooltip:"\u4e0b\u5c42\u8840\u6761\u7684\u586b\u5145\u603b\u91cf\u4ece1\u6d88\u51cf\u52300\u9700\u8981\u7684\u603b\u65f6\u95f4"})],r.prototype,"totalSlideTime",void 0),__decorate([l({displayName:"\u4e0b\u5c42\u8840\u6761\u6ed1\u52a8\u7684\u7b49\u5f85\u65f6\u95f4",tooltip:"\u4e0b\u5c42\u8840\u6761\u64ad\u653e\u6d88\u51cf\u52a8\u753b\u524d\u7684\u7b49\u5f85\u65f6\u95f4"})],r.prototype,"slideDelayTime",void 0),n=__decorate([n],r),o.HpSlider=n,cc._RF.pop()},{}],ISDK:[function(e,t,a){"use strict";cc._RF.push(t,"64b83BvcYFEnr+j7g73AEnh","ISDK");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),cc._RF.pop()},{}],IgniteEffect:[function(e,t,a){"use strict";cc._RF.push(t,"53cf79JjHlJ4rRx5A4YvSpR","IgniteEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SkillSystem"),s=n("EnumAndConst"),c=n("GameCommonPool"),p=n("WorldEventManager"),d=n("LocalWorldEventType"),u=n("LocalSoundManager"),h=n("RoleManager"),m=n("GameState");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.igniteAnimation=null,e.userData=null,e.targetData=null,e.igniteCount=0,e.burnedCount=1,e.durationTime=0,e.isDisappear=!1,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),f.prototype.onEnable=function(){u.LocalSoundManager.playFireAudio(),this.isDisappear=!1,this.node.opacity=255,this.node.stopAllActions(),p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this)},f.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},f.prototype.update=function(e){null==this.targetData||this.targetData.isDead||this.targetData.isDestroy?this.disappear():this.isDisappear||(this.targetData.isTeleporting?this.close():(this.durationTime-=e,this.durationTime<=0&&(m.GameState.isGaming&&(e=this.targetData.isBoss?.01:.02,e=this.targetData.isPlayer?.005:e,e=Math.round(this.targetData.maxHp*e),e=Math.max(1,e),e=Math.min(e,this.userData.atk),h.RoleManager.roleIsDamaged(this.targetData,this.userData,e,this.targetData.logicPos,!1),this.durationTime=.5,this.burnedCount++),this.burnedCount>=this.igniteCount&&this.disappear())))},f.prototype.lateUpdate=function(){null!=this.targetData&&(this.targetData.profession==s.ProfessionEnum.LAUNCHER&&!this.targetData.isBoss||this.targetData.profession==s.ProfessionEnum.NECROMANCER||this.targetData.profession==s.ProfessionEnum.SHIELD_WIZARD||this.updatePosition())},f.prototype.bindData=function(e,t,a){this.userData=e,this.targetData=t,e=this.userData.isPlayer?r.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.IGNITE):r.SkillSystem.getEquipedSkillInitData(s.SkillTypeEnum.IGNITE),this.igniteCount=e,this.burnedCount=0,this.durationTime=.5,this.igniteAnimation.play("Ignite"),this.closeAction=a,t.isBoss?this.node.scale=1.6:this.node.scale=.8},f.prototype.disappear=function(){var e=this;this.isDisappear||(u.LocalSoundManager.stop("fire"),u.LocalSoundManager.lastFireTime-=2e3,this.closeAction&&this.closeAction(),this.isDisappear=!0,this.node.runAction(cc.sequence(cc.fadeOut(1),cc.callFunc(function(){e.close()}))))},f.prototype.updatePosition=function(){null!=this.targetData&&(this.node.position=this.targetData.logicPos)},f.prototype.close=function(){this.closeAction&&this.closeAction(),c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u7ec4\u4ef6",type:cc.Animation})],f.prototype,"igniteAnimation",void 0),n=__decorate([n],f),i.IgniteEffect=n,cc._RF.pop()},{}],IncidentItem:[function(e,t,a){"use strict";cc._RF.push(t,"653b6OVSilOIJtnOIp/C6oG","IncidentItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("ConfigData"),c=n("SkillSystem"),p=n("SpecailSkill"),d=n("LocalSoundManager"),u=n("BattleUI"),h=n("ShareVideoControl"),m=n("BattleNumManager"),f=n("BoxReward"),g=n("LocalData"),y=n("GameConfigData"),v=n("ShareManager"),D=n("SkillItem"),E=n("GameCommonPool"),S=n("SingleEffectManager"),A=n("UIManager"),C=n("RandomIncidentManager"),M=n("GameState"),T=n("PlayerState");function _(){var e=null!==l&&l.apply(this,arguments)||this;return e.incidentIcon=null,e.boxDetail=null,e.newIncidentDetail=null,e.incidentDetail1=null,e.incidentDetail2=null,e.effectLabel=null,e.endLabel=null,e.priceLable=null,e.stengthenIcons=[],e.effectBtn=null,e.extraEffect=null,e.selectSkillItem=null,e.equipmentContent=null,e.boxSpriteFrames=[],e.equipments=[],e.clickAction=null,e.skillAction=null,e.videoNeed=!0,e.isProfiteer=!1,e.newItemIndex=null,e.incidentType=null,e.skillType=null,e.skillItem=null,e.equipmentDatas=[],e.boxType=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(_,l),_.prototype.bindData=function(e,t,a,n,o){var i,l,c,d,u,h=this;if(this.incidentType=n,this.skillItem&&(this.skillItem.node.active=!1),null!=e){var g=T.PlayerState.playerData;if(null==g)return;this.videoNeed=!0;var v,D=0,E=0;return this.incidentIcon.spriteFrame=this.getStrengthenIcon(e),e==r.StrengthenTypeEnum.ATk_STRONGER?(v=s.ConfigData.getWeaponAtk(g.weaponIndex,null,null),D=Math.ceil(.25*v),this.incidentDetail1.string="\u653b\u51fb\u529b+"+D):e==r.StrengthenTypeEnum.HP_STRONGER&&(E=Math.ceil(.25*g.initMaxHp),this.incidentDetail1.string="\u751f\u547d\u503c\u4e0a\u9650+"+E),this.isProfiteer=!1,void(this.clickAction=function(){e==r.StrengthenTypeEnum.ATk_STRONGER?(g.atk+=D,g.retainExtraAk+=D,p.SpecailSkill.createSkillEffectInPlayer(r.SkillTypeEnum.DAMAGE_UP,g)):e==r.StrengthenTypeEnum.HP_STRONGER&&(g.maxHp+=E,g.hp+=E,g.retainExtraHp+=E,S.SingleEffectManager.showHpUpEffect(g),m.BattleNumManager.createBattleNumEffect(r.BattleNumTypeEnum.HP_UP,E,g,g.logicPos)),o&&o()})}if(null!=t)return this.equipmentContent.active=!1,this.equipmentDatas=[],this.boxType=t,this.showEquipments(),this.isProfiteer=!0,this.videoNeed=!0,this.incidentIcon.spriteFrame=this.boxSpriteFrames[t-1],void(1==t?(this.incidentDetail1.string="\u767d\u94f6\u5b9d\u7bb1",this.boxDetail.string=s.ConfigData.normalBoxDetail,this.clickAction=function(){var e;f.BoxReward.isOpenBox||(e=h.getFixedEquip(),f.BoxReward.isOpenBox=!0,f.BoxReward.normalBoxReward(o,!0,e))}):2==t?(this.incidentDetail1.string="\u4f20\u5947\u5b9d\u7bb1",this.boxDetail.string=s.ConfigData.legendBoxDetail,this.clickAction=function(){var e;f.BoxReward.isOpenBox||(e=h.getFixedEquip(),f.BoxReward.isOpenBox=!0,f.BoxReward.legendBoxReward(o,!0,e))}):3==t&&(this.incidentDetail1.string="\u6770\u4f5c\u5b9d\u7bb1",this.boxDetail.string=s.ConfigData.weaponBoxDetail,this.clickAction=function(){var e;f.BoxReward.isOpenBox||(e=h.getFixedEquip(),f.BoxReward.isOpenBox=!0,f.BoxReward.weaponBoxReward(o,!0,e))}));null!=a&&(this.skillAction=null,this.extraEffect.active=!1,this.newItemIndex=a,this.effectLabel.string="",this.endLabel.string="\u597d\u7684",this.priceLable.node.active=!1,this.incidentIcon.spriteFrame=null,this.effectLabel.node.color=cc.Color.GREEN,this.incidentDetail1.node.parent.active=!0,this.incidentDetail2.node.parent.active=!0,this.effectBtn.active=!1,null!=(u=T.PlayerState.playerData)&&(n==r.RandomIncidentTypeEnum.NEWRECLUSE?(M.GameState.newIncidentTimes++,this.newIncidentDetail.node.active=!0,l=y.GameConfigData.data.recluseStartText[a],1==a&&(i=Math.round(.2*u.rewardCoin)+"\u91d1\u5e01",l=l.replace("[\u5f53\u524d\u83b7\u5f97\u91d1\u989d\u768420%]",i)),this.newIncidentDetail.string=l,this.incidentDetail1.string=y.GameConfigData.data.recluseRefuseText[a],this.incidentDetail2.string=y.GameConfigData.data.recluseSelectText[a]):n==r.RandomIncidentTypeEnum.ANGEL?(v=y.GameConfigData.data.angelStartText[a],c=y.GameConfigData.data.angelSelect1Text[a],d=y.GameConfigData.data.angelSelect2Text[a],t=u.hp>=u.maxHp,i=null==u.helmetIndex?1:u.helmetDefense/u.maxHelmetDefense,l=null==u.shieldIndex?1:u.shieldDefense/u.maxShieldDefense,0==a?(M.GameState.angel12Appear=!0,t&&(d=y.GameConfigData.data.angelSelect2Text[4]),i<l&&(c=c.replace("\u76fe","\u5934\u76d4"))):1==a?(M.GameState.angel12Appear=!0,t&&(c=c.replace("\u6cbb\u7597","\u4fee\u590d"))):2==a&&(1<=i&&1<=l?(c="",v=y.GameConfigData.data.angelStartText[4]):i<l&&(v=v.replace("\u76fe","\u5934\u76d4"))),this.newIncidentDetail.string=v,this.incidentDetail1.string=c,this.incidentDetail2.string=d,""==c&&(this.incidentDetail1.node.parent.active=!1)):n==r.RandomIncidentTypeEnum.DEMON&&(this.endLabel.string="\u544a\u8f9e",n=y.GameConfigData.data.devilStartText[a],c=y.GameConfigData.data.devilSelect1Text[a],d=y.GameConfigData.data.devilSelect2Text[a],this.newIncidentDetail.string=n,this.incidentDetail1.string=c,this.incidentDetail2.string=d,u=Math.floor(.25*u.maxHp),this.priceLable.string="\u751f\u547d\u503c\u4e0a\u9650-"+u,this.priceLable.node.active=!0),this.clickAction=o))},_.prototype.getFixedEquip=function(){if(null==this.equipmentDatas||this.equipmentDatas.length<=0)return null;var e=Math.random();return 1==this.boxType&&.4<e||2==this.boxType&&.6<e||3==this.boxType&&.8<e?null:(e=Math.floor(Math.random()*this.equipmentDatas.length),this.equipmentDatas[e])},_.prototype.showEquipments=function(){var e=this,t=2,a=g.LocalData.getEquippedEquipment(g.EquipmentType.weapon),n=g.LocalData.getEquippedEquipment(g.EquipmentType.helmet),o=g.LocalData.getEquippedEquipment(g.EquipmentType.shield),i=g.LocalData.getEquippedEquipment(g.EquipmentType.cloak),l=s.ConfigData.maxEquipmentRank-2;if(null!=a&&a.rank>l&&null!=n&&n.rank>l&&null!=o&&o.rank>l){if(3!=this.boxType)return;if(null!=i&&i.rank>l)return}t=Math.min(null==a?2:a.rank+1,null==n?2:n.rank+1),t=Math.min(t,null==o?2:o.rank+1),3==this.boxType&&(t=Math.min(t,null==i?2:i.rank+1)),t=cc.misc.clampf(t,2,l);var r,c,p=[];if(3==this.boxType&&(null==i||i.rank<=t)&&(r=Math.floor(Math.random()*s.ConfigData.profiteerCloakCount),c=new g.NewEquipmentData(g.EquipmentType.cloak,r,l,!0,!1),p.push(c)),(null==a||a.rank<=t)&&(r=Math.floor(Math.random()*(3==this.boxType?s.ConfigData.profiteerMaxWeaponCount:s.ConfigData.profiteerWeaponCount)),c=new g.NewEquipmentData(g.EquipmentType.weapon,r,t,!0,!1),p.push(c)),(null==n||n.rank<=t)&&(r=Math.floor(Math.random()*s.ConfigData.profiteerHelmetCount),c=new g.NewEquipmentData(g.EquipmentType.helmet,r,t,!0,!1),p.push(c)),(null==o||o.rank<=t)&&(r=Math.floor(Math.random()*s.ConfigData.profiteerShieldCount),c=new g.NewEquipmentData(g.EquipmentType.shield,r,t,!0,!1),p.push(c)),!(null==p||p.length<=0)){var d=function(){var a=Math.floor(Math.random()*(3==e.boxType?4:3)),n=Math.floor(5*Math.random());n=new g.NewEquipmentData(a,n,t,!0,!1),a==g.EquipmentType.cloak&&(n.rank=4),e.equipmentDatas.push(n)};if(1==this.boxType){p[0]&&this.equipmentDatas.push(p[0]);for(var u=this.equipmentDatas.length;u<2;u++)d()}else if(2==this.boxType)for(p[0]&&this.equipmentDatas.push(p[0]),p[1]&&this.equipmentDatas.push(p[1]),u=this.equipmentDatas.length;u<3;u++)d();else if(3==this.boxType)for(p[0]&&this.equipmentDatas.push(p[0]),p[1]&&this.equipmentDatas.push(p[1]),p[2]&&this.equipmentDatas.push(p[2]),u=this.equipmentDatas.length;u<3;u++)d();if(!(null==this.equipmentDatas||this.equipmentDatas.length<=0))for(this.equipmentContent.active=!0,u=0;u<3;u++){var h=this.equipmentDatas[u],m=this.equipments[u];if(null==m){var f=A.UIManager.createEquipmentItem(this.equipmentContent,h,!1,!1,!1,!1,cc.Vec2.ZERO,1.2);if(null==f)continue;this.equipments[u]=m=f}null!=h?(m.node.active=!0,m.bindData(h,!1,!1,!1,!1)):m.node.active=!1}}},_.prototype.clickSelect1=function(){var e=this;d.LocalSoundManager.playAudio("click"),this.incidentDetail1.node.parent.active=!1,this.incidentDetail2.node.parent.active=!1,this.effectBtn.active=!0;var t=T.PlayerState.playerData;if(this.incidentType==r.RandomIncidentTypeEnum.NEWRECLUSE){var a=y.GameConfigData.data.recluseFailResultText[this.newItemIndex];this.newIncidentDetail.string=a;var n=s.ConfigData.getWeaponAtk(t.weaponIndex,null,null),o=Math.ceil(n*y.GameConfigData.data.recluseRefuseEffect);this.effectLabel.string="\u653b\u51fb\u529b+"+o,this.incidentIcon.spriteFrame=this.stengthenIcons[0],1!=this.newItemIndex&&(this.effectLabel.string="",this.incidentIcon.spriteFrame=null),this.skillAction=function(){1==e.newItemIndex&&e.addAtk(y.GameConfigData.data.recluseRefuseEffect)}}else if(this.incidentType==r.RandomIncidentTypeEnum.ANGEL){a=y.GameConfigData.data.angelSelect1ResultText[this.newItemIndex];var i=t.hp>=t.maxHp;n=null==t.helmetIndex?1:t.helmetDefense/t.maxHelmetDefense,o=null==t.shieldIndex?1:t.shieldDefense/t.maxShieldDefense,0==this.newItemIndex?n<o?(this.effectLabel.string="\u5934\u76d4\u62a4\u7532\u56de\u590d+"+Math.round(.5*t.maxHelmetDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[3],this.skillAction=function(){c.SkillSystem.useImmediateSkill(14,.5)}):(this.effectLabel.string="\u76fe\u724c\u62a4\u7532\u56de\u590d+"+Math.round(.5*t.maxShieldDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[4],this.skillAction=function(){c.SkillSystem.useImmediateSkill(11,.5)}):1==this.newItemIndex?i?(a=a.replace("\u6cbb\u7597","\u4fee\u590d"),n<o?(this.effectLabel.string="\u5934\u76d4\u62a4\u7532\u56de\u590d+"+Math.round(.3*t.maxHelmetDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[3],this.skillAction=function(){c.SkillSystem.useImmediateSkill(14,.3)}):(this.effectLabel.string="\u76fe\u724c\u62a4\u7532\u56de\u590d+"+Math.round(.3*t.maxShieldDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[4],this.skillAction=function(){c.SkillSystem.useImmediateSkill(11,.3)})):(this.effectLabel.string="\u751f\u547d\u56de\u590d+"+Math.round(.3*t.maxHp),this.incidentIcon.spriteFrame=this.stengthenIcons[1],this.skillAction=function(){c.SkillSystem.useImmediateSkill(12,.3)}):2==this.newItemIndex?n<o?(this.effectLabel.string="\u5934\u76d4\u62a4\u7532\u56de\u590d+"+Math.round(.5*t.maxHelmetDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[3],this.skillAction=function(){c.SkillSystem.useImmediateSkill(14,.5)}):(this.effectLabel.string="\u76fe\u724c\u62a4\u7532\u56de\u590d+"+Math.round(.5*t.maxShieldDefense),this.incidentIcon.spriteFrame=this.stengthenIcons[4],this.skillAction=function(){c.SkillSystem.useImmediateSkill(11,.5)}):3==this.newItemIndex&&(this.effectLabel.string="\u5168\u72b6\u6001\u6062\u590d50%",this.extraEffect.active=!0,this.incidentIcon.spriteFrame=this.stengthenIcons[1],this.skillAction=function(){c.SkillSystem.useImmediateSkill(11,.5),c.SkillSystem.useImmediateSkill(12,.5),c.SkillSystem.useImmediateSkill(14,.5)}),this.newIncidentDetail.string=a}else if(this.incidentType==r.RandomIncidentTypeEnum.DEMON){if(this.priceLable.node.active=!1,a=y.GameConfigData.data.devilSelect1ResultText[this.newItemIndex],this.newIncidentDetail.string=a,this.skillType=C.RandomIncidentManager.getDevilSkill(),(this.incidentIcon.spriteFrame=null)==this.skillItem){if(null==(a=E.GameCommonPool.requestInstant(this.selectSkillItem)))return;if(a.setParent(this.node),a.setPosition(cc.v2(0,9)),null==(a=a.getComponent(D.SkillItem)))return;this.skillItem=a}this.skillItem.node.active=!0,this.skillItem.bindInfo(this.skillType,.75,!1,null,null),this.skillAction=function(){var a,n=c.SkillSystem.isImmediateSkill(e.skillType);null!=n&&(e.skillType!=r.SkillTypeEnum.HP_UP&&e.skillType!=r.SkillTypeEnum.SHIELD_UP&&e.skillType!=r.SkillTypeEnum.HELMET_UP&&c.SkillSystem.chooseSkill(e.skillType),u.BattleUI.showSkillDescribe(e.skillType),n?c.SkillSystem.useImmediateSkill(e.skillType,null):c.SkillSystem.equipSkill(e.skillType),null!=(a=T.PlayerState.player)&&a.changeWeapon(),n=t.maxHp,a=Math.ceil(.25*n),t.extraHp-=a,t.maxHp=n-a,t.hp=Math.min(t.hp,t.maxHp))}}},_.prototype.clickSelect2=function(){var e=this;d.LocalSoundManager.playAudio("click"),this.incidentDetail1.node.parent.active=!1,this.incidentDetail2.node.parent.active=!1,this.effectBtn.active=!0;var t=T.PlayerState.playerData;if(this.incidentType==r.RandomIncidentTypeEnum.NEWRECLUSE){var a=y.GameConfigData.data.recluseSuccessResultText[this.newItemIndex];this.newIncidentDetail.string=a;var n=s.ConfigData.getWeaponAtk(t.weaponIndex,null,null);n=Math.ceil(n*y.GameConfigData.data.recluseEffect[this.newItemIndex]),this.effectLabel.string="\u653b\u51fb\u529b+"+n,this.incidentIcon.spriteFrame=this.stengthenIcons[0],this.skillAction=function(){var a;e.addAtk(y.GameConfigData.data.recluseEffect[e.newItemIndex]),1==e.newItemIndex&&(a=Math.round(.2*t.rewardCoin),t.rewardCoin-=a)}}else if(this.incidentType==r.RandomIncidentTypeEnum.ANGEL){if(a=y.GameConfigData.data.angelSelect2ResultText[this.newItemIndex],n=t.hp>=t.maxHp,0==this.newItemIndex)n?(a=y.GameConfigData.data.angelSelect2ResultText[4],this.effectLabel.string="\u6700\u5927\u751f\u547d\u503c+"+Math.round(.1*t.initMaxHp),this.incidentIcon.spriteFrame=this.stengthenIcons[2],this.skillAction=function(){c.SkillSystem.useImmediateSkill(13,.1)}):(this.effectLabel.string="\u751f\u547d\u56de\u590d+"+Math.round(.3*t.maxHp),this.incidentIcon.spriteFrame=this.stengthenIcons[1],this.skillAction=function(){c.SkillSystem.useImmediateSkill(12,.3)});else if(1==this.newItemIndex)this.effectLabel.string="",this.incidentIcon.spriteFrame=null,this.skillAction=function(){M.GameState.reclusePart=M.GameState.currentPart+1};else if(2==this.newItemIndex)this.effectLabel.string="\u6700\u5927\u751f\u547d\u503c+"+Math.round(.2*t.initMaxHp),this.incidentIcon.spriteFrame=this.stengthenIcons[2],this.skillAction=function(){c.SkillSystem.useImmediateSkill(13,.2)};else if(3==this.newItemIndex){if(this.effectLabel.string="",(this.incidentIcon.spriteFrame=null)==this.skillItem){if(null==(n=E.GameCommonPool.requestInstant(this.selectSkillItem)))return;if(n.setParent(this.node),n.setPosition(cc.v2(0,9)),null==(n=n.getComponent(D.SkillItem)))return;this.skillItem=n}this.skillItem.node.active=!0,this.skillItem.bindInfo(21,.75,!1,null,null),this.skillAction=function(){c.SkillSystem.equipSkill(21),S.SingleEffectManager.showReviveHoleEffect(),t.skillRevive=1}}this.newIncidentDetail.string=a}else this.incidentType==r.RandomIncidentTypeEnum.DEMON&&(this.priceLable.node.active=!1,a=y.GameConfigData.data.devilSelect2ResultText[this.newItemIndex],this.newIncidentDetail.string=a,this.skillAction=function(){})},_.prototype.addAtk=function(e){var t,a=T.PlayerState.playerData;null!=a&&(t=s.ConfigData.getWeaponAtk(a.weaponIndex,null,null),e=Math.ceil(t*e),a.atk+=e,a.extraAtk+=e,p.SpecailSkill.createSkillEffectInPlayer(r.SkillTypeEnum.DAMAGE_UP,a))},_.prototype.getStrengthenIcon=function(e){return(e=e==r.StrengthenTypeEnum.ATk_STRONGER?0:1)<0||e>=this.stengthenIcons.length?null:this.stengthenIcons[e]},_.prototype.clickSkill=function(){d.LocalSoundManager.playAudio("click"),this.skillAction&&this.skillAction(),this.clickAction&&this.clickAction()},_.prototype.clickChoose=function(){var e=this;function t(){e.clickAction&&e.clickAction()}d.LocalSoundManager.playAudio("click"),f.BoxReward.isOpenBox=!1,v.ShareManager.getShareControlType()!=v.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME&&this.videoNeed?this.isProfiteer?h.ShareVideoControl.videoFunc("\u5978\u5546",t,null,t,null,null,h.VideoAdIdEnum.PROFITEER_ID):h.ShareVideoControl.videoFunc("\u9009\u62e9\u4e8b\u4ef6",t,null,t,null,null,h.VideoAdIdEnum.RECULSE_ID):t()},__decorate([o({displayName:"\u4e8b\u4ef6\u56fe\u6807",type:cc.Sprite})],_.prototype,"incidentIcon",void 0),__decorate([o({displayName:"\u5b9d\u7bb1\u63cf\u8ff0",type:cc.Label})],_.prototype,"boxDetail",void 0),__decorate([o({displayName:"\u65b0\u968f\u673a\u4e8b\u4ef6\u63cf\u8ff0",type:cc.Label})],_.prototype,"newIncidentDetail",void 0),__decorate([o({displayName:"\u9009\u62e91",type:cc.Label})],_.prototype,"incidentDetail1",void 0),__decorate([o({displayName:"\u9009\u62e92",type:cc.Label})],_.prototype,"incidentDetail2",void 0),__decorate([o({displayName:"\u6548\u679c\u6587\u5b57",type:cc.Label})],_.prototype,"effectLabel",void 0),__decorate([o({displayName:"\u7ed3\u675f\u6587\u5b57",type:cc.Label})],_.prototype,"endLabel",void 0),__decorate([o({displayName:"\u9009\u62e9\u80fd\u529b\u4ee3\u4ef7",type:cc.Label})],_.prototype,"priceLable",void 0),__decorate([o({displayName:"\u5f3a\u5316\u4e8b\u4ef6\u56fe\u6807\u96c6\u5408",type:cc.SpriteFrame})],_.prototype,"stengthenIcons",void 0),__decorate([o({displayName:"\u6548\u679c\u9009\u62e9\u6309\u94ae",type:cc.Node})],_.prototype,"effectBtn",void 0),__decorate([o({displayName:"\u989d\u5916\u6548\u679c",type:cc.Node})],_.prototype,"extraEffect",void 0),__decorate([o({displayName:"\u9009\u62e9\u6280\u80fditem",type:cc.Prefab})],_.prototype,"selectSkillItem",void 0),__decorate([o({displayName:"\u88c5\u5907\u680f",type:cc.Node})],_.prototype,"equipmentContent",void 0),__decorate([o({displayName:"\u5b9d\u7bb1\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],_.prototype,"boxSpriteFrames",void 0),n=__decorate([n],_),i.IncidentItem=n,cc._RF.pop()},{}],InheritItem:[function(e,t,a){"use strict";cc._RF.push(t,"85d3bgbzVJDv4dp0SXB1wgq","InheritItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("SpriteFrameManager"),c=n("LocalSoundManager"),p=n("GameState"),d=n("CommonMask"),u=n("ConfigData"),h=n("Timer");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.description=null,e.inheritSkillName=null,e.skillIconsNode=null,e.inheritIcon=null,e.videoIcon=null,e.skillIcons=[],e.oneSkilIcons=null,e.inheritSpriteFrames=[],e.inheritSkillAni=null,e.light=null,e.lightCircle=null,e.descriptionStrings=["\u968f\u673a\u4fdd\u7559\u4e00\u4e2a\u6280\u80fd","\u653b\u51fb\u529b+","\u751f\u547d\u4e0a\u9650+","\u5934\u76d4\u62a4\u7532\u4e0a\u9650+","\u76fe\u724c\u62a4\u7532\u4e0a\u9650+","\u6ee1\u72b6\u6001\u56de\u590d"],e.skillIconsPos=[cc.v2(-46,-6),cc.v2(38,-6),cc.v2(-3,54)],e.inheritType=null,e.clickAction=null,e.addPercent=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.onEnable=function(){this.description.node.stopAllActions(),this.description.node.position=cc.v2(-2,-70),this.description.node.opacity=255,this.inheritSkillName.node.stopAllActions(),this.inheritSkillName.node.position=cc.v2(-2,-50),this.inheritSkillName.node.opacity=0},m.prototype.bindData=function(e,t,a,n){if(null!=e&&null!=t)if(this.inheritType=e,this.clickAction=t,this.addPercent=a,t="",e!=r.InheritTypeEnum.SKILL&&e!=r.InheritTypeEnum.RESTORE&&(t=Math.round(100*a)+"%"),e==r.InheritTypeEnum.SKILL&&5<=p.GameState.inheritSkillCount?this.description.string="\u9009\u62e9\u4e00\u4e2a\u6280\u80fd\u66ff\u6362":this.description.string=this.descriptionStrings[e]+t,this.refreshVideoIcon(!1),this.inheritType==r.InheritTypeEnum.SKILL){this.skillIconsNode.active=!0,this.inheritIcon.node.active=!1,this.light.active=!1,this.lightCircle.active=!1;for(var o=0,i=this.skillIcons;o<i.length;o++){var l=i[o];if(null==l)return;l.node.scale=.8}if(this.skillIcons[0].node.position=this.skillIconsPos[0],this.skillIcons[1].node.position=this.skillIconsPos[1],this.skillIcons[2].node.position=this.skillIconsPos[2],null!=n){var c=n.concat([]);if(1<c.length){this.oneSkilIcons.node.active=!1;for(var d=0;d<3;d++){var u=c[d];this.skillIcons[d].node.active=!0,this.skillIcons[d].spriteFrame=s.SpriteFrameManager.getSkillSpriteFrame(u)}}else{for(d=0;d<3;d++)this.skillIcons[d].node.active=!1;this.oneSkilIcons.node.active=!0,this.oneSkilIcons.spriteFrame=s.SpriteFrameManager.getSkillSpriteFrame(c[0])}}}else this.skillIconsNode.active=!1,this.inheritIcon.node.active=!0,this.inheritIcon.spriteFrame=this.inheritSpriteFrames[this.inheritType]},m.prototype.refreshVideoIcon=function(e){this.videoIcon.active=e},m.prototype.playInheritSkillAni=function(e,t,a){var n=this;function o(){n.lightCircle.active=!0,n.lightCircle.stopAllActions(),n.lightCircle.opacity=255,n.lightCircle.runAction(cc.sequence(cc.repeat(cc.sequence(cc.fadeOut(.1),cc.fadeIn(.1)),3),cc.callFunc(function(){n.lightCircle.active=!1,n.oneSkilIcons.node.stopAllActions(),n.oneSkilIcons.node.runAction(cc.sequence(cc.scaleTo(.1,.6),cc.scaleTo(.1,.8),cc.callFunc(function(){a&&a()})))})))}function i(){n.description.node.runAction(cc.spawn(cc.fadeOut(.1),cc.moveBy(.1,0,20))),n.inheritSkillName.string=u.ConfigData.skillName[t],n.inheritSkillName.node.runAction(cc.spawn(cc.fadeIn(.1),cc.moveBy(.1,0,-20)))}d.CommonMask.showMask(),this.oneSkilIcons.node.active=!0,this.oneSkilIcons.spriteFrame=s.SpriteFrameManager.getSkillSpriteFrame(t),e<=5?(this.inheritSkillAni.play("InheritSkill"),h.TimerManager.addTimer(.6,function(){o(),i()},this.node)):(o(),i())},m.prototype.clickInherit=function(){c.LocalSoundManager.playAudio("click"),this.clickAction&&this.clickAction(this.inheritType,this.addPercent)},__decorate([o({displayName:"\u63cf\u8ff0",type:cc.Label})],m.prototype,"description",void 0),__decorate([o({displayName:"\u7ee7\u627f\u7684\u6280\u80fd\u540d\u79f0",type:cc.Label})],m.prototype,"inheritSkillName",void 0),__decorate([o({displayName:"\u6280\u80fd\u5c55\u793a\u8282\u70b9",type:cc.Node})],m.prototype,"skillIconsNode",void 0),__decorate([o({displayName:"\u7ee7\u627f\u56fe\u6807",type:cc.Sprite})],m.prototype,"inheritIcon",void 0),__decorate([o({displayName:"\u89c6\u9891\u89d2\u6807",type:cc.Node})],m.prototype,"videoIcon",void 0),__decorate([o({displayName:"\u6280\u80fd\u56fe\u6807",type:cc.Sprite})],m.prototype,"skillIcons",void 0),__decorate([o({displayName:"\u5355\u72ec\u7684\u6280\u80fd\u56fe\u6807",type:cc.Sprite})],m.prototype,"oneSkilIcons",void 0),__decorate([o({displayName:"\u7ee7\u627f\u7c7b\u578b\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],m.prototype,"inheritSpriteFrames",void 0),__decorate([o({displayName:"\u7ee7\u627f\u6280\u80fd\u52a8\u753b\u8282\u70b9",type:cc.Animation})],m.prototype,"inheritSkillAni",void 0),__decorate([o({displayName:"\u5149\u8292\u8282\u70b9",type:cc.Node})],m.prototype,"light",void 0),__decorate([o({displayName:"\u5149\u5708\u8282\u70b9",type:cc.Node})],m.prototype,"lightCircle",void 0),n=__decorate([n],m),i.InheritItem=n,cc._RF.pop()},{}],InheritPopUI:[function(e,t,a){"use strict";cc._RF.push(t,"efeddcvljdOmquompMQazm4","InheritPopUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("UIManager"),c=n("PlayerState"),p=n("LocalSoundManager"),d=n("GameConfigData"),u=n("SkillSystem"),h=n("Util"),m=n("GameState"),f=n("SingleEffectManager"),g=n("ShareVideoControl"),y=n("InheritItem"),v=n("BattleNumManager"),D=n("EnumAndConst"),E=n("SpecailSkill"),S=n("ShareManager"),A=n("WorldEventManager"),C=n("LocalWorldEventType"),M=n("SpriteFrameManager"),T=n("CommonMask");function _(){var e=null!==l&&l.apply(this,arguments)||this;return e.closeButtonNode=null,e.contentNode=null,e.masks=[],e.inheritItemPrefab=null,e.inheritSkillIcons=[],e.inheritSkillDefaultIcon=null,e.inheritAniSkillIcon=null,e.questionMarkButton=null,e.questionBubble=null,e.bigMask=null,e.replaceSkillBubble=null,e.replaceSkillEffects=[],e.inheritItems=null,e.remainInheritCount=2,e.inheritInitPercent=.2,e.hasExHeighSkillChances=[.2,.4,.4],e.hasNoExHeighSkillChances=[1/3,1/3,1/3],e.targetSkills=[],e.hasExHeighSkill=!1,e.keepedSkill=null,e.canReplaceSkill=!1,e.restoreState=!1,e.chooseInheritSkills=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(_,l),_.prototype.onEnable=function(){this.closeButtonNode.active=!1,this.inheritAniSkillIcon.node.active=!1;for(var e=0,t=this.masks;e<t.length;e++){var a=t[e];if(null==a)return;a.active=!1}this.questionBubble.active=!1,this.bigMask.active=!1,this.replaceSkillBubble.active=!1,this.canReplaceSkill=!1;for(var n=0,o=this.replaceSkillEffects;n<o.length;n++){var i=o[n];if(null==i)return;i.active=!1}this.restoreState=!1},_.prototype.update=function(){s.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},_.prototype.bindData=function(e){var t=this;this.closeAction=e,this.remainInheritCount=2,this.keepedSkill=null,this.showInheritSkills(),this.refreshInheritSkills();var a=this.getRandomInheritTypes();if(!(null==a||a.length<0)){null==this.inheritItems&&(this.inheritItems=[]);for(var n=0;n<a.length;n++){var o=this.inheritItems[n];if(null==o){var i=r.GameCommonPool.requestInstant(this.inheritItemPrefab);if(null==i)return;var l=i.getComponent(y.InheritItem);if(null==l)return;i.setParent(this.contentNode),this.inheritItems[n]=o=l}null==(i=a[n])?o.node.active=!1:(o.node.active=!0,l=this.getAddPercent(i),o.bindData(i,function(e,a){e!=D.InheritTypeEnum.SKILL?e!=D.InheritTypeEnum.ATK?e!=D.InheritTypeEnum.MAX_HP?e!=D.InheritTypeEnum.MAX_HELMET_DEFENSE?e!=D.InheritTypeEnum.MAX_SHIELD_DEFENSE?t.restore():t.inheritMaxShieldDefense(a):t.inheritMaxHelmetDefense(a):t.inheritMaxHp(a):t.inheritAtk(a):t.inheritSkill()},l,this.targetSkills))}}},_.prototype.getRandomInheritTypes=function(){if(null!=(n=c.PlayerState.playerData)){var e=[null,null,null,null];e[0]=D.InheritTypeEnum.SKILL,e[3]=D.InheritTypeEnum.RESTORE;var t=[D.InheritTypeEnum.ATK,D.InheritTypeEnum.MAX_HP],a=0<n.helmetDefense&&!n.helmetDroped,n=0<n.shieldDefense&&!n.shieldDroped;return a&&t.push(D.InheritTypeEnum.MAX_HELMET_DEFENSE),n&&t.push(D.InheritTypeEnum.MAX_SHIELD_DEFENSE),t=h.Util.getRandomArrayElements(t,2),e[1]=t[0],e[2]=t[1],e}},_.prototype.getAddPercent=function(e){var t=this.inheritInitPercent,a=0;switch(e){case D.InheritTypeEnum.ATK:a=m.GameState.inheritAtkCount;break;case D.InheritTypeEnum.MAX_HP:a=m.GameState.inheritMaxHpCount;break;case D.InheritTypeEnum.MAX_HELMET_DEFENSE:a=m.GameState.inheritMaxHelmetDefenseCount;break;case D.InheritTypeEnum.MAX_SHIELD_DEFENSE:a=m.GameState.inheritMaxShieldDefenseCount}return t-=.05*a,Math.max(t,.1)},_.prototype.showInheritSkills=function(){var e=u.SkillSystem.inheritSkillLevels;this.chooseInheritSkills=[];for(var t,a=0;a<e.length;a++){var n=e[t=a];if(!(null==n||n<=0))for(var o=0;o<n;o++)this.chooseInheritSkills.push(t)}for(a=0;a<this.inheritSkillIcons.length;a++)null!=(t=this.chooseInheritSkills[a])?this.inheritSkillIcons[a].spriteFrame=M.SpriteFrameManager.getSkillSpriteFrame(t):this.inheritSkillIcons[a].spriteFrame=this.inheritSkillDefaultIcon},_.prototype.refreshInheritSkills=function(){this.targetSkills=[];var e=u.SkillSystem.getSkillsBySelect();if(m.GameState.inheritSkillCount<5){this.questionMarkButton.active=!1;for(var t,a=[],n=0;n<e.length;n++){var o=e[n];-1!=(t=d.GameConfigData.data.exHeightSkillArray.indexOf(o))&&a.push(o)}0<a.length?(i=h.Util.getRandomValueFromArray(a),this.targetSkills.push(i),-1!=(t=e.indexOf(i))&&e.splice(t,1),this.hasExHeighSkill=!0):this.hasExHeighSkill=!1;var i=3-this.targetSkills.length;i=h.Util.getRandomArrayElements(e,i),this.targetSkills=this.targetSkills.concat(i),this.targetSkills.sort(function(e,t){return Math.random()<.5?e-t:t-e})}else this.questionMarkButton.active=!0,i=h.Util.getRandomValueFromArray(e),this.targetSkills.push(i)},_.prototype.inheritSkill=function(){var e=this;function t(){if(e.remainInheritCount--,m.GameState.inheritSkillCount<5){var t=e.hasExHeighSkill?e.hasExHeighSkillChances:e.hasNoExHeighSkillChances;t=h.Util.getRandomIndexInChanceArray(t),t=e.targetSkills[t],e.keepedSkill=t,t=e.inheritSkillIcons[m.GameState.inheritSkillCount],e.selectInheritSkill(t)}else{e.canReplaceSkill=!0,e.bigMask.active=!0,e.replaceSkillBubble.active=!0;for(var a=0,n=e.replaceSkillEffects;a<n.length;a++){var o=n[a];if(null==o)return;o.active=!0}}}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?t():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",t,null,t,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.selectInheritSkill=function(e){var t=this;m.GameState.inheritSkillCount++;var a=this.inheritItems[0];null!=a&&(0<this.remainInheritCount?a.playInheritSkillAni(m.GameState.inheritSkillCount,this.keepedSkill,function(){t.playInheritAnimation(.01,e,function(){t.refreshButtonVideoIcons(D.InheritTypeEnum.SKILL)})}):a.playInheritSkillAni(m.GameState.inheritSkillCount,this.keepedSkill,function(){t.playInheritAnimation(.3,e,function(){t.close()})}))},_.prototype.inheritAtk=function(e){var t=this;function a(){t.remainInheritCount--;var a,n=c.PlayerState.playerData;null!=n&&(a=Math.round(n.initAtk*e),n.atk+=a,n.retainExtraAk+=a,E.SpecailSkill.createSkillEffectInPlayer(D.SkillTypeEnum.DAMAGE_UP,n),m.GameState.inheritAtkCount++,0<t.remainInheritCount?t.refreshButtonVideoIcons(D.InheritTypeEnum.ATK):t.close())}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?a():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",a,null,a,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.inheritMaxHp=function(e){var t=this;function a(){t.remainInheritCount--;var a,n=c.PlayerState.playerData;null!=n&&(a=Math.round(n.initMaxHp*e),n.maxHp+=a,n.hp+=a,n.retainExtraHp+=a,f.SingleEffectManager.showHpUpEffect(n),v.BattleNumManager.createBattleNumEffect(D.BattleNumTypeEnum.HP_UP,a,n,n.logicPos),m.GameState.inheritMaxHpCount++,0<t.remainInheritCount?t.refreshButtonVideoIcons(D.InheritTypeEnum.MAX_HP):t.close())}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?a():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",a,null,a,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.inheritMaxHelmetDefense=function(e){var t=this;function a(){t.remainInheritCount--;var a,n=c.PlayerState.playerData;null!=n&&(a=Math.round(n.initHelmetDefense*e),n.maxHelmetDefense+=a,n.helmetDefense+=a,n.retainExtraHelmetDefense+=a,f.SingleEffectManager.showRepairEffect(n),v.BattleNumManager.createBattleNumEffect(D.BattleNumTypeEnum.EQUIPMENT_UP,a,n,n.logicPos),m.GameState.inheritMaxHelmetDefenseCount++,0<t.remainInheritCount?t.refreshButtonVideoIcons(D.InheritTypeEnum.MAX_HELMET_DEFENSE):t.close())}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?a():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",a,null,a,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.inheritMaxShieldDefense=function(e){var t=this;function a(){t.remainInheritCount--;var a,n=c.PlayerState.playerData;null!=n&&(a=Math.round(n.initShieldDefense*e),n.maxShieldDefense+=a,n.shieldDefense+=a,n.retainExtraShieldDefense+=a,f.SingleEffectManager.showRepairEffect(n),v.BattleNumManager.createBattleNumEffect(D.BattleNumTypeEnum.EQUIPMENT_UP,a,n,n.logicPos),m.GameState.inheritMaxShieldDefenseCount++,0<t.remainInheritCount?t.refreshButtonVideoIcons(D.InheritTypeEnum.MAX_SHIELD_DEFENSE):t.close())}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?a():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",a,null,a,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.restore=function(){var e=this;function t(){e.remainInheritCount--,null!=c.PlayerState.playerData&&(u.SkillSystem.useImmediateSkill(D.SkillTypeEnum.HP_UP,1),u.SkillSystem.useImmediateSkill(D.SkillTypeEnum.HELMET_UP,1),u.SkillSystem.useImmediateSkill(D.SkillTypeEnum.SHIELD_UP,1),e.restoreState=!0,0<e.remainInheritCount?e.refreshButtonVideoIcons(D.InheritTypeEnum.RESTORE):e.close())}p.LocalSoundManager.playAudio("click"),2<=this.remainInheritCount||S.ShareManager.getShareControlType()==S.ShareControlType.ShareAndAdClose||cc.sys.platform!==cc.sys.WECHAT_GAME?t():g.ShareVideoControl.videoFunc("\u65e0\u5c3d\u6a21\u5f0f\u7ee7\u627f\u754c\u9762\u4fdd\u7559\u6280\u80fd",t,null,t,null,null,g.VideoAdIdEnum.REVIVE_ID)},_.prototype.refreshButtonVideoIcons=function(e){this.closeButtonNode.active=!0;for(var t=0;t<this.inheritItems.length;t++){var a=this.inheritItems[t];if(null==a)return;a.inheritType!=e?this.inheritItems[t].refreshVideoIcon(!0):(this.masks[t].active=!0,this.masks[t].x=a.node.x+2)}},_.prototype.playInheritAnimation=function(e,t,a){var n,o,i=this;null!=e&&null!=t&&(n=cc.v2(-287.5,86),o=t.node.position,this.inheritAniSkillIcon.spriteFrame=M.SpriteFrameManager.getSkillSpriteFrame(this.keepedSkill),this.inheritAniSkillIcon.node.setPosition(n),this.inheritAniSkillIcon.node.scale=.8,this.inheritAniSkillIcon.node.active=!0,this.inheritAniSkillIcon.node.stopAllActions(),this.inheritAniSkillIcon.node.runAction(cc.sequence(cc.spawn(cc.scaleTo(.3,1),cc.moveTo(.3,o)),cc.callFunc(function(){var n;t.spriteFrame=i.inheritAniSkillIcon.spriteFrame,i.inheritAniSkillIcon.node.active=!1,null!=(n=t)&&(n.node.stopAllActions(),n.node.scale=1,n.node.runAction(cc.sequence(cc.scaleTo(.05,.8),cc.scaleTo(.05,1.2),cc.scaleTo(.05,1),cc.delayTime(e),cc.callFunc(function(){T.CommonMask.hideMask(),a&&a()}))))}))))},_.prototype.clickQuestionMark=function(){this.questionBubble.active=!this.questionBubble.active},_.prototype.clickReplaceSkill=function(e,t){if(this.canReplaceSkill){this.canReplaceSkill=!1,this.bigMask.active=!1,this.replaceSkillBubble.active=!1;for(var a=0,n=this.replaceSkillEffects;a<n.length;a++){var o=n[a];if(null==o)return;o.active=!1}var i=parseInt(t);t=this.chooseInheritSkills[i],u.SkillSystem.inheritSkillLevels[t]=u.SkillSystem.inheritSkillLevels[t]-1,this.keepedSkill=this.targetSkills[0]||0,i=this.inheritSkillIcons[i],this.selectInheritSkill(i)}},_.prototype.clickClose=function(){p.LocalSoundManager.playAudio("click"),this.close()},_.prototype.close=function(){u.SkillSystem.inheritSkill(this.keepedSkill),u.SkillSystem.initSkill(null,null,u.SkillSystem.equipmentSkillLevels,u.SkillSystem.inheritSkillLevels,!0);var e=u.SkillSystem.equipedSkillLevels;f.SingleEffectManager.returnPermanentEffects(e),null!=(e=c.PlayerState.playerData)&&(e.level=1,e.exp=0,e.maxHp-=e.extraHp,e.maxHp=Math.max(1,e.maxHp),e.hp=Math.min(e.hp,e.maxHp),e.extraHp=0,e.atk-=e.extraAtk,e.extraAtk=0,this.restoreState&&(e.hp=e.maxHp,e.helmetDefense=e.maxHelmetDefense,e.shieldDefense=e.maxShieldDefense),e={lastlevel:e.level,currentExpPercent:e.exp,addTime:0,isSlide:!1},A.WorldEventManager.triggerEvent(C.LocalWorldEventType.AddExp,e),c.PlayerState.player.changeWeapon(),this.closeAction&&this.closeAction(),r.GameCommonPool.returnInstant(this.node))},__decorate([o({displayName:"\u5173\u95ed\u6309\u94ae\u8282\u70b9",type:cc.Node})],_.prototype,"closeButtonNode",void 0),__decorate([o({displayName:"\u7ee7\u627f\u5185\u5bb9\u8282\u70b9",type:cc.Node})],_.prototype,"contentNode",void 0),__decorate([o({displayName:"\u906e\u7f69\u96c6\u5408",type:cc.Node})],_.prototype,"masks",void 0),__decorate([o({displayName:"\u7ee7\u627f\u7684item",type:cc.Prefab})],_.prototype,"inheritItemPrefab",void 0),__decorate([o({displayName:"\u5df2\u7ee7\u627f\u6280\u80fd\u7684\u56fe\u6807",type:cc.Sprite})],_.prototype,"inheritSkillIcons",void 0),__decorate([o({displayName:"\u5df2\u7ee7\u627f\u6280\u80fd\u56fe\u6807\u9ed8\u8ba4\u56fe\u7247",type:cc.SpriteFrame})],_.prototype,"inheritSkillDefaultIcon",void 0),__decorate([o({displayName:"\u7ee7\u627f\u52a8\u753b\u6280\u80fdicon",type:cc.Sprite})],_.prototype,"inheritAniSkillIcon",void 0),__decorate([o({displayName:"\u7ee7\u627f\u6ee1\u6b21\u7684\u63d0\u793a\u6309\u94ae\u8282\u70b9",type:cc.Node})],_.prototype,"questionMarkButton",void 0),__decorate([o({displayName:"\u7ee7\u627f\u6ee1\u6b21\u7684\u63d0\u793a\u6c14\u6ce1",type:cc.Node})],_.prototype,"questionBubble",void 0),__decorate([o({displayName:"\u66ff\u6362\u6280\u80fd\u65f6\u7684\u5927\u906e\u7f69",type:cc.Node})],_.prototype,"bigMask",void 0),__decorate([o({displayName:"\u5f15\u5bfc\u66ff\u6362\u6280\u80fd\u6c14\u6ce1",type:cc.Node})],_.prototype,"replaceSkillBubble",void 0),__decorate([o({displayName:"\u66ff\u6362\u6280\u80fd\u9ad8\u4eae\u63d0\u793a\u7279\u6548",type:cc.Node})],_.prototype,"replaceSkillEffects",void 0),n=__decorate([n],_),i.InheritPopUI=n,cc._RF.pop()},{}],InspireWallEffect:[function(e,t,a){"use strict";cc._RF.push(t,"dda03mhU11FM69E5cWjv52D","InspireWallEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("SingleEffectManager"),d=n("PlayerState");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.inspireWallAni=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.inspireWallAni.play("InspireWall"),this.inspireWallAni.on("finished",this.close,this)},u.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),this.inspireWallAni.off("finished",this.close,this)},u.prototype.close=function(){p.SingleEffectManager.deleteEffect(d.PlayerState.playerData,p.SingleEffectTypeEnum.INSPIRE_WALL_EFFECT),r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u632f\u594b\u4e4b\u58c1\u7279\u6548\u52a8\u753b",type:cc.Animation})],u.prototype,"inspireWallAni",void 0),n=__decorate([n],u),i.InspireWallEffect=n,cc._RF.pop()},{}],LaserCollider:[function(e,t,a){"use strict";cc._RF.push(t,"b11443K6itMSJ0+8DispBke","LaserCollider");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameState"),s=n("EnumAndConst"),c=n("Head"),p=n("RoleManager"),d=n("Body"),u=n("Shield"),h=n("ConfigData");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.boxCollider=null,e.userData=null,e.lastHurtData=null,e.isActivate=!1,e.lastWidth=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.onEnable=function(){this.isActivate=!1},m.prototype.update=function(){this.node.width!=this.lastWidth&&(this.lastWidth=this.node.width,this.boxCollider.offset.x=-this.node.width/2,this.boxCollider.size.width=this.node.width)},m.prototype.bindData=function(e){this.userData=e},m.prototype.onCollisionEnter=function(e,t){null!=this.userData&&this.isActivate&&r.GameState.isGaming&&(e.node.group!=s.GroupNameEnum.HEAD?e.node.group!=s.GroupNameEnum.BODY?e.node.group!=s.GroupNameEnum.SHIELD||this.collideShield(e,t):this.collideBody(e,t):this.collideHead(e,t))},m.prototype.onCollisionStay=function(e,t){null!=this.userData&&this.isActivate&&r.GameState.isGaming&&(e.node.group!=s.GroupNameEnum.HEAD?e.node.group!=s.GroupNameEnum.BODY?e.node.group!=s.GroupNameEnum.SHIELD||this.collideShield(e,t):this.collideBody(e,t):this.collideHead(e,t))},m.prototype.collideHead=function(e,t){var a,n,o=e.getComponent(c.Head);null!=o&&(null==(a=o.roleData)||a.isPlayer||a.isDead||a.isTeleporting||a==this.userData||a==this.lastHurtData||a.isEnemy==this.userData.isEnemy||(n=a.helmetDefense,null!=o.helmet&&0<n?this.collideHelmet(e,t,o,a):(this.lastHurtData=a,p.RoleManager.roleIsDamaged(a,this.userData,h.ConfigData.MAX_DAMAGE,a.logicPos))))},m.prototype.collideHelmet=function(e,t,a,n){this.lastHurtData=n,p.RoleManager.roleIsDamaged(n,this.userData,h.ConfigData.MAX_DAMAGE,n.logicPos),null!=a.helmet&&a.helmet.node.active&&n.helmetDefense<=0&&(a.helmet.drop(-100,200),a.helmet=null)},m.prototype.collideBody=function(e){null!=(e=e.getComponent(d.Body))&&(null==(e=e.roleData)||e.isPlayer||e.isDead||e.isTeleporting||e==this.userData||e==this.lastHurtData||e.isEnemy==this.userData.isEnemy||(this.lastHurtData=e,p.RoleManager.roleIsDamaged(e,this.userData,h.ConfigData.MAX_DAMAGE,e.logicPos)))},m.prototype.collideShield=function(e){var t=e.getComponent(u.Shield);null!=t&&(null==(e=t.roleData)||e.isPlayer||e.isDead||e.isTeleporting||e==this.userData||e==this.lastHurtData||e.isEnemy==this.userData.isEnemy||(this.lastHurtData=e,p.RoleManager.roleIsDamaged(e,this.userData,h.ConfigData.MAX_DAMAGE,e.logicPos),e.shieldDefense<=0&&t.drop(-100,200)))},__decorate([o({displayName:"\u78b0\u649e\u76d2",type:cc.BoxCollider})],m.prototype,"boxCollider",void 0),n=__decorate([n],m),i.LaserCollider=n,cc._RF.pop()},{}],Laser:[function(e,t,a){"use strict";cc._RF.push(t,"44b24sgDmBCCLGmnF0N+jdH","Laser");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("GameManager"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("EnumAndConst"),u=n("Util"),h=n("LocalSoundManager"),m=n("Arrow"),f=n("SingleEffectManager"),g=n("LocalData"),y=n("RoleManager"),v=n("GameState"),D=n("EffectCreate"),E=n("PlayerState"),S=n("LaserCollider"),A=n("ConfigData");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.laserGun=null,e.laser=null,e.laserCollider=null,e.laserHead=null,e.moveSpeed=200,e.moveDirection=null,e.isMoving=!1,e.moveTime=null,e.roleData=null,e.isDamaging=!1,e.isClosing=!1,e.aimingPos=null,e.rotateTween=null,e.turnOffLaserAction=null,e.closeAction=null,e.getLaserCountAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(C,l),C.prototype.onEnable=function(){c.WorldEventManager.addListener(p.LocalWorldEventType.BackHome,this.close,this)},C.prototype.onDisable=function(){c.WorldEventManager.removeListener(p.LocalWorldEventType.BackHome,this.close,this)},C.prototype.update=function(e){null!=this.roleData&&!this.roleData.isDead||this.isClosing||this.closing(),this.moving(e),this.refreshLaserLength()},C.prototype.bindData=function(e,t,a,n){this.roleData=e,this.closeAction=t,this.getLaserCountAction=a,this.turnOffLaserAction=n,this.isMoving=!1,this.isDamaging=!1,this.isClosing=!1,this.laserGun.opacity=0,this.laser.scaleY=0,this.laserCollider.node.scaleY=0,this.laserCollider.bindData(this.roleData),this.node.position=cc.v2(u.Util.getRandomFloatNum(-400,440),u.Util.getRandomFloatNum(-100,160)),this.activateAction(),this.refreshLaserLength()},C.prototype.activateAction=function(){var e=this,t=A.ConfigData.PLYAER_POS.sub(this.node.position).normalize(),a=A.ConfigData.PLYAER_POS.add(t.mul(500));t=Math.random(),this.aimingPos=t<.5?a.add(cc.v2(0,1).mul(u.Util.getRandomNum(200,300))):a.add(cc.v2(0,-1).mul(u.Util.getRandomNum(200,300))),this.node.stopAllActions(),this.laser.stopAllActions(),this.laserCollider.node.stopAllActions(),this.laserGun.stopAllActions(),this.laserGun.runAction(cc.sequence(cc.fadeIn(.5),cc.callFunc(function(){e.laserCollider.node.runAction(cc.scaleTo(.5,1,1)),e.laser.runAction(cc.sequence(cc.scaleTo(.5,1,1),cc.callFunc(function(){v.GameState.isGaming?(e.isMoving=!0,h.LocalSoundManager.playLaserAudio(),s.GameManager.shakeEffect(6),e.laserCollider.isActivate=!0,e.setMoveAction(),e.setRotateAction()):e.closing()})))})))},C.prototype.setMoveAction=function(){var e=cc.v2(u.Util.getRandomFloatNum(-400,440),u.Util.getRandomFloatNum(-100,160)),t=u.Util.getDistance(this.node.position,e);this.moveTime=t/this.moveSpeed,this.moveDirection=e.sub(this.node.position).normalize()},C.prototype.setRotateAction=function(){var e=this,t=v.GameState.heroModel?1.5:3;this.rotateTween=new cc.Tween,this.rotateTween.target(this),this.rotateTween.to(t,{aimingPos:A.ConfigData.PLYAER_POS},null),this.rotateTween.call(function(){e.aimingPos=A.ConfigData.PLYAER_POS}),this.rotateTween.call(function(){e.damageAction()}),this.rotateTween.start()},C.prototype.moving=function(e){null==this.roleData||this.roleData.isDead||null==this.moveTime||null==this.moveDirection||0==this.moveDirection.x&&0==this.moveDirection.y||this.isMoving&&(this.node.position=this.node.position.add(this.moveDirection.mul(this.moveSpeed*e)),this.moveTime-=e,this.moveTime<=0&&this.setMoveAction())},C.prototype.onCollisionEnter=function(e,t){var a,n;e&&t&&null!=this.roleData&&!this.isClosing&&e.node.group==d.GroupNameEnum.ARROW&&(null==(a=e.getComponent(m.Arrow))||null!=(n=a.roleData)&&n.isEnemy!=this.roleData.isEnemy&&a.arrowState==d.ArrowStateEnum.LAUNCHING&&(this.node.stopAllActions(),null!=(t=t.world)&&(null==(t=t.points)||t.length<=0||(D.EffectCreate.createSpark(t[0],-1,!0),h.LocalSoundManager.playShieldResistAudio(),e.node.destroy(),this.closing()))))},C.prototype.damageAction=function(){var e=this;this.isDamaging=!0;for(var t=this,a=0;a<9;a++)!function(a){t.node.runAction(cc.sequence(cc.delayTime(.3*a),cc.callFunc(function(){var t=E.PlayerState.playerData;if(null!=t)if(9<=a||t.isDead)e.closing();else if(!e.isClosing){var n=Math.floor(1.5*e.roleData.atk/9);return 0<t.shieldDefense?(E.PlayerState.player.equipmentIsDamaged(g.EquipmentType.shield,e.roleData,n,t.logicPos),t.shieldDefense<=0&&(t.shieldDroped=!0),8<=a||t.isDead?void e.closing():void 0):0<t.helmetDefense?(E.PlayerState.player.equipmentIsDamaged(g.EquipmentType.helmet,e.roleData,n,t.logicPos),t.helmetDefense<=0&&(t.helmetDroped=!0),8<=a||t.isDead?void e.closing():void 0):(t.invincibleTime<=0&&f.SingleEffectManager.showBloodEffect(t.logicPos,e.node.scaleX,t),y.RoleManager.roleIsDamaged(t,e.roleData,n,t.logicPos),void((8<=a||t.isDead)&&e.closing()))}})))}(a)},C.prototype.refreshLaserLength=function(){var e=this.node.position.sub(this.aimingPos).normalize(),t=180*-cc.v2(e).signAngle(cc.Vec2.RIGHT)/Math.PI;this.node.angle=t,t=this.isDamaging?A.ConfigData.PLYAER_POS.y+5:-180,e=(e=(this.node.y-t)/e.y*e.mag())<=0?1386:e,this.laser.width=e,this.laserCollider.node.width=e,this.laserHead.x=-e},C.prototype.closing=function(){var e=this;this.turnOffLaserAction&&this.turnOffLaserAction(),this.isMoving=!1,this.laserCollider.isActivate=!1,this.getLaserCountAction()<=0&&h.LocalSoundManager.stopLaserAudio(),this.isDamaging=!1,this.isClosing=!0,this.node.stopAllActions(),this.laser.stopAllActions(),this.laserCollider.node.stopAllActions(),this.laserGun.stopAllActions(),this.laserCollider.node.runAction(cc.scaleTo(.5,1,0)),this.laser.runAction(cc.sequence(cc.scaleTo(.5,1,0),cc.callFunc(function(){e.laserGun.runAction(cc.sequence(cc.fadeOut(.5),cc.callFunc(function(){e.closeAction&&e.closeAction(),e.close()})))})))},C.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6fc0\u5149\u70ae",type:cc.Node})],C.prototype,"laserGun",void 0),__decorate([o({displayName:"\u6fc0\u5149",type:cc.Node})],C.prototype,"laser",void 0),__decorate([o({displayName:"\u6fc0\u5149\u78b0\u649e\u76d2\u8282\u70b9",type:S.LaserCollider})],C.prototype,"laserCollider",void 0),__decorate([o({displayName:"\u6fc0\u5149\u5934",type:cc.Node})],C.prototype,"laserHead",void 0),n=__decorate([n],C),i.Laser=n,cc._RF.pop()},{}],LaunchOption:[function(e,t,a){"use strict";cc._RF.push(t,"2bd9f1+oAVPCYWNaw+jDcu5","LaunchOption");var n=a;function o(){this.code=null,this.scene=null,this.wxAdInfo=null}Object.defineProperty(n,"__esModule",{value:!0}),o.data=new o,n.LaunchPacket=o,cc._RF.pop()},{}],LightningAnimation:[function(e,t,a){"use strict";cc._RF.push(t,"6c30fMuEjRIvIWVxny/CFUt","LightningAnimation");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.videoTip=null,e.detail=null,e}i=cc.Component,__extends(r,i),r.prototype.onEnable=function(){var e=this;this.videoTip.scale=1,this.videoTip.stopAllActions(),this.videoTip.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.4,1.2),cc.scaleTo(.4,1)))),this.detail.opacity=0,this.detail.y=-80,this.detail.stopAllActions(),this.detail.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.fadeIn(.3),cc.moveTo(.3,0,-66)),cc.delayTime(1.5),cc.spawn(cc.fadeOut(.3),cc.moveTo(.3,0,-80)),cc.callFunc(function(){e.detail.opacity=0}),cc.delayTime(.6))))},__decorate([l({type:cc.Node,displayName:"\u89c6\u9891\u6807"})],r.prototype,"videoTip",void 0),__decorate([l({type:cc.Node,displayName:"\u63cf\u8ff0"})],r.prototype,"detail",void 0),n=__decorate([n],r),o.LightningAnimation=n,cc._RF.pop()},{}],LightningEffect:[function(e,t,a){"use strict";cc._RF.push(t,"c6954d5ZVxNbaWhT3gxmgef","LightningEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.lightningAni=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.addListener(s.LocalWorldEventType.NextPart,this.close,this),this.lightningAni.play("Lightning"),this.lightningAni.on("finished",this.close,this)},p.prototype.onDisable=function(){this.lightningAni.off("finished",this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.NextPart,this.close,this)},p.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u95ea\u7535\u52a8\u753b",type:cc.Animation})],p.prototype,"lightningAni",void 0),n=__decorate([n],p),i.LightningEffect=n,cc._RF.pop()},{}],Loading:[function(e,t,a){"use strict";cc._RF.push(t,"f7216kgOABAc5tb4fIcYRtq","Loading");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("PrefabUrl");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.loadingProgress=null,e.loadSubSuccess=!1,e.finish=!1,e.resIndex=0,e.loadResSuccess=!1,e.loadMainSuccess=!1,e.processCount=0,e.maxProcessCount=0,e.baseResLoading=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),(r=c).prototype.start=function(){this.fixCocos(),this.maxProcessCount=s.PrefabUrl.mainUrlList.length+2,this.loadingProgress.fillRange=0,this.loadSub(),r.sendEvent("enter_game_loading")},c.prototype.update=function(){this.finish||(this.loadingProgress.fillRange=this.processCount/this.maxProcessCount,this.loadMainSuccess?this.loadingMain():this.loadSubSuccess&&this.loadRes())},c.prototype.fixCocos=function(){try{cc.RotateTo.prototype.startWithTarget=function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e);var t=e.angle%360;180<(e=cc.macro.ROTATE_ACTION_CCW?this._dstAngle-t:t-this._dstAngle)&&(e-=360),e<-180&&(e+=360),this._startAngle=t,this._angle=cc.macro.ROTATE_ACTION_CCW?e:-e},cc.RotateBy.prototype.startWithTarget=function(e){cc.ActionInterval.prototype.startWithTarget.call(this,e),this._startAngle=e.angle}}catch(n){console.error(n)}},c.prototype.loadSub=function(){var e=this;if(cc.sys.platform!==cc.sys.WECHAT_GAME||"function"!=typeof wx.loadSubpackage)return this.processCount++,void(this.loadSubSuccess=!0);r.sendEvent("load_subPackage_start"),wx.loadSubpackage({name:"Subpackage",success:function(t){r.sendEvent("load_subPackage_succ"),t&&console.log("wx.loadSubpackage success",t),e.processCount++,e.loadSubSuccess=!0,r.sendEvent("download_res_start")},fail:function(t){t&&console.error("wx.loadSubpackage fail",t),r.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.loadSub()},null)}})},c.prototype.loadRes=function(){if(!this.finish&&!this.baseResLoading){var e=s.PrefabUrl.mainUrlList[this.resIndex];if(e)return this.loadBaseRes(e),void this.resIndex++;this.loadResSuccess||(this.preLoadMainScene(),this.loadResSuccess=!0,r.sendEvent("download_res_succ"))}},c.prototype.loadingMain=function(){this.finish=!0,this.loadingProgress.fillRange=1,r.sendEvent("enter_scene_start"),cc.director.loadScene("main")},c.prototype.loadBaseRes=function(e){var t=this;this.baseResLoading=!0,cc.loader.loadRes(e,function(a,n){null==a&&null!=n?(t.baseResLoading=!1,t.processCount++):r.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){t.loadBaseRes(e)},null)})},c.prototype.preLoadMainScene=function(){var e=this;r.sendEvent("preload_scene_start"),cc.director.preloadScene("main",null,function(t){null==t?(r.sendEvent("preload_scene_succ"),e.processCount++,e.loadMainSuccess=!0):r.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.preLoadMainScene()},null)})},c.loadGame=function(e,t,a){var n=this;e&&(t=-1);var o,i=!!this.loadChapterResMap.has(t)&&this.loadChapterResMap.get(t);if(this.loadGameResSucc&&i)a&&a();else if(this.loadGameResSucc||(o=0,c=function e(){o++;var t=s.PrefabUrl.gameUrlList[o];if(null==t)return n.loadGameResSucc=!0,void(n.loadGameResSucc&&i&&a&&a());n.loadGameRes(t,e)},r=s.PrefabUrl.gameUrlList[o],this.loadGameRes(r,c)),!i){var l,r,c,p=null;switch(t){case-1:p=s.PrefabUrl.endlessChapterUrlList;break;case 1:p=s.PrefabUrl.firstChapterUrlList;break;case 2:p=s.PrefabUrl.secondChapterUrlList;break;case 3:p=s.PrefabUrl.thirdChapterUrlList;break;case 4:p=s.PrefabUrl.fourChapterUrlList;break;case 5:p=s.PrefabUrl.fiveChapterUrlList;break;case 6:p=s.PrefabUrl.sixChapterUrlList;break;case 7:p=s.PrefabUrl.sevenChapterUrlList}null!=p?(r=function e(){var o=p[++l];if(null==o)return i=!0,n.loadChapterResMap.set(t,!0),void(n.loadGameResSucc&&i&&a&&a());n.loadGameRes(o,e)},c=p[l=0],this.loadGameRes(c,r)):console.error("\u6ca1\u6709\u914d\u7f6e\u8be5\u7ae0\u8282\u9884\u52a0\u8f7d\u7684\u9884\u8bbe")}},c.loadGameRes=function(e,t){var a=this;cc.loader.loadRes(e,function(n,o){null==n&&null!=o?t&&t():r.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.loadGameRes(e,t)},null)})},c.showWxModal=function(e,t,a,n){if(cc.sys.platform===cc.sys.WECHAT_GAME&&"function"==typeof wx.showModal)try{wx.showModal({title:e,content:t,showCancel:null!=n,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:function(e){e.confirm&&a&&a(),e.cancel&&n&&n()}})}catch(e){console.error(e)}},c.prototype.clickRestart=function(){cc.sys.platform==cc.sys.WECHAT_GAME&&(wxDownloader.cleanOldAssets(),r.showWxModal("\u63d0\u793a","\u7f13\u5b58\u6e05\u7406\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u8fdb\u5165\u5c0f\u6e38\u620f\uff01",function(){wx.exitMiniProgram()},null))},c.sendEvent=function(e){null!=e&&cc.sys.platform===cc.sys.WECHAT_GAME&&wx.$$Rangers.event(e)},c.loadGameResSucc=!1,c.loadChapterResMap=new Map,__decorate([o({type:cc.Sprite,displayName:"\u52a0\u8f7d\u8fdb\u5ea6\u6761"})],c.prototype,"loadingProgress",void 0),n=r=__decorate([n],c),i.Loading=n,cc._RF.pop()},{}],LocalData:[function(e,t,a){"use strict";cc._RF.push(t,"b4de3qcPOJDXqlJUqKxG48E","LocalData");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("UserData"),l=n("GameCommonUtil"),r=n("GameConfigData"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameGuardSystem");function d(){this.passChapter=0,this.currentChapter=1,this.selectChapter=1,this.chapterRecord=null,this.chapterMaxPart=[[0,0,0,0,0],[0,0,0,0,0]],this.endlessMaxPart=0,this.gemCount=0,this.energyNum=20,this.normalBoxTimes=3,this.lastOpenLegendBoxTime=null,this.getGemTimes=5,this.weaponIndex=0,this.shieldIndex=null,this.helmetIndex=null,this.lastLoginTime=null,this.lastGetEnergyTime=null,this.lastBattleData=null,this.lastBattleDataJson=null,this.lastEndlessDataJson=null,this.selectSkillTip=0,this.resetSkillVideo=!1,this.newEquipmentDatas=[new h(u.weapon,0,1,!1,!0),new h(u.shield,0,1,!1,!0)],this.talentLevel=[0,0,0,0,0,0],this.talentExtractTimes=0,this.showAdTimes=0,this.weaponBoxTime=1,this.openWeaponBoxTimes=0,this.getCloakNum=null,this.vibrateOpened=!0,this.lastVersion=null,this.eggMachineTimes=0,this.eggMachineGetCloak=!1,this.eggMachineDailyTimes=5,this.userInfo=null,this.getRankRewardYear=null,this.getRankRewardMonth=null,this.clearEndlessProgressYear=null,this.clearEndlessProgressMonth=null,this.chapterProgressRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150]],this.heroChapterProgressRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150]]}Object.defineProperty(d,"data",{get:function(){if(null==this._data||this._data!=i.UserData.data.otherData){var e,t,a=i.UserData.data.otherData;if(a&&a.equipmentDatas){for(var n=function(e,t){return(e.equipmentType==u.weapon&&e.equipmentIndex==a.weaponIndex||e.equipmentType==u.helmet&&e.equipmentIndex==a.helmetIndex||e.equipmentType==u.shield&&e.equipmentIndex==a.shieldIndex)&&(t.equipped=!0)},o=[],s=0,c=a.equipmentDatas;s<c.length;s++){var p=c[s],m=Math.pow(3,p.equipmentLevel-1)+p.equipmentCount,f=!1;if(81<=m){var g=new h(p.equipmentType,p.equipmentIndex,5,!1);f=n(p,g),o.push(g)}else{var y=Math.floor(m/27),v=Math.floor(m%27/9),D=Math.floor(m%9/3),E=m%3;if(1<=y)for(var S=0;S<y;S++){var A=new h(p.equipmentType,p.equipmentIndex,4,!1);f=f||n(p,A),o.push(A)}if(1<=v)for(S=0;S<v;S++){var C=new h(p.equipmentType,p.equipmentIndex,3,!1);f=f||n(p,C),o.push(C)}if(1<=D)for(S=0;S<D;S++){var M=new h(p.equipmentType,p.equipmentIndex,2,!1);f=f||n(p,M),o.push(M)}if(1<=E)for(S=0;S<E;S++){var T=new h(p.equipmentType,p.equipmentIndex,1,!1);f=f||n(p,T),o.push(T)}}}a.newEquipmentDatas=o,a.equipmentDatas=null}if(this._data=a,null==this._data&&(this._data=new d,i.UserData.data.otherData=this._data),null!=this._data.lastLoginTime&&l.GameCommonUtil.isToday(this._data.lastLoginTime)||(this._data.lastLoginTime=Date.now(),this._data.normalBoxTimes=r.GameConfigData.data.maxOpenNormalBoxTimes,this._data.getGemTimes=r.GameConfigData.data.maxGetGemTimes,this._data.showAdTimes=0,this._data.weaponBoxTime=r.GameConfigData.data.maxWeaponBoxTime,this._data.eggMachineDailyTimes=r.GameConfigData.data.eggMachineDailyMaxTime),null==this._data.lastGetEnergyTime&&(this._data.lastGetEnergyTime=null),null==this._data.energyNum&&(this._data.energyNum=20),null==this._data.selectChapter&&(this._data.selectChapter=this.data.currentChapter,this.data.currentChapter++),null==this._data.passChapter&&(this._data.passChapter=this.data.currentChapter-1),null==this._data.selectSkillTip&&(this._data.selectSkillTip=2),null==this._data.resetSkillVideo&&(this._data.resetSkillVideo=!0),this._data.passChapter>=this._data.currentChapter&&this._data.currentChapter<r.GameConfigData.data.MAX_CHAPTER_COUNT&&(this._data.passChapter=this._data.currentChapter,this._data.currentChapter++,this._data.selectChapter=this._data.currentChapter),null==this._data.talentLevel&&(this._data.talentLevel=[0,0,0,0,0,0]),null==this._data.talentExtractTimes&&(this._data.talentExtractTimes=0),null==this._data.showAdTimes&&(this._data.showAdTimes=0),null==this._data.weaponBoxTime&&(this._data.weaponBoxTime=r.GameConfigData.data.maxWeaponBoxTime),null==this._data.openWeaponBoxTimes&&(this._data.openWeaponBoxTimes=0),null==this._data.getCloakNum&&(this._data.getCloakNum=null),this._data.normalBoxTimes=Math.min(this._data.normalBoxTimes,r.GameConfigData.data.maxOpenNormalBoxTimes),null==this._data.vibrateOpened&&(this._data.vibrateOpened=!0),null==this._data.chapterRecord&&(e=this._data.currentChapter,P=this._data.currentChapter==this._data.passChapter?20:0,e=this.getChapterRecord(e,P,!1),this._data.chapterRecord=e),null==this._data.chapterMaxPart){var _=!1;0<this._data.chapterRecord&&Math.ceil(this._data.chapterRecord/20)%2==0&&(_=!0);var k=0<this._data.chapterRecord?Math.ceil(this._data.chapterRecord/40):1,P=0;for(0<this._data.chapterRecord&&(P=_?this._data.chapterRecord-(20+40*(k-1)):this._data.chapterRecord-40*(k-1)),this._data.chapterMaxPart=[[0,0,0,0,0],[0,0,0,0,0]],S=0;S<r.GameConfigData.data.MAX_CHAPTER_COUNT;S++){var R,I,w=S+1;k<w||(R=this._data.chapterMaxPart[0],I=this._data.chapterMaxPart[1],w==k?(R[S]=_?20:P,I[S]=_?P:0):(R[S]=20,I[S]=20))}}if(null==this._data.lastBattleDataJson&&null!=this._data.lastBattleData&&(this._data.lastBattleDataJson=JSON.stringify(this._data.lastBattleData),this._data.lastBattleData=null),null==this._data.eggMachineTimes&&(this._data.eggMachineTimes=0),null==this._data.eggMachineGetCloak&&(this._data.eggMachineGetCloak=!1),null==this._data.eggMachineDailyTimes&&(this._data.eggMachineDailyTimes=r.GameConfigData.data.eggMachineDailyMaxTime),null==this._data.lastEndlessDataJson&&(this._data.lastEndlessDataJson=null),null==this._data.endlessMaxPart&&(this._data.endlessMaxPart=0),null==this._data.chapterProgressRewards&&(this._data.chapterProgressRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150]]),null==this._data.heroChapterProgressRewards&&(this._data.heroChapterProgressRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150]]),this._data.chapterProgressRewards.length<this.chapterRewards.length){var b=this.chapterRewards.length-this._data.chapterProgressRewards.length;for(S=t=this._data.chapterProgressRewards.length;S<t+b;S++){var N=this.chapterRewards[t];this._data.chapterProgressRewards.push(N)}}if(this._data.heroChapterProgressRewards.length<this.heroChapterRewards.length)for(b=this.heroChapterRewards.length-this._data.heroChapterProgressRewards.length,S=t=this._data.heroChapterProgressRewards.length-1;S<t+b;S++)N=this.heroChapterRewards[t],this._data.heroChapterProgressRewards.push(N)}return this._data},enumerable:!0,configurable:!0}),d.changeCoin=function(e){null!=e&&(i.UserData.data.coin+=e,p.GameGuardSystem.lastCoin=i.UserData.data.coin)},d.changeGem=function(e){null!=e&&(this.data.gemCount+=e,p.GameGuardSystem.lastGem=this.data.gemCount)},d.passChapter=function(e){e<=this.data.passChapter||(this.data.passChapter++,this.data.currentChapter++,this.data.currentChapter=Math.min(r.GameConfigData.data.MAX_CHAPTER_COUNT,this.data.currentChapter),this.data.selectChapter=this.data.currentChapter)},d.getTalentLevel=function(e){var t=d.data.talentLevel[e];return null==t||0==t?0:t>=r.GameConfigData.data.talentMaxLevel[e]?(d.data.talentLevel[e]=r.GameConfigData.data.talentMaxLevel[e],d.data.talentLevel[e]):t},d.orderEquipmentData=function(){this.data.newEquipmentDatas.sort(function(e,t){return e.rank==t.rank?e.level==t.level?t.index-e.index:t.level-e.level:t.rank-e.rank})},d.getEquipmentData=function(e,t,a){if(null!=e&&null!=t&&null!=a){for(var n=[],o=0,i=this.data.newEquipmentDatas;o<i.length;o++){var l=i[o];e==l.type&&t==l.index&&a==l.rank&&n.push(l)}return n}},d.removeEquipmentData=function(e){null==e||-1!=(e=this.data.newEquipmentDatas.indexOf(e))&&this.data.newEquipmentDatas.splice(e,1)},d.getEquipmentTotalCount=function(e){if(null==e)return null;for(var t=0,a=0,n=this.data.newEquipmentDatas;a<n.length;a++)n[a].type==e&&t++;return t},d.getEquipmentTypeData=function(e){if(null==e)return null;for(var t=[],a=0,n=this.data.newEquipmentDatas;a<n.length;a++){var o=n[a];o.type==e&&t.push(o)}return t},d.getEquippedEquipment=function(e){if(null==e)return null;for(var t=0,a=this.data.newEquipmentDatas;t<a.length;t++){var n=a[t];if(n.type==e&&n.equipped)return n}return null},d.rewardEquipment=function(e,t,a,n){if(void 0===n&&(n=1),null!=e&&null!=t&&null!=a)return(a=new h(e,t,a,!0)).level=n,this.data.newEquipmentDatas.push(a),s.WorldEventManager.triggerEvent(c.LocalWorldEventType.GetNewEquipment,null),a},d.getChapterRecord=function(e,t,a){return a?40*(e-1)+20+t:40*(e-1)+t},d.setChapterMaxPart=function(e,t,a){(null==this.data.chapterMaxPart||this.data.chapterMaxPart.length<2)&&(this.data.chapterMaxPart=[[0,0,0,0,0],[0,0,0,0,0]]);var n=e?this.data.chapterMaxPart[1]:this.data.chapterMaxPart[0];e=n[t-1],n[t-1]=e=(e=null==e?0:e)<a?a:e},d.getChapterMaxPart=function(e,t){var a=e?this.data.chapterMaxPart[1]:this.data.chapterMaxPart[0];return e=a[t-1],a[t-1]=null==e?0:e},d.getChapterProgressRewardCondition=function(e,t){if(null!=e&&null!=t&&(e=e?this.data.heroChapterProgressRewards:this.data.chapterProgressRewards,!((t-=1)<0||t>=e.length))){for(var a=e[t],n=0,o=0;o<a.length;o++)if(!(a[o]<=0)){n=5*(o+1);break}return n}},d.getChapterPregressReward=function(e,t){if(null!=e&&null!=t&&(e=e?this.data.heroChapterProgressRewards:this.data.chapterProgressRewards,!((t-=1)<0||t>=e.length))){for(var a=e[t],n=0,o=0;o<a.length;o++){var i=a[o];if(!(i<=0)){n=i;break}}return n}},d.receiveChapterProgressRewar=function(e,t,a){null!=e&&null!=t&&null!=a&&(e=e?this.data.heroChapterProgressRewards:this.data.chapterProgressRewards,(t-=1)<0||t>=e.length||(t=e[t],(a=a/5-1)<0||a>=t.length||(t[a]=0)))},d.TEMP_BATTLE_DATA=null,d.temp_hero_model=null,d.temp_pass_chapter=null,d.temp_last_pass_chapter=null,d.chapterRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150],[50,100,150,200]],d.heroChapterRewards=[[30,30,30,50],[30,30,50,50],[30,50,50,50],[50,50,50,100],[50,50,100,100],[50,50,100,150],[50,100,150,200]],d._data=null,n=d,o.LocalData=n,n=function(e,t,a,n,o){this.equipmentType=u.weapon,this.equipmentIndex=0,this.equipmentLevel=1,this.equipmentCount=3,this.isNew=!0,this.equipmentType=e,this.equipmentIndex=t,this.equipmentLevel=a,this.equipmentCount=n,this.isNew=o},o.EquipmentData=n;var u,h=function(e,t,a,n,o){void 0===o&&(o=!1),this.type=u.weapon,this.index=0,this.rank=1,this.level=1,this.isNew=!0,this.equipped=!1,this.type=e,this.index=t,this.rank=a,this.isNew=n,this.equipped=o};o.NewEquipmentData=h,(n=u=o.EquipmentType||(o.EquipmentType={}))[n.weapon=0]="weapon",n[n.helmet=1]="helmet",n[n.shield=2]="shield",n[n.cloak=3]="cloak",o.LastBattleData=function(e,t,a,n,o,i,l,r,s,c,p,d,u,h,m,f,g,y,v,D,E,S,A){this.lastChapter=null,this.lastPart=null,this.lastRoleData=null,this.lastEquipSkills=null,this.lastChooseSkills=null,this.lastReviveCount=null,this.lastProfiteerPartArray=[],this.equipmentDropPart=null,this.equipmentDropEnemy=null,this.dropedEquipmentData=null,this.bossDropedEquipmentData=null,this.dropedEquipmentDatas=null,this.heroModel=null,this.lastPartBubbleCount=null,this.lastChapterBubbleCount=null,this.newIncidentTimes=null,this.lastIsBegining=!1,this.lastSkillPool=null,this.isReorganize=!1,this.inheritSkillCount=null,this.inheritAtkCount=null,this.inheritMaxHpCount=null,this.inheritMaxHelmetDefenseCount=null,this.inheritMaxShieldDefenseCount=null,this.inheritSkillLevels=[],this.chapterOrder=[],this.lastChapter=e,this.lastPart=t,this.lastRoleData=a,this.lastEquipSkills=n,this.lastChooseSkills=o,this.lastReviveCount=i,this.lastProfiteerPartArray=l,this.equipmentDropPart=r,this.equipmentDropEnemy=s,this.dropedEquipmentData=c,this.bossDropedEquipmentData=p,this.dropedEquipmentDatas=d,this.heroModel=u,this.lastIsBegining=h,this.lastSkillPool=m,this.isReorganize=f,this.inheritSkillCount=g,this.inheritAtkCount=y,this.inheritMaxHpCount=v,this.inheritMaxHelmetDefenseCount=D,this.inheritMaxShieldDefenseCount=E,this.inheritSkillLevels=S,this.chapterOrder=A},cc._RF.pop()},{}],LocalDialUI:[function(e,t,a){"use strict";cc._RF.push(t,"4cb61kFF3BGVa3xrwR339vL","LocalDialUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("DialItem"),s=n("DialManager"),c=n("GameCommonPool"),p=n("SpriteFrameManager"),d=n("Util");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.dialRewardSprite=[],e.dialNode=null,e.freeBtn=null,e.dialItems=new Array,e.dialTittle=null,e.dialBoard=null,e.rewardAction=null,e.animationRun=!1,e.currentIndex=0,e.randomAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onLoad=function(){},u.prototype.onEnable=function(){var e=this;this.dialTittle.stopAllActions(),this.dialBoard.stopAllActions(),this.freeBtn.stopAllActions(),this.dialTittle.opacity=0,this.freeBtn.opacity=0,this.dialBoard.opacity=0,this.dialBoard.scale=0,this.dialBoard.runAction(cc.sequence(cc.spawn(cc.scaleTo(.4,1),cc.fadeIn(.4)),cc.callFunc(function(){e.dialTittle.runAction(cc.fadeIn(.3))}),cc.delayTime(.3),cc.callFunc(function(){e.freeBtn.runAction(cc.fadeIn(.3))})))},u.prototype.bindData=function(e,t){void 0===t&&(t=null),this.rewardAction=e,this.randomAction=t;var a=this.getDialItem();if(null!=a)for(var n=0;n<this.dialItems.length;n++)this.dialItems[n].bindData(a[n])},u.prototype.clcikFree=function(){this.animationRun||this.gainReward()},u.prototype.gainReward=function(){var e,t,a,n=this;this.animationRun||(this.animationRun=!0,e=this.dialItems.length,a=0,null!=this.randomAction?(a=(t=null==(t=this.randomAction())||t<0||e<=t?Math.floor(Math.random()*e):t)>=this.currentIndex?t-this.currentIndex:t+e-this.currentIndex,this.currentIndex=t):(a=Math.floor(Math.random()*e),this.currentIndex=(a+this.currentIndex)%e),this.dialNode.runAction(cc.sequence(cc.rotateBy(1.5,1440),cc.rotateBy(2,360-360*a/e).easing(cc.easeBackOut()),cc.delayTime(.5),cc.callFunc(function(){var e;n.animationRun=!1,null!=n.rewardAction&&null!=(e=n.dialItems[n.currentIndex])&&null!=e.data&&(n.rewardAction(e.data.itemType,e.data.itemCount),c.GameCommonPool.returnInstant(n.node))}))))},u.prototype.getDialItem=function(){var e=new Array,t=new s.DialItemData(1,"\u5c0f\u888b\u91d1\u5e01",this.getDialSpriteFrame(0),100,1),a=new s.DialItemData(1,"\u4e2d\u888b\u91d1\u5e01",this.getDialSpriteFrame(0),300,1),n=new s.DialItemData(1,"\u5927\u888b\u91d1\u5e01",this.getDialSpriteFrame(1),500,1),o=new s.DialItemData(2,"\u5c0f\u888b\u94bb\u77f3",this.getDialSpriteFrame(2),10,1),i=new s.DialItemData(2,"\u4e2d\u888b\u94bb\u77f3",this.getDialSpriteFrame(2),30,1),l=new s.DialItemData(2,"\u5927\u888b\u94bb\u77f3",this.getDialSpriteFrame(3),50,1),r=new Array,c=new s.DialItemData(3,"\u5c04\u901f\u63d0\u5347",p.SpriteFrameManager.getSkillSpriteFrame(6),1,.4),u=new s.DialItemData(4,"\u653b\u51fb\u63d0\u5347",p.SpriteFrameManager.getSkillSpriteFrame(15),1,.4),h=new s.DialItemData(5,"\u8840\u91cf\u6062\u590d",p.SpriteFrameManager.getSkillSpriteFrame(12),1,.4),m=new s.DialItemData(6,"\u751f\u547d\u4e0a\u9650\u63d0\u5347",p.SpriteFrameManager.getSkillSpriteFrame(13),1,.4),f=new s.DialItemData(7,"\u76fe\u724c\u4fee\u590d",p.SpriteFrameManager.getSkillSpriteFrame(11),1,.4),g=new s.DialItemData(8,"\u5934\u76d4\u4fee\u590d",p.SpriteFrameManager.getSkillSpriteFrame(14),1,.4);return r.push(c),r.push(u),r.push(h),r.push(m),r.push(f),r.push(g),m=d.Util.getRandomValueFromArray(h=[0,1,2,3,4,5]),h.splice(h.indexOf(m),1),f=d.Util.getRandomValueFromArray(h),h.splice(h.indexOf(f),1),g=d.Util.getRandomValueFromArray(h),h.splice(h.indexOf(g),1),(h=Math.random())<.7?(e.push(t),e.push(a),e.push(n),e.push(r[g])):h<.8?(e.push(o),e.push(i),e.push(l),e.push(r[g])):(e.push(t),e.push(a),e.push(n),e.push(o),e.push(i),e.push(l),e.splice(d.Util.getRandomNum(0,2),1),e.splice(d.Util.getRandomNum(e.length-3,e.length-1),1)),e.push(r[m]),e.push(r[f]),e},u.prototype.getDialSpriteFrame=function(e){var t=this.dialRewardSprite.length;if(!(e<0||t<=e))return this.dialRewardSprite[e]},__decorate([o({displayName:"\u8f6c\u76d8\u5956\u52b1\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],u.prototype,"dialRewardSprite",void 0),__decorate([o(cc.Node)],u.prototype,"dialNode",void 0),__decorate([o(cc.Node)],u.prototype,"freeBtn",void 0),__decorate([o([r.DialItem])],u.prototype,"dialItems",void 0),__decorate([o(cc.Node)],u.prototype,"dialTittle",void 0),__decorate([o(cc.Node)],u.prototype,"dialBoard",void 0),n=__decorate([n],u),i.LocalDialUI=n,cc._RF.pop()},{}],LocalGameCommon:[function(e,t,a){"use strict";cc._RF.push(t,"13b88Ewn2xFsbM4kmoUuZAL","LocalGameCommon");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("GameCommon"),s=o("UserData"),c=o("UIManager");function p(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=r.GameCommon,__extends(p,l),p.prototype.update=function(e){s.UserData.init&&null!=this._sdk&&(this.storageDataInterval+=e,60<=this.storageDataInterval&&(this._sdk.setStorage(s.UserData.storageKey,s.UserData.getJsonStr()),this.storageDataInterval=0))},p.prototype.appGameLaunch=function(){this.userDataInit&&this.shareManagerInit&&(this._sdk&&this._sdk.appGameOnLanch(),c.UIManager.showMainBoard())},o=__decorate([o],p),i.LocalGameCommon=o,cc._RF.pop()},{}],LocalHorizontaBoxItem:[function(e,t,a){"use strict";cc._RF.push(t,"7f1fc73dSNGX4BHA2obkAVH","LocalHorizontaBoxItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("HorizontaBoxItem");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.nameLabel=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.HorizontaBoxItem,__extends(s,l),s.prototype.bindData=function(e,t){l.prototype.bindData.call(this,e,t),null!=e&&(this.nameLabel.string=e.gameName)},__decorate([o({type:cc.Label,displayName:"\u6e38\u620f\u540d\u79f0"})],s.prototype,"nameLabel",void 0),n=__decorate([n],s),i.LocalHorizontaBoxItem=n,cc._RF.pop()},{}],LocalHorizontaGameBox:[function(e,t,a){"use strict";cc._RF.push(t,"ef511a7kvdEUKby36fejj2m","LocalHorizontaGameBox");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("MoreGameManager"),c=n("ShareManager"),p=n("UserData"),d=n("GameCommonPool"),u=n("HorizontaBoxItem"),h=n("GameCommon"),m=n("GameCommonHttp"),f=n("StatisticsManager");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.gameItemPrefab=null,e.layout=null,e.startIndex=0,e.blockExportType=c.BlockExportType.OTHER_UI,e.init=!1,e.itemArrays=new Array,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),(r=g).prototype.onEnable=function(){this.blockExportType==c.BlockExportType.EQUIPMENT_UI?f.StatisticsManager.thirdSendEvent("equip_block_show_succ"):this.blockExportType==c.BlockExportType.SETTLEMENT_UI?f.StatisticsManager.thirdSendEvent("settle_block_show_succ"):this.blockExportType==c.BlockExportType.REVIVE_UI?f.StatisticsManager.thirdSendEvent("revive_block_show_succ"):this.blockExportType==c.BlockExportType.SELL_EQUIP_UI&&f.StatisticsManager.thirdSendEvent("sell_block_show_succ"),c.ShareManager.getHorizontalControl()?p.UserData.addModuleShows(p.ExportTypeEnum.HORIZONTA_GAME_BOX,1):this.node.active=!1},g.prototype.update=function(){this.init||this.initMoreGameInfo()},g.prototype.initMoreGameInfo=function(){var e=r.horizontalArray;if(null!=e&&0!=e.length){if(e.length<8)for(var t=8-e.length,a=0;a<t;a++){var n=e[a],o=new s.MoreGameInfo(n.gameName,n.gameIconUrl,n.gameAppId,n.jumpPath,n.switchControl,n.redPoint,n.QRCode,n.switchQRCode,n.gameDesc);e.push(o)}for(this.init=!0,a=this.startIndex;a<this.startIndex+4;a++){if(null==(n=e[a])||n.boyGame)return;var i=d.GameCommonPool.requestInstant(this.gameItemPrefab);if(null==i)return;if(i.setParent(this.layout),this.itemArrays.push(i),null==(i=i.getComponent(u.HorizontaBoxItem)))return;i.bindData(n,this.blockExportType)}}else r.initHorizontalConfig()},g.initHorizontalConfig=function(){var e;this.horizontalArrayLoading||(e=c.ShareManager.cdnFileUrl+"/game-common/"+h.GameConfig.wxAppName+"/assets/"+h.GameConfig.versionCode+"/horizontalGameConfig.txt?time="+Date.now(),this.horizontalArrayLoading=!0,m.GameCommonHttp.wxHttpGet(e,function(e,t){if(r.horizontalArrayLoading=!1,0==e&&null!=t&&null!=(t=t.moreGames))for(var a=0,n=t;a<n.length;a++){var o=n[a];o._jumpSwith&&r.addHorizontalMoreGame(o._name,o._jumpImageUrl,o._jumpAppId,o._jumpPath,o._jumpSwith,o._redDot,o._QRCode,o._switchQRCode,o.gameDesc,o.rectIconUrl,o.boyGame)}}))},g.addHorizontalMoreGame=function(e,t,a,n,o,i,l,r,c,p,d){(c=new s.MoreGameInfo(e,t,a,n,o,i,l,r,c)).rectIconUrl=p,c.boyGame=d,this.horizontalArray.push(c)},g.horizontalArrayLoading=!1,g.horizontalArray=[],__decorate([o(cc.Prefab)],g.prototype,"gameItemPrefab",void 0),__decorate([o(cc.Node)],g.prototype,"layout",void 0),__decorate([o],g.prototype,"startIndex",void 0),__decorate([o({displayName:"\u79ef\u6728\u6240\u5904UI\u754c\u9762",type:cc.Enum(c.BlockExportType)})],g.prototype,"blockExportType",void 0),n=r=__decorate([n],g),i.LocalHorizontaGameBox=n,cc._RF.pop()},{}],LocalSoundManager:[function(e,t,a){"use strict";cc._RF.push(t,"c49c8sCjK5BM7xgr2TFX3ow","LocalSoundManager");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("SoundManager"),s=o("UserData"),c=o("LocalData");function p(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=r.SoundManager,__extends(p,l),p.playVibrateShort=function(){c.LocalData.data.vibrateOpened&&window.gameCommon.getSDK.vibrateShort()},p.playArrowHitAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastArrowHitTime<300||(this.lastArrowHitTime=Date.now(),this.playAudio("hit")))},p.playShieldResistAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastShieldHitTime<400||(this.lastShieldHitTime=Date.now(),this.playAudio("shieldResist")))},p.playHelmetResistAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastHelmetHitTime<400||(this.lastHelmetHitTime=Date.now(),this.playAudio("helmetResist")))},p.playWeaponCollision=function(){s.UserData.data.gameSound&&(Date.now()-this.lastWeaponCollisionTime<100||(this.lastWeaponCollisionTime=Date.now(),this.playAudio("WeaponCollision")))},p.playThunderAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastThunderTime<1e3||(this.lastThunderTime=Date.now(),this.playAudio("thunder")))},p.playBlastAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastBlastTime<1e3||(this.lastBlastTime=Date.now(),this.playAudio("blast")))},p.playFireAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastFireTime<2e3||(this.lastFireTime=Date.now(),this.playAudio("fire")))},p.playFrozenAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastFrozenTime<1e3||(this.lastFrozenTime=Date.now(),this.playAudio("frozen")))},p.playThrowAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastThrowTime<200||(this.lastThrowTime=Date.now(),this.playAudio("throw")))},p.playCoinAudio=function(){s.UserData.data.gameSound&&(Date.now()-this.lastCoinTime<100||(this.lastCoinTime=Date.now(),this.playAudio("coin")))},p.playLaserAudio=function(){s.UserData.data.gameSound&&(this.isLaserAudioPlaying||(this.isLaserAudioPlaying=!0,this.playAudio("laser")))},p.stopLaserAudio=function(){s.UserData.data.gameSound&&(this.isLaserAudioPlaying=!1,this.stop("laser"))},p.lastWeaponCollisionTime=0,p.lastThunderTime=0,p.lastArrowHitTime=0,p.lastShieldHitTime=0,p.lastHelmetHitTime=0,p.lastBlastTime=0,p.lastFireTime=0,p.lastFrozenTime=0,p.lastThrowTime=0,p.lastCoinTime=0,p.isLaserAudioPlaying=!1,o=__decorate([o],p),i.LocalSoundManager=o,cc._RF.pop()},{}],LocalWorldEventType:[function(e,t,a){"use strict";cc._RF.push(t,"93f77NNJiRJqJkVJoAlSXWw","LocalWorldEventType");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),(n=n.LocalWorldEventType||(n.LocalWorldEventType={})).BackHome="BackHome",n.ChangeEquipment="ChangeEquipment",n.NextPart="NextPart",n.UpgradeEquipment="UpgradeEquipment",n.PlayerRevive="PlayerRevive",n.EnemyRevive="EnemyRevive",n.ShowBubble="ShowBubble",n.SellEquipment="SellEquipment",n.PlayerDead="PlayerDead",n.CheckEquip="checkEquip",n.ShowMainUI="ShowMainUI",n.HideMainUI="HideMainUI",n.GetNewEquipment="GetNewEquipment",n.RefreshActivity="RefreshActivity",n.ShowBroadcast="ShowBroadcast",n.EndlessModel="EndlessModel",n.AddExp="AddExp",cc._RF.pop()},{}],LongEnemy:[function(e,t,a){"use strict";cc._RF.push(t,"0a6adki8YZFjZhEErrSCI4s","LongEnemy");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("EnumAndConst"),s=o("GameManager"),c=o("Head"),p=o("Timer"),d=o("Util"),u=o("WorldEventManager"),h=o("LocalWorldEventType"),m=o("GameCommonPool"),f=o("EnemyArea"),g=o("SpecailSkill"),y=o("GameConfigData"),v=o("ConfigData"),D=o("LongRoleBase"),E=o("RoleManager"),S=o("GameState"),A=o("EndlessModelConfigData"),C=o("EquipmentEffectSystem");function M(){var e=null!==l&&l.apply(this,arguments)||this;return e.attackTargetLastPos=null,e}o=(n=cc._decorator).ccclass,n.property,l=D.LongRoleBase,__extends(M,l),M.prototype.onEnable=function(){u.WorldEventManager.addListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.addListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.addListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.shield=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.launchDelayTime=.05,this.fireCount=1,this.fireTimeScale=null,this.isWaitingRevive=!1},M.prototype.onDisable=function(){u.WorldEventManager.removeListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},M.prototype.update=function(){null!=this.roleData&&(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),S.GameState.isGaming&&(this.isSearch&&null==this.attackTargetData?(this.searchAttackTarget(),this.isSearch=!1):this.isSearch=!0))},M.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},M.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(c.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipHelmet(),this.equipShield(),this.equipWeapon(),this.searchAttackTarget()},M.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setAttack()},M.prototype.setAttack=function(){if(null!=this.roleData&&!this.roleData.isDead&&(this.searchAttackTargetData(),this.currentArrow||this.equipWeapon(),this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),S.GameState.isGaming)){if(null==this.attackTargetData)return this.roleUp.angle=0,this.roleUp.scaleX=this.roleData.orientation,void(this.roleDown.scaleX=this.roleData.orientation);this.setHitRate(),this.attackTargetLastPos=this.attackTargetData.logicPos.clone(),this.roleData.orientation=this.attackTargetData.logicPos.x>this.roleData.logicPos.x?-1:1,this.currentArrow&&this.currentArrow.refreshScale(),this.roleUp.scaleX=this.roleData.orientation,this.roleDown.scaleX=this.roleData.orientation,this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce);var e=this.attackTargetData.logicPos,t=d.Util.getRandomFloatNum(e.x-30,e.x+30),a=d.Util.getRandomFloatNum(e.y+40,e.y-40);e=cc.v2(t,a),t=Math.abs(this.roleData.logicPos.x-e.x),a=e.y-this.roleData.logicPos.y,e=Math.abs(a)/t,e=Math.atan(e)*(Math.PI/180),e=t/(t=this.targetForceMagnitude*(1-e/90)),e=(a-.5*s.GameManager.getGravity()*Math.pow(e,2))/e,t=0<this.roleUp.scaleX?-t:t,this.targetForce=cc.v2(t,e),this.randomAttackAngle()}},M.prototype.randomAttackAngle=function(){var e,t,a,n,o=this;null==this.roleData||this.roleData.isDead||(e=-(d.Util.getVectorsAngle(this.targetForce.normalize(),cc.Vec2.RIGHT)+(0<this.roleData.orientation?150:30)),a=(t=d.Util.getRandomFloatNum(1,2))+1,S.GameState.endlessModel?(t/=n=A.EndlessModelConfigData.getEndlessEnemyAttackFrequency(S.GameState.currentPart),a/=n):S.GameState.heroModel&&(t/=y.GameConfigData.data.heroEnemyAttackFrequency,a/=y.GameConfigData.data.heroEnemyAttackFrequency),this.roleUp.runAction(cc.rotateTo(t,e)),p.TimerManager.addTimer(a,function(){null==o.roleData||o.roleData.isDead||o.roleData.isDestroy||(o.fireCount=1,o.fireTimeScale=1,o.roleData.enemyEquipSkills.isHaveSkill(r.SkillTypeEnum.RUNNINGFIRE)&&(o.fireCount=2,o.fireTimeScale=1.5),o.launchDelayTime=.05/o.fireTimeScale,o.launch())},this.node))},M.prototype.launch=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){this.currentArrow||this.equipWeapon();var t=this.attackTargetData.logicPos;90<d.Util.getDistance(this.attackTargetLastPos,t)&&(t=this.attackTargetLastPos);var a,n=this.currentArrow.node.position,o=!1,i=null,l=null,s=(t=Math.random()<=this.hitRate?(o=!0,a=d.Util.getRandomFloatNum(t.x-20,t.x+20),d.Util.getRandomFloatNum(t.y+35,t.y-25)):(o=!1,Math.random()<.5?(a=t.x,d.Util.getRandomFloatNum(t.y+80,t.y+100)):(a=t.x,d.Util.getRandomFloatNum(t.y-80,t.y-100))),cc.v2(a,t));if(o){var c=null;if(this.roleData.isEnemy&&!S.GameState.endlessModel&&!S.GameState.heroModel){var p=f.EnemyArea.enemyDataArray;if(null==p||p.length<=0)return;for(var u=0,h=p;u<h.length;u++){var m=h[u];m==this.roleData||m.isDestroy||m.logicPos.x<=this.attackTargetData.logicPos.x||m.logicPos.x>=this.roleData.logicPos.x||m.logicPos.y<this.roleData.logicPos.y||null!=c&&c.logicPos.y>=m.logicPos.y||(c=m)}}null!=c&&(i=cc.v2(c.logicPos.x,c.logicPos.y+120),this.targetForceMagnitude=d.Util.getRandomFloatNum(400,600)),T=null==i?(y=Math.abs(n.x-s.x),D=s.y-n.y,A=Math.abs(D)/y,C=Math.atan(A)*(Math.PI/180),M=y/(_=this.targetForceMagnitude*(1-C/90)),(D-.5*(k=v.ConfigData.weaponConfigDatas[this.roleData.weaponIndex].gravity)*Math.pow(M,2))/M):(T=Math.abs(n.x-i.x),o=Math.abs(i.x-s.x),p=i.y-n.y,i=s.y-i.y,T/=_=this.targetForceMagnitude,(p-.5*(k=(i-p*(o/=_)/T)/(.5*T*o+.5*Math.pow(o,2)))*Math.pow(T,2))/T),_=0<this.roleUp.scaleX?-_:_,this.targetForce=cc.v2(_,T),l=k}else{var y=Math.abs(n.x-s.x),D=s.y-n.y,A=Math.abs(D)/y,C=Math.atan(A)*(Math.PI/180),M=y/(_=this.targetForceMagnitude*(1-C/90)),T=(D-.5*(k=v.ConfigData.weaponConfigDatas[this.roleData.weaponIndex].gravity)*Math.pow(M,2))/M,_=0<this.roleUp.scaleX?-_:_;this.targetForce=cc.v2(_,T),l=k}this.roleData.weaponLaunch=!0,T=this.targetForce;var k=this.roleData.enemyEquipSkills.isHaveSkill(r.SkillTypeEnum.DIVISION);l=this.currentArrow.launch(T,this.launchDelayTime,k?1:0,l),E.RoleManager.addWaitingLaunchArrow(this.roleData,l),k&&g.SpecailSkill.division(this.currentArrow,1),this.currentArrow=null,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){1<e.fireCount?(e.fireCount--,e.equipWeapon(n),e.launch()):(e.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),e.equipWeapon(),e.setAttack())},this.fireTimeScale)}},M.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),p.TimerManager.pasueAllTimers(this.node),E.RoleManager.pauseWaitingLaunchArrows(this.roleData),e=this.roleData.frozenTime,p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),t.roleUp.resumeAllActions(),p.TimerManager.resumeAllTimers(t.node),E.RoleManager.resumeWaitingLaunchArrows(t.roleData))},this.node))},M.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTarget(),E.RoleManager.hitRole(this.roleData))},M.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.close())},M.prototype.die=function(){var e,t=this;null==this.roleData||this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,E.RoleManager.resumeWaitingLaunchArrows(this.roleData),this.node.stopAllActions(),this.roleUp.stopAllActions(),p.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?s.GameManager.killEnemy(this.roleData):s.GameManager.friendDie(this.roleData),C.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?r.SpineAniNameEnum.D2:r.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,function(){var e=null!=f.EnemyArea.necromancer&&f.EnemyArea.reviveReady&&null==f.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void f.EnemyArea.necromancer.reviveEnemy(t.roleData);p.TimerManager.addTimer(.1,function(){if(null!=t.roleData)return m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,g.SpecailSkill.turnHeart(t.roleData,S.GameState.isGaming,f.EnemyArea.turnedEnemyCount)?(t.roleData.isDestroy=!0,t.close(),void f.EnemyArea.createTurnedEnemy(t.roleData)):g.SpecailSkill.killBlast(t.roleData)?(t.roleData.isDestroy=!0,void t.close()):void t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))},t.node)}))},o=__decorate([o],M),i.LongEnemy=o,cc._RF.pop()},{}],LongRoleBase:[function(e,t,a){"use strict";cc._RF.push(t,"131d60lVuhC45P2dIcwkSV4","LongRoleBase");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("RoleBase"),s=o("ConfigData"),c=o("PlayerManager"),p=o("GameState");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.maxForce=800,e.minForce=600,e.launchDelayTime=.05,e.fireCount=1,e.fireTimeScale=null,e.hitRate=0,e}o=(n=cc._decorator).ccclass,n.property,l=r.RoleBase,__extends(d,l),d.prototype.equipWeapon=function(e){void 0===e&&(e=null),null==this.roleData||this.roleData.isDead||this.currentArrow||(this.currentArrow=c.PlayerManager.createArrow(this.roleData.logicPos),e&&(this.currentArrow.node.position=e),this.currentArrow&&(this.currentArrow.bindData(this.roleData,null),this.spineController.equipWeapon(this.currentArrow.node),this.roleData.weaponLaunch=!1))},d.prototype.setHitRate=function(){var e,t,a,n,o,i,l;null==this.roleData||this.roleData.isDead||null==this.attackTargetData||(e=this.roleData.logicPos.x,t=p.GameState.currentChapter,a=p.GameState.currentPart,n=p.GameState.endlessModel,o=p.GameState.heroModel,i=this.attackTargetData.logicPos.x,l=this.attackTargetData.isPlayer,this.hitRate=this.roleData.isBoss?s.ConfigData.getBossHitRate(n,t,e,i,l):s.ConfigData.getEnemyHitRate(a,o,e,i,l))},o=__decorate([o],d),i.LongRoleBase=o,cc._RF.pop()},{}],MagicBallBlast:[function(e,t,a){"use strict";cc._RF.push(t,"0c83fGzjyxOG7CXpQ9RJqNF","MagicBallBlast");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("EnumAndConst"),d=n("Util"),u=n("ConfigData"),h=n("EquipmentEffectSystem"),m=n("EnemyArea"),f=n("SingleEffectManager"),g=n("RoleManager"),y=n("GameState"),v=n("EffectCreate"),D=n("PlayerState");function E(){var e=null!==l&&l.apply(this,arguments)||this;return e.blastAnimation=null,e.defaultScale=3,e.roleData=null,e.hurtRoleData=null,e.isFire=!1,e.hasFriendDamage=!0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(E,l),E.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.roleData=null,this.hurtRoleData=null,this.isFire=!1},E.prototype.onDisable=function(){this.blastAnimation.off("finished",this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},E.prototype.showBlast=function(e,t,a,n,o){void 0===o&&(o=!0),this.node.scale=(n=void 0===n?1:n)*this.defaultScale,this.blastAnimation.play(a?"Blast":"IceBlast"),this.blastAnimation.on("finished",this.close,this),this.roleData=e,this.hurtRoleData=t,this.isFire=a,this.hasFriendDamage=o,this.causeDamage()},E.prototype.causeDamage=function(){if(y.GameState.isGaming&&null!=this.roleData)for(var e=(e=(e=(e=[]).concat(m.EnemyArea.enemyDataArray)).concat([D.PlayerState.playerData])).concat(m.EnemyArea.friendDatas),t=0;t<e.length;t++){var a=e[t];if(!(null==a||a.isDead||a.isFeignDeath||a.isTeleporting)&&(a!=this.roleData||!this.roleData.isBoss)&&(this.hasFriendDamage||a.isEnemy!=this.roleData.isEnemy)){var n=!1;if(d.Util.getDistance(this.node.position,a.logicPos)>u.ConfigData.BLAST_RANGE*(this.node.scale/this.defaultScale)){if(null==a.headPosition)continue;if(d.Util.getDistance(this.node.position,a.headPosition)>u.ConfigData.BLAST_RANGE*(this.node.scale/this.defaultScale))continue;if(this.roleData==a&&this.roleData.profession==p.ProfessionEnum.FLY_HEAD_GHOST)continue;n=!0}if(!a.isPlayer||null!=this.hurtRoleData)if(this.isFire){if(a!=this.hurtRoleData){var o=Math.floor(.5*this.roleData.atk);if(g.RoleManager.roleIsDamaged(a,this.roleData,o,a.logicPos),a.invincibleTime<=0&&(o=n?a.headPosition:a.logicPos,n=this.node.x>a.logicPos.x?1:-1,f.SingleEffectManager.showBloodEffect(o,n,a),this.roleData.enemyEquipSkills&&this.roleData.enemyEquipSkills.isHaveSkill(p.SkillTypeEnum.IGNITE))){if(a.isPlayer&&(n=null==h.EquipmentEffectSystem.currentCloakEffectData[1]?0:h.EquipmentEffectSystem.currentCloakEffectData[1],Math.random()<n))return void v.EffectCreate.createRoleTip(a.logicPos,2);if(a.isBoss&&7==y.GameState.currentChapter)return void v.EffectCreate.createRoleTip(a.headPosition,2);f.SingleEffectManager.showIgniteEffect(this.roleData,a)}}}else if(!(a.isFrozening||0<a.frozenImmuneTime||0<a.invincibleTime)){if(a.isPlayer){var i=null==h.EquipmentEffectSystem.currentShieldEffectData[4]?0:h.EquipmentEffectSystem.currentShieldEffectData[4];if(i+=(null==h.EquipmentEffectSystem.currentHelmetEffectData[4]?0:h.EquipmentEffectSystem.currentHelmetEffectData[4])+(null==h.EquipmentEffectSystem.currentCloakEffectData[7]?0:h.EquipmentEffectSystem.currentCloakEffectData[7]),Math.random()<i){v.EffectCreate.createRoleTip(a.logicPos,2);continue}}if(a.isBoss&&7==y.GameState.currentChapter)return void v.EffectCreate.createRoleTip(a.headPosition,2);i=a.isPlayer?1.5:1,f.SingleEffectManager.showFrozenEffect(this.roleData,a,i)}}}},E.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b",type:cc.Animation})],E.prototype,"blastAnimation",void 0),n=__decorate([n],E),i.MagicBallBlast=n,cc._RF.pop()},{}],MagicBall:[function(e,t,a){"use strict";cc._RF.push(t,"f736eAh8NlM/K9wq+5rwFhC","MagicBall");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Util"),s=n("EnumAndConst"),c=n("Body"),p=n("Head"),d=n("Shield"),u=n("MagicBallBlast"),h=n("Arrow"),m=n("WorldEventManager"),f=n("LocalWorldEventType"),g=n("LocalSoundManager"),y=n("NewBezier"),v=n("BattleNodeManager"),D=n("EquipmentEffectSystem"),E=n("EnemyArea"),S=n("GameCommonPool"),A=n("SingleEffectManager"),C=n("RoleManager"),M=n("LocalData"),T=n("GameState"),_=n("PlayerState"),k=n("EffectCreate");function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.partical=null,e.roleData=null,e.ballSize=0,e.isFire=!1,e.targetPos=null,e.moveBezier=null,e.closeAction=null,e.isDestroy=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(P,l),P.prototype.onEnable=function(){m.WorldEventManager.addListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.addListener(f.LocalWorldEventType.NextPart,this.close,this),m.WorldEventManager.addListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.partical.resetSystem(),this.roleData=null,this.isFire=!1,this.targetPos=null,this.moveBezier=null,this.closeAction=null,this.isDestroy=!1},P.prototype.onDisable=function(){m.WorldEventManager.removeListener(f.LocalWorldEventType.BackHome,this.close,this),m.WorldEventManager.removeListener(f.LocalWorldEventType.NextPart,this.close,this),m.WorldEventManager.removeListener(f.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},P.prototype.update=function(e){var t;null!=this.targetPos&&null!=this.roleData&&(this.roleData.isBoss&&this.roleData.isDead?null!=(t=_.PlayerState.playerData)&&this.blast(t,this.ballSize):r.Util.getDistance(this.node.position,this.targetPos)<100*e?this.blast(null,this.ballSize):null!=this.moveBezier&&(e=this.moveBezier.update(e),this.node.position=e))},P.prototype.bindData=function(e,t,a,n,o,i,l){var s,c,p;void 0===o&&(o=null),void 0===i&&(i=null),void 0===l&&(l=1),this.roleData=a,this.isFire=t,this.closeAction=o,this.ballSize=l,null!=(l=_.PlayerState.playerData)&&(l=l.logicPos,this.targetPos=l,null!=e&&(null!=i&&2<=i.length?(s=i[0],p=i[1],s.x<=-200&&(s.x=-200),p.x<=-200&&(p.x=-200),this.partical.resetSystem(),c=new y.NewBezier(this.node.position,s,p,l,n),this.moveBezier=c):(s=(i=cc.v2((l.x+this.node.x)/3,(l.y+this.node.y)/3)).mul(2),p=l.sub(this.node.position).normalize(),c=r.Util.rotateAngle(p,90),p=T.GameState.endlessModel?r.Util.getRandomFloatNum(-50,150):150,i=i.add(c.mul(-(e-2)*p)),p=s.add(c.mul(-(e-2)*p)),i.x<=-200&&(i.x=-200),p.x<=-200&&(p.x=-200),this.partical.resetSystem(),n=new y.NewBezier(this.node.position,i,p,l,n),this.moveBezier=n)))},P.prototype.onCollisionEnter=function(e){if(null!=this.roleData&&!this.isDestroy)if(e.node.group!=s.GroupNameEnum.BODY)if(e.node.group!=s.GroupNameEnum.HEAD){if(e.node.group!=s.GroupNameEnum.SHIELD)e.node.group!=s.GroupNameEnum.ARROW||null!=(t=e.getComponent(h.Arrow))&&t.arrowState==s.ArrowStateEnum.LAUNCHING&&(i=t.roleData)!=this.roleData&&i.isEnemy!=this.roleData.isEnemy&&(e.node.destroy(),this.reduceSize(t.arrowSize,null));else if(null!=(n=e.getComponent(d.Shield))&&!(null==(i=n.roleData)||i.isTeleporting||i==this.roleData||i.hasEnemyShield||this.roleData.isEnemy&&i.isEnemy&&(T.GameState.endlessModel||T.GameState.endlessModel||this.roleData.profession==s.ProfessionEnum.FIRE_DRAGON||this.roleData.profession==s.ProfessionEnum.ICE_DRAGON))){if(!T.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null,this.ballSize);o=this.roleData.atk,this.isFire&&i.isPlayer&&(l=null==D.EquipmentEffectSystem.currentHelmetEffectData[3]?0:D.EquipmentEffectSystem.currentHelmetEffectData[3],o*=1-(l+=null==D.EquipmentEffectSystem.currentShieldEffectData[3]?0:D.EquipmentEffectSystem.currentShieldEffectData[3])),C.RoleManager.equipmentIsDamaged(i,M.EquipmentType.shield,this.roleData,o,this.node.position),i.shieldDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),n.drop(200*a.x,200*a.y)),this.blast(null,this.ballSize)}}else{var t=e.getComponent(p.Head);if(null!=t&&null!=(i=t.roleData)&&!i.isTeleporting&&i!=this.roleData&&!(this.roleData.isEnemy&&i.isEnemy&&(T.GameState.endlessModel||T.GameState.endlessModel||this.roleData.profession==s.ProfessionEnum.FIRE_DRAGON||this.roleData.profession==s.ProfessionEnum.ICE_DRAGON||this.roleData.isBoss&&7==T.GameState.currentChapter)||i.profession!=s.ProfessionEnum.FLY_HEAD_GHOST&&i.hasEnemyShield)){if(!T.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null,this.ballSize);if(0<i.helmetDefense){var a,n=this.roleData.atk;return this.isFire&&i.isPlayer&&(l=null==D.EquipmentEffectSystem.currentHelmetEffectData[3]?0:D.EquipmentEffectSystem.currentHelmetEffectData[3],n*=1-(l+=null==D.EquipmentEffectSystem.currentShieldEffectData[3]?0:D.EquipmentEffectSystem.currentShieldEffectData[3])),C.RoleManager.equipmentIsDamaged(i,M.EquipmentType.helmet,this.roleData,n,this.node.position),null!=t.helmet&&t.helmet.node.active&&i.helmetDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),t.helmet.drop(200*a.x,200*a.y),t.helmet=null),void this.blast(null,this.ballSize)}var o=this.roleData.atk;if(this.isFire&&i.isPlayer&&(l=null==D.EquipmentEffectSystem.currentHelmetEffectData[3]?0:D.EquipmentEffectSystem.currentHelmetEffectData[3],o*=1-(l+=null==D.EquipmentEffectSystem.currentShieldEffectData[3]?0:D.EquipmentEffectSystem.currentShieldEffectData[3])),C.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0&&(r=this.node.x>i.logicPos.x?1:-1,A.SingleEffectManager.showBloodEffect(i.logicPos,r,i),this.isFire&&this.roleData.enemyEquipSkills&&this.roleData.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.IGNITE))){if(i.isPlayer&&(u=null==D.EquipmentEffectSystem.currentCloakEffectData[1]?0:D.EquipmentEffectSystem.currentCloakEffectData[1],Math.random()<u))return void k.EffectCreate.createRoleTip(i.logicPos,2);A.SingleEffectManager.showIgniteEffect(this.roleData,i)}this.blast(i,this.ballSize)}}else{var i;if(null!=(e=e.getComponent(c.Body))&&!(null==(i=e.roleData)||i.isTeleporting||i==this.roleData||i.hasEnemyShield||this.roleData.isEnemy&&i.isEnemy&&(T.GameState.endlessModel||T.GameState.heroModel||this.roleData.profession==s.ProfessionEnum.FIRE_DRAGON||this.roleData.profession==s.ProfessionEnum.ICE_DRAGON||this.roleData.isBoss&&7==T.GameState.currentChapter))){if(!T.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null,this.ballSize);var l;if(o=this.roleData.atk,this.isFire&&i.isPlayer&&(l=null==D.EquipmentEffectSystem.currentHelmetEffectData[3]?0:D.EquipmentEffectSystem.currentHelmetEffectData[3],o*=1-(l+=null==D.EquipmentEffectSystem.currentShieldEffectData[3]?0:D.EquipmentEffectSystem.currentShieldEffectData[3])),C.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0){var r=this.node.x>i.logicPos.x?1:-1;if(A.SingleEffectManager.showBloodEffect(i.logicPos,r,i),this.isFire&&this.roleData.enemyEquipSkills&&this.roleData.enemyEquipSkills.isHaveSkill(s.SkillTypeEnum.IGNITE)){if(i.isPlayer){var u=null==D.EquipmentEffectSystem.currentCloakEffectData[1]?0:D.EquipmentEffectSystem.currentCloakEffectData[1];if(Math.random()<u)return void k.EffectCreate.createRoleTip(i.logicPos,2)}A.SingleEffectManager.showIgniteEffect(this.roleData,i)}}this.blast(i,this.ballSize)}}},P.prototype.reduceSize=function(e,t){var a=this.ballSize;this.ballSize-=e,this.ballSize<=0?this.blast(t,a):(a=this.ballSize,this.node.runAction(cc.scaleTo(.5,a)))},P.prototype.blast=function(e,t,a){var n,o,i;void 0===a&&(a=!1),this.isDestroy||(this.isDestroy=!0,this.closeAction&&this.closeAction(),null!=(n=v.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE))&&(null==(o=E.EnemyArea.createMaigcBallBlast())||null!=(i=o.getComponent(u.MagicBallBlast))&&(a||g.LocalSoundManager.playBlastAudio(),o.setParent(n),o.setPosition(this.node.position),t=Math.max(1,t),i.showBlast(this.roleData,e,this.isFire,t),this.close())))},P.prototype.isReviveKnocked=function(){null!=this.roleData&&this.blast(_.PlayerState.playerData,this.ballSize,!0)},P.prototype.close=function(){S.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7c92\u5b50",type:cc.ParticleSystem})],P.prototype,"partical",void 0),n=__decorate([n],P),i.MagicBall=n,cc._RF.pop()},{}],MainBgWeapon:[function(e,t,a){"use strict";cc._RF.push(t,"d1a68qpqlBHPa9X2BrJfJoy","MainBgWeapon");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Util");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.bgWeapons=[],e.bgWeaponFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onEnable=function(){var e=this;this.bgWeapons.forEach(function(t){null!=t&&(t.spriteFrame=e.getRandomFrame())})},s.prototype.getRandomFrame=function(){var e=r.Util.getRandomNum(0,4);return this.bgWeaponFrames[e]||this.bgWeaponFrames[0]},__decorate([o({type:[cc.Sprite],displayName:"\u80cc\u666f\u6b66\u5668"})],s.prototype,"bgWeapons",void 0),__decorate([o({type:[cc.SpriteFrame],displayName:"\u80cc\u666f\u6b66\u5668\u7d20\u6750"})],s.prototype,"bgWeaponFrames",void 0),n=__decorate([n],s),i.MainBgWeapon=n,cc._RF.pop()},{}],MainUI:[function(e,t,a){"use strict";cc._RF.push(t,"b63aat9/o5AG4fCZ0e04nyp","MainUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("UserData"),p=n("LocalData"),d=n("EnumAndConst"),u=n("TipManager"),h=n("Timer"),m=n("LocalSoundManager"),f=n("UIManager"),g=n("GameConfigData"),y=n("StatisticsManager"),v=n("RankingManager"),D=n("GameManager"),E=n("PrefabUrl"),S=n("WorldEventManager"),A=n("LocalWorldEventType"),C=n("Loading"),M=n("CommonMask");function T(){var e=null!==l&&l.apply(this,arguments)||this;return e.effect1=null,e.effect2=null,e.playerRole=null,e.storeBtn=null,e.storeBtnSprite=[],e.equipmentBtn=null,e.equipmentBtnSprite=[],e.battleBtn=null,e.battleBtnSprite=[],e.talentBtn=null,e.talentBtnSprite=[],e.uiNode=null,e.storeTip=null,e.equipmentTip=null,e.lastCoinCount=null,e.lastGemCount=null,e.lastEnergyCount=null,e.storeUI=null,e.equipmentUI=null,e.battleUI=null,e.talentUI=null,e.currentUI=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(T,l),(r=T).prototype.onLoad=function(){y.StatisticsManager.thirdSendEvent("enter_lobby_succ"),r.instance=this,f.UIManager.createCurrencyUI(this.node),v.RankingManager.submitData(d.OpenDataKeyEnum.PART,p.LocalData.data.chapterRecord),this.refreshEndlessModel(),c.UserData.newUser||f.PopUITaskManager.addTask(this.dailyLoginTask.bind(this)),c.UserData.newUser||f.PopUITaskManager.addTask(this.showEggMachineTask.bind(this)),f.PopUITaskManager.addTask(this.continueBattleTask.bind(this))},T.prototype.onEnable=function(){var e=this;this.checkEquipmentNewOrUpgrade(),S.WorldEventManager.addListener(A.LocalWorldEventType.GetNewEquipment,this.checkEquipmentNewOrUpgrade,this),S.WorldEventManager.triggerEvent(A.LocalWorldEventType.ShowMainUI,null),f.UIManager.isMainUI=!0,p.LocalData.data.passChapter<1?this.talentBtn.node.color=cc.color(124,124,124,255):this.talentBtn.node.color=cc.color(255,255,255,255),h.TimerManager.clearTimers(),this.effactAction(!0),f.PopUITaskManager.addTask(this.unlockSkillTask.bind(this)),!c.UserData.newUser||r.init||r.autoShowedDailyLogin||(r.autoShowedDailyLogin=!0,f.PopUITaskManager.addTask(this.dailyLoginTask.bind(this)),f.PopUITaskManager.addTask(this.showEggMachineTask.bind(this))),f.PopUITaskManager.addTask(this.failPopTask.bind(this)),r.init=!1,this.currentUI&&this.currentUI==this.battleUI||(this.selectUI(3),s.GameCommonPool.requestInstantByUrl(E.PrefabUrl.battleStartUI,function(t,a){null!=a&&(a.setParent(e.uiNode),e.currentUI&&e.currentUI.active&&s.GameCommonPool.returnInstant(e.currentUI),e.currentUI=a,e.battleUI=a)}))},T.prototype.onDisable=function(){f.UIManager.isMainUI=!1,S.WorldEventManager.triggerEvent(A.LocalWorldEventType.HideMainUI,null),S.WorldEventManager.removeListener(A.LocalWorldEventType.GetNewEquipment,this.checkEquipmentNewOrUpgrade,this)},T.prototype.update=function(){this.lastCoinCount==c.UserData.data.coin&&this.lastGemCount==p.LocalData.data.gemCount&&this.lastEnergyCount==p.LocalData.data.energyNum||(this.lastCoinCount=c.UserData.data.coin,this.lastGemCount=p.LocalData.data.gemCount,this.lastEnergyCount=p.LocalData.data.energyNum),this.currentUI==this.storeUI&&null!=this.storeUI||!(0<p.LocalData.data.weaponBoxTime||0<p.LocalData.data.normalBoxTimes||null==p.LocalData.data.lastOpenLegendBoxTime||Date.now()/1e3-p.LocalData.data.lastOpenLegendBoxTime>=g.GameConfigData.data.legendBoxTime)?this.storeTip.active=!1:this.storeTip.active=!0},T.prototype.checkEquipmentNewOrUpgrade=function(){for(var e=0,t=p.LocalData.data.newEquipmentDatas;e<t.length;e++){var a=t[e];if(null!=a&&a.isNew)return void(this.equipmentTip.active=!0)}this.equipmentTip.active=!1},T.prototype.clickStore=function(){var e=this;m.LocalSoundManager.playAudio("click"),this.currentUI!=this.storeUI&&(this.storeTip.active=!1,this.selectUI(1),M.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(E.PrefabUrl.storeUI,function(t,a){M.CommonMask.hideMask(),null==t&&null!=a?(a.setParent(e.uiNode),e.currentUI&&e.currentUI.active&&s.GameCommonPool.returnInstant(e.currentUI),e.currentUI=a,e.storeUI=a):C.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.clickStore()},null)}))},T.prototype.clickEquipment=function(){var e=this;m.LocalSoundManager.playAudio("click"),this.currentUI!=this.equipmentUI&&(this.selectUI(2),M.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(E.PrefabUrl.equipmentUI,function(t,a){M.CommonMask.hideMask(),null==t&&null!=a?(a.setParent(e.uiNode),e.currentUI&&e.currentUI.active&&s.GameCommonPool.returnInstant(e.currentUI),e.currentUI=a,e.equipmentUI=a):C.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.clickEquipment()},null)}))},T.prototype.clickBattle=function(){var e=this;m.LocalSoundManager.playAudio("click"),this.currentUI&&this.currentUI==this.battleUI||(this.selectUI(3),M.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(E.PrefabUrl.battleStartUI,function(t,a){M.CommonMask.hideMask(),null==t&&null!=a?(a.setParent(e.uiNode),e.currentUI&&e.currentUI.active&&s.GameCommonPool.returnInstant(e.currentUI),e.currentUI=a,e.battleUI=a):C.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.clickBattle()},null)}))},T.prototype.clickTalent=function(){var e=this;m.LocalSoundManager.playAudio("click"),p.LocalData.data.passChapter<1?u.TipManager.showTip("\u901a\u8fc7\u7b2c\u4e00\u7ae0\u540e\u89e3\u9501"):this.currentUI!=this.talentUI&&(this.selectUI(4),M.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(E.PrefabUrl.talentUI,function(t,a){M.CommonMask.hideMask(),null==t&&null!=a?(a.setParent(e.uiNode),e.currentUI&&e.currentUI.active&&s.GameCommonPool.returnInstant(e.currentUI),e.currentUI=a,e.talentUI=a):C.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.clickTalent()},null)}))},T.prototype.selectUI=function(e){switch(this.storeBtn.spriteFrame=this.storeBtnSprite[0],this.battleBtn.spriteFrame=this.battleBtnSprite[0],this.talentBtn.spriteFrame=this.talentBtnSprite[0],this.equipmentBtn.spriteFrame=this.equipmentBtnSprite[0],e){case 1:this.storeBtn.spriteFrame=this.storeBtnSprite[1],this.effect1.active=!1,this.effect2.active=!1,this.playerRole.active=!1;break;case 2:this.equipmentBtn.spriteFrame=this.equipmentBtnSprite[1],this.effactAction(!1),this.playerRole.active=!0;break;case 3:this.battleBtn.spriteFrame=this.battleBtnSprite[1],this.effactAction(!1),this.playerRole.active=!0;break;case 4:this.talentBtn.spriteFrame=this.talentBtnSprite[1],this.effactAction(!1),this.playerRole.active=!0}},T.prototype.effactAction=function(e){var t=this;if(this.effect1.active=!0,this.effect2.active=!0,!e)return this.effect1.resumeAllActions(),void this.effect2.resumeAllActions();this.effect1.scale=.4,this.effect1.opacity=120,this.effect1.stopAllActions(),this.effect1.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(.9,1.2),cc.fadeOut(.9)),cc.callFunc(function(){t.effect1.scale=.4,t.effect1.opacity=120})))),this.effect2.scale=.8,this.effect2.opacity=100,this.effect2.stopAllActions(),this.effect2.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(.9,1.6),cc.fadeOut(.9)),cc.callFunc(function(){t.effect2.scale=.8,t.effect2.opacity=100}))))},T.prototype.clickSetting=function(){m.LocalSoundManager.playAudio("click"),f.UIManager.showSettingUIPop()},T.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},T.prototype.clickBtnByPop=function(e){if(null!=e)switch(e){case 1:this.clickStore();break;case 2:this.clickEquipment()}},T.prototype.refreshEndlessModel=function(){var e,t=new Date,a=t.getFullYear(),n=t.getMonth();p.LocalData.data.clearEndlessProgressYear==a&&p.LocalData.data.clearEndlessProgressMonth==n||null!=(e=null==p.LocalData.data.lastEndlessDataJson?null:JSON.parse(p.LocalData.data.lastEndlessDataJson))&&(null!=(t=e.lastRoleData)&&null!=t.rewardCoin&&0<t.rewardCoin&&(p.LocalData.changeCoin(3*t.rewardCoin),u.TipManager.showTip("\u606d\u559c\u83b7\u5f97"+3*t.rewardCoin+"\u91d1\u5e01\uff01")),p.LocalData.data.lastEndlessDataJson=null),p.LocalData.data.clearEndlessProgressYear=a,p.LocalData.data.clearEndlessProgressMonth=n},T.prototype.unlockSkillTask=function(e,t){null==p.LocalData.temp_last_pass_chapter||2<p.LocalData.temp_last_pass_chapter||p.LocalData.data.passChapter!=p.LocalData.temp_last_pass_chapter+1?t&&t():(p.LocalData.temp_last_pass_chapter=null,f.UIManager.showUnlockSkillUI(p.LocalData.data.passChapter,e))},T.prototype.continueBattleTask=function(e,t){var a;null!=p.LocalData.data.lastBattleDataJson||null!=p.LocalData.data.lastEndlessDataJson?null==(a=null==p.LocalData.data.lastEndlessDataJson?null:JSON.parse(p.LocalData.data.lastEndlessDataJson))||a.isReorganize?null!=p.LocalData.data.lastBattleDataJson&&f.UIManager.showContinueBattlePop(!1,e):f.UIManager.showContinueBattlePop(!0,e):t&&t()},T.prototype.failPopTask=function(e,t){var a=D.GameManager.getFailPopUI();a!=d.gameFailUIType.needNotPop?f.UIManager.showFailTipUI(a,e):t&&t()},T.prototype.dailyLoginTask=function(e,t){c.UserData.data.loginRewardRecievedCount<c.UserData.data.loginRewardCanRecieveCount&&c.UserData.data.loginRewardRecievedCount<7?f.UIManager.showDailyLoginReward(e):t&&t()},T.prototype.showEggMachineTask=function(e,t){0<p.LocalData.data.eggMachineDailyTimes?f.UIManager.showEggMachineUIPop(e):t&&t()},T.instance=null,T.autoShowedDailyLogin=!1,T.init=!0,__decorate([o({type:cc.Node,displayName:"\u89d2\u8272\u80cc\u666f\u7279\u65481"})],T.prototype,"effect1",void 0),__decorate([o({type:cc.Node,displayName:"\u89d2\u8272\u80cc\u666f\u7279\u65482"})],T.prototype,"effect2",void 0),__decorate([o({displayName:"\u89d2\u8272\u5c55\u793aui",type:cc.Node})],T.prototype,"playerRole",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5546\u5e97\u6309\u94ae"})],T.prototype,"storeBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5546\u5e97\u6309\u94ae\u56fe\u7247"})],T.prototype,"storeBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u88c5\u5907\u6309\u94ae"})],T.prototype,"equipmentBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u88c5\u5907\u6309\u94ae\u56fe\u7247"})],T.prototype,"equipmentBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u6218\u6597\u6309\u94ae"})],T.prototype,"battleBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u6218\u6597\u6309\u94ae\u56fe\u7247"})],T.prototype,"battleBtnSprite",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5929\u8d4b\u6309\u94ae"})],T.prototype,"talentBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5929\u8d4b\u6309\u94ae\u56fe\u7247"})],T.prototype,"talentBtnSprite",void 0),__decorate([o({type:cc.Node,displayName:"UI\u5b50\u5c42"})],T.prototype,"uiNode",void 0),__decorate([o({type:cc.Node,displayName:"\u5546\u5e97\u63d0\u793a"})],T.prototype,"storeTip",void 0),__decorate([o({type:cc.Node,displayName:"\u88c5\u5907\u63d0\u793a"})],T.prototype,"equipmentTip",void 0),n=r=__decorate([n],T),i.MainUI=n,cc._RF.pop()},{}],MapElementData:[function(e,t,a){"use strict";cc._RF.push(t,"d53b2CK/MRMLqM0GFaLLvhk","MapElementData");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(i=cc._decorator).ccclass;var i=i.property;function l(){this.frame=null,this.maxPosY=0,this.minPosY=0,this.anchor=cc.v2(.5,.5)}__decorate([i({displayName:"\u5730\u56fe\u5143\u7d20\u56fe\u7247",type:cc.SpriteFrame})],l.prototype,"frame",void 0),__decorate([i({displayName:"Y\u8f74\u5750\u6807\u6700\u5927\u503c"})],l.prototype,"maxPosY",void 0),__decorate([i({displayName:"Y\u8f74\u5750\u6807\u6700\u5c0f\u503c"})],l.prototype,"minPosY",void 0),__decorate([i({displayName:"\u951a\u70b9"})],l.prototype,"anchor",void 0),n=__decorate([n("MapElementData")],l),o.MapElementData=n,cc._RF.pop()},{}],MapElement:[function(e,t,a){"use strict";cc._RF.push(t,"1291fOvgaFE1ripxGaoU5rF","MapElement");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Util"),s=n("MapElementData");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.elementSprite=null,e.mapFarElements=[],e.mapMiddleElements=[],e.mapNearElements=[],e.mapGroundElements=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.bindData=function(e){var t;null!=e&&(t=null,0==e?t=r.Util.getRandomValueFromArray(this.mapFarElements):1==e?t=r.Util.getRandomValueFromArray(this.mapMiddleElements):2==e?t=r.Util.getRandomValueFromArray(this.mapNearElements):3==e&&(t=r.Util.getRandomValueFromArray(this.mapGroundElements)),this.elementSprite.spriteFrame=t.frame,this.node.setAnchorPoint(t.anchor),this.node.setPosition(cc.v2(this.node.x,r.Util.getRandomNum(t.maxPosY,t.minPosY))))},__decorate([o({displayName:"\u5730\u56fe\u5143\u7d20\u56fe\u7247",type:cc.Sprite})],c.prototype,"elementSprite",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fdc\u666f\u5143\u7d20\u96c6\u5408",type:s.MapElementData})],c.prototype,"mapFarElements",void 0),__decorate([o({displayName:"\u5730\u56fe\u4e2d\u666f\u5143\u7d20\u96c6\u5408",type:s.MapElementData})],c.prototype,"mapMiddleElements",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fd1\u666f\u5143\u7d20\u96c6\u5408",type:s.MapElementData})],c.prototype,"mapNearElements",void 0),__decorate([o({displayName:"\u5730\u56fe\u5730\u5e95\u5143\u7d20\u96c6\u5408",type:s.MapElementData})],c.prototype,"mapGroundElements",void 0),n=__decorate([n],c),i.MapElement=n,cc._RF.pop()},{}],MapItem:[function(e,t,a){"use strict";cc._RF.push(t,"32ce1J5zxZAG6blkYsW7eec","MapItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SpriteFrameManager"),s=n("ConfigData"),c=n("LocalData"),p=n("GameConfigData"),d=n("GameCommonPool"),u=n("UnlockSkillDetail");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.mapSprite=null,e.lockedNode=null,e.mapName=null,e.mapDescribe=null,e.bossSprite=null,e.unlockSkillDetailPrefab=null,e.chapter=null,e.unlockSkillDetail=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onEnable=function(){null!=this.chapter&&(this.chapter>c.LocalData.data.currentChapter?(this.lockedNode.active=!0,this.chapter>p.GameConfigData.data.MAX_CHAPTER_COUNT&&(this.mapSprite.node.color=cc.Color.GRAY,this.mapName.string="\u656c\u8bf7\u671f\u5f85",this.mapDescribe.string="\u656c\u8bf7\u671f\u5f85")):this.lockedNode.active=!1,null!=this.unlockSkillDetail&&this.chapter<=c.LocalData.data.passChapter&&(this.unlockSkillDetail.close(),this.unlockSkillDetail=null),this.refreshBossSprite())},h.prototype.bindData=function(e){this.mapSprite.spriteFrame=r.SpriteFrameManager.getFullMap(e),this.mapName.string=s.ConfigData.MAP_NAME_ARRAY[e-1],this.mapDescribe.string="\u5730\u56fe\u4ecb\u7ecd\uff1a"+s.ConfigData.MAP_DESCRIBE[e-1],this.bossSprite.spriteFrame=r.SpriteFrameManager.getBossSpriteFrame(e),this.chapter=e,this.refreshBossSprite(),this.showUnlockSkillDetail()},h.prototype.refreshBossSprite=function(){this.chapter>c.LocalData.data.passChapter?this.bossSprite.node.color=cc.color(0,0,0):this.bossSprite.node.color=cc.color(255,255,255)},h.prototype.refreshSkillButton=function(e){null!=this.unlockSkillDetail&&this.unlockSkillDetail.refreshButtons(e)},h.prototype.showUnlockSkillDetail=function(){var e;null!=this.unlockSkillDetail||null!=(e=d.GameCommonPool.requestInstant(this.unlockSkillDetailPrefab))&&(e.setParent(this.node),null!=(e=e.getComponent(u.UnlockSkillDetail))&&(e.bindData(this.chapter),this.unlockSkillDetail=e))},__decorate([o({displayName:"\u5730\u56fe\u56fe\u7247",type:cc.Sprite})],h.prototype,"mapSprite",void 0),__decorate([o({displayName:"\u9501\u5b9a\u56fe\u7247",type:cc.Node})],h.prototype,"lockedNode",void 0),__decorate([o({displayName:"\u5730\u56fe\u540d\u79f0",type:cc.Label})],h.prototype,"mapName",void 0),__decorate([o({displayName:"\u5730\u56fe\u4ecb\u7ecd",type:cc.Label})],h.prototype,"mapDescribe",void 0),__decorate([o({type:cc.Sprite,displayName:"boss\u56fe\u7247"})],h.prototype,"bossSprite",void 0),__decorate([o({displayName:"\u89e3\u9501\u6280\u80fd\u8be6\u60c5\u9875\u9884\u8bbe",type:cc.Prefab})],h.prototype,"unlockSkillDetailPrefab",void 0),n=__decorate([n],h),i.MapItem=n,cc._RF.pop()},{}],MapManager:[function(e,t,a){"use strict";cc._RF.push(t,"b9dccwRPK1KdpOZtRersRnF","MapManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("Util"),p=n("MapElement"),d=n("Loading"),u=cc._decorator,h=u.ccclass;function m(){this.chapter=1,this.mapSF=null,this.mapWidth=3e3}function f(){this.chapter=1,this.elementType=0,this.minInterval=400,this.maxInterval=600}function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.mapBgSFInfos=[],e.mapFarSFInfos=[],e.mapNearSFInfos=[],e.mapGroundSFInfos=[],e.mapElementIntervals=[],e.mapBgSprite=null,e.mapFarSprite=null,e.mapNearSprite=null,e.mapGroundSprite=null,e.mapFar=null,e.mapMiddle=null,e.mapNear=null,e.mapUnder=null,e.mapBgSpeed=50,e.mapFarSpeed=100,e.mapMiddleSpeed=150,e.mapNearSpeed=250,e.mapGroundSpeed=350,e.farElementArray=[],e.middleElementArray=[],e.nearElementArray=[],e.underElementArray=[],e.startPosX=[-1e3,-1e3,-1e3,-1e3],e.endPosX=[1e3,1e3,1e3,1e3],e.isMoving=!1,e.mapBgXLimit=1500,e.mapFarXLimit=1500,e.mapNearXLimit=1500,e.mapGroundXLimit=1500,e}o=u.property,__decorate([o({displayName:"\u7ae0\u8282"})],m.prototype,"chapter",void 0),__decorate([o({displayName:"\u7ae0\u8282\u5bf9\u5e94\u7684\u56fe\u7247",type:cc.SpriteFrame})],m.prototype,"mapSF",void 0),__decorate([o({displayName:"\u7ae0\u8282\u5bf9\u5e94\u56fe\u7247\u62c9\u4f38\u540e\u7684\u5bbd\u5ea6"})],m.prototype,"mapWidth",void 0),n=__decorate([h("MapSFInfo")],m),i.MapSFInfo=n,__decorate([o({displayName:"\u7ae0\u8282"})],f.prototype,"chapter",void 0),__decorate([o({displayName:"\u5730\u56fe\u5143\u7d20\u7c7b\u578b",tooltip:"type 0\uff0c1\uff0c2\uff0c3\u5206\u522b\u8868\u793a\u8fdc\u666f\u3001\u4e2d\u666f\u3001\u8fd1\u666f\u3001\u5730\u5e95"})],f.prototype,"elementType",void 0),__decorate([o({displayName:"\u5143\u7d20\u95f4\u8ddd\u6700\u5c0f\u503c"})],f.prototype,"minInterval",void 0),__decorate([o({displayName:"\u5143\u7d20\u95f4\u8ddd\u6700\u5927\u503c"})],f.prototype,"maxInterval",void 0),u=__decorate([h("MapElementInfo")],f),i.MapElementInterval=u,l=cc.Component,__extends(g,l),(r=g).prototype.onEnable=function(){r.instance=this},g.prototype.update=function(){this.isMoving&&(this.mapBgSprite.node.x<=-this.mapBgXLimit&&(this.mapBgSprite.node.x=0),this.mapFarSprite.node.x<=-this.mapFarXLimit&&(this.mapFarSprite.node.x=0),this.mapNearSprite.node.x<=-this.mapNearXLimit&&(this.mapNearSprite.node.x=0),this.mapGroundSprite.node.x<=-this.mapGroundXLimit&&(this.mapGroundSprite.node.x=0),this.refreshAllMapElements())},g.setMap=function(e,t){var a,n,o=r.instance;null!=o&&(this.init(),o.startPosX=[-1e3,-1e3,-1e3,-1e3],o.endPosX=[1e3,1e3,1e3,1e3],o.isMoving=!1,null!=(a=o.getMapSF(e,o.mapBgSFInfos))&&(o.mapBgSprite.spriteFrame=a.mapSF,o.mapBgSprite.node.width=a.mapWidth,o.mapBgXLimit=a.mapWidth/2),null!=(a=o.getMapSF(e,o.mapFarSFInfos))&&(o.mapFarSprite.spriteFrame=a.mapSF,o.mapFarSprite.node.width=a.mapWidth,o.mapFarXLimit=a.mapWidth/2,null!=(n=a.mapSF&&a.mapSF.getOriginalSize())&&null!=n.height&&(o.mapFarSprite.node.height=n.height)),null!=(a=o.getMapSF(e,o.mapNearSFInfos))&&(o.mapNearSprite.spriteFrame=a.mapSF,o.mapNearSprite.node.width=a.mapWidth,o.mapNearXLimit=a.mapWidth/2,null!=(n=a.mapSF&&a.mapSF.getOriginalSize())&&null!=n.height&&(o.mapNearSprite.node.height=n.height)),null!=(n=o.getMapSF(e,o.mapGroundSFInfos))&&(o.mapGroundSprite.spriteFrame=n.mapSF,o.mapGroundSprite.node.width=n.mapWidth,o.mapGroundXLimit=n.mapWidth/2),t&&(o.createMapElements(e,0,o.mapFar),o.createMapElements(e,1,o.mapMiddle),o.createMapElements(e,2,o.mapNear),2!=e&&5!=e&&o.createMapElements(e,3,o.mapUnder)))},g.prototype.getMapSF=function(e,t){if(!(null==e||null==t||t.length<=0)){for(var a=null,n=0,o=t;n<o.length;n++){var i=o[n];if(null!=i&&null!=i.chapter&&i.chapter==e){a=i;break}}return a}},g.prototype.createMapElements=function(e,t,a){var n=this.startPosX[t],o=this.endPosX[t],i=this.getElementInterval(e,t);if(null!=i&&null!=i.minInterval&&null!=i.maxInterval)for(var l=0;l<999&&!(o<=n)&&(this.createElement(n,e,t,a),n+=c.Util.getRandomFloatNum(i.minInterval,i.maxInterval),!(o<=(this.startPosX[t]=n)));l++);},g.prototype.getElementInterval=function(e,t){if(!(null==this.mapElementIntervals||this.mapElementIntervals.length<=0||null==e)){for(var a=0;a<this.mapElementIntervals.length;a++){var n=this.mapElementIntervals[a];if(null!=n&&n.chapter==e&&n.elementType==t)return n}return null}},g.prototype.createElement=function(e,t,a,n){var o=this;s.GameCommonPool.requestInstantByUrl("Game/Map/mapElement"+t,function(i,l){null==i&&null!=l?(l.setParent(n),l.setPosition(e,0),null!=(i=l.getComponent(p.MapElement))&&(i.bindData(a),0==a?o.farElementArray.push(l):1==a?o.middleElementArray.push(l):2==a?o.nearElementArray.push(l):3==a&&o.underElementArray.push(l))):d.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){o.createElement(e,t,a,n)},null)})},g.moveMap=function(e,t){void 0===t&&(t=null);var a=r.instance;null!=a&&(null==t&&(t=2),this.stopMoveMap(),a.isMoving=!0,a.mapBgSprite.node.runAction(cc.sequence(cc.moveBy(t,-a.mapBgSpeed*t,0),cc.callFunc(function(){a.isMoving=!1}))),a.mapFarSprite.node.runAction(cc.moveBy(t,-a.mapFarSpeed*t,0)),a.mapNearSprite.node.runAction(cc.moveBy(t,-a.mapNearSpeed*t,0)),a.mapGroundSprite.node.runAction(cc.moveBy(t,-a.mapGroundSpeed*t,0)),a.mapFar.runAction(cc.moveBy(t,-a.mapFarSpeed*t,0)),a.mapMiddle.runAction(cc.moveBy(t,-a.mapMiddleSpeed*t,0)),a.mapNear.runAction(cc.moveBy(t,-a.mapNearSpeed*t,0)),a.mapUnder.runAction(cc.moveBy(t,-a.mapGroundSpeed*t,0)),a.endPosX[0]+=a.mapFarSpeed*t,a.endPosX[1]+=a.mapMiddleSpeed*t,a.endPosX[2]+=a.mapNearSpeed*t,a.endPosX[3]+=a.mapGroundSpeed*t,a.createMapElements(e,0,a.mapFar),a.createMapElements(e,1,a.mapMiddle),a.createMapElements(e,2,a.mapNear),2!=e&&5!=e&&a.createMapElements(e,3,a.mapUnder))},g.stopMoveMap=function(){var e=r.instance;null!=e&&(e.isMoving=!1,e.mapBgSprite.node.stopAllActions(),e.mapFarSprite.node.stopAllActions(),e.mapNearSprite.node.stopAllActions(),e.mapGroundSprite.node.stopAllActions(),e.mapFar.stopAllActions(),e.mapMiddle.stopAllActions(),e.mapNear.stopAllActions(),e.mapUnder.stopAllActions())},g.init=function(){var e=r.instance;null!=e&&(this.clearAllMapElements(),e.mapBgSprite.node.x=0,e.mapFarSprite.node.x=0,e.mapNearSprite.node.x=0,e.mapGroundSprite.node.x=0,e.mapFar.x=0,e.mapMiddle.x=0,e.mapNear.x=0,e.mapUnder.x=0)},g.prototype.refreshAllMapElements=function(){if(null!=this.farElementArray&&0<this.farElementArray.length)for(var e=0;e<this.farElementArray.length;e++)null!=(t=this.farElementArray[e])&&t.x+this.mapFar.x<=-1e3&&(s.GameCommonPool.returnInstant(t),this.farElementArray.splice(e,1),e--);if(null!=this.middleElementArray&&0<this.middleElementArray.length)for(e=0;e<this.middleElementArray.length;e++)null!=(t=this.middleElementArray[e])&&t.x+this.mapMiddle.x<=-1e3&&(s.GameCommonPool.returnInstant(t),this.middleElementArray.splice(e,1),e--);if(null!=this.nearElementArray&&0<this.nearElementArray.length)for(e=0;e<this.nearElementArray.length;e++)null!=(t=this.nearElementArray[e])&&t.x+this.mapNear.x<=-1e3&&(s.GameCommonPool.returnInstant(t),this.nearElementArray.splice(e,1),e--);if(null!=this.underElementArray&&0<this.underElementArray.length)for(e=0;e<this.underElementArray.length;e++){var t;null!=(t=this.underElementArray[e])&&t.x+this.mapUnder.x<=-1e3&&(s.GameCommonPool.returnInstant(t),this.underElementArray.splice(e,1),e--)}},g.clearAllMapElements=function(){var e,t=r.instance;if(null!=t){if(null!=t.farElementArray&&0<t.farElementArray.length)for(var a=0,n=t.farElementArray;a<n.length;a++)null!=(e=n[a])&&s.GameCommonPool.returnInstant(e);if(null!=t.middleElementArray&&0<t.middleElementArray.length)for(var o=0,i=t.middleElementArray;o<i.length;o++)null!=(e=i[o])&&s.GameCommonPool.returnInstant(e);if(null!=t.nearElementArray&&0<t.nearElementArray.length)for(var l=0,c=t.nearElementArray;l<c.length;l++)null!=(e=c[l])&&s.GameCommonPool.returnInstant(e);if(null!=t.underElementArray&&0<t.underElementArray.length)for(var p=0,d=t.underElementArray;p<d.length;p++)null!=(e=d[p])&&s.GameCommonPool.returnInstant(e);t.farElementArray=[],t.middleElementArray=[],t.nearElementArray=[],t.underElementArray=[]}},g.instance=null,__decorate([o({displayName:"\u5730\u56fe\u80cc\u666f\u96c6\u5408",type:n})],g.prototype,"mapBgSFInfos",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fdc\u666f\u96c6\u5408",type:n})],g.prototype,"mapFarSFInfos",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fd1\u666f\u96c6\u5408",type:n})],g.prototype,"mapNearSFInfos",void 0),__decorate([o({displayName:"\u5730\u56fe\u5730\u9762\u96c6\u5408",type:n})],g.prototype,"mapGroundSFInfos",void 0),__decorate([o({displayName:"\u5730\u56fe\u5143\u7d20\u6570\u636e",type:u})],g.prototype,"mapElementIntervals",void 0),__decorate([o({displayName:"\u5730\u56fe\u80cc\u666f",type:cc.Sprite})],g.prototype,"mapBgSprite",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fdc\u666f",type:cc.Sprite})],g.prototype,"mapFarSprite",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fd1\u666f",type:cc.Sprite})],g.prototype,"mapNearSprite",void 0),__decorate([o({displayName:"\u5730\u56fe\u5730\u9762",type:cc.Sprite})],g.prototype,"mapGroundSprite",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fdc\u666f\u5143\u7d20\u8282\u70b9",type:cc.Node})],g.prototype,"mapFar",void 0),__decorate([o({displayName:"\u5730\u56fe\u4e2d\u666f\u5143\u7d20\u8282\u70b9",type:cc.Node})],g.prototype,"mapMiddle",void 0),__decorate([o({displayName:"\u5730\u56fe\u8fd1\u666f\u5143\u7d20\u8282\u70b9",type:cc.Node})],g.prototype,"mapNear",void 0),__decorate([o({displayName:"\u5730\u56fe\u5730\u5e95\u5143\u7d20\u8282\u70b9",type:cc.Node})],g.prototype,"mapUnder",void 0),h=r=__decorate([h],g),i.MapManager=h,cc._RF.pop()},{}],MoreGameItem:[function(e,t,a){"use strict";cc._RF.push(t,"92c3fxIrj1P8Y+yjaUZ24zZ","MoreGameItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("UserData");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.gameName=null,e.gameIcon=null,e.clickAction=null,e.moreGameInfo=null,e.itemOrder=1,e.partExport=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.bindData=function(e,t,a){var n;null!=e&&(this.itemOrder=t,this.gameName.string=e.gameName,(n=this).gameIcon.spriteFrame=null,cc.loader.load({url:e.gameIconUrl,type:"png"},function(e,t){null!=t&&(n.gameIcon.spriteFrame=new cc.SpriteFrame(t))}),this.clickAction=a,this.moreGameInfo=e)},s.prototype.clickItem=function(){null!=this.clickAction&&this.clickAction(this.moreGameInfo,r.ExportTypeEnum.MORE_GAME,this.itemOrder)},__decorate([o({type:cc.Label,displayName:"\u6e38\u620f\u540d\u79f0"})],s.prototype,"gameName",void 0),__decorate([o({type:cc.Sprite,displayName:"\u6e38\u620ficon"})],s.prototype,"gameIcon",void 0),n=__decorate([n],s),i.MoreGameItem=n,cc._RF.pop()},{}],MoreGameManager:[function(e,t,a){"use strict";cc._RF.push(t,"1ec29B5XiZGiZzTLdqCseMT","MoreGameManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("MoreGame"),c=n("GameCommonPool"),p=n("GameCommonHttp"),d=n("GameCommon"),u=n("StatisticsManager"),h=n("ShareManager"),m=n("AdManager"),f=n("BackHomeMoreGame"),g=n("UserData");function y(){var e=null!==l&&l.apply(this,arguments)||this;return e.moreGamePrefab=null,e.newMoreGamePrefab=null,e.backHomeMoreGamePrefab=null,e.boyMoreGamePrefab=null,e.moreGameNode=null,e.newMoreGameNode=null,e.boyMoreGameNode=null,e.partMoreGameNode=null,e.backHomeMoreGameNode=null,e.moreGameArray=new Array,e.boyMoreGameArray=new Array,e.partMoreGameArray=new Array,e.horizontalArray=new Array,e.clickAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(y,l),(r=y).prototype.onLoad=function(){var e=r.instance=this;this.clickAction=function(t,a,n){console.log(t),null!=t&&(u.StatisticsManager.uploadJumpRecord(t.gameAppId,t.gameName,"playerClick",a,n),window.gameCommon.getSDK.navigateToMiniProgram(t.gameAppId,t.jumpPath,function(o){return o?void u.StatisticsManager.uploadJumpRecord(t.gameAppId,t.gameName,"jumpSuccess",a,n):(t.switchQRCode&&window.gameCommon.getSDK.previewImage(t.QRCode),void e.navigateFail(t))}))}},y.prototype.navigateFail=function(e){var t;null!=this.moreGameNode&&null!=(t=this.moreGameNode.getComponent(s.MoreGame))&&t.navigateFail(e),null!=this.newMoreGameNode&&null!=(t=this.newMoreGameNode.getComponent(s.MoreGame))&&t.navigateFail(e),null!=this.partMoreGameNode&&null!=(t=this.partMoreGameNode.getComponent(s.MoreGame))&&t.navigateFail(e),null!=this.boyMoreGameNode&&null!=(t=this.boyMoreGameNode.getComponent(s.MoreGame))&&t.navigateFail(e)},y.isShow=function(){return null!=this.instance&&null!=this.instance.moreGameNode&&!!this.instance.moreGameNode.active},y.showNewMoreGame=function(e){if(this.checkMoreGameConfig()){var t=this.instance;if(null!=t)if(h.ShareManager.getFullScreenControl()){if(g.UserData.addModuleShows(g.ExportTypeEnum.NEW_MORE_GAME,1),m.AdManager.hideBannerAd(),null!=t.newMoreGameNode)return null==(a=t.newMoreGameNode.getComponent(s.MoreGame))?void(e&&e()):(a.bindCloseAction(e),void(t.newMoreGameNode.active=!0));var a,n=c.GameCommonPool.requestInstant(t.newMoreGamePrefab);null!=n?(n.setParent(t.node),null!=(a=(t.newMoreGameNode=n).getComponent(s.MoreGame))?(a.bindData(t.moreGameArray,t.clickAction),a.bindCloseAction(e)):e&&e()):e&&e()}else e&&e()}else e&&e()},y.closeNewMoreGame=function(){var e=this.instance;null==e||null==e.newMoreGameNode||null!=(e=e.newMoreGameNode.getComponent(s.MoreGame))&&e.showCloseMoreGame()},y.showBoyMoreGame=function(e){if(this.checkBoyMoreGameConfig()){var t=this.instance;if(null!=t)if(h.ShareManager.getFullScreenControl()){if(g.UserData.addModuleShows(g.ExportTypeEnum.BOY_MORE_GAME,1),m.AdManager.hideBannerAd(),null!=t.boyMoreGameNode)return null==(a=t.boyMoreGameNode.getComponent(s.MoreGame))?void(e&&e()):(a.bindCloseAction(e),void(t.boyMoreGameNode.active=!0));var a,n=c.GameCommonPool.requestInstant(t.boyMoreGamePrefab);null!=n?(n.setParent(t.node),null!=(a=(t.boyMoreGameNode=n).getComponent(s.MoreGame))?(a.bindData(t.boyMoreGameArray,t.clickAction),a.bindCloseAction(e)):e&&e()):e&&e()}else e&&e()}else e&&e()},y.closeBoyMoreGame=function(){var e=this.instance;null==e||null==e.boyMoreGameNode||null!=(e=e.boyMoreGameNode.getComponent(s.MoreGame))&&e.showCloseMoreGame()},y.showPartMoreGame=function(e){if(this.checkPartMoreGameConfig()){var t=this.instance;if(null!=t)if(h.ShareManager.getFullScreenControl()){if(g.UserData.addModuleShows(g.ExportTypeEnum.PASS_PART_MORE_GAME,1),m.AdManager.hideBannerAd(),null!=t.newMoreGameNode)return null==(a=t.newMoreGameNode.getComponent(s.MoreGame))?void(e&&e()):(a.bindCloseAction(e),void(t.newMoreGameNode.active=!0));var a,n=c.GameCommonPool.requestInstant(t.newMoreGamePrefab);null!=n?(n.setParent(t.node),null!=(a=(t.partMoreGameNode=n).getComponent(s.MoreGame))?(a.partExport=!0,a.bindData(t.partMoreGameArray,t.clickAction),a.bindCloseAction(e)):e&&e()):e&&e()}else e&&e()}else e&&e()},y.closePartMoreGame=function(){var e=this.instance;null==e||null==e.partMoreGameNode||null!=(e=e.partMoreGameNode.getComponent(s.MoreGame))&&e.showCloseMoreGame()},y.showBackHomeMoreGame=function(e,t){var a=this.instance;if(null!=a){if(!h.ShareManager.getFullScreenControl())return e&&e(),void(t&&t());if(m.AdManager.hideBannerAd(),null!=a.backHomeMoreGameNode)return null==(n=a.backHomeMoreGameNode.getComponent(f.BackHomeMoreGame))?(e&&e(),void(t&&t())):(n.bindAction(e,t),void(a.backHomeMoreGameNode.active=!0));var n,o=c.GameCommonPool.requestInstant(a.backHomeMoreGamePrefab);return null==o?(e&&e(),void(t&&t())):(o.setParent(a.node),null==(n=(a.backHomeMoreGameNode=o).getComponent(f.BackHomeMoreGame))?(e&&e(),void(t&&t())):void n.bindAction(e,t))}},y.closeBackHomeMoreGame=function(){var e=this.instance;null!=e&&null!=e.backHomeMoreGameNode&&(e.backHomeMoreGameNode.active=!1)},y.showMoreGame=function(e){this.checkMoreGameConfig();var t,a,n=this.instance;null!=n&&(h.ShareManager.getMoreGameControl()?(g.UserData.addModuleShows(g.ExportTypeEnum.MORE_GAME,1),null==n.moreGameNode?null!=(t=c.GameCommonPool.requestInstant(n.moreGamePrefab))&&(t.setParent(n.node),null!=(a=(n.moreGameNode=t).getComponent(s.MoreGame))&&(a.bindData(n.moreGameArray,n.clickAction),a.bindCloseAction(e))):(n.moreGameNode.active=!0,null!=(a=n.moreGameNode.getComponent(s.MoreGame))&&a.bindCloseAction(e))):e&&e())},y.initMoreGameConfig=function(){var e,t=this.instance;null!=t&&(e=h.ShareManager.cdnFileUrl+"/game-common/"+d.GameConfig.wxAppName+"/assets/"+d.GameConfig.versionCode+"/moreGameConfig.txt?time="+Date.now(),this.moreGameArrayLoading=!0,p.GameCommonHttp.wxHttpGet(e,function(e,a){if(r.moreGameArrayLoading=!1,0==e&&null!=a&&null!=(a=a.moreGames))for(var n=0,o=a;n<o.length;n++){var i=o[n];i._jumpSwith&&t.addMoreGame(i._name,i._jumpImageUrl,i._jumpAppId,i._jumpPath,i._jumpSwith,i._redDot,i._QRCode,i._switchQRCode,i.gameDesc,i.rectIconUrl,i.boyGame)}}))},y.initBoyMoreGameConfig=function(){var e,t=this.instance;null!=t&&(e=h.ShareManager.cdnFileUrl+"/game-common/"+d.GameConfig.wxAppName+"/assets/"+d.GameConfig.versionCode+"/boyMoreGameConfig.txt?time="+Date.now(),this.boyMoreGameArrayLoading=!0,p.GameCommonHttp.wxHttpGet(e,function(e,a){if(r.boyMoreGameArrayLoading=!1,0==e&&null!=a&&null!=(a=a.moreGames))for(var n=0,o=a;n<o.length;n++){var i=o[n];i._jumpSwith&&t.addBoyMoreGame(i._name,i._jumpImageUrl,i._jumpAppId,i._jumpPath,i._jumpSwith,i._redDot,i._QRCode,i._switchQRCode,i.gameDesc,i.rectIconUrl)}}))},y.initPartMoreGameConfig=function(){var e,t=this.instance;null!=t&&(e=h.ShareManager.cdnFileUrl+"/game-common/"+d.GameConfig.wxAppName+"/assets/"+d.GameConfig.versionCode+"/passPartMoreGameConfig.txt?time="+Date.now(),this.partMoreGameArrayLoading=!0,p.GameCommonHttp.wxHttpGet(e,function(e,a){if(r.partMoreGameArrayLoading=!1,0==e&&null!=a&&null!=(a=a.moreGames))for(var n=0,o=a;n<o.length;n++){var i=o[n];i._jumpSwith&&t.addPartMoreGame(i._name,i._jumpImageUrl,i._jumpAppId,i._jumpPath,i._jumpSwith,i._redDot,i._QRCode,i._switchQRCode,i.gameDesc,i.rectIconUrl,i.boyGame)}}))},y.initHorizontalConfig=function(){var e,t=this.instance;null!=t&&(e=h.ShareManager.cdnFileUrl+"/game-common/"+d.GameConfig.wxAppName+"/assets/"+d.GameConfig.versionCode+"/horizontalGameConfig.txt?time="+Date.now(),this.horizontalArrayLoading=!0,p.GameCommonHttp.wxHttpGet(e,function(e,a){if(r.horizontalArrayLoading=!1,0==e&&null!=a&&null!=(a=a.moreGames))for(var n=0,o=a;n<o.length;n++){var i=o[n];i._jumpSwith&&t.addHorizontalMoreGame(i._name,i._jumpImageUrl,i._jumpAppId,i._jumpPath,i._jumpSwith,i._redDot,i._QRCode,i._switchQRCode,i.gameDesc,i.rectIconUrl,i.boyGame)}}))},y.checkMoreGameConfig=function(){if(this.moreGameArrayLoading)return!1;var e=this.instance;return!(null==e||(null==e.moreGameArray||e.moreGameArray.length<=0)&&(this.initMoreGameConfig(),1))},y.checkBoyMoreGameConfig=function(){if(this.boyMoreGameArrayLoading)return!1;var e=this.instance;return!(null==e||(null==e.boyMoreGameArray||e.boyMoreGameArray.length<=0)&&(this.initBoyMoreGameConfig(),1))},y.checkPartMoreGameConfig=function(){if(this.partMoreGameArrayLoading)return!1;var e=this.instance;return!(null==e||(null==e.partMoreGameArray||e.partMoreGameArray.length<=0)&&(this.initPartMoreGameConfig(),1))},y.checkHorizontalConfig=function(){if(this.horizontalArrayLoading)return!1;var e=this.instance;return!(null==e||(null==e.horizontalArray||e.horizontalArray.length<=0)&&(this.initHorizontalConfig(),1))},y.getMoreGameInfo=function(){var e=this.instance;return null==e?null:e.moreGameArray},y.getHorizontalMoreGameInfo=function(){this.checkHorizontalConfig();var e=this.instance;return null==e?null:e.horizontalArray},y.prototype.addMoreGame=function(e,t,a,n,o,i,l,r,s,c,p){(s=new v(e,t,a,n,o,i,l,r,s)).rectIconUrl=c,s.boyGame=p,this.moreGameArray.push(s)},y.prototype.addBoyMoreGame=function(e,t,a,n,o,i,l,r,s,c){(s=new v(e,t,a,n,o,i,l,r,s)).rectIconUrl=c,this.boyMoreGameArray.push(s)},y.prototype.addPartMoreGame=function(e,t,a,n,o,i,l,r,s,c,p){(s=new v(e,t,a,n,o,i,l,r,s)).rectIconUrl=c,s.boyGame=p,this.partMoreGameArray.push(s)},y.prototype.addHorizontalMoreGame=function(e,t,a,n,o,i,l,r,s,c,p){(s=new v(e,t,a,n,o,i,l,r,s)).rectIconUrl=c,s.boyGame=p,this.horizontalArray.push(s)},y.instance=null,y.moreGameArrayLoading=!1,y.boyMoreGameArrayLoading=!1,y.partMoreGameArrayLoading=!1,y.horizontalArrayLoading=!1,__decorate([o(cc.Prefab)],y.prototype,"moreGamePrefab",void 0),__decorate([o({type:cc.Prefab,displayName:"\u65b0\u5bfc\u51fa\u76d2\u5b50\u9884\u8bbe"})],y.prototype,"newMoreGamePrefab",void 0),__decorate([o({type:cc.Prefab,displayName:"\u8fd4\u56de\u9996\u9875\u76d2\u5b50\u9884\u8bbe"})],y.prototype,"backHomeMoreGamePrefab",void 0),__decorate([o({type:cc.Prefab,displayName:"\u7537\u6027\u7528\u6237\u76d2\u5b50\u9884\u8bbe"})],y.prototype,"boyMoreGamePrefab",void 0),n=r=__decorate([n],y),i.MoreGameManager=n;var v=function(e,t,a,n,o,i,l,r,s){void 0===s&&(s=""),this.tryGameTime=0,this.QRCode=null,this.switchQRCode=!1,this.gameDesc=null,this.rectIconUrl=null,this.boyGame=!1,this.gameName=e,this.gameIconUrl=t,this.gameAppId=a,this.jumpPath=n,this.switchControl=o,this.redPoint=i,this.QRCode=l,this.switchQRCode=r,this.gameDesc=s};i.MoreGameInfo=v,cc._RF.pop()},{}],MoreGame:[function(e,t,a){"use strict";cc._RF.push(t,"183c2kmImpDrKpRlSiH6QiZ","MoreGame");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("MoreGameItem"),c=n("UserData");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.bg=null,e.board=null,e.closeNode=null,e.moreGameContent=null,e.moreGameItemPrefab=null,e.originalPosition=null,e.originalWidth=0,e.gameItemMap=new Map,e.show=!1,e.closeAction=null,e.partExport=!1,e.currentGender=null,e.itemArrays=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onLoad=function(){this.originalPosition=this.board.position.clone(),this.originalWidth=this.board.width},p.prototype.onEnable=function(){this.board.stopAllActions(),this.board.x=-this.originalWidth,this.showMoreGame()},p.prototype.update=function(){null==this.itemArrays||this.itemArrays.length<=0||this.currentGender!=c.UserData.data.gender&&1==c.UserData.data.gender&&(this.currentGender=c.UserData.data.gender,this.showBoyGame())},p.prototype.bindData=function(e,t){if(null!=e){var a=e.length;console.log(e);for(var n=0;n<a&&n<9;n++)this.createMoreGameItem(e[n],n+1,t)}},p.prototype.createMoreGameItem=function(e,t,a){var n,o=r.GameCommonPool.requestInstant(this.moreGameItemPrefab);null!=o&&(o.setParent(this.moreGameContent),null!=(n=o.getComponent(s.MoreGameItem))&&(this.gameItemMap.set(e,n),n.bindData(e,t,a),n.partExport=this.partExport,o.active=!e.boyGame,this.itemArrays.push(o)))},p.prototype.showMoreGame=function(){var e;this.show||(this.closeNode.opacity=0,this.show=!0,(e=this).board.runAction(cc.sequence(cc.moveTo(.5,this.originalPosition).easing(cc.easeQuarticActionOut()),cc.callFunc(function(){e.closeNode.runAction(cc.fadeIn(.3))}))),this.bg.opacity=0,this.bg.runAction(cc.sequence(cc.delayTime(.2),cc.fadeTo(.5,177))))},p.prototype.showCloseMoreGame=function(){var e;this.show&&(this.show=!1,(e=this).board.runAction(cc.sequence(cc.moveBy(.5,cc.v2(-this.originalWidth,0)).easing(cc.easeQuadraticActionOut()),cc.callFunc(function(){e.node.active=!1,e.closeAction&&e.closeAction()}))))},p.prototype.showBoyGame=function(){for(var e=0,t=this.itemArrays;e<t.length;e++){var a=t[e];null!=a&&(a.active=!0)}},p.prototype.bindCloseAction=function(e){this.closeAction=e},p.prototype.navigateFail=function(){},p.prototype.clickClose=function(){this.showCloseMoreGame()},__decorate([o(cc.Node)],p.prototype,"bg",void 0),__decorate([o(cc.Node)],p.prototype,"board",void 0),__decorate([o(cc.Node)],p.prototype,"closeNode",void 0),__decorate([o(cc.Node)],p.prototype,"moreGameContent",void 0),__decorate([o(cc.Prefab)],p.prototype,"moreGameItemPrefab",void 0),n=__decorate([n],p),i.MoreGame=n,cc._RF.pop()},{}],MultiTouchManager:[function(e,t,a){"use strict";cc._RF.push(t,"244ddnM1cBCGYA7NQhwAV1b","MultiTouchManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.open=!1,e}i=cc.Component,__extends(s,i),(l=s).setCurrentTouchInfo=function(e,t){this.currentTouchId=e,this.currentTouchNodeId=t},s.resetCurrentTouchInfo=function(){this.currentTouchId=-1,this.currentTouchNodeId=null},s.prototype.onLoad=function(){var e,t,a;this.open||(e=cc.Node.prototype.dispatchEvent,cc.Node.prototype.dispatchEvent=function(t){switch(t.type){case"touchstart":if(-1<l.currentTouchId)return;l.setCurrentTouchInfo(t.touch._id,t.getCurrentTarget()._id),e.call(this,t);break;case"touchmove":if(-1===l.currentTouchId)l.setCurrentTouchInfo(t.touch._id,t.getCurrentTarget()._id),e.call(this,t);else{if(l.currentTouchId!=t.touch._id)return;e.call(this,t)}break;case"touchend":case"touchcancel":if(l.currentTouchId!=t.touch._id)return;l.resetCurrentTouchInfo(),e.call(this,t);break;default:e.call(this,t)}},t=cc.Node.prototype._onPostActivated,cc.Node.prototype._onPostActivated=function(e){e||l.currentTouchNodeId!=this._id||l.resetCurrentTouchInfo(),t.call(this,e)},a=cc.Node.prototype._onPreDestroy,cc.Node.prototype._onPreDestroy=function(){l.currentTouchNodeId==this._id&&l.resetCurrentTouchInfo(),a.call(this)})},s.currentTouchId=-1,s.currentTouchNodeId=null,__decorate([r({displayName:"\u5f00\u542f\u591a\u70b9\u89e6\u6478"})],s.prototype,"open",void 0),n=l=__decorate([n],s),o.MultiTouchManager=n,cc._RF.pop()},{}],Necromancer:[function(e,t,a){"use strict";cc._RF.push(t,"32336cXRhZLNY6xpOTpTngc","Necromancer");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("Head"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("GameManager"),d=o("EnumAndConst"),u=o("Timer"),h=o("GameCommonPool"),m=o("EnemyArea"),f=o("SingleEffectManager"),g=o("RoleBase"),y=o("RoleManager"),v=o("GameState"),D=o("SpecailSkill"),E=o("EquipmentEffectSystem");function S(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillCd=5,e.isConjuring=!1,e.isWaitingUseSkill=!1,e.targetData=null,e.prepareSkillTimer=null,e}o=(n=cc._decorator).ccclass,n.property,l=g.RoleBase,__extends(S,l),S.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.roleData=null,this.head=null,this.footRest=null,this.isConjuring=!1,this.isHitAniRunning=!1,this.isWaitingUseSkill=!1,this.targetData=null,this.prepareSkillTimer=null},S.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},S.prototype.update=function(){null!=this.roleData&&(this.refreshDeadState(),this.isWaitingUseSkill&&null!=this.targetData&&this.reviveEnemy(this.targetData))},S.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},S.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.prepareReviveSkill()},S.prototype.prepareReviveSkill=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null),e=this.skillCd,v.GameState.heroModel&&(e*=.75),this.prepareSkillTimer=u.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(m.EnemyArea.reviveReady=!0,t.prepareSkillTimer=null)},this.node))},S.prototype.reviveEnemy=function(e){var t=this;if(null!=this.roleData&&!this.roleData.isDead&&null!=m.EnemyArea.necromancer&&m.EnemyArea.reviveReady){if(this.roleData.isFrozening||this.isHitAniRunning)return this.isWaitingUseSkill=!0,void(this.targetData=e);this.isWaitingUseSkill=!1,this.targetData=null,m.EnemyArea.reviveEnemy(e,!0),this.isConjuring=!0,m.EnemyArea.reviveReady=!1,this.spineController.playAnimation(d.SpineAniNameEnum.Atk,!1,!1,function(){t.isConjuring=!1,t.prepareReviveSkill(),t.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null)})}},S.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isConjuring?this.isHitAniRunning=!1:this.isHitAniRunning||(this.node.stopAllActions(),this.isHitAniRunning=!0,this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,e.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null)}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},S.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.spineController.pauseAnimation(!0),u.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,u.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),u.TimerManager.resumeAllTimers(t.node))},this.node))},S.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||this.prepareSkillTimer&&this.prepareSkillTimer.pauseTimer()},S.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.prepareSkillTimer&&this.prepareSkillTimer.resumeTimer(),y.RoleManager.hitRole(this.roleData))},S.prototype.die=function(){var e=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,f.SingleEffectManager.clearInsertArrows(this.roleData),m.EnemyArea.reviveReady=!1,m.EnemyArea.necromancer=null,this.roleData.isFrozening=!1,this.node.stopAllActions(),u.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),p.GameManager.killEnemy(this.roleData),E.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),this.spineController.playAnimation(d.SpineAniNameEnum.D,!1,!1,function(){u.TimerManager.addTimer(.1,function(){if(null!=e.roleData){if(h.GameCommonPool.returnInstant(e.footRest.node),e.footRest=null,D.SpecailSkill.killBlast(e.roleData))return e.roleData.isDestroy=!0,void e.close();e.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){e.roleData.isDestroy=!0,e.close()})))}},e.node)}))},o=__decorate([o],S),i.Necromancer=o,cc._RF.pop()},{}],NewBezier:[function(e,t,a){"use strict";cc._RF.push(t,"9d334/6D/FDFL+w4/58QSlk","NewBezier");var n=a;function o(e,t,a,n,o){this.total_length=0,this.P0=null,this.P1=null,this.P2=null,this.P3=null,this.speed=0,this.time=0,this.nextControlP1=null,this.lastT2=0,this.P0=e,this.P1=t,this.P2=a,this.P3=n,this.speed=o,this.total_length=this.beze_length(1),null!=a&&null!=n&&(this.nextControlP1=cc.v2(2*n.x-a.x,2*n.y-a.y))}Object.defineProperty(n,"__esModule",{value:!0}),o.prototype.beze_x=function(e){var t=1-e;return t*t*t*this.P0.x+3*t*t*e*this.P1.x+3*t*e*e*this.P2.x+e*e*e*this.P3.x},o.prototype.beze_y=function(e){var t=1-e;return t*t*t*this.P0.y+3*t*t*e*this.P1.y+3*t*e*e*this.P2.y+e*e*e*this.P3.y},o.prototype.beze_speed_x=function(e){var t=1-e;return-3*this.P0.x*t*t+3*this.P1.x*t*t-6*this.P1.x*t*e+6*this.P2.x*t*e-3*this.P2.x*e*e+3*this.P3.x*e*e},o.prototype.beze_speed_y=function(e){var t=1-e;return-3*this.P0.y*t*t+3*this.P1.y*t*t-6*this.P1.y*t*e+6*this.P2.y*t*e-3*this.P2.y*e*e+3*this.P3.y*e*e},o.prototype.beze_speed=function(e){var t=this.beze_speed_x(e);return e=this.beze_speed_y(e),Math.sqrt(t*t+e*e)},o.prototype.beze_length=function(e){var t=Math.floor(100*e);if(1&t&&t++,0==t)return 0;for(var a=t/2,n=0,o=0,i=e/t,l=0;l<a;l++)n+=this.beze_speed((2*l+1)*i);for(var r=1;r<a;r++)o+=this.beze_speed(2*r*i);return(this.beze_speed(0)+this.beze_speed(1)+2*o+4*n)*i/3},o.prototype.beze_even=function(e){for(var t,a=e*this.total_length,n=e,o=1;;){if(30<++o)return this.lastT2+=.005,this.lastT2;if(t=n-(this.beze_length(n)-a)/this.beze_speed(n),Math.abs(n-t)<1e-7)break;n=t}return this.lastT2=t},o.prototype.totalTime=function(){return this.total_length/this.speed},o.prototype.isDone=function(){return 1<=this.time*this.speed/this.total_length},o.prototype.update=function(e){if(this.time+=e,1<=(t=this.time*this.speed/this.total_length))return this.P3.clone();t=cc.misc.clamp01(t);var t=this.beze_even(t);return e=this.beze_x(t),t=this.beze_y(t),cc.v2(cc.misc.clampf(e,-1250,1250),cc.misc.clampf(t,-1250,1250))},o.step=70,n.NewBezier=o,cc._RF.pop()},{}],NewLaser:[function(e,t,a){"use strict";cc._RF.push(t,"304be0ZFANHLLuAJl5xIW8h","NewLaser");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("WorldEventManager"),s=o("LocalWorldEventType"),c=o("GameCommonPool"),p=o("GameState"),d=o("EnumAndConst"),u=o("Head"),h=o("RoleManager"),m=o("LocalData"),f=o("Body"),g=o("Shield"),y=o("LocalSoundManager"),v=o("BattleNodeManager"),D=o("EnemyArea"),E=o("MagicBallBlast"),S=o("GameManager"),A=o("ConfigData");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.speed=1500,e.atk=null,e.userData=null,e.attackTargetData=null,e.lastHurtData=null,e.isClosed=!1,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(C,l),C.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),this.atk=null,this.userData=null,this.attackTargetData=null,this.lastHurtData=null,this.isClosed=!1},C.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},C.prototype.bindData=function(e,t,a){null!=e&&null!=t&&null!=a&&(this.atk=e,this.userData=t,this.attackTargetData=a,this.userData.isBoss?this.node.scale=1:this.node.scale=.5,this.moveAction())},C.prototype.moveAction=function(){var e=this,t=this.node.position.sub(this.attackTargetData.logicPos),a=180*-cc.v2(t).signAngle(cc.Vec2.RIGHT)/Math.PI;this.node.angle=a,t=t.mag()/this.speed,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(t,this.attackTargetData.logicPos),cc.callFunc(function(){e.isClosed||e.blast(null)})))},C.prototype.onCollisionEnter=function(e,t){null!=this.userData&&p.GameState.isGaming&&(e.node.group!=d.GroupNameEnum.HEAD?e.node.group!=d.GroupNameEnum.BODY?e.node.group!=d.GroupNameEnum.SHIELD||this.collideShield(e,t):this.collideBody(e,t):this.collideHead(e,t))},C.prototype.collideHead=function(e,t){var a,n,o=e.getComponent(u.Head);null!=o&&(null==(a=o.roleData)||a.isDead||a.isTeleporting||a==this.userData||a==this.lastHurtData||a.isEnemy==this.userData.isEnemy||(n=a.helmetDefense,null!=o.helmet&&0<n?this.collideHelmet(e,t,o,a):(this.lastHurtData=a,o=this.getFinalDamage(a),h.RoleManager.roleIsDamaged(a,this.userData,o,a.logicPos),a.isPlayer&&this.blast(a))))},C.prototype.collideHelmet=function(e,t,a,n){this.lastHurtData=n;var o=this.getFinalDamage(n);h.RoleManager.equipmentIsDamaged(n,m.EquipmentType.helmet,this.userData,o,n.logicPos),null!=a.helmet&&a.helmet.node.active&&n.helmetDefense<=0&&(a.helmet.drop(-100,200),a.helmet=null),n.isPlayer&&this.blast(n)},C.prototype.collideBody=function(e){var t=e.getComponent(f.Body);null!=t&&(null==(e=t.roleData)||e.isDead||e.isTeleporting||e==this.userData||e==this.lastHurtData||e.isEnemy==this.userData.isEnemy||(this.lastHurtData=e,t=this.getFinalDamage(e),h.RoleManager.roleIsDamaged(e,this.userData,t,e.logicPos),e.isPlayer&&this.blast(e)))},C.prototype.collideShield=function(e){var t,a=e.getComponent(g.Shield);null!=a&&(null==(t=a.roleData)||t.isDead||t.isTeleporting||t==this.userData||t==this.lastHurtData||t.isEnemy==this.userData.isEnemy||(this.lastHurtData=t,e=this.getFinalDamage(t),h.RoleManager.equipmentIsDamaged(t,m.EquipmentType.shield,this.userData,e,t.logicPos),t.shieldDefense<=0&&a.drop(-100,200),t.isPlayer&&this.blast(t)))},C.prototype.getFinalDamage=function(e){if(null==e)return 0;var t=this.atk;return!e.isPlayer&&this.userData.isBoss?A.ConfigData.MAX_DAMAGE:t},C.prototype.blast=function(e){var t,a,n;this.isClosed||(this.isClosed=!0,y.LocalSoundManager.playBlastAudio(),this.userData.isBoss&&S.GameManager.shakeEffect(.5),null!=(t=v.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE))&&(null==(n=D.EnemyArea.createMaigcBallBlast())||null!=(a=n.getComponent(E.MagicBallBlast))&&(n.setParent(t),n.setPosition(A.ConfigData.PLYAER_POS),n=this.userData.isBoss?2:1,a.showBlast(this.userData,e,!0,n,!1),this.close())))},C.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},o=__decorate([o],C),i.NewLaser=o,cc._RF.pop()},{}],NewRewardUI:[function(e,t,a){"use strict";cc._RF.push(t,"0861b2SkH1HPohrmxk4faNn","NewRewardUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RewardItem"),s=n("GameCommonPool"),c=n("LocalSoundManager");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.rewardPrefab=null,e.itemNode=null,e.board=null,e.rewardItem=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){this.board.stopAllActions(),this.board.scale=.1,this.board.runAction(cc.scaleTo(.3,1))},p.prototype.bind=function(e,t){if(null!=e){if(null==this.rewardItem){var a=s.GameCommonPool.requestInstant(this.rewardPrefab);if(null==a)return;a.setParent(this.itemNode),a.position=cc.v2(),a=a.getComponent(r.RewardItem),this.rewardItem=a}this.rewardItem.bindData(e),this.closeAction=t}},p.prototype.clickClose=function(){c.LocalSoundManager.playAudio("click"),this.closeAction&&this.closeAction(),this.closeAction=null,this.close()},p.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Prefab,displayName:"\u5956\u52b1\u9884\u8bbe"})],p.prototype,"rewardPrefab",void 0),__decorate([o({type:cc.Node,displayName:"\u5956\u52b1\u8282\u70b9"})],p.prototype,"itemNode",void 0),__decorate([o({displayName:"\u4e3b\u9762\u677f",type:cc.Node})],p.prototype,"board",void 0),n=__decorate([n],p),i.NewRewardUI=n,cc._RF.pop()},{}],NoobGuide:[function(e,t,a){"use strict";cc._RF.push(t,"db750v6BqpAg6sNCrz2tE7e","NoobGuide");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("GameManager"),c=n("EnumAndConst"),p=n("UIManager");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.animation=null,e.roleUpSpineAni=null,e.weaponNode=null,e.finger=null,e.aimingLine=null,e.widget=[],e.startPoint=cc.v2(0,30),e.weaponBone=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){this.widget.forEach(function(e){e.updateAlignment()}),this.animation.play("NoobGuide"),this.weaponBone=this.roleUpSpineAni.findBone(c.BoneNameEnum.WEAPON)},d.prototype.update=function(){if(p.UIManager.isMainUI)return this.animation.stop(),void r.GameCommonPool.returnInstant(this.node);this.refreshWeapon(),this.refreshAim()},d.prototype.bindData=function(e){null==this.closeAction&&(this.closeAction=e)},d.prototype.refreshAim=function(){var e=this.finger.position,t=10*(n=e.sub(this.startPoint)).mag();if(!(t<=0)){var a=cc.Vec2.RIGHT;e.x<this.startPoint.x&&(a=a.neg()),a=(n=180*-cc.v2(n).signAngle(a)/Math.PI)+30*this.roleUpSpineAni.node.scaleX,this.roleUpSpineAni.node.angle=a,a=Math.sin(n*Math.PI/180);for(var n=Math.cos(n*Math.PI/180),o=cc.v2(n,a).mul(t),i=[],l=4+Math.floor(t/1200*10),r=cc.v2(o),c=cc.Vec2.ZERO,p=0;p<l;p++){var d=c.add(r.normalize().mul(18));i.push(d);var u=Math.abs(d.x-c.x)/o.x;r.y+=u*s.GameManager.getGravity(),c=d}for(this.aimingLine.clear(),p=0;p<i.length;p++)p<2||(d=i[p])&&this.aimingLine.circle(d.x,d.y,3);this.aimingLine.fill()}},d.prototype.refreshWeapon=function(){var e=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY);e=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),e=this.node.convertToNodeSpaceAR(e),this.weaponNode.position=e,this.aimingLine.node.position=e,this.weaponNode.angle=this.roleUpSpineAni.node.angle-30*this.roleUpSpineAni.node.scaleX,this.weaponNode.scaleX=.2*this.roleUpSpineAni.node.scaleX},d.prototype.clickClose=function(){this.animation.stop(),r.GameCommonPool.returnInstant(this.node),this.closeAction&&this.closeAction(),this.closeAction=null},__decorate([o({displayName:"\u5e27\u52a8\u753b",type:cc.Animation})],d.prototype,"animation",void 0),__decorate([o({displayName:"\u4e0a\u534a\u8eabspine\u52a8\u753b",type:sp.Skeleton})],d.prototype,"roleUpSpineAni",void 0),__decorate([o({displayName:"\u6b66\u5668",type:cc.Node})],d.prototype,"weaponNode",void 0),__decorate([o({displayName:"\u624b\u6307",type:cc.Node})],d.prototype,"finger",void 0),__decorate([o({displayName:"\u7784\u51c6\u7ebf",type:cc.Graphics})],d.prototype,"aimingLine",void 0),__decorate([o({type:cc.Widget})],d.prototype,"widget",void 0),n=__decorate([n],d),i.NoobGuide=n,cc._RF.pop()},{}],NpcRole:[function(e,t,a){"use strict";cc._RF.push(t,"19fd3aVlwtK+KhWXQkhZ0ag","NpcRole");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameCommonPool");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.npcSprite=null,e.npcSpriteFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this)},d.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},d.prototype.bindData=function(e){this.npcSprite.spriteFrame=this.getNpcSpriteFrame(e),this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.5,0,20),cc.moveBy(.5,0,-20))))},d.prototype.close=function(){p.GameCommonPool.returnInstant(this.node)},d.prototype.getNpcSpriteFrame=function(e){if(null!=e){var t=null;switch(e){case r.RandomIncidentTypeEnum.ANGEL:t=0;break;case r.RandomIncidentTypeEnum.DEMON:t=1;break;case r.RandomIncidentTypeEnum.RECLUSE:t=2;break;case r.RandomIncidentTypeEnum.PROFITEER:t=3;break;case r.RandomIncidentTypeEnum.NEWRECLUSE:t=2}return e=this.npcSpriteFrames.length,t<0||e<=t?null:this.npcSpriteFrames[t]}},__decorate([o({displayName:"npc\u56fe\u7247",type:cc.Sprite})],d.prototype,"npcSprite",void 0),__decorate([o({displayName:"npc\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],d.prototype,"npcSpriteFrames",void 0),n=__decorate([n],d),i.NpcRole=n,cc._RF.pop()},{}],NumberImg:[function(e,t,a){"use strict";cc._RF.push(t,"17a48XKpBlIL5JbjeSmXAUz","NumberImg");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.numberImgArray=new Array,e.numberArray=new Array,e}i=cc.Component,__extends(s,i),l=s,Object.defineProperty(s.prototype,"value",{set:function(e){for(var t=new Array,a=0;a<e.length;a++){var n=e[a];-1==(n=l.NumberImgIndex.indexOf(n))||null!=(n=this.numberImgArray[n])&&t.push(n)}for(var o=0;o<this.numberArray.length;o++){var i,r=this.numberArray[o];null!=r&&(null==(i=t[o])?r.node.active=!1:(r.node.active=!0,r.spriteFrame=i))}},enumerable:!0,configurable:!0}),s.NumberImgIndex=["0","1","2","3","4","5","6","7","8","9","x","l","v",".","/"],__decorate([r([cc.SpriteFrame])],s.prototype,"numberImgArray",void 0),__decorate([r([cc.Sprite])],s.prototype,"numberArray",void 0),n=l=__decorate([n],s),o.NumberImg=n,cc._RF.pop()},{}],Operate:[function(e,t,a){"use strict";cc._RF.push(t,"d0b570ELxlNYZAh4seyf+GB","Operate");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("EnumAndConst"),s=o("PlayerState");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.fragDis=20,e.touchStartPoint=null,e.touchPoint=null,e.aimDirection=null,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(c,l),c.prototype.onEnable=function(){this.touchStartPoint=null,this.touchPoint=null,this.aimDirection=null,this.addEventListener()},c.prototype.onDisable=function(){this.removeEventListener()},c.prototype.addEventListener=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},c.prototype.removeEventListener=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchCancel,this)},c.prototype.onTouchStart=function(e){var t;e&&(null==(t=s.PlayerState.playerData)||t.isDead||(this.touchStartPoint=e.getLocation()))},c.prototype.onTouchMove=function(e){if(e&&this.touchStartPoint){var t=s.PlayerState.playerData;if(null!=t&&!t.isDead){if(this.touchPoint=e.getLocation(),this.aimDirection==r.AimDirectionEnum.RIGHT&&this.touchPoint.x<this.touchStartPoint.x||this.aimDirection==r.AimDirectionEnum.LEFT&&this.touchPoint.x>this.touchStartPoint.x)return t.attackAngle=null,void(t.attackPower=null);var a=this.touchPoint.sub(this.touchStartPoint),n=a.mag();if(n<=this.fragDis)return t.attackAngle=null,void(t.attackPower=null);null==this.aimDirection&&(this.touchPoint.x>this.touchStartPoint.x?this.aimDirection=r.AimDirectionEnum.RIGHT:this.touchPoint.x<this.touchStartPoint.x&&(this.aimDirection=r.AimDirectionEnum.LEFT)),e=8*(n-this.fragDis)+400,n=cc.Vec2.RIGHT,this.touchPoint.x<this.touchStartPoint.x&&(n=n.neg()),n=180*-a.signAngle(n)/Math.PI,t.attackAngle=n,t.attackPower=e}}},c.prototype.onTouchEnd=function(e){var t,a;e&&(this.touchPoint=e.getLocation(),null!=this.touchPoint&&null!=this.touchStartPoint)&&(null==(t=s.PlayerState.playerData)||t.isDead||(this.aimDirection==r.AimDirectionEnum.RIGHT&&this.touchPoint.x<this.touchStartPoint.x||this.aimDirection==r.AimDirectionEnum.LEFT&&this.touchPoint.x>=this.touchStartPoint.x?(this.touchStartPoint=null,this.touchPoint=null,this.aimDirection=null,t.attackAngle=null,(t.attackPower=null)!=(a=s.PlayerState.player)&&a.playRunOrStayAni(!1)):(e=this.touchPoint.sub(this.touchStartPoint).mag(),this.touchStartPoint=null,this.touchPoint=null,this.aimDirection=null,t.attackAngle=null,t.attackPower=null,e<=this.fragDis?null!=(a=s.PlayerState.player)&&a.playRunOrStayAni(!1):t.isAttack=!0)))},c.prototype.onTouchCancel=function(e){e&&(this.touchStartPoint=null,this.touchPoint=null,this.aimDirection=null,(e=s.PlayerState.playerData).attackAngle=null,e.attackPower=null)},o=__decorate([o],c),i.Operate=o,cc._RF.pop()},{}],PlayerManager:[function(e,t,a){"use strict";cc._RF.push(t,"0e44a2znaVFmqQyEjQScwfT","PlayerManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("RoleBody"),c=n("BattleNodeManager"),p=n("EnumAndConst"),d=n("Arrow"),u=n("Shield"),h=n("GameCommonPool"),m=n("Helmet"),f=n("FootRest");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.playerBodyPrefab=null,e.roleHeadPrefab=null,e.arrowPrefab=null,e.shieldPrefab=null,e.helmetPrefab=null,e.footRestPrefab=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),r=g,Object.defineProperty(g,"Instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),g.prototype.onEnable=function(){r._instance=this},g.createRoleBody=function(e){var t=r.Instance;if(null!=t){var a=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.ROLE_BODY_NODE);if(null!=a&&null!=(t=cc.instantiate(t.playerBodyPrefab))&&(t.setParent(a),t.setPosition(cc.v2(9999,9999)),e&&(r.playerBody=t),null!=(t=t.getComponent(s.RoleBody))))return t}},g.createRoleHead=function(){var e=r.Instance;if(null!=e){var t=cc.instantiate(e.roleHeadPrefab);if(null!=t&&null!=(e=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.ROLE_HEAD_NODE)))return t.setParent(e),t.setPosition(cc.v2(9999,9999)),t}},g.createArrow=function(e){if(null!=(t=r.Instance)){var t,a=t.arrowPrefab;return(t=cc.instantiate(a))?null==(a=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.ARROW_NODE))?void 0:(t.setParent(a),t.setPosition(e),t.getComponent(d.Arrow)):null}},g.createShield=function(e){if(null!=(t=r.Instance)){var t,a=t.shieldPrefab;return(t=h.GameCommonPool.requestInstant(a))?null==(a=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.SHIRLD_NODE))?void 0:(t.setParent(a),t.setPosition(e),t.getComponent(u.Shield)):null}},g.createHelmet=function(e){if(null!=(t=r.Instance)){var t,a=t.helmetPrefab;return(t=h.GameCommonPool.requestInstant(a))?null==(a=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.HELMET_NODE))?void 0:(t.setParent(a),t.setPosition(e),t.getComponent(m.Helmet)):null}},g.createFootRest=function(){if(null!=(e=r.Instance)){var e,t=e.footRestPrefab;return(e=h.GameCommonPool.requestInstant(t))?null==(t=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.FOOT_REST_NODE))?void 0:(e.setParent(t),e.getComponent(f.FootRest)):null}},g._instance=null,g.playerBody=null,__decorate([o({displayName:"\u73a9\u5bb6\u8eab\u4f53\u9884\u8bbe",type:cc.Prefab})],g.prototype,"playerBodyPrefab",void 0),__decorate([o({displayName:"\u89d2\u8272\u5934\u90e8\u9884\u8bbe",type:cc.Prefab})],g.prototype,"roleHeadPrefab",void 0),__decorate([o({displayName:"\u7bad\u9884\u5236\u4f53",type:cc.Prefab})],g.prototype,"arrowPrefab",void 0),__decorate([o({displayName:"\u76fe\u724c\u9884\u5236\u4f53",type:cc.Prefab})],g.prototype,"shieldPrefab",void 0),__decorate([o({displayName:"\u5934\u76d4\u9884\u5236\u4f53",type:cc.Prefab})],g.prototype,"helmetPrefab",void 0),__decorate([o({displayName:"\u811a\u8e0f\u677f\u9884\u5236\u4f53",type:cc.Prefab})],g.prototype,"footRestPrefab",void 0),n=r=__decorate([n],g),i.PlayerManager=n,cc._RF.pop()},{}],PlayerRoleUI:[function(e,t,a){"use strict";cc._RF.push(t,"f50d0sV73hDU4DFSm5ASw7X","PlayerRoleUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LocalData"),s=n("SpriteFrameManager"),c=n("EnumAndConst"),p=n("ConfigData"),d=n("CloakController"),u=n("EquipmentConfigData");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.roleAni=null,e.weapon=null,e.helmet=null,e.helmetEffect=null,e.shield=null,e.cloakNode=null,e.weaponData=null,e.helmetData=null,e.shieldData=null,e.cloakData=null,e.centerBone=null,e.weaponBone=null,e.helmetBone=null,e.shieldBone=null,e.cloakBone=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onLoad=function(){this.centerBone=this.roleAni.findBone(c.BoneNameEnum.CENTER),this.weaponBone=this.roleAni.findBone(c.BoneNameEnum.WEAPON),this.helmetBone=this.roleAni.findBone(c.BoneNameEnum.HEAD),this.shieldBone=this.roleAni.findBone(c.BoneNameEnum.SHIELD),this.cloakBone=this.roleAni.findBone(c.BoneNameEnum.CLOAK),this.cloakNode.scaleX=.2},h.prototype.onEnable=function(){this.refreshWeapon(),this.refreshHelmet(),this.refreshShield(),this.refreshCloak()},h.prototype.update=function(){r.LocalData.getEquippedEquipment(r.EquipmentType.weapon)&&this.weaponData!=r.LocalData.getEquippedEquipment(r.EquipmentType.weapon)&&this.refreshWeapon(),r.LocalData.getEquippedEquipment(r.EquipmentType.helmet)&&this.helmetData!=r.LocalData.getEquippedEquipment(r.EquipmentType.helmet)&&this.refreshHelmet(),r.LocalData.getEquippedEquipment(r.EquipmentType.shield)&&this.shieldData!=r.LocalData.getEquippedEquipment(r.EquipmentType.shield)&&this.refreshShield(),r.LocalData.getEquippedEquipment(r.EquipmentType.cloak)&&this.cloakData!=r.LocalData.getEquippedEquipment(r.EquipmentType.cloak)&&this.refreshCloak(),this.refreshLocaltion()},h.prototype.refreshLocaltion=function(){var e=cc.v2(this.helmetBone.worldX,this.helmetBone.worldY);this.helmet.node.position=e,this.helmet.node.angle=this.centerBone.rotation,e=cc.v2(this.shieldBone.worldX,this.shieldBone.worldY),this.shield.node.position=e,this.shield.node.angle=this.centerBone.rotation,e=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY),this.weapon.node.position=e,this.weapon.node.angle=this.roleAni.node.angle-30,e=cc.v2(this.cloakBone.worldX,this.cloakBone.worldY),this.cloakNode.position=e,this.cloakNode.angle=this.roleAni.node.angle},h.prototype.refreshWeapon=function(){var e=r.LocalData.getEquippedEquipment(r.EquipmentType.weapon);null==e||(this.weaponData=e,this.weapon.spriteFrame=s.SpriteFrameManager.getLaunchWeaponSpriteFrame(e.index,e.rank),e.index<0||e.index>=p.ConfigData.weaponConfigDatas.length)||null!=(e=p.ConfigData.weaponConfigDatas[e.index])&&(this.weapon.node.anchorX=e.holdAnchorX,this.weapon.node.anchorY=e.holdAnchorY)},h.prototype.refreshHelmet=function(){var e=r.LocalData.getEquippedEquipment(r.EquipmentType.helmet);if(null==e)return this.helmet.spriteFrame=null,void(this.helmetEffect.node.active=!1);this.helmetData=e,this.helmet.spriteFrame=s.SpriteFrameManager.getHelmetSpriteFrame(e.index,e.rank);var t=(4<=e.rank?u.EquipmentConfigData.awakeningHelmetConfigDatas:u.EquipmentConfigData.helmetConfigDatas)[e.index];this.helmet.node.anchorX=t.anchorX,this.helmet.node.anchorY=t.anchorY,t.hasEffect?(e="HelmetEffect"+e.index,this.helmetEffect.node.active=!0,this.helmetEffect.node.anchorX=t.effectAnchorX,this.helmetEffect.node.anchorY=t.effectAnchorY,this.helmetEffect.play(e)):this.helmetEffect.node.active=!1},h.prototype.refreshShield=function(){var e=r.LocalData.getEquippedEquipment(r.EquipmentType.shield);null!=e?(this.shieldData=e,this.shield.spriteFrame=s.SpriteFrameManager.getShieldSpriteFrame(e.index,e.rank)):this.shield.spriteFrame=null},h.prototype.refreshCloak=function(){var e,t=r.LocalData.getEquippedEquipment(r.EquipmentType.cloak);null!=t?(this.cloakNode.active=!0,this.cloakData=t,null!=(e=this.cloakNode.getComponent(d.CloakController))&&e.selectCloak(t.index)):this.cloakNode.active=!1},__decorate([o({displayName:"\u9aa8\u9abc\u52a8\u753b",type:sp.Skeleton})],h.prototype,"roleAni",void 0),__decorate([o({displayName:"\u6b66\u5668",type:cc.Sprite})],h.prototype,"weapon",void 0),__decorate([o({displayName:"\u5934\u76d4",type:cc.Sprite})],h.prototype,"helmet",void 0),__decorate([o({displayName:"\u5934\u76d4\u7279\u6548\u52a8\u753b",type:cc.Animation})],h.prototype,"helmetEffect",void 0),__decorate([o({displayName:"\u76fe\u724c",type:cc.Sprite})],h.prototype,"shield",void 0),__decorate([o({displayName:"\u62ab\u98ce",type:cc.Node})],h.prototype,"cloakNode",void 0),n=__decorate([n],h),i.PlayerRoleUI=n,cc._RF.pop()},{}],PlayerState:[function(e,t,a){"use strict";cc._RF.push(t,"d4557cTHupIk44XFm8tkn7G","PlayerState");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("RoleManager"),l=n("Player");function r(){}r.bindPlayer=function(e,t,a,n){var o=e.getComponent(l.Player);null!=o&&(o.bindData(t,a,n),r.player=o,t.logicPos=e.position,i.RoleManager.addRole(t.id,o))},r.reviveCount=0,r.player=null,r.playerData=null,n=r,o.PlayerState=n,cc._RF.pop()},{}],PlayerTip:[function(e,t,a){"use strict";cc._RF.push(t,"00bcayaAaRC84vS/+O1yKc7","PlayerTip");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.tipSprite=null,e.tipSpriteFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.bindData=function(e){var t=this;null==e||e<0||e>=this.tipSpriteFrames.length||(this.tipSprite.spriteFrame=this.tipSpriteFrames[e],this.tipSprite.node.stopAllActions(),this.tipSprite.node.x=-100,this.tipSprite.node.opacity=0,this.tipSprite.node.runAction(cc.sequence(cc.spawn(cc.moveTo(.2,0,70),cc.fadeIn(.2)),cc.delayTime(1),cc.spawn(cc.moveTo(.2,100,70),cc.fadeOut(.2)),cc.callFunc(function(){r.GameCommonPool.returnInstant(t.node)}))))},__decorate([o({displayName:"\u63d0\u793a\u56fe\u7247",type:cc.Sprite})],s.prototype,"tipSprite",void 0),__decorate([o({displayName:"\u63d0\u793a\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"tipSpriteFrames",void 0),n=__decorate([n],s),i.PlayerTip=n,cc._RF.pop()},{}],Player:[function(e,t,a){"use strict";cc._RF.push(t,"0930dDeOstIsoZakPTdKY7M","Player");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameManager"),c=n("SkillSystem"),p=n("SpecailSkill"),d=n("Head"),u=n("WorldEventManager"),h=n("LocalWorldEventType"),m=n("ConfigData"),f=n("LocalData"),g=n("GameConfigData"),y=n("Timer"),v=n("SingleEffectManager"),D=n("EnemyArea"),E=n("Util"),S=n("LocalSoundManager"),A=n("LongRoleBase"),C=n("RoleManager"),M=n("GameState"),T=n("EffectCreate"),_=n("PlayerManager");function k(){var e=null!==l&&l.apply(this,arguments)||this;return e.aimLine=null,e.aimLinePoints=[],e.minForce=400,e.maxAngle=80,e.minAngle=-30,e.currentRoleAngle=0,e.isAttacking=!1,e.reviveHalo=null,e.weaponConfig=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=A.LongRoleBase,__extends(k,l),k.prototype.onEnable=function(){u.WorldEventManager.addListener(h.LocalWorldEventType.BackHome,this.close,this),this.roleData=null,this.targetForceMagnitude=0,this.currentRoleAngle=0,this.head=null,this.shield=null,this.currentArrow=null,this.fireCount=1,this.fireTimeScale=1,this.launchDelayTime=0,this.isAttacking=!1,this.reviveHalo=null,this.weaponConfig=null,this.roleUp.angle=0},k.prototype.onDisable=function(){u.WorldEventManager.removeListener(h.LocalWorldEventType.BackHome,this.close,this)},k.prototype.update=function(e){null!=this.roleData&&(this.refreshEquipmentState(),this.aim(),this.attack(),this.refreshTime(e),null!=this.reviveHalo&&(this.reviveHalo.angle=this.roleUp.angle))},k.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(d.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),null!=this.currentArrow&&this.currentArrow.bindData(e),this.weaponConfig=m.ConfigData.weaponConfigDatas[this.roleData.weaponIndex],this.playRunOrStayAni(!1),this.equipHelmet(),this.equipShield(),this.equipWeapon(),this.equipCloak()},k.prototype.aim=function(){if(!this.isAttacking&&null!=this.roleData&&!this.roleData.isDead&&!this.roleData.isDestroy)if(null!=this.roleData.attackAngle&&null!=this.roleData.attackPower){if(null!=this.currentArrow){var e=this.roleData.attackAngle;e=Math.min(e,this.maxAngle),e=Math.max(e,this.minAngle),this.spineController.pauseAnimation(!0);var t=e+30*this.roleUp.scaleX;this.roleUp.angle=t,this.targetForceMagnitude=this.roleData.attackPower;var a=c.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.FAST_ATTACK);t=g.GameConfigData.data.talentData[3]*f.LocalData.getTalentLevel(3),a=this.weaponConfig.maxForce*(1+a+t),a=Math.min(a,g.GameConfigData.data.weaponMaxForce),t=this.roleData.isFrozening?a/2:a,a=this.roleData.isFrozening?this.minForce/2:this.minForce,this.targetForceMagnitude=Math.max(this.targetForceMagnitude,a),this.targetForceMagnitude=Math.min(this.targetForceMagnitude,t),t=Math.sin(e*Math.PI/180),e=Math.cos(e*Math.PI/180);for(var n=cc.v2(e,t).mul(this.targetForceMagnitude),o=[],i=Math.floor(20*this.targetForceMagnitude/g.GameConfigData.data.weaponMaxForce),l=cc.v2(n),s=l.normalize().mul(30),p=this.weaponConfig.gravity,d=0;d<i;d++){var u=s.add(l.normalize().mul(18));o.push(u);var h=Math.abs(u.x-s.x)/n.x;l.y+=h*p,s=u}for(this.aimLine.active=!0,d=0;d<this.aimLinePoints.length;d++){var m,y=this.aimLinePoints[d];null!=y&&((m=o[d])?(y.active=!0,y.position=m):y.active=!1)}}}else this.cancelAttack()},k.prototype.attack=function(){null==this.roleData||this.roleData.isDead||this.roleData.isAttack&&(this.roleData.isAttack=!1,this.isAttacking||(null!=this.roleData.attackAngle&&null!=this.roleData.attackPower&&(this.spineController.refreshWeapon(),this.roleData.attackAngle=null,this.roleData.attackPower=null),this.aimLine.active=!1,0!=this.targetForceMagnitude&&(this.spineController.pauseAnimation(!1),0<c.SkillSystem.getSkillLevel(r.SkillTypeEnum.RUNNINGFIRE)?(this.fireCount=2,this.fireTimeScale=1.5):(this.fireCount=1,this.fireTimeScale=1),this.launchDelayTime=.05/this.fireTimeScale,this.launch(),c.SkillSystem.getSkillLevel(r.SkillTypeEnum.SHAKER_SPRINT)<=0||Math.random()<.2&&D.EnemyArea.createPlayerFriendSharker())))},k.prototype.cancelAttack=function(){this.isAttacking=!1,this.roleData.attackAngle=null,this.roleData.attackPower=null,this.aimLine.active=!1},k.prototype.launch=function(){var e,t,a,n=this;null!=this.roleData&&!this.roleData.isDead&&this.currentArrow&&(e=this.currentArrow.node.position,this.roleData.weaponLaunch=!0,t=this.currentArrow.node.angle,a=Math.sin(t*Math.PI/180),t=Math.cos(t*Math.PI/180),t=cc.v2(t,a).mul(this.targetForceMagnitude),a=c.SkillSystem.getSkillLevel(r.SkillTypeEnum.DIVISION),this.currentArrow.launch(t,this.launchDelayTime,a),0<a&&(a=c.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.DIVISION),p.SpecailSkill.division(this.currentArrow,a)),this.isAttacking=!0,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_atk_nwp_a_lance,!1,!1,function(){1<n.fireCount?(n.fireCount--,n.equipWeapon(e),n.launch()):(n.isAttacking=!1,n.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null),n.equipWeapon())},this.fireTimeScale),this.currentArrow=null)},k.prototype.isHit=function(){this.isHitAniRunning=!1},k.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,e=this.roleData.frozenTime,y.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1)},this.node))},k.prototype.refreshTime=function(e){var t,a,n,o=this;null!=this.roleData&&!this.roleData.isDead&&(0<this.roleData.invincibleTime&&(this.roleData.invincibleTime-=e),M.GameState.isGaming)&&(null!=(t=c.SkillSystem.getSkillLevel(r.SkillTypeEnum.DIVINE_SHIELD))&&0<t&&(this.roleData.divineShieldCDTime-=e,this.roleData.divineShieldCDTime<=0&&(p.SpecailSkill.createSkillEffectInPlayer(r.SkillTypeEnum.DIVINE_SHIELD,this.roleData),this.roleData.invincibleTime=5,this.roleData.divineShieldCDTime=15)),null!=(t=c.SkillSystem.getSkillLevel(r.SkillTypeEnum.THUNDERBOLT))&&0<t&&(this.roleData.thunderBoltCDTime-=e,this.roleData.thunderBoltCDTime<=0)&&(this.roleData.thunderBoltCDTime=10,null==(e=D.EnemyArea.enemyDataArray)||e.length<=0||(a=[],e.forEach(function(e){null==e||e.isBoss||e.isDead||e.isTeleporting||0<e.invincibleTime||a.push(e)}),a.length<=0||null==(n=E.Util.getRandomValueFromArray(a))||n.isDead||T.EffectCreate.createLightning(n,function(){S.LocalSoundManager.playAudio("lightning"),C.RoleManager.roleIsDamaged(n,o.roleData,m.ConfigData.MAX_DAMAGE,n.logicPos)}))))},k.prototype.restoreRoleStatus=function(e,t){if(null!=this.roleData&&!this.roleData.isDead){var a=this.roleData,n=a.hp>=a.maxHp,o=null!=a.helmetIndex&&!a.helmetDroped,i=null!=a.shieldIndex&&!a.shieldDroped,l=a.helmetDefense>=a.maxHelmetDefense,r=a.shieldDefense>=a.maxShieldDefense;if(n){var s=null==a.helmetIndex?1:a.helmetDefense/a.maxHelmetDefense,c=null==a.shieldIndex?1:a.shieldDefense/a.maxShieldDefense;return n=null,i&&o?l&&r?(e&&(t=a.maxHp*t),void this.restoreHp(t)):(n=c<=s?(e&&(t=a.maxShieldDefense*t),f.EquipmentType.shield):(e&&(t=a.maxHelmetDefense*t),f.EquipmentType.helmet),void this.repairEquipment(n,t)):i&&!o?r?(e&&(t=a.maxHp*t),void this.restoreHp(t)):(e&&(t=a.maxShieldDefense*t),n=f.EquipmentType.shield,void this.repairEquipment(n,t)):i||!o||l?(e&&(t=a.maxHp*t),void this.restoreHp(t)):(e&&(t=a.maxHelmetDefense*t),n=f.EquipmentType.helmet,void this.repairEquipment(n,t))}e&&(t=a.maxHp*t),this.restoreHp(t)}},k.prototype.equipWeapon=function(e){void 0===e&&(e=null),this.currentArrow||(this.currentArrow=_.PlayerManager.createArrow(this.roleData.logicPos),this.currentArrow&&(this.currentArrow.bindData(this.roleData),this.spineController.equipWeapon(this.currentArrow.node),this.roleData.weaponLaunch=!1,e?(this.currentArrow.node.position=e,this.currentArrow.node.angle=this.roleUp.angle-30*this.roleUp.scaleX,this.currentArrow.node.scaleX=m.ConfigData.getEquipmentScale(this.roleData,f.EquipmentType.weapon)):this.spineController.refreshWeapon()),this.aimLine.active=!1)},k.prototype.changeWeapon=function(){this.currentArrow&&(this.currentArrow.node.destroy(),this.currentArrow=null),this.equipWeapon()},k.prototype.equipCloak=function(){var e=f.LocalData.getEquippedEquipment(f.EquipmentType.cloak);null!=e?this.spineController.equipCloak(e.index):this.spineController.equipCloak(null)},k.prototype.playRunOrStayAni=function(e,t){void 0===t&&(t=2),null==this.roleData||this.roleData.isDead||(e?(v.SingleEffectManager.showThornsChainsEffect(!0,t),v.SingleEffectManager.clearInsertArrows(this.roleData),this.spineController.playAnimation(r.SpineAniNameEnum.Run2,!0,!0,null)):(v.SingleEffectManager.stopMoveThornsChainsEffects(),this.isAttacking||(this.isAttacking=!1,this.spineController.playAnimation(r.SpineAniNameEnum.Hero_st_nwp_a,!1,!0,null))))},k.prototype.win=function(){this.cancelAttack(),this.roleUp.angle=0,this.spineController.pauseAnimation(!1),this.spineController.playAnimation(r.SpineAniNameEnum.Win,!0,!0,null)},k.prototype.die=function(){var e;null==this.roleData||this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,this.cancelAttack(),this.spineController.pauseAnimation(!1),this.node.stopAllActions(),e=this.roleData.headDroped?r.SpineAniNameEnum.D2:r.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,null),s.GameManager.playerDead())},k.prototype.reset=function(){this.currentArrow&&this.currentArrow.node.destroy(),this.currentArrow},k.prototype.playerRefreshWeapon=function(){this.spineController.refreshWeapon()},k.prototype.getCurWeaponData=function(e){return{maxForce:this.weaponConfig.maxForce,gravity:this.weaponConfig.gravity}[e]},k.prototype.continuousEmission=function(){var e=c.SkillSystem.getSkillLevel(r.SkillTypeEnum.RUNNINGFIRE);this.fireCount=0<e?2:1,this.fireTimeScale=+this.fireCount,this.launchDelayTime=.05/this.fireTimeScale},__decorate([o({displayName:"\u7784\u51c6\u7ebf",type:cc.Node})],k.prototype,"aimLine",void 0),__decorate([o({displayName:"\u7784\u51c6\u7ebf-\u70b9",type:[cc.Node]})],k.prototype,"aimLinePoints",void 0),n=__decorate([n],k),i.Player=n,cc._RF.pop()},{}],Portal:[function(e,t,a){"use strict";cc._RF.push(t,"6a7cfwmSKpOw7I2gZg5z6Bv","Portal");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("GameCommonPool"),c=n("WorldEventManager"),p=n("LocalWorldEventType"),d=n("ConfigData");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.portalSpine=null,e.moveSpeed=350,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){c.WorldEventManager.addListener(p.LocalWorldEventType.BackHome,this.close,this)},u.prototype.onDisable=function(){c.WorldEventManager.removeListener(p.LocalWorldEventType.BackHome,this.close,this)},u.prototype.playAnimation=function(e,t,a){this.portalSpine.loop=t,this.portalSpine.animation=e,this.portalSpine.setCompleteListener(a)},u.prototype.appear=function(e){var t=this;this.playAnimation(r.SpineAniNameEnum.chuxian,!1,function(){e(),t.playAnimation(r.SpineAniNameEnum.xunhuan,!0,null);var a=450/t.moveSpeed;t.node.stopAllActions(),t.node.runAction(cc.sequence(cc.moveTo(a,d.ConfigData.PLYAER_POS),cc.delayTime(.2),cc.callFunc(function(){t.close()})))})},u.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u4f20\u9001\u95e8spine\u52a8\u753b",type:sp.Skeleton})],u.prototype,"portalSpine",void 0),n=__decorate([n],u),i.Portal=n,cc._RF.pop()},{}],PowerGetUI:[function(e,t,a){"use strict";cc._RF.push(t,"ab1012xbuxD85l6OVq4sPu1","PowerGetUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("LocalSoundManager"),c=n("ShareManager"),p=n("LocalData"),d=n("ShareVideoControl");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.allBg=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3)))},u.prototype.clickClose=function(){s.LocalSoundManager.playAudio("click"),this.close()},u.prototype.clickVideoGet=function(){var e=this;function t(){p.LocalData.data.energyNum+=5,e.close()}s.LocalSoundManager.playAudio("click"),c.ShareManager.getShareControlType()!=c.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?d.ShareVideoControl.videoFunc("\u83b7\u5f97\u4f53\u529b",t,null,t,null,null,d.VideoAdIdEnum.GET_ENERGY_ID):t()},u.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Node,displayName:"\u6574\u4f53"})],u.prototype,"allBg",void 0),n=__decorate([n],u),i.PowerGetUI=n,cc._RF.pop()},{}],PrefabUrl:[function(e,t,a){"use strict";cc._RF.push(t,"406achsW75OBpzIevy7U6iL","PrefabUrl");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.initUrlList=function(){this.mainUrlList.push(this.mainUI),this.gameUrlList.push(this.battleUI),this.firstChapterUrlList.push(this.map1Url),this.secondChapterUrlList.push(this.map2Url),this.thirdChapterUrlList.push(this.map3Url),this.fourChapterUrlList.push(this.map4Url),this.fiveChapterUrlList.push(this.map5Url),this.sixChapterUrlList.push(this.map6Url),this.sevenChapterUrlList.push(this.map7Url),this.sevenChapterUrlList.push(this.bossBubbleTextUrl),this.endlessChapterUrlList.push(this.map1Url),this.endlessChapterUrlList.push(this.map2Url),this.endlessChapterUrlList.push(this.map3Url),this.endlessChapterUrlList.push(this.map4Url),this.endlessChapterUrlList.push(this.map5Url),this.endlessChapterUrlList.push(this.map6Url),this.endlessChapterUrlList.push(this.map7Url),this.endlessChapterUrlList.push(this.bossBubbleTextUrl),this.gameUrlList.push(this.gamePauseUIPop),this.gameUrlList.push(this.blastEffectUrl),this.gameUrlList.push(this.restoreEffectUrl),this.gameUrlList.push(this.igniteEffectUrl),this.gameUrlList.push(this.frozonEffectUrl),this.gameUrlList.push(this.thunderEffectUrl),this.gameUrlList.push(this.thornsChainsEffectUrl),this.gameUrlList.push(this.turnHeartEffectUrl),this.gameUrlList.push(this.damageUpEffectUrl),this.gameUrlList.push(this.reviveHaloEffectUrl),this.gameUrlList.push(this.roleTipUrl),this.gameUrlList.push(this.thornsChainsDamageEffectUrl),this.gameUrlList.push(this.inspireWallEffectUrl),this.gameUrlList.push(this.divineShieldEffectUrl),this.gameUrlList.push(this.thunderImmuneEffectUrl),this.gameUrlList.push(this.furyEffectUrl),this.gameUrlList.push(this.spottingArrowUrl),this.gameUrlList.push(this.frozenImmuneEffectUrl),this.gameUrlList.push(this.reviveEffectUrl),this.gameUrlList.push(this.lightningEffectUrl),this.gameUrlList.push(this.fireArrowEffect),this.gameUrlList.push(this.iceArrowEffectUrl),this.gameUrlList.push(this.thunderArrowEffectUrl),this.gameUrlList.push(this.emergencyEquipmentUrl)},o.storeUI="UI/storeUI",o.talentUI="UI/talentUI",o.battleStartUI="UI/battleStartUI",o.boxGetUIPop="UI/boxGetUIPop",o.continueBattleUIPop="UI/continueBattleUIPop",o.equipmentCombineUIPop="UI/equipmentCombineUIPop",o.equipmentListUI="UI/equipmentListUI",o.equipmentUI="UI/equipmentUI",o.equipmentUIPop="UI/equipmentUIPop",o.sellEquipmentUIPop="UI/sellEquipmentUIPop",o.getEnergyUIPop="UI/getEnergyUIPop",o.getMoreGoldCoin="UI/getMoreGoldCoinPop",o.mainUI="UI/mainUI",o.rankingUIPop="UI/rankingUIPop",o.selectMapUIPop="UI/selectMapUIPop",o.settingUIPop="UI/settingUIPop",o.eggMachineUI="UI/eggMachineUI",o.newRewardUI="UI/newRewardUI",o.endlessRankingUI="UI/endlessRankingUI",o.endlessRankingRewardUI="UI/endlessRankingRewardUI",o.endlessReceiveRewardUI="UI/endlessReceiveRewardUI",o.skillDescriptionUI="UI/skillDescriptionUI",o.chapterProgressRewardUI="UI/chapterProgressRewardUI",o.noobGuideUIPop="Game/NoobGuide",o.backHomeWarnUIPop="Game/backHomeWarnUIPop",o.battleUI="Game/battleUI",o.failTipUIPop="Game/failTipUI",o.gamePauseUIPop="Game/gamePauseUIPop",o.randomIncidentUIPop="Game/randomIncidentUIPop",o.reviveUIPop="Game/reviveUIPop",o.selectSkilllPop="Game/selectSkillPop",o.settlementUIPop="Game/settlementUIPop",o.endlessModelBackUI="Game/endlessModelBackUI",o.inheritUIPop="Game/inheritUIPop",o.unlockSkillUI="Game/unlockSkillUI",o.localDial="Game/LocalDial",o.getSkillUI="Game/getSkillUI",o.bossBubbleTextUrl="Game/bossBubbleText",o.roleUrl="Game/Role/",o.bossUrl="Game/Boss/",o.map1Url="Game/Map/mapElement1",o.map2Url="Game/Map/mapElement2",o.map3Url="Game/Map/mapElement3",o.map4Url="Game/Map/mapElement4",o.map5Url="Game/Map/mapElement5",o.map6Url="Game/Map/mapElement6",o.map7Url="Game/Map/mapElement7",o.effectUrl="Game/Effect/",o.blastEffectUrl="Game/Effect/blastEffect",o.restoreEffectUrl="Game/Effect/restoreEffect",o.igniteEffectUrl="Game/Effect/igniteEffect",o.frozonEffectUrl="Game/Effect/frozonEffect",o.thunderEffectUrl="Game/Effect/thunderEffect",o.thornsChainsEffectUrl="Game/Effect/thornsChainsEffect",o.turnHeartEffectUrl="Game/Effect/turnHeartEffect",o.damageUpEffectUrl="Game/Effect/damageUpEffect",o.reviveHaloEffectUrl="Game/Effect/reviveHaloEffect",o.roleTipUrl="Game/Effect/roleTip",o.thornsChainsDamageEffectUrl="Game/Effect/thornsChainsDamageEffect",o.inspireWallEffectUrl="Game/Effect/inspireWallEffect",o.divineShieldEffectUrl="Game/Effect/divineShieldEffect",o.thunderImmuneEffectUrl="Game/Effect/thunderImmuneEffect",o.furyEffectUrl="Game/Effect/furyEffect",o.spottingArrowUrl="Game/Effect/spottingArrow",o.frozenImmuneEffectUrl="Game/Effect/frozenImmuneEffect",o.reviveEffectUrl="Game/Effect/reviveEffect",o.lightningEffectUrl="Game/Effect/lightningEffect",o.fireArrowEffect="Game/Effect/fireArrowEffect",o.iceArrowEffectUrl="Game/Effect/iceArrowEffect",o.thunderArrowEffectUrl="Game/Effect/thunderArrowEffect",o.emergencyEquipmentUrl="Game/Effect/emergencyEquipment",o.mainUrlList=[],o.gameUrlList=[],o.firstChapterUrlList=[],o.secondChapterUrlList=[],o.thirdChapterUrlList=[],o.fourChapterUrlList=[],o.fiveChapterUrlList=[],o.sixChapterUrlList=[],o.sevenChapterUrlList=[],o.endlessChapterUrlList=[],(n.PrefabUrl=o).initUrlList(),(n=n.EffectPrefabNameEnum||(n.EffectPrefabNameEnum={})).blastEffect="blastEffect",n.restoreEffect="restoreEffect",n.igniteEffect="igniteEffect",n.frozonEffect="frozonEffect",n.thunderEffect="thunderEffect",n.thornsChainsEffect="thornsChainsEffect",n.turnHeartEffect="turnHeartEffect",n.damageUpEffect="damageUpEffect",n.reviveHaloEffect="reviveHaloEffect",n.roleTip="roleTip",n.thornsChainsDamageEffect="thornsChainsDamageEffect",n.inspireWallEffect="inspireWallEffect",n.divineShieldEffect="divineShieldEffect",n.thunderImmuneEffect="thunderImmuneEffect",n.furyEffect="furyEffect",n.spottingArrow="spottingArrow",n.frozenImmuneEffect="frozenImmuneEffect",n.reviveEffect="reviveEffect",n.lightningEffect="lightningEffect",n.fireArrowEffect="fireArrowEffect",n.iceArrowEffect="iceArrowEffect",n.thunderArrowEffect="thunderArrowEffect",n.emergencyEquipment="emergencyEquipment",cc._RF.pop()},{}],RandomIncidentManager:[function(e,t,a){"use strict";cc._RF.push(t,"08b41ZqOMFDdp5NyEC06uv+","RandomIncidentManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("EnumAndConst"),l=n("SkillSystem"),r=n("Util"),s=n("GameConfigData"),c=n("GameState"),p=n("PlayerState"),d=n("ConfigData");function u(){}u.getRandomIncidentType=function(e,t){if(null==e)return null;if(t){var a=d.ConfigData.isBossPart(e);return t=l.SkillSystem.chooseSkills.length,e%5!=0||a?null:(t=t>=d.ConfigData.EQUIPED_SKILL_MAX_COUNT?[i.RandomIncidentTypeEnum.ANGEL,i.RandomIncidentTypeEnum.NEWRECLUSE,i.RandomIncidentTypeEnum.PROFITEER]:[i.RandomIncidentTypeEnum.ANGEL,i.RandomIncidentTypeEnum.DEMON,i.RandomIncidentTypeEnum.NEWRECLUSE,i.RandomIncidentTypeEnum.PROFITEER],r.Util.getRandomValueFromArray(t))}switch(e){case c.GameState.reclusePart:return c.GameState.profiteerPartArray[0]==c.GameState.reclusePart&&c.GameState.profiteerPartArray[0]++,c.GameState.profiteerPartArray[1]==c.GameState.reclusePart&&c.GameState.profiteerPartArray[1]++,i.RandomIncidentTypeEnum.NEWRECLUSE;case 5:case 15:return Math.random()<.25?i.RandomIncidentTypeEnum.NEWRECLUSE:i.RandomIncidentTypeEnum.ANGEL;case 10:var n=null==(n=this.getDevilSkillPool())||n.length<=0?[0,1]:[.75,1];return Math.random()<n[0]?i.RandomIncidentTypeEnum.DEMON:i.RandomIncidentTypeEnum.NEWRECLUSE}return e==c.GameState.profiteerPartArray[0]?(c.GameState.profiteerPartArray.splice(0,1),i.RandomIncidentTypeEnum.PROFITEER):e==c.GameState.profiteerPartArray[1]?(c.GameState.profiteerPartArray.splice(1,1),i.RandomIncidentTypeEnum.PROFITEER):null},u.getRandomStrengthenIncident=function(){var e=[i.StrengthenTypeEnum.HP_STRONGER,i.StrengthenTypeEnum.ATk_STRONGER],t=[],a=r.Util.getRandomNum(0,e.length-1);return t.push(e[a]),t},u.getRandomNewAngelIncident=function(){var e=(n=p.PlayerState.playerData).hp<=.5*n.maxHp,t=null==n.helmetIndex?0:n.helmetDefense/n.maxHelmetDefense,a=null==n.shieldIndex?0:n.shieldDefense/n.maxShieldDefense,n=l.SkillSystem.getEquipedSkillData(i.SkillTypeEnum.REVIVE_HALO)<1;return e&&t<.2&&a<.2&&n&&c.GameState.angel12Appear&&!c.GameState.endlessModel?3:r.Util.getRandomNum(0,2)},u.getRandomNewIncident=function(){return c.GameState.newIncidentTimes<1?.5<Math.random()?0:1:r.Util.getRandomIndexInChanceArray(s.GameConfigData.data.recluseChance)},u.getRandomBoxIncident=function(){var e=Math.random();return e<.1?3:e<.2?2:1},u.getDevilSkillPool=function(){var e=c.GameState.skillPool;if(null!=e){for(var t=[].concat(s.GameConfigData.data.heighSkillArray.concat(s.GameConfigData.data.exHeightSkillArray)),a=r.Util.arrayIntersection(t,e),n=0;n<a.length;n++){var o=a[n];null!=o&&l.SkillSystem.isSkillFullLevel(o)&&(a.splice(n,1),n--)}return a}},u.getDevilSkill=function(){var e=this.getDevilSkillPool();if(!(null==e||e.length<=0))return e[r.Util.getRandomNum(0,e.length-1)]},n=u,o.RandomIncidentManager=n,cc._RF.pop()},{}],RandomIncidentUI:[function(e,t,a){"use strict";cc._RF.push(t,"2e18aJGRZ5DbaJD++GTD5iL","RandomIncidentUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("LocalData"),c=n("GameCommonPool"),p=n("IncidentItem"),d=n("GameManager"),u=n("ConfigData"),h=n("Timer"),m=n("UIManager"),f=n("LocalSoundManager"),g=n("Util"),y=n("RandomIncidentManager"),v=n("GameState");function D(){var e=null!==l&&l.apply(this,arguments)||this;return e.widgets=[],e.npcSprite=null,e.incidentStrenthenItem=null,e.incidentEquipmentItem=null,e.incidentNewItem=null,e.incidentItemContent=null,e.tittle=null,e.returnBtn=null,e.npcSpriteFrames=[],e.incidentItems=[],e.closeAciton=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(D,l),D.prototype.onEnable=function(){null==this.widgets||this.widgets.length<=0||this.widgets.forEach(function(e){e.updateAlignment()})},D.prototype.update=function(){if(m.UIManager.isMainUI||v.GameState.isGaming){this.closeAciton&&this.closeAciton();for(var e=0;e<this.incidentItems.length;e++){var t=this.incidentItems[e];c.GameCommonPool.returnInstant(t),this.incidentItems.splice(e,1),e--}c.GameCommonPool.returnInstant(this.node)}},D.prototype.bindData=function(e,t){if(this.closeAciton=t,this.returnBtn.active=!0,this.incidentItems=[],this.tittle.string=u.ConfigData.randomIncidentTypeString[e],this.npcSprite.spriteFrame=this.getNpcSpriteFrame(e),this.npcSprite.node.setPosition(cc.v2(310,158)),this.npcSprite.node.stopAllActions(),this.npcSprite.node.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.5,0,20),cc.moveBy(.5,0,-20)))),e==r.RandomIncidentTypeEnum.PROFITEER){var a=y.RandomIncidentManager.getRandomBoxIncident();this.createIncidentItem(e,null,a,null)}else if(e==r.RandomIncidentTypeEnum.RECLUSE){var n=y.RandomIncidentManager.getRandomStrengthenIncident();if(null!=n)for(var o=0;o<n.length;o++){var i=n[o];this.createIncidentItem(e,i,null,null)}}else a=e==r.RandomIncidentTypeEnum.NEWRECLUSE?y.RandomIncidentManager.getRandomNewIncident():e==r.RandomIncidentTypeEnum.ANGEL?y.RandomIncidentManager.getRandomNewAngelIncident():g.Util.getRandomNum(0,5),this.returnBtn.active=!1,this.createIncidentItem(e,null,null,a)},D.prototype.getNpcSpriteFrame=function(e){if(null!=e){var t=null;switch(e){case r.RandomIncidentTypeEnum.ANGEL:t=0;break;case r.RandomIncidentTypeEnum.DEMON:t=1;break;case r.RandomIncidentTypeEnum.RECLUSE:t=2;break;case r.RandomIncidentTypeEnum.PROFITEER:t=3;break;case r.RandomIncidentTypeEnum.NEWRECLUSE:t=2}return e=this.npcSpriteFrames.length,t<0||e<=t?null:this.npcSpriteFrames[t]}},D.prototype.createIncidentItem=function(e,t,a,n){var o,i,l=this,s=null;switch(e){case r.RandomIncidentTypeEnum.RECLUSE:s=this.incidentStrenthenItem;break;case r.RandomIncidentTypeEnum.DEMON:case r.RandomIncidentTypeEnum.ANGEL:case r.RandomIncidentTypeEnum.NEWRECLUSE:s=this.incidentNewItem;break;case r.RandomIncidentTypeEnum.PROFITEER:s=this.incidentEquipmentItem}null!=s&&(null==(o=c.GameCommonPool.requestInstant(s))||null!=(i=o.getComponent(p.IncidentItem))&&(o.setParent(this.incidentItemContent),i.bindData(t,a,n,e,function(){l.close()}),this.incidentItems.push(o)))},D.prototype.clickClose=function(){f.LocalSoundManager.playAudio("click"),this.close()},D.prototype.close=function(){this.closeAciton&&this.closeAciton();for(var e=0;e<this.incidentItems.length;e++){var t=this.incidentItems[e];c.GameCommonPool.returnInstant(t),this.incidentItems.splice(e,1),e--}function a(){d.GameManager.startBattle()}v.GameState.currentPart<=1?0<s.LocalData.getTalentLevel(5)?m.UIManager.showSelectSkillPop(a):a():h.TimerManager.addTimer(1.3,function(){d.GameManager.nextPart()}),c.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Widget})],D.prototype,"widgets",void 0),__decorate([o({displayName:"npc\u5f62\u8c61",type:cc.Sprite})],D.prototype,"npcSprite",void 0),__decorate([o({displayName:"\u968f\u673a\u5f3a\u5316\u4e8b\u4ef6item",type:cc.Prefab})],D.prototype,"incidentStrenthenItem",void 0),__decorate([o({displayName:"\u968f\u673a\u88c5\u5907\u4e8b\u4ef6item",type:cc.Prefab})],D.prototype,"incidentEquipmentItem",void 0),__decorate([o({displayName:"\u968f\u673a\u65b0item",type:cc.Prefab})],D.prototype,"incidentNewItem",void 0),__decorate([o({displayName:"\u4e8b\u4ef6item\u7236\u8282\u70b9",type:cc.Node})],D.prototype,"incidentItemContent",void 0),__decorate([o({displayName:"\u6807\u9898",type:cc.Label})],D.prototype,"tittle",void 0),__decorate([o({displayName:"\u8fd4\u56de\u6309\u94ae",type:cc.Node})],D.prototype,"returnBtn",void 0),__decorate([o({displayName:"npc\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],D.prototype,"npcSpriteFrames",void 0),n=__decorate([n],D),i.RandomIncidentUI=n,cc._RF.pop()},{}],RankingItem:[function(e,t,a){"use strict";cc._RF.push(t,"fb92e5BQfJDVKK6QkSFSuya","RankingItem");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.bgSprite=null,e.medalSprite=null,e.rankNumLabel=null,e.headIcon=null,e.nickNameLabel=null,e.partNumLabel=null,e.bgSpriteFrames=[],e.medalSpriteFrames=[],e}i=cc.Component,__extends(r,i),r.prototype.bindData=function(e,t,a,n){var o=this;null!=e&&null!=t&&null!=a&&null!=n&&(e<=3?(this.rankNumLabel.node.active=!1,this.medalSprite.node.active=!0,this.medalSprite.spriteFrame=this.medalSpriteFrames[e-1]):(this.rankNumLabel.node.active=!0,this.medalSprite.node.active=!1,this.rankNumLabel.string=9999<e?"9999+":e+""),this.bgSprite.spriteFrame=null!=e&&e%2==1?this.bgSpriteFrames[0]:this.bgSpriteFrames[1],this.nickNameLabel.string=6<a.length?a.slice(0,5):a,this.partNumLabel.string="\u7b2c"+n+"\u5173",cc.loader.load({url:t,type:"png"},function(e,t){e&&console.warn(e),o.headIcon.spriteFrame=new cc.SpriteFrame(t)}))},__decorate([l({displayName:"\u80cc\u666f",type:cc.Sprite})],r.prototype,"bgSprite",void 0),__decorate([l({displayName:"\u5956\u724c",type:cc.Sprite})],r.prototype,"medalSprite",void 0),__decorate([l({displayName:"\u6392\u540d",type:cc.Label})],r.prototype,"rankNumLabel",void 0),__decorate([l({displayName:"\u5934\u50cf",type:cc.Sprite})],r.prototype,"headIcon",void 0),__decorate([l({displayName:"\u6635\u79f0",type:cc.Label})],r.prototype,"nickNameLabel",void 0),__decorate([l({displayName:"\u5173\u5361\u6570",type:cc.Label})],r.prototype,"partNumLabel",void 0),__decorate([l({displayName:"\u80cc\u666f\u56fe\u96c6\u5408",type:cc.SpriteFrame})],r.prototype,"bgSpriteFrames",void 0),__decorate([l({displayName:"\u5956\u724c\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],r.prototype,"medalSpriteFrames",void 0),n=__decorate([n],r),o.RankingItem=n,cc._RF.pop()},{}],RankingManager:[function(e,t,a){"use strict";cc._RF.push(t,"8f45fqgHzdNFILJCq7fIzdx","RankingManager");var n,o=t,i=a;function l(){}Object.defineProperty(i,"__esModule",{value:!0}),(o=n=i.MessageTypeEnum||(i.MessageTypeEnum={})).SUBMIT_DATA="\u63d0\u4ea4\u6570\u636e",o.SHOW_RANK_LIST="\u663e\u793a\u5217\u8868\u6392\u884c",o.SHOW_SURPASS_RANK="\u663e\u793a\u8d85\u8d8a\u6392\u884c",o.PRE_RANK_PAGE="\u4e0a\u4e00\u9875",o.NEXT_RANK_PAGE="\u4e0b\u4e00\u9875",o.OPEN_SLIDE="\u5f00\u542f\u6ed1\u52a8",o.CLOSE_SLIDE="\u5173\u95ed\u6ed1\u52a8",l.submitData=function(e,t){var a=n.SUBMIT_DATA;this.postMessage(a,e,t)},l.showRankList=function(e){var t=n.SHOW_RANK_LIST;this.postMessage(t,e,"")},l.showPrePage=function(e){var t=n.PRE_RANK_PAGE;this.postMessage(t,e,"")},l.showNextPage=function(e){var t=n.NEXT_RANK_PAGE;this.postMessage(t,e,"")},l.openRankListSlide=function(){var e=n.OPEN_SLIDE;this.postMessage(e,"","")},l.closeRankListSlide=function(){var e=n.CLOSE_SLIDE;this.postMessage(e,"","")},l.postMessage=function(e,t,a){cc.sys.platform===cc.sys.WECHAT_GAME&&"function"==typeof wx.getOpenDataContext&&wx.getOpenDataContext().postMessage({type:e,key:t,value:a})},i.RankingManager=o=l,cc._RF.pop()},{}],RankingUI:[function(e,t,a){"use strict";cc._RF.push(t,"e76a7Dj4ktJq5+wJMgQlCNM","RankingUI");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("LocalSoundManager"),s=o("RankingManager"),c=o("GameCommonPool"),p=o("EnumAndConst");function d(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){s.RankingManager.showRankList(p.OpenDataKeyEnum.PART),s.RankingManager.openRankListSlide()},d.prototype.clickClose=function(){r.LocalSoundManager.playAudio("click"),s.RankingManager.closeRankListSlide(),c.GameCommonPool.returnInstant(this.node)},o=__decorate([o],d),i.RankingUI=o,cc._RF.pop()},{}],RestoreEffect:[function(e,t,a){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}cc._RF.push(t,"f1d1cWm5DVL840bnDt8tXyl","RestoreEffect");var o=e,i=t,l=a;Object.defineProperty(l,"__esModule",{value:!0});var r,s=o("EnumAndConst"),c=o("GameCommonPool"),p=o("WorldEventManager"),d=o("LocalWorldEventType"),u=o("RestoreMark");function h(){var e=null!==r&&r.apply(this,arguments)||this;return e.restoreMarkPrefab=null,e.hpUpBg=null,e.repairBg=null,e.restoreMarks=[],e}o=(i=cc._decorator).ccclass,i=i.property,r=cc.Component,__extends(h,r),h.prototype.onEnable=function(){p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this)},h.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},h.prototype.bindData=function(e){this.restoreMarks=[],e==s.SkillTypeEnum.LIFE_MEACHINE?this.lifeMachineAnimaiton():this.restoreAnimation(e)},h.prototype.restoreAnimation=function(e){var t=null;e==s.SkillTypeEnum.HP_UP||e==s.SkillTypeEnum.MAX_HP_UP?(t=0,this.hpUpBg.active=!0,this.repairBg.active=!1):(t=1,this.hpUpBg.active=!1,this.repairBg.active=!0);for(var a=this,o=0;o<3;o++){var i=function(n){var o=c.GameCommonPool.requestInstant(a.restoreMarkPrefab);if(null==o)return{value:void 0};var i=o.getComponent(u.RestoreMark);if(null==i)return{value:void 0};i.bindData(t),o.setParent(a.node),a.restoreMarks.push(o);var l=null,r=0,p=null;switch(n){case 0:r=1.2,p=e==s.SkillTypeEnum.HP_UP||e==s.SkillTypeEnum.MAX_HP_UP?(l=cc.v2(-28,-49),cc.v2(-28,35)):(l=cc.v2(4,-49),cc.v2(4,35));break;case 1:r=1.4,p=e==s.SkillTypeEnum.HP_UP||e==s.SkillTypeEnum.MAX_HP_UP?(l=cc.v2(28,-60),cc.v2(28,35)):(l=cc.v2(-28,-60),cc.v2(-28,35));break;case 2:r=1.6,p=e==s.SkillTypeEnum.HP_UP||e==s.SkillTypeEnum.MAX_HP_UP?(l=cc.v2(4,-77),cc.v2(4,35)):(l=cc.v2(28,-77),cc.v2(28,35))}o.position=l,o.stopAllActions(),o.opacity=255,o.runAction(cc.sequence(cc.moveTo(r,p),cc.callFunc(function(){o.opacity=0})))}(o);if("object"==n(i))return i.value}},h.prototype.lifeMachineAnimaiton=function(){for(var e=0;e<2;e++){var t=c.GameCommonPool.requestInstant(this.restoreMarkPrefab);if(null==t)return;if(null==(n=t.getComponent(u.RestoreMark)))return;n.bindData(0),t.setParent(this.node),this.restoreMarks.push(t);var a=e<=0?cc.v2(-28,42):cc.v2(11,42),n=e<=0?cc.v2(-28,-42):cc.v2(11,-42);if(t.position=a,t.opacity=0,t.stopAllActions(),t.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.sequence(cc.fadeIn(.2),cc.delayTime(.6),cc.fadeOut(.2)),cc.moveTo(1,n)))),null==(a=c.GameCommonPool.requestInstant(this.restoreMarkPrefab)))return;if(null==(t=a.getComponent(u.RestoreMark)))return;t.bindData(1),a.setParent(this.node),this.restoreMarks.push(a),n=e<=0?cc.v2(32,-42):cc.v2(-11,-42),t=e<=0?cc.v2(32,42):cc.v2(-11,42),a.position=n,a.opacity=0,a.stopAllActions(),a.runAction(cc.sequence(cc.delayTime(.2),cc.spawn(cc.sequence(cc.fadeIn(.2),cc.delayTime(.6),cc.fadeOut(.2)),cc.moveTo(1,t))))}},h.prototype.close=function(){null!=this.restoreMarks&&0<this.restoreMarks.length&&this.restoreMarks.forEach(function(e){c.GameCommonPool.returnInstant(e)}),c.GameCommonPool.returnInstant(this.node)},__decorate([i({displayName:"\u56de\u590d\u6807\u5fd7\u9884\u8bbe",type:cc.Prefab})],h.prototype,"restoreMarkPrefab",void 0),__decorate([i({displayName:"\u751f\u547d\u6062\u590d\u80cc\u666f",type:cc.Node})],h.prototype,"hpUpBg",void 0),__decorate([i({displayName:"\u88c5\u5907\u4fee\u590d\u80cc\u666f",type:cc.Node})],h.prototype,"repairBg",void 0),o=__decorate([o],h),l.RestoreEffect=o,cc._RF.pop()},{}],RestoreMark:[function(e,t,a){"use strict";cc._RF.push(t,"754bbJyrb1E5KD7Dct5sJDJ","RestoreMark");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.markSprite=null,e.markSpriteFrames=[],e}i=cc.Component,__extends(r,i),r.prototype.bindData=function(e){null==e||e<0||e>=this.markSpriteFrames.length||(this.markSprite.spriteFrame=this.markSpriteFrames[e])},__decorate([l({displayName:"\u6807\u5fd7\u56fe\u7247",type:cc.Sprite})],r.prototype,"markSprite",void 0),__decorate([l({displayName:"\u6807\u5fd7\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],r.prototype,"markSpriteFrames",void 0),n=__decorate([n],r),o.RestoreMark=n,cc._RF.pop()},{}],ReviveEffect:[function(e,t,a){"use strict";cc._RF.push(t,"61509Xiq4lEkJINtWAqMvK2","ReviveEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameManager"),d=n("LocalSoundManager"),u=n("EnemyArea");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.reviveAnimation=null,e.reviveKnock=null,e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),d.LocalSoundManager.playAudio("revive"),this.reviveAnimation.play("Revive"),this.reviveAnimation.on("finished",this.revivePlayer,this),this.reviveKnock.scale=0,this.reviveKnock.stopAllActions()},h.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),this.reviveAnimation.off("finished",this.revivePlayer,this)},h.prototype.bindData=function(e){this.roleData=e},h.prototype.revivePlayer=function(){var e=this;if(null!=this.roleData)return this.roleData.isPlayer?(p.GameManager.revivePlayer(),d.LocalSoundManager.playAudio("reviveKnock"),void this.reviveKnock.runAction(cc.sequence(cc.scaleTo(.1,50),cc.callFunc(function(){e.close()})))):void u.EnemyArea.reviveEnemy(this.roleData,!1);this.close()},h.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u7ec4\u4ef6",type:cc.Animation})],h.prototype,"reviveAnimation",void 0),__decorate([o({displayName:"\u590d\u6d3b\u9707\u51fb",type:cc.Node})],h.prototype,"reviveKnock",void 0),n=__decorate([n],h),i.ReviveEffect=n,cc._RF.pop()},{}],ReviveHaloEffect:[function(e,t,a){"use strict";cc._RF.push(t,"1fabcNyezhI3rMGICkEHgQ1","ReviveHaloEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("Util"),c=n("PlayerState");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.reviveHalo=null,e.stars=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){var e=c.PlayerState.player;null!=e?(e.reviveHalo=this.node,this.reviveHalo.position=cc.v2(0,73),this.reviveHalo.stopAllActions(),this.reviveHalo.runAction(cc.repeatForever(cc.sequence(cc.moveBy(.5,0,5),cc.moveBy(.5,0,-5)))),this.stars.forEach(function(e){e.stopAllActions(),e.scale=0;var t=s.Util.getRandomFloatNum(.3,.5);e.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(t,.3),cc.scaleTo(t,0))))})):r.GameCommonPool.returnInstant(this.node)},p.prototype.update=function(){var e=c.PlayerState.playerData;null!=e&&!e.isDead||r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u590d\u6d3b\u5149\u73af",type:cc.Node})],p.prototype,"reviveHalo",void 0),__decorate([o({displayName:"\u661f\u661f\u96c6\u5408",type:cc.Node})],p.prototype,"stars",void 0),n=__decorate([n],p),i.ReviveHaloEffect=n,cc._RF.pop()},{}],ReviveUI:[function(e,t,a){"use strict";cc._RF.push(t,"a706e89MW5F+Jgr0ezlFs3a","ReviveUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("GameCommonPool"),c=n("GameManager"),p=n("UIManager"),d=n("LocalSoundManager"),u=n("ShareVideoControl"),h=n("ShareManager"),m=n("GameState"),f=n("EffectCreate"),g=n("PlayerState"),y=n("StatisticsManager");function v(){var e=null!==l&&l.apply(this,arguments)||this;return e.timeCountDown=null,e.bg1=null,e.bg2=null,e.videoReviveBtn=null,e.notReviveBtn=null,e.totalTime=9,e.lastTime=9,e.isPause=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(v,l),v.prototype.onEnable=function(){this.isPause=!1,this.videoReviveBtn.position=cc.v2(1e3,-121),this.videoReviveBtn.stopAllActions(),this.videoReviveBtn.runAction(cc.moveTo(.3,0,-121)),this.notReviveBtn.opacity=0,this.notReviveBtn.stopAllActions(),this.notReviveBtn.runAction(cc.sequence(cc.delayTime(1),cc.fadeIn(.3))),this.totalTime=9,this.lastTime=9,this.timeCountDown.value=this.totalTime+""},v.prototype.update=function(e){if(p.UIManager.isMainUI)s.GameCommonPool.returnInstant(this.node);else if(!this.isPause){if(this.totalTime<=0)return c.GameManager.endGame(!1),void this.close();this.totalTime-=e,this.bg1.fillRange-=e,this.bg2.fillRange+=e,(e=Math.ceil(this.totalTime))!=this.lastTime&&(this.lastTime=e,this.timeCountDown.value=e+"",this.bg1.fillRange=0,this.bg2.fillRange=0)}},v.prototype.clickVideoRevive=function(){var e,t=this;function a(){cc.director.resume(),t.isPause=!1,t.close(),m.GameState.isSettling||(f.EffectCreate.createReviveEffect(g.PlayerState.playerData),y.StatisticsManager.sendPartEvent(y.StatisticsCode.PART_REVIVE,"video"))}d.LocalSoundManager.playAudio("click"),h.ShareManager.getShareControlType()!=h.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(e=function(){cc.director.resume(),t.isPause=!1},this.isPause=!0,u.ShareVideoControl.videoFunc("\u590d\u6d3b",a,e,a,e,function(){cc.director.pause()},u.VideoAdIdEnum.REVIVE_ID)):a()},v.prototype.clickDiscardRevive=function(){d.LocalSoundManager.playAudio("click"),c.GameManager.endGame(!1),this.close()},v.prototype.close=function(){s.GameCommonPool.returnInstant(this.node)},__decorate([o({type:r.NumberImg,displayName:"\u5012\u8ba1\u65f6"})],v.prototype,"timeCountDown",void 0),__decorate([o({type:cc.Sprite,displayName:"\u80cc\u666f1"})],v.prototype,"bg1",void 0),__decorate([o({type:cc.Sprite,displayName:"\u80cc\u666f2"})],v.prototype,"bg2",void 0),__decorate([o({type:cc.Node,displayName:"\u89c6\u9891\u590d\u6d3b\u6309\u94ae"})],v.prototype,"videoReviveBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u653e\u5f03\u590d\u6d3b\u6309\u94ae"})],v.prototype,"notReviveBtn",void 0),n=__decorate([n],v),i.ReviveUI=n,cc._RF.pop()},{}],RewardItem:[function(e,t,a){"use strict";cc._RF.push(t,"2c3ffBX/DdL3rD2k66Ss1a+","RewardItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("SpriteFrameManager"),c=n("LocalData");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.rewardSpriteFrame=[],e.rewardSprite=null,e.rewardNum=null,e.equipmentLevel=null,e.bgSprite=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.bindData=function(e){this.node.scale=1,this.rewardNum.value="x"+e.rewardCount,this.rewardNum.node.position=cc.v2(0,-31),this.rewardSprite.node.angle=0,(this.rewardSprite.node.scale=1)==e.rewardType?(this.bgSprite.spriteFrame=s.SpriteFrameManager.getEquipmentRankSpriteFrame(0),this.equipmentLevel.active=!1,this.rewardSprite.spriteFrame=this.rewardSpriteFrame[0]):2==e.rewardType?(this.bgSprite.spriteFrame=s.SpriteFrameManager.getEquipmentRankSpriteFrame(0),this.equipmentLevel.active=!1,this.rewardSprite.spriteFrame=this.rewardSpriteFrame[1],this.rewardSprite.node.scale=.5):3==e.rewardType&&(this.rewardNum.node.position=cc.v2(30,35),this.rewardSprite.node.scale=.2,e=e.equipmentData,this.bgSprite.spriteFrame=s.SpriteFrameManager.getEquipmentRankSpriteFrame(e.rank-1),this.equipmentLevel.active=!0,e.type==c.EquipmentType.weapon?(this.rewardSprite.node.angle=-45,this.rewardSprite.spriteFrame=s.SpriteFrameManager.getLaunchWeaponSpriteFrame(e.index,e.rank)):e.type==c.EquipmentType.helmet?this.rewardSprite.spriteFrame=s.SpriteFrameManager.getHelmetSpriteFrame(e.index,e.rank):e.type==c.EquipmentType.shield?this.rewardSprite.spriteFrame=s.SpriteFrameManager.getShieldSpriteFrame(e.index,e.rank):e.type==c.EquipmentType.cloak&&(this.rewardSprite.spriteFrame=s.SpriteFrameManager.getCloakSpriteFrame(e.index)))},__decorate([o({type:cc.SpriteFrame,displayName:"\u6218\u5229\u54c1\u56fe\u7247\u96c6\u5408"})],p.prototype,"rewardSpriteFrame",void 0),__decorate([o({type:cc.Sprite,displayName:"\u6218\u5229\u54c1\u56fe\u7247"})],p.prototype,"rewardSprite",void 0),__decorate([o({type:r.NumberImg,displayName:"\u6570\u91cf"})],p.prototype,"rewardNum",void 0),__decorate([o({displayName:"\u88c5\u5907\u7b49\u7ea7",type:cc.Node})],p.prototype,"equipmentLevel",void 0),__decorate([o({displayName:"\u54c1\u8d28\u80cc\u666f",type:cc.Sprite})],p.prototype,"bgSprite",void 0),n=__decorate([n],p),i.RewardItem=n,cc._RF.pop()},{}],RobotAimed:[function(e,t,a){"use strict";cc._RF.push(t,"650357bEplKg63+tgIDI8C1","RobotAimed");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RoleBase"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("RoleManager"),d=n("Head"),u=n("GameState"),h=n("PlayerState"),m=n("EnumAndConst"),f=n("Timer"),g=n("LocalSoundManager"),y=n("GameCommonPool"),v=n("BattleNodeManager"),D=n("NewLaser"),E=n("Util"),S=n("EnemyArea"),A=n("GameManager"),C=n("GameConfigData"),M=n("EndlessModelConfigData"),T=n("SpecailSkill"),_=n("EquipmentEffectSystem");function k(){var e=null!==l&&l.apply(this,arguments)||this;return e.aimingRayPrefab=null,e.laserPrefab=null,e.aimingRay=null,e.weaponBone=null,e.attackInterval=2,e.aimTime=1.5,e.attackWaitTime=1,e.attackTimer=null,e.aimingLineTween=null,e.bodyRotateTween=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.RoleBase,__extends(k,l),k.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.targetForce=null,this.node.scale=1,this.attackTimer=null,this.aimingLineTween=null,this.bodyRotateTween=null,this.aimingRay=null,this.weaponBone=null,this.isWaitingRevive=!1},k.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},k.prototype.update=function(){this.refreshDeadState(),this.refresReviveState(),this.refreshAimingRayPos()},k.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},k.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(d.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),u.GameState.heroModel&&(this.roleData.atk+=50),this.equipFootRest(),this.searchAttackTarget(),this.setAttack()},k.prototype.searchAttackTarget=function(){var e;null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||null!=(e=h.PlayerState.playerData)&&(this.attackTargetData=e)},k.prototype.setAttack=function(){var e,t,a=this;null==this.roleData||this.roleData.isDead||(this.spineController.playAnimation(m.SpineAniNameEnum.St,!1,!0,null),e=E.Util.getRandomNum(0,60),t=this.attackInterval,u.GameState.endlessModel?t/=M.EndlessModelConfigData.getEndlessEnemyAttackFrequency(u.GameState.currentPart):u.GameState.heroModel&&(t/=C.GameConfigData.data.heroEnemyAttackFrequency),this.rotateBody(t,e),this.attackTimer=f.TimerManager.addTimer(t,function(){if(null==a.roleData||a.roleData.isDead)return a.aimingRay&&y.GameCommonPool.returnInstant(a.aimingRay),void(a.aimingRay=null);a.spineController.playAnimation(m.SpineAniNameEnum.Aim,!1,!0,null);var e=a.roleData.logicPos.sub(a.attackTargetData.logicPos),t=180*-cc.v2(e).signAngle(cc.Vec2.RIGHT)/Math.PI;null!=(e=a.createAimingRay())&&(a.aimingRay=e,a.refreshAimingRayPos(),a.rotateBody(a.aimTime,t),a.attackTimer=null)},this.node))},k.prototype.createAimingRay=function(){var e=y.GameCommonPool.requestInstant(this.aimingRayPrefab);if(null!=e){var t=v.BattleNodeManager.getParentNode(m.BattleNodeEnum.EFFECT_NODE);if(null!=t)return e.width=0,e.setParent(t),e}},k.prototype.shootLaser=function(){g.LocalSoundManager.playAudio("newLaser");var e,t,a=y.GameCommonPool.requestInstant(this.laserPrefab);null!=a&&(null==(e=v.BattleNodeManager.getParentNode(m.BattleNodeEnum.EFFECT_NODE))||null!=(t=this.spineController.getBoneWorldPos(m.BoneNameEnum.WEAPON))&&(t=this.roleUp.convertToWorldSpaceAR(t),t=e.convertToNodeSpaceAR(t),a.setParent(e),a.setPosition(t),null!=(a=a.getComponent(D.NewLaser))&&a.bindData(this.roleData.atk,this.roleData,this.attackTargetData)))},k.prototype.rotateBody=function(e,t){var a=this,n=this.spineController.getBoneByName(m.BoneNameEnum.Rotate);null!=n&&(null!=this.aimingRay&&(this.aimingRay.width=1500,this.aimingRay.angle=n.rotation,this.aimingLineTween=new cc.Tween,this.aimingLineTween.target(this.aimingRay),this.aimingLineTween.to(this.aimTime,{angle:t},null),this.aimingLineTween.call(function(){var e=E.Util.getDistance(a.attackTargetData.logicPos,a.aimingRay.position);a.aimingRay.width=e}),this.aimingLineTween.delay(this.attackWaitTime),this.aimingLineTween.call(function(){a.aimingRay&&y.GameCommonPool.returnInstant(a.aimingRay),a.aimingRay=null,a.shootLaser(),a.spineController.playAnimation(m.SpineAniNameEnum.Atk,!1,!1,function(){a.setAttack()}),a.aimingLineTween=null}),this.aimingLineTween.start()),this.bodyRotateTween&&this.bodyRotateTween.stop(),this.bodyRotateTween=new cc.Tween,this.bodyRotateTween.target(n),this.bodyRotateTween.to(e,{rotation:t},null),this.bodyRotateTween.call(function(){a.bodyRotateTween=null}),this.bodyRotateTween.start())},k.prototype.stopRotate=function(){this.aimingLineTween&&this.aimingLineTween.stop(),this.aimingLineTween=null,this.bodyRotateTween&&this.bodyRotateTween.stop(),this.bodyRotateTween=null,this.aimingRay&&y.GameCommonPool.returnInstant(this.aimingRay),this.aimingRay=null},k.prototype.refreshAimingRayPos=function(){var e;null==this.roleData||this.roleData.isDead||(null!=this.weaponBone?null!=this.aimingRay&&(e=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY),e=this.roleUp.convertToWorldSpaceAR(e),e=this.node.parent.convertToNodeSpaceAR(e),this.aimingRay.position=e):this.weaponBone=this.spineController.getBoneByName(m.BoneNameEnum.WEAPON))},k.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||(this.attackTimer&&this.attackTimer.pauseTimer(),this.stopRotate(),this.spineController.playAnimation(m.SpineAniNameEnum.Fankui,!1,!1,function(){null==e.attackTimer?e.setAttack():e.attackTimer.resumeTimer()}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},k.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.spineController.pauseAnimation(!0),f.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,f.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),f.TimerManager.resumeAllTimers(t.node))},this.node))},k.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||p.RoleManager.hitRole(this.roleData)},k.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(y.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.close())},k.prototype.die=function(){var e,t=this;null==this.roleData||this.roleData.isFalledDown||(this.stopRotate(),this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,f.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?A.GameManager.killEnemy(this.roleData):A.GameManager.friendDie(this.roleData),_.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?m.SpineAniNameEnum.D2:m.SpineAniNameEnum.D,this.spineController.playAnimation(e,!0,!1,function(){var e=null!=S.EnemyArea.necromancer&&S.EnemyArea.reviveReady&&null==S.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void S.EnemyArea.necromancer.reviveEnemy(t.roleData);f.TimerManager.addTimer(.1,function(){if(null!=t.roleData){if(y.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,T.SpecailSkill.killBlast(t.roleData))return t.roleData.isDestroy=!0,void t.close();t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))}},t.node)}))},__decorate([o({displayName:"\u7ea2\u5916\u7784\u51c6\u7ebf\u9884\u8bbe",type:cc.Prefab})],k.prototype,"aimingRayPrefab",void 0),__decorate([o({displayName:"\u6fc0\u5149",type:cc.Prefab})],k.prototype,"laserPrefab",void 0),n=__decorate([n],k),i.RobotAimed=n,cc._RF.pop()},{}],RobotBurrow:[function(e,t,a){"use strict";cc._RF.push(t,"d0957ItQmxHZLQBoWZasu8d","RobotBurrow");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("ShortRoleBase"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("GameState"),d=o("EnumAndConst"),u=o("Head"),h=o("SkillSystem"),m=o("Util"),f=o("RoleManager"),g=o("GameCommonPool"),y=o("Timer"),v=o("GameManager"),D=o("EnemyArea"),E=o("SpecailSkill"),S=o("BattleNumManager"),A=o("LocalSoundManager"),C=o("LocalData"),M=o("SingleEffectManager"),T=o("ConfigData"),_=o("EquipmentEffectSystem"),k=o("EffectCreate");function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.dangerHpLine=.6,e.posXOffset=70,e.standPosY=-147,e.usedSkill=!1,e.upTargetPos=null,e.isBurrowing=!1,e}o=(n=cc._decorator).ccclass,n.property,l=r.ShortRoleBase,__extends(P,l),P.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.moveSpeed=75,this.isMoving=!1,this.isHitAniRunning=!1,this.isWaitingRevive=!1,this.upTargetPos=null,this.isBurrowing=!1,this.usedSkill=!1},P.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},P.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refresReviveState(),this.refreshSkillSatate(),!this.roleData.isRecycled)){if(this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,p.GameState.isGaming&&this.isMoving&&this.moveToTarget(e),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!p.GameState.isGaming||this.roleData.isDead)return;this.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null,1.5)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},P.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},P.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1,this.node.y=this.standPosY;var n=a.getComponent(u.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.burrowDown(!1)},P.prototype.burrowDown=function(e){var t=this;M.SingleEffectManager.clearInsertArrows(this.roleData),this.isMoving=!1,this.isBurrowing=!0,this.roleData.isTeleporting=!0,this.roleData.isFrozening=!1,this.isHitAniRunning=!1,this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.spineController.playAnimation(d.SpineAniNameEnum.Down,!1,!1,function(){var a;e?(a=Math.round(t.roleData.maxHp-t.roleData.hp),f.RoleManager.restoreRoleHp(t.roleData,a,!1,!0),y.TimerManager.addTimer(1,function(){t.isMoving=!0},t.node)):t.isMoving=!0,t.isBurrowing=!1,t.setBurrowUpTargetPosX(e),t.moveSpeed=200,t.upTargetPos.x>t.node.x?(t.roleUp.scaleX=-1,t.node.x+=t.posXOffset):(t.roleUp.scaleX=1,t.node.x-=t.posXOffset),t.spineController.playAnimation(d.SpineAniNameEnum.Run_ug,!1,!0,null)},.6)},P.prototype.burrowUp=function(){var e=this;-1==this.roleUp.scaleX&&(this.roleUp.scaleX=1,this.node.x-=2*this.posXOffset),this.isMoving=!1,this.isBurrowing=!0,y.TimerManager.addTimer(.6,function(){e.roleData.isTeleporting=!1},this.node),this.spineController.playAnimation(d.SpineAniNameEnum.Up,!1,!1,function(){e.isMoving=!0,e.upTargetPos=null,e.isBurrowing=!1,e.moveSpeed=150,e.searchAttackTarget()})},P.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTargetData(),this.isMoving=!0,p.GameState.isGaming?this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||this.isHitAniRunning||this.roleData.isTeleporting||this.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null,1.5):this.spineController.pauseAnimation(!0))},P.prototype.moveToTarget=function(e){var t,a;null==this.roleData||this.roleData.isDead?this.isMoving=!1:this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(a=(this.roleData.isTeleporting&&null!=this.upTargetPos?this.upTargetPos:null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),t=Math.abs(a.x),a=a.x<0?-this.moveSpeed:this.moveSpeed,t>this.attackDis?this.node.x+=a*e:(this.isMoving=!1,this.roleData.isTeleporting?this.burrowUp():null!=this.attackTargetData?this.setAttack():this.die()))},P.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=h.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!p.GameState.isGaming||this.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null,1.5)))},P.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);if(30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead)return e.node.stopAllActions(),void e.searchAttackTarget();p.GameState.isGaming?e.spineController.playAnimation(d.SpineAniNameEnum.Atk,!1,!1,null):e.node.stopAllActions()}),cc.delayTime(.33),cc.callFunc(function(){var t,a,n,o,i=e.attackTargetData;null==i||i.isDead||i.isTeleporting||(t=Math.abs(e.roleData.logicPos.x-i.logicPos.x),n=Math.abs(e.roleData.logicPos.y-i.logicPos.y),90<t||90<n||(n=0,e.roleData.isEnemy&&e.attackTargetData.isPlayer&&(n=h.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.DODGE)),e.attackTargetData.enemyEquipSkills.isHaveSkill(d.SkillTypeEnum.DODGE)&&(n=h.SkillSystem.getEquipedSkillInitData(d.SkillTypeEnum.DODGE),e.attackTargetData.isBoss&&p.GameState.heroModel&&(n*=2)),Math.random()<n?k.EffectCreate.createRoleTip(i.logicPos,0):i.hasEnemyShield?(i.hasEnemyShield=!1,a=Math.round(e.roleData.atk),n=d.BattleNumTypeEnum.HP_REDUCE,S.BattleNumManager.createBattleNumEffect(n,a,i,i.logicPos),A.LocalSoundManager.playShieldResistAudio()):0<i.shieldDefense?(A.LocalSoundManager.playShieldResistAudio(),a=Math.round(e.roleData.atk),f.RoleManager.equipmentIsDamaged(e.attackTargetData,C.EquipmentType.shield,e.roleData,a,cc.v2(i.logicPos.x+35,i.logicPos.y)),i.shieldDefense<=0&&(i.shieldDroped=!0)):0<i.helmetDefense?(A.LocalSoundManager.playHelmetResistAudio(),o=Math.round(e.roleData.atk),f.RoleManager.equipmentIsDamaged(e.attackTargetData,C.EquipmentType.helmet,e.roleData,o,cc.v2(i.headPosition.x,i.headPosition.y)),i.helmetDefense<=0&&(i.helmetDroped=!0)):(o=Math.round(e.roleData.atk),o*=1-i.bodyHurtReduction,f.RoleManager.roleIsDamaged(e.attackTargetData,e.roleData,o,i.logicPos),i.invincibleTime<=0?(A.LocalSoundManager.playArrowHitAudio(),A.LocalSoundManager.playVibrateShort(),M.SingleEffectManager.showBloodEffect(i.logicPos,1,i)):A.LocalSoundManager.playShieldResistAudio())))}),cc.delayTime(m.Util.getRandomFloatNum(1,1.5))))))},P.prototype.refreshSkillSatate=function(){null==this.roleData||this.roleData.isDead||this.roleData.hp<=0||this.usedSkill||this.roleData.hp/this.roleData.maxHp<=this.dangerHpLine&&(this.usedSkill=!0,this.node.stopAllActions(),this.burrowDown(!0))},P.prototype.setBurrowUpTargetPosX=function(e){var t=this.roleData.logicPos.x<=T.ConfigData.PLYAER_POS.x+2*this.attackDis?T.ConfigData.PLYAER_POS.x+2*this.attackDis+2*this.posXOffset:e||Math.random()<.5?T.ConfigData.PLYAER_POS.x:m.Util.getRandomFloatNum(T.ConfigData.PLYAER_POS.x,this.roleData.logicPos.x);e=this.standPosY,this.upTargetPos=cc.v2(t,e)},P.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isBurrowing||this.roleData.isTeleporting?this.isHitAniRunning=!1:(this.isHitAniRunning=!0,this.node.stopAllActions(),this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,p.GameState.isGaming&&!e.roleData.isDead&&e.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null,1.5))},1.5),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},P.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.node.stopAllActions(),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},P.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||this.isBurrowing||this.roleData.isTeleporting||(this.searchAttackTarget(),f.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5)},P.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&this.close()},P.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.node.stopAllActions(),y.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?v.GameManager.killEnemy(this.roleData):v.GameManager.friendDie(this.roleData),_.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?d.SpineAniNameEnum.D2:d.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){var e=null!=D.EnemyArea.necromancer&&D.EnemyArea.reviveReady&&null==D.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void D.EnemyArea.necromancer.reviveEnemy(t.roleData);y.TimerManager.addTimer(.1,function(){null!=t.roleData&&(null!=t.footRest&&(g.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null),t.roleData.isDestroy=!0,t.close(),E.SpecailSkill.killBlast(t.roleData))},t.node)}))},o=__decorate([o],P),i.RobotBurrow=o,cc._RF.pop()},{}],RobotMixed:[function(e,t,a){"use strict";cc._RF.push(t,"fb7a6T8Bk9Bg6bwdCZry9Xh","RobotMixed");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LongRoleBase"),s=n("GameCommonPool"),c=n("BattleNodeManager"),p=n("EnumAndConst"),d=n("Sword"),u=n("WorldEventManager"),h=n("LocalWorldEventType"),m=n("GameState"),f=n("Head"),g=n("Util"),y=n("GameManager"),v=n("Timer"),D=n("ConfigData"),E=n("EnemyArea"),S=n("RoleManager"),A=n("SpecailSkill"),C=n("SkillSystem"),M=n("GameConfigData"),T=n("EndlessModelConfigData"),_=n("EnemyShield"),k=n("EquipmentEffectSystem");function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.enemyShield=null,e.swordPrefab=null,e.attackTargetLastPos=null,e.moveSpeed=75,e.attackDis=80,e.isMoving=!1,e.deadAniRunning=!1,e.isFalling=!1,e.isLongRangeWaitting=!1,e.isAttacking=!1,e.shieldSkillCd=5,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.LongRoleBase,__extends(P,l),P.prototype.onEnable=function(){u.WorldEventManager.addListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.addListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.addListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.currentArrow=null,this.shield=null,this.sword=null,this.targetForceMagnitude=0,this.isHitAniRunning=!1,this.launchDelayTime=.05,this.fireCount=1,this.fireTimeScale=null,this.isWaitingRevive=!1,this.isMoving=!1,this.deadAniRunning=!1,this.isFalling=!1,this.attackTargetLastPos=null,this.isLongRangeWaitting=!1,this.isAttacking=!1,this.roleUp.angle=0,this.isSearch=!0,this.shieldSkillCd=5},P.prototype.onDisable=function(){u.WorldEventManager.removeListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},P.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),this.refreshSkillTime(e),m.GameState.isGaming)){if(this.isSearch&&this.isMoving?this.searchAttackTargetData():this.isSearch=!0,this.moveToTarget(e),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!m.GameState.isGaming||this.roleData.isDead||this.isAttacking&&this.roleData.attackModel==p.AttackModelTypeEnum.LONG_RANGE_ATTACK)return;this.spineController.playAnimation(p.SpineAniNameEnum.Run,!1,!0,null)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},P.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},P.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(f.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.roleData.attackModel=p.AttackModelTypeEnum.LONG_RANGE_ATTACK,this.isMoving=!0,this.equipFootRest(),this.equipWeapon(),this.searchAttackTarget()},P.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||this.roleData.isFrozening||this.setLongRangeAttack()},P.prototype.setLongRangeAttack=function(){var e,t=this;this.isLongRangeWaitting||null==this.roleData||this.roleData.isDead||(null!=this.sword&&(s.GameCommonPool.returnInstant(this.sword.node),this.sword=null),this.roleData.attackModel=p.AttackModelTypeEnum.LONG_RANGE_ATTACK,this.currentArrow||this.equipWeapon(),this.spineController.playAnimation(p.SpineAniNameEnum.Run,!1,!0,null),!m.GameState.isGaming||null==this.attackTargetData)||(this.isLongRangeWaitting=!0,this.attackTargetLastPos=this.attackTargetData.logicPos.clone(),e=g.Util.getRandomFloatNum(2,3),m.GameState.endlessModel?e/=T.EndlessModelConfigData.getEndlessEnemyAttackFrequency(m.GameState.currentPart):m.GameState.heroModel&&(e/=M.GameConfigData.data.heroEnemyAttackFrequency),v.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.fireCount=1,t.fireTimeScale=1,t.roleData.enemyEquipSkills.isHaveSkill(p.SkillTypeEnum.RUNNINGFIRE)&&(t.fireCount=2,t.fireTimeScale=1.5),t.launchDelayTime=.05/t.fireTimeScale,t.launch())},this.node))},P.prototype.launch=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead){this.currentArrow||this.equipWeapon(),this.setHitRate(),this.targetForceMagnitude=this.minForce+Math.random()*(this.maxForce-this.minForce);var t=this.attackTargetData.logicPos;90<g.Util.getDistance(this.attackTargetLastPos,t)&&(t=this.attackTargetLastPos);var a,n=this.currentArrow.node.position,o=!1,i=null,l=null,r=(t=Math.random()<=this.hitRate?(o=!0,a=g.Util.getRandomFloatNum(t.x-20,t.x+20),g.Util.getRandomFloatNum(t.y+35,t.y-25)):(o=!1,Math.random()<.5?(a=t.x,g.Util.getRandomFloatNum(t.y+80,t.y+100)):(a=t.x,g.Util.getRandomFloatNum(t.y-80,t.y-100))),cc.v2(a,t));if(o){var s=null;if(this.roleData.isEnemy){var c=E.EnemyArea.enemyDataArray;if(null==c||c.length<=0)return;for(var d=0,u=c;d<u.length;d++){var h=u[d];h==this.roleData||h.isDestroy||h.logicPos.x<=this.attackTargetData.logicPos.x||h.logicPos.x>=this.roleData.logicPos.x||h.logicPos.y<this.roleData.logicPos.y||null!=s&&s.logicPos.y>=h.logicPos.y||(s=h)}}null!=s&&(i=cc.v2(s.logicPos.x,s.logicPos.y+120),this.targetForceMagnitude=g.Util.getRandomFloatNum(400,600)),M=null==i?(m=Math.abs(n.x-r.x),f=r.y-n.y,y=Math.abs(f)/m,v=Math.atan(y)*(Math.PI/180),C=m/(T=this.targetForceMagnitude*(1-v/90)),(f-.5*(_=D.ConfigData.weaponConfigDatas[this.roleData.weaponIndex].gravity)*Math.pow(C,2))/C):(M=Math.abs(n.x-i.x),o=Math.abs(i.x-r.x),c=i.y-n.y,i=r.y-i.y,M/=T=this.targetForceMagnitude,(c-.5*(_=(i-c*(o/=T)/M)/(.5*M*o+.5*Math.pow(o,2)))*Math.pow(M,2))/M),T=0<this.roleUp.scaleX?-T:T,this.targetForce=cc.v2(T,M),l=_}else{var m=Math.abs(n.x-r.x),f=r.y-n.y,y=Math.abs(f)/m,v=Math.atan(y)*(Math.PI/180),C=m/(T=this.targetForceMagnitude*(1-v/90)),M=(f-.5*(_=D.ConfigData.weaponConfigDatas[this.roleData.weaponIndex].gravity)*Math.pow(C,2))/C,T=0<this.roleUp.scaleX?-T:T;this.targetForce=cc.v2(T,M),l=_}this.roleData.weaponLaunch=!0,M=this.targetForce;var _=this.roleData.enemyEquipSkills.isHaveSkill(p.SkillTypeEnum.DIVISION);l=this.currentArrow.launch(M,this.launchDelayTime,_?1:0,l),S.RoleManager.addWaitingLaunchArrow(this.roleData,l),_&&A.SpecailSkill.division(this.currentArrow,1),this.currentArrow=null,this.isAttacking=!0,this.isHitAniRunning=!1,this.spineController.playAnimation(p.SpineAniNameEnum.Atk_run,!1,!1,function(){e.isAttacking=!1,e.isLongRangeWaitting=!1,1<e.fireCount?(e.fireCount--,e.equipWeapon(n),e.launch()):(e.spineController.playAnimation(p.SpineAniNameEnum.Run,!1,!0,null),e.equipWeapon(),e.setLongRangeAttack())},this.fireTimeScale)}},P.prototype.moveToTarget=function(e){if(m.GameState.isGaming&&this.isMoving)if(null==this.roleData||this.roleData.isDead)this.isMoving=!1;else if(!(this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){var t=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),a=Math.abs(t.x);if(t=t.x<0?-this.moveSpeed:this.moveSpeed,this.attackTargetData.isPlayer&&a>this.attackDis||!this.attackTargetData.isPlayer&&(a>this.attackDis||30<this.roleData.logicPos.y-this.attackTargetData.logicPos.y||50<this.attackTargetData.logicPos.y-this.roleData.logicPos.y))return this.node.x+=t*e,void this.setLongRangeAttack();this.isMoving=!1,null!=this.attackTargetData?(this.stopLongRangeAttack(),this.attackTargetData.isPlayer&&null!=this.footRest?this.fallToGround():this.setMeleeAttack()):this.die()}},P.prototype.stopLongRangeAttack=function(){this.currentArrow&&(this.currentArrow.close(),this.currentArrow=null),this.isAttacking=!1,this.isLongRangeWaitting=!1,this.roleUp.stopAllActions(),v.TimerManager.removeAllTimers(this.node),this.spineController.playAnimation(p.SpineAniNameEnum.St,!1,!0,null),this.roleData.attackModel=p.AttackModelTypeEnum.MELEE_ATTACK},P.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=C.SkillSystem.getEquipedSkillData(p.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!m.GameState.isGaming||this.isAttacking&&this.roleData.attackModel==p.AttackModelTypeEnum.LONG_RANGE_ATTACK||this.spineController.playAnimation(p.SpineAniNameEnum.Run,!1,!0,null)))},P.prototype.fallToGround=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(s.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.isMoving=!1,this.isFalling=!0,this.spineController.pauseAnimation(!0),this.roleData.isMoveModel=!1,e=Math.abs(this.roleData.logicPos.y-D.ConfigData.PLYAER_POS.y)/300,e=Math.max(0,e),this.node.runAction(cc.sequence(cc.moveTo(e,this.roleData.logicPos.x,D.ConfigData.PLYAER_POS.y),cc.callFunc(function(){var e;t.roleData.isMoveModel=!0,t.isFalling=!1,t.roleData.isDead?t.deadAniRunning||(e=null!=E.EnemyArea.necromancer&&E.EnemyArea.reviveReady,t.roleData.isEnemy&&e?E.EnemyArea.necromancer.reviveEnemy(t.roleData):v.TimerManager.addTimer(.1,function(){if(null!=t.roleData){if(A.SpecailSkill.killBlast(t.roleData))return t.footRest&&s.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close();null!=t.footRest?(s.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close())}},t.node)):(t.spineController.pauseAnimation(!1),t.setMeleeAttack())}))))},P.prototype.setMeleeAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(null==this.sword&&this.equipSword(),this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);return 30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead?(e.isAttacking=!1,e.sword&&e.sword.stopAttack(),e.node.stopAllActions(),e.searchAttackTargetData(),void(e.isMoving=!0)):!m.GameState.isGaming||e.roleData.isDead?(e.sword&&e.sword.stopAttack(),void e.node.stopAllActions()):(e.isAttacking=!0,void e.spineController.playAnimation(p.SpineAniNameEnum.Cut,!1,!1,function(){e.isAttacking=!1,e.sword&&e.sword.stopAttack()}))}),cc.delayTime(.4),cc.callFunc(function(){e.sword&&e.sword.startAttack()}),cc.delayTime(g.Util.getRandomFloatNum(1,1.5))))))},P.prototype.refreshSkillTime=function(e){null==this.roleData||this.roleData.isDead||this.roleData.hasEnemyShield||(this.shieldSkillCd-=e,this.shieldSkillCd<=0&&(this.shieldSkillCd=5,this.useShieldSkill()))},P.prototype.useShieldSkill=function(){null==this.roleData||this.roleData.isDead||this.createEnemyShield(this.roleData)},P.prototype.createEnemyShield=function(e){var t,a,n;null==E.EnemyArea.instance||null!=(t=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.SHIRLD_NODE))&&(null==(a=s.GameCommonPool.requestInstant(this.enemyShield))||null!=(n=a.getComponent(_.EnemyShield))&&(n.bindData(e),a.setParent(t),a.setPosition(e.logicPos)))},P.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isAttacking&&this.roleData.attackModel==p.AttackModelTypeEnum.LONG_RANGE_ATTACK||this.isFalling?this.isHitAniRunning=!1:(this.isHitAniRunning=!0,this.node.stopAllActions(),this.sword&&this.sword.stopAttack(),this.spineController.playAnimation(p.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,m.GameState.isGaming&&!e.roleData.isDead&&e.spineController.playAnimation(p.SpineAniNameEnum.Run,!1,!0,null))}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},P.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.node.pauseAllActions(),this.roleUp.pauseAllActions(),this.spineController.pauseAnimation(!0),v.TimerManager.pasueAllTimers(this.node),S.RoleManager.pauseWaitingLaunchArrows(this.roleData),e=this.roleData.frozenTime,v.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),t.node.resumeAllActions(),t.roleUp.resumeAllActions(),v.TimerManager.resumeAllTimers(t.node),S.RoleManager.resumeWaitingLaunchArrows(t.roleData))},this.node))},P.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||this.isFalling||(this.roleData.isEnemy?(this.searchAttackTarget(),S.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5):this.searchAttackTarget())},P.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(null!=this.sword&&(s.GameCommonPool.returnInstant(this.sword.node),this.sword=null),this.close())},P.prototype.equipSword=function(){var e,t=s.GameCommonPool.requestInstant(this.swordPrefab);null==t||null!=(e=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.SWORD_NODE))&&(t.setParent(e),t.setPosition(cc.v2(9999,9999)),null!=(t=t.getComponent(d.Sword))&&(t.bindData(this.roleData),this.sword=t,this.roleData.weaponLaunch=!1,this.spineController.equipWeapon(this.sword.node)))},P.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.deadAniRunning=!0,this.isMoving=!1,this.roleData.isFrozening=!1,S.RoleManager.resumeWaitingLaunchArrows(this.roleData),null!=this.sword&&this.sword.stopAttack(),this.isFalling?this.node.resumeAllActions():this.node.stopAllActions(),v.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?y.GameManager.killEnemy(this.roleData):y.GameManager.friendDie(this.roleData),k.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?p.SpineAniNameEnum.D2:p.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){if(t.deadAniRunning=!1,!t.isFalling){var e=null!=E.EnemyArea.necromancer&&E.EnemyArea.reviveReady&&null==E.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void E.EnemyArea.necromancer.reviveEnemy(t.roleData);v.TimerManager.addTimer(.1,function(){if(null!=t.roleData){if(A.SpecailSkill.killBlast(t.roleData))return t.footRest&&s.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close();null!=t.footRest?(s.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close())}})}}))},__decorate([o({displayName:"\u654c\u4eba\u9632\u62a4\u7f69",type:cc.Prefab})],P.prototype,"enemyShield",void 0),__decorate([o({displayName:"\u5200\u5251\u9884\u8bbe",type:cc.Prefab})],P.prototype,"swordPrefab",void 0),n=__decorate([n],P),i.RobotMixed=n,cc._RF.pop()},{}],RoleBase:[function(e,t,a){"use strict";cc._RF.push(t,"1ff4aooduZLQ6PvT99438C8","RoleBase");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SpineController"),s=n("FootRest"),c=n("GameCommonPool"),p=n("Timer"),d=n("EnemyArea"),u=n("Util"),h=n("GameConfigData"),m=n("LocalData"),f=n("BattleNumManager"),g=n("EnumAndConst"),y=n("SingleEffectManager"),v=n("EquipmentEffectSystem"),D=n("SkillSystem"),E=n("WorldEventManager"),S=n("LocalWorldEventType"),A=n("SpecailSkill"),C=n("RoleManager"),M=n("GameState"),T=n("EffectCreate"),_=n("PlayerManager"),k=n("PlayerState"),P=n("ConfigData"),R=n("BroadcastManager"),I=n("ShareManager");function w(){var e=null!==l&&l.apply(this,arguments)||this;return e.spineController=null,e.roleUp=null,e.roleDown=null,e.roleData=null,e.attackTargetData=null,e.currentArrow=null,e.sword=null,e.head=null,e.shield=null,e.footRest=null,e.targetForce=null,e.targetForceMagnitude=null,e.isHitAniRunning=!1,e.arrowLaunchTimers=[],e.isSearch=!0,e.isWaitingRevive=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(w,l),w.prototype.bindData=function(){},w.prototype.searchAttackTargetData=function(){var e=this;if(M.GameState.isGaming&&null!=this.roleData&&!this.roleData.isDead){var t=this.roleData.isEnemy?d.EnemyArea.friendDatas:d.EnemyArea.enemyDataArray;if(t.length<=0)this.attackTargetData=this.roleData.isEnemy?k.PlayerState.playerData:null;else{var a=[];if(t.forEach(function(t){null==t||null==t.logicPos||t.isDead||t.isTeleporting||e.roleData.isEnemy&&t.logicPos.x>=e.roleData.logicPos.x||!e.roleData.isEnemy&&e.roleData.attackModel==g.AttackModelTypeEnum.MELEE_ATTACK&&t.logicPos.x<=e.roleData.logicPos.x||e.roleData.attackModel==g.AttackModelTypeEnum.MELEE_ATTACK&&(30<e.roleData.logicPos.y-t.logicPos.y||50<t.logicPos.y-e.roleData.logicPos.y)||a.push(t)}),a.length<=0)this.attackTargetData=this.roleData.isEnemy?k.PlayerState.playerData:null;else{this.roleData.isEnemy&&a.push(k.PlayerState.playerData);for(var n=null,o=9999,i=0;i<a.length;i++){var l,r=a[i];null!=r&&(l=u.Util.getDistance(this.roleData.logicPos,r.logicPos),this.roleData.attackModel==g.AttackModelTypeEnum.MELEE_ATTACK?l<=80&&l<o&&(n=r,o=l):0<=r.logicPos.y&&50<l&&l<o&&(n=r,o=l))}this.attackTargetData=null!=n?n:this.roleData.isEnemy?k.PlayerState.playerData:null}}}},w.prototype.equipFootRest=function(){var e,t=_.PlayerManager.createFootRest(this.roleData.logicPos);null==t||null!=(e=t.getComponent(s.FootRest))&&(e.bindData(this.roleData),this.footRest=t)},w.prototype.equipShield=function(){null==this.roleData.shieldIndex||this.roleData.shieldDefense<=0||(this.shield=_.PlayerManager.createShield(this.roleData.logicPos),this.shield&&(this.shield.bindData(this.roleData),this.shield.node.scaleX=P.ConfigData.getEquipmentScale(this.roleData,m.EquipmentType.shield),this.spineController.equipShield(this.shield.node),this.roleData.shieldDroped=!1))},w.prototype.equipHelmet=function(){null==this.roleData.helmetIndex||this.roleData.helmetDefense<=0||(this.head.helmet=_.PlayerManager.createHelmet(this.roleData.logicPos),this.head.helmet&&(this.head.helmet.bindData(this.roleData),this.head.helmet.node.scaleX=P.ConfigData.getEquipmentScale(this.roleData,m.EquipmentType.helmet),this.spineController.equipHelmet(this.head.helmet.node),this.roleData.helmetDroped=!1))},w.prototype.isDamaged=function(e,t,a,n,o,i,l,r,s){void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===i&&(i=!1),void 0===l&&(l=!0),void 0===r&&(r=!1),void 0===s&&(s=!1);var c=this.roleData;if(null==c)return 0;if(!M.GameState.isGaming)return 0;if(null==t)return 0;if(c.hp<=0||c.isDead)return c.hp=0,c.isDead=!0,0;if(c.isTeleporting)return 0;var d=t==P.ConfigData.MAX_DAMAGE;d||(e.isPlayer&&c.isEnemy&&(t*=1+v.EquipmentEffectSystem.getAtkEffectData(c.profession,c.attackModel)),c.isPlayer&&e.isEnemy&&(k=0,t*=1-(k=e.attackModel==g.AttackModelTypeEnum.MELEE_ATTACK?h.GameConfigData.data.talentData[4]*m.LocalData.getTalentLevel(4):k)-v.EquipmentEffectSystem.getDefenseEffectData(e.profession,e.attackModel))),t=Math.round(t);var u,_=!1,k=null;if(k=(_=e!=c&&0<c.invincibleTime||_)?g.BattleNumTypeEnum.ABSORB:d?g.BattleNumTypeEnum.SECKILL:o&&i?g.BattleNumTypeEnum.HEAD_SHOOT_CRIT:o&&!i?g.BattleNumTypeEnum.HEAD_SHOOT:i&&!o?g.BattleNumTypeEnum.CRIT:g.BattleNumTypeEnum.HP_REDUCE,f.BattleNumManager.createBattleNumEffect(k,t,c,a),!_)if(c.reduceHp(t),c.isDivideBoss&&(c.totalDamage+=t),0<c.hp)n&&C.RoleManager.hitRole(c,o,r,s),c.isPlayer&&(c.hp/c.maxHp<.3&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:25}),!e.isEnemy||0<(w=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.EMERGENCY_EQUIPMENT))&&y.SingleEffectManager.showEmergencyEquipmentEffect(t,0));else{var w=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.INSPIRE_WALL);if(c.isPlayer&&0<w&&(0<c.shieldDefense||0<c.helmetDefense))c.hp=1,y.SingleEffectManager.showInspireWallEffect();else{if(c.isDead=!0,c.killerData=e,l&&C.RoleManager.roleDie(c),c.isPlayer&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:26}),c.isBoss&&!c.isUltimateBoss)return;l=0,c.killerData.isEnemy==c.isEnemy?l=1:(l=o?2:0,c.isEnemy&&o&&null!=c.killerData&&c.killerData.isPlayer&&I.ShareManager.getViolenceControl()&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBroadcast,{type:R.BroadCastTypeEnum.HEAD_KILL})),T.EffectCreate.createDeadEffect(l,c.logicPos)}}return c.isPlayer&&e.isEnemy&&0<c.hp&&0<(w=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.THORNS_CHAINS))&&null!=(w=D.SkillSystem.getEquipedSkillData(g.SkillTypeEnum.THORNS_CHAINS))&&(w=Math.min(1,w),u=Math.round(t*w),A.SpecailSkill.createSkillEffectInEnemy(g.SkillTypeEnum.THORNS_CHAINS,c,e),p.TimerManager.addTimer(.4,function(){null==e||e.isDead||e.isTeleporting||(C.RoleManager.roleIsDamaged(e,c,u,e.logicPos,!1),y.SingleEffectManager.showBloodEffect(e.logicPos,-1,e))})),t},w.prototype.restoreHp=function(e,t,a){void 0===t&&(t=!0),void 0===a&&(a=!0),null!=e&&(null==this.roleData||this.roleData.isDead||(t&&(e*=1+h.GameConfigData.data.talentData[1]*m.LocalData.getTalentLevel(1)),e=Math.round(e),this.roleData.restoreHp(e),f.BattleNumManager.createBattleNumEffect(g.BattleNumTypeEnum.HP_UP,e,this.roleData,this.roleData.logicPos),a&&y.SingleEffectManager.showHpUpEffect(this.roleData)))},w.prototype.equipmentIsDamaged=function(e,t,a,n){var o,i,l,r,s,c,d=this.roleData;null!=d&&M.GameState.isGaming&&null!=a&&((o=a==P.ConfigData.MAX_DAMAGE)||(t.isPlayer&&d.isEnemy&&(a*=1+v.EquipmentEffectSystem.getAtkEffectData(d.profession,d.attackModel)),d.isPlayer&&t.isEnemy&&(r=0,a*=1-(r=t.attackModel==g.AttackModelTypeEnum.MELEE_ATTACK?h.GameConfigData.data.talentData[4]*m.LocalData.getTalentLevel(4):r)-v.EquipmentEffectSystem.getDefenseEffectData(t.profession,t.attackModel),!(0<d.shieldDefense||0<d.helmetDefense)||null!=(i=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.INSPIRE_WALL))&&0<i&&(a*=.7,y.SingleEffectManager.showInspireWallEffect()))),a=Math.round(a),l=!1,r=null,r=(l=t!=d&&0<d.invincibleTime||l)?g.BattleNumTypeEnum.ABSORB:o?g.BattleNumTypeEnum.BROKE_EQUIPMENT:g.BattleNumTypeEnum.EQUIPMENT_REDUCE,f.BattleNumManager.createBattleNumEffect(r,a,d,n),!l&&(d.reduceEquipmentDefense(e,a),d.isPlayer)&&(n=!1,l=e==m.EquipmentType.shield?d.shieldDefense:d.helmetDefense,d.hp>Math.floor(.1*d.maxHp)&&0<l&&0<(i=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.LIFE_MEACHINE))&&(l=a*(s=D.SkillSystem.getEquipedSkillData(g.SkillTypeEnum.LIFE_MEACHINE)),C.RoleManager.roleIsDamaged(this.roleData,this.roleData,Math.floor(.1*d.maxHp),this.roleData.logicPos),this.repairEquipment(e,l,!1,!1),y.SingleEffectManager.showLifeMachineEffect(),n=!0),n||0<(i=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.EMERGENCY_EQUIPMENT))&&(n=e==m.EquipmentType.helmet?1:2,y.SingleEffectManager.showEmergencyEquipmentEffect(a,n)),e==m.EquipmentType.helmet&&d.helmetDefense<=0&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:24}),e==m.EquipmentType.helmet&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:45}),e==m.EquipmentType.shield&&d.shieldDefense<=0&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:23}),e==m.EquipmentType.shield&&E.WorldEventManager.triggerEvent(S.LocalWorldEventType.ShowBubble,{type:44})),d.isPlayer&&t.isEnemy&&0<(i=D.SkillSystem.getSkillLevel(g.SkillTypeEnum.THORNS_CHAINS))&&null!=(s=D.SkillSystem.getEquipedSkillData(g.SkillTypeEnum.THORNS_CHAINS))&&(s=Math.min(1,s),c=Math.round(a*s),A.SpecailSkill.createSkillEffectInEnemy(g.SkillTypeEnum.THORNS_CHAINS,d,t),p.TimerManager.addTimer(.4,function(){null==t||t.isDead||t.isTeleporting||(C.RoleManager.roleIsDamaged(t,d,c,t.logicPos,!1),y.SingleEffectManager.showBloodEffect(t.logicPos,-1,t))})))},w.prototype.repairEquipment=function(e,t,a,n){void 0===a&&(a=!0),void 0===n&&(n=!0),null!=e&&null!=t&&(this.roleData.isDead||(a&&(t*=1+h.GameConfigData.data.talentData[1]*m.LocalData.getTalentLevel(1)),t=Math.round(t),this.roleData.restoreEquipmentDefense(e,t),f.BattleNumManager.createBattleNumEffect(g.BattleNumTypeEnum.EQUIPMENT_UP,t,this.roleData,this.roleData.logicPos),n&&y.SingleEffectManager.showRepairEffect(this.roleData)))},w.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead?this.isHitAniRunning=!1:this.isHitAniRunning||(this.isHitAniRunning=!0,this.roleUp.runAction(cc.sequence(cc.rotateBy(.1,30),cc.rotateBy(.1,-30),cc.callFunc(function(){e.isHitAniRunning=!1}))),this.roleData.isFrozening&&this.roleUp.pauseAllActions())},w.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.node.pauseAllActions(),this.spineController.pauseAnimation(!0),e=this.roleData.frozenTime,p.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.node.resumeAllActions(),t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1))},this.node))},w.prototype.addWaitingLaunchArrow=function(e){null!=e&&((null==this.arrowLaunchTimers||this.arrowLaunchTimers.length<=0)&&(this.arrowLaunchTimers=[]),this.arrowLaunchTimers.push(e))},w.prototype.pauseWaitingLaunchArrows=function(){null==this.arrowLaunchTimers||this.arrowLaunchTimers.length<=0||this.arrowLaunchTimers.forEach(function(e){e&&e.pauseTimer()})},w.prototype.resumeWaitingLaunchArrows=function(){null==this.arrowLaunchTimers||this.arrowLaunchTimers.length<=0||this.arrowLaunchTimers.forEach(function(e){e&&e.resumeTimer()})},w.prototype.die=function(){},w.prototype.refreshEquipmentState=function(){null!=this.roleData&&(this.roleData.shieldDroped&&null!=this.shield&&null!=this.shield.roleData&&this.shield.roleData==this.roleData&&!this.shield.isDroping&&(this.shield.drop(100,200),this.shield=null),this.roleData.helmetDroped&&null!=this.head&&null!=this.head.helmet&&null!=this.head.helmet.roleData&&this.head.helmet.roleData==this.roleData&&!this.head.helmet.isDroping&&(this.head.helmet.drop(100,200),this.head.helmet=null),this.roleData.shieldDroped&&null!=this.shield&&this.shield.isDroping&&(this.shield=null),this.roleData.helmetDroped&&null!=this.head&&null!=this.head.helmet&&this.head.helmet.isDroping&&(this.head.helmet=null))},w.prototype.refresReviveState=function(){var e=this;null!=this.roleData&&!this.roleData.isReviving&&this.isWaitingRevive&&null==d.EnemyArea.necromancer&&(this.isWaitingRevive=!1,null!=this.footRest&&(c.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null),this.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){e.roleData.isDestroy=!0,e.close()}))))},w.prototype.refreshDeadState=function(){null!=this.roleData&&(this.roleData.hp<=0||this.roleData.isDead)&&!this.roleData.isFalledDown&&(this.roleData.hp=0,this.roleData.isDead=!0,this.die())},w.prototype.recyvle=function(){var e,t=this;null!=this.roleData&&(this.roleData.isFrozening=!1,null!=this.sword&&this.sword.stopAttack(),this.node.stopAllActions(),p.TimerManager.removeAllTimers(this.node),e=function(){null!=t.roleData&&(T.EffectCreate.createAppearEffect(t.roleData.logicPos),null!=t.footRest&&(c.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null),t.roleData.isDestroy=!0,t.close())},this.roleData.isEnemy?e():(this.roleUp.angle=0,this.roleUp.stopAllActions(),p.TimerManager.addTimer(2,e,this.node),this.spineController.playAnimation(g.SpineAniNameEnum.Win,!0,!0,null)))},w.prototype.close=function(){y.SingleEffectManager.clearInsertArrows(this.roleData),null==this.currentArrow||null==this.currentArrow.node||this.roleData.weaponLaunch||(this.currentArrow.node.destroy(),this.currentArrow=null),null!=this.sword&&null!=this.sword.node&&(c.GameCommonPool.returnInstant(this.sword.node),this.sword=null),null==this.shield||this.roleData.shieldDroped||(this.shield.close(),this.shield=null),null==this.head||this.roleData.headDroped||(null!=this.head.helmet&&(this.head.helmet.close(),this.head.helmet=null),null!=this.head.node&&this.head.node.destroy()),c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u9aa8\u9abc\u63a7\u5236\u5668",type:r.SpineController})],w.prototype,"spineController",void 0),__decorate([o({displayName:"\u4e0a\u534a\u8eab",type:cc.Node})],w.prototype,"roleUp",void 0),__decorate([o({displayName:"\u4e0b\u534a\u8eab",type:cc.Node})],w.prototype,"roleDown",void 0),n=__decorate([n],w),i.RoleBase=n,cc._RF.pop()},{}],RoleBody:[function(e,t,a){"use strict";cc._RF.push(t,"824775jsuBOeKBiwPOHRSz4","RoleBody");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Body"),s=n("WorldEventManager"),c=n("LocalWorldEventType");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.bodyColliders=[],e.bodys=[],e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},p.prototype.update=function(){null!=this.roleData&&this.roleData.isDestroy&&this.close()},p.prototype.lateUpdate=function(){null!=this.roleData&&(this.node.position=this.roleData.logicPos)},p.prototype.bindData=function(e){this.roleData=e,this.bodys.forEach(function(t){null!=t&&t.bindData(e)})},p.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&this.close()},p.prototype.getBodyColliders=function(){return this.bodyColliders},p.prototype.close=function(){this.node.destroy()},__decorate([o({displayName:"\u8eab\u4f53\u78b0\u649e\u76d2",type:cc.Collider})],p.prototype,"bodyColliders",void 0),__decorate([o({displayName:"\u8eab\u4f53",type:r.Body})],p.prototype,"bodys",void 0),n=__decorate([n],p),i.RoleBody=n,cc._RF.pop()},{}],RoleData:[function(e,t,a){"use strict";cc._RF.push(t,"28993ui3tNLrpdl80fNWDXU","RoleData");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l=o("EnumAndConst"),r=o("ConfigData"),s=o("LocalData"),c=o("GameConfigData"),p=o("Util"),d=o("GameState"),u=o("SkillData");function h(){this.id=null,this.isPlayer=!1,this.isEnemy=!1,this.exp=0,this.level=1,this.isBoss=!1,this.isUltimateBoss=!1,this.isDivideBoss=!1,this.ancestorData=null,this.divideBossDatas=[],this.totalDamage=0,this.isSummon=!1,this.isRecycled=!1,this.rewardCoin=0,this.profession=l.ProfessionEnum.LAUNCHER,this.attackModel=l.AttackModelTypeEnum.LONG_RANGE_ATTACK,this.weaponIndex=null,this.shieldIndex=null,this.helmetIndex=null,this.isDead=!1,this.isFeignDeath=!1,this.isFalledDown=!1,this.isDestroy=!1,this.hp=0,this.maxHp=0,this.initMaxHp=0,this.extraHp=0,this.retainExtraHp=0,this.atk=0,this.initAtk=0,this.extraAtk=0,this.retainExtraAk=0,this.logicPos=null,this.headPosition=null,this.helmetDefense=0,this.maxHelmetDefense=0,this.initHelmetDefense=0,this.retainExtraHelmetDefense=0,this.shieldDefense=0,this.maxShieldDefense=0,this.initShieldDefense=0,this.retainExtraShieldDefense=0,this.weaponLaunch=!1,this.helmetDroped=!1,this.shieldDroped=!1,this.headDroped=!1,this.holdHead=!1,this.attackPower=null,this.attackAngle=null,this.isAttack=!1,this.isMoveModel=!1,this.isTeleporting=!1,this.repelTime=0,this.reviveRepelTime=0,this.frozenTime=0,this.isFrozening=!1,this.rewardExpCount=0,this.rewardCoinCount=0,this.killerData=null,this.bodyHurtReduction=0,this.headHurtReduction=0,this.frozenImmuneTime=0,this.thunderImmuneTime=0,this.invincibleTime=0,this.divineShieldCDTime=0,this.thunderBoltCDTime=0,this.skillRevive=0,this.isReviving=!1,this.isRevived=!1,this.isFireArrow=!1,this.hasEnemyShield=!1,this.enemyEquipSkills=new u.SkillData,this.continueHeadShootCount=0,this.orientation=null,this.isTurnEnemy=!1}o=(n=cc._decorator).ccclass,n.property,h.prototype.addExp=function(e){null!=e&&(this.isDead||this.isDestroy||(this.exp+=e))},h.prototype.restoreHp=function(e){null!=e&&(e=Math.round(e),this.hp+=e,this.hp=Math.min(this.hp,this.maxHp))},h.prototype.restoreEquipmentDefense=function(e,t){t=Math.round(t),e==s.EquipmentType.helmet?(this.helmetDefense+=t,this.helmetDefense=Math.max(0,this.helmetDefense),this.helmetDefense=Math.min(this.helmetDefense,this.maxHelmetDefense)):e==s.EquipmentType.shield&&(this.shieldDefense+=t,this.shieldDefense=Math.max(0,this.shieldDefense),this.shieldDefense=Math.min(this.shieldDefense,this.maxShieldDefense))},h.prototype.reduceHp=function(e){e=Math.round(e),this.hp-=e,this.hp=Math.max(0,this.hp)},h.prototype.reduceEquipmentDefense=function(e,t){t=Math.round(t),e==s.EquipmentType.helmet?(this.helmetDefense-=t,this.helmetDefense=Math.max(0,this.helmetDefense)):e==s.EquipmentType.shield&&(this.shieldDefense-=t,this.shieldDefense=Math.max(0,this.shieldDefense))},h.prototype.resetData=function(e){this.isRevived=e=void 0!==e&&e,this.isDead=!1,this.isFalledDown=!1,this.isDestroy=!1,this.isRecycled=!1,this.hp=this.maxHp,this.isPlayer&&(this.helmetDefense=this.maxHelmetDefense,this.shieldDefense=this.maxShieldDefense,this.invincibleTime=2),this.weaponLaunch=!1,this.helmetDroped=!1,this.shieldDroped=!1,this.headDroped=!1,this.isAttack=!1,this.isTeleporting=!1,this.repelTime=0,this.reviveRepelTime=0,this.frozenTime=0,this.isFrozening=!1},h.prototype.getEnemyRandomSkill=function(){var e=d.GameState.currentChapter,t=c.GameConfigData.data.enemySkill[e-1];if(this.isBoss)this.enemyEquipSkills.addSkill(t[0]);else{var a=r.ConfigData.isWizardProfession(this.profession);if(this.profession==l.ProfessionEnum.SHORT_ZOMBIE||this.profession==l.ProfessionEnum.WARRIOR||this.profession==l.ProfessionEnum.SHARKER||this.profession==l.ProfessionEnum.SHIELD_DEFENDER||this.profession==l.ProfessionEnum.RUN_DRAGON||a)this.enemyEquipSkills.addSkill(l.SkillTypeEnum.DODGE);else{var n=p.Util.getRandomIndexInChanceArray(c.GameConfigData.data.enemySkillChance[e-1]);switch(e){case 1:case 2:case 3:this.enemyEquipSkills.addSkill(t[n]);break;case 4:case 5:case 6:case 7:0==n?(this.enemyEquipSkills.addSkill(t[0]),this.enemyEquipSkills.addSkill(t[1])):this.enemyEquipSkills.addSkill(t[n+1])}}}},o=__decorate([o],h),i.RoleData=o,cc._RF.pop()},{}],RoleManager:[function(e,t,a){"use strict";cc._RF.push(t,"56bf4GkKBNFRrDLyXVGLtXp","RoleManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l=cc._decorator;function r(){return null!==i&&i.apply(this,arguments)||this}n=l.ccclass,l.property,i=cc.Component,__extends(r,i),r.init=function(){this.roleMap=new Map},r.restoreRoleHp=function(e,t,a,n){void 0===a&&(a=!0),void 0===n&&(n=!0),null==e||null==t||e.isDead||null!=(e=this.getRole(e.id))&&e.restoreHp(t,a,n)},r.restoreRoleEquipmentDefense=function(e,t,a,n,o){void 0===n&&(n=!0),void 0===o&&(o=!0),null==e||null==a||e.isDead||null!=(e=this.getRole(e.id))&&e.repairEquipment(t,a,n,o)},r.roleIsDamaged=function(e,t,a,n,o,i,l,r,s,c){if(void 0===o&&(o=!0),void 0===i&&(i=!1),void 0===l&&(l=!1),void 0===r&&(r=!0),void 0===s&&(s=!1),void 0===c&&(c=!1),null!=e&&null!=a&&!e.isDead&&null!=(e=this.getRole(e.id)))return e.isDamaged(t,a,n,o,i,l,r,s,c)},r.equipmentIsDamaged=function(e,t,a,n,o){null==e||null==t||null==n||null==o||e.isDead||null!=(e=this.getRole(e.id))&&e.equipmentIsDamaged(t,a,n,o)},r.hitRole=function(e,t,a,n){void 0===t&&(t=!1),void 0===a&&(a=!1),void 0===n&&(n=!1),null==e||e.isDead||null!=(e=this.getRole(e.id))&&e.isHit(t,a,n)},r.roleDie=function(e){null==e||null!=(e=this.getRole(e.id))&&e.die()},r.frozeRole=function(e){null==e||e.isDead||null!=(e=this.getRole(e.id))&&e.isFroze()},r.recyvleRole=function(e){null==e||e.isDead||null!=(e=this.getRole(e.id))&&e.recyvle()},r.addWaitingLaunchArrow=function(e,t){null==e||null==t||null!=(e=this.getRole(e.id))&&e.addWaitingLaunchArrow(t)},r.pauseWaitingLaunchArrows=function(e){null==e||null!=(e=this.getRole(e.id))&&e.pauseWaitingLaunchArrows()},r.resumeWaitingLaunchArrows=function(e){null==e||null!=(e=this.getRole(e.id))&&e.resumeWaitingLaunchArrows()},r.clearWaitingLaunchArrows=function(e){null==e||null!=(e=this.getRole(e.id))&&(e.arrowLaunchTimers=[])},r.addRole=function(e,t){null!=e&&null!=t&&this.roleMap.set(e,t)},r.getRole=function(e){if(null!=e&&this.roleMap.has(e))return this.roleMap.get(e)},r.deleteRole=function(e){null!=e&&this.roleMap.has(e)&&this.roleMap.delete(e)},r.roleMap=null,n=__decorate([n],r),o.RoleManager=n,cc._RF.pop()},{}],RunDragonSpineController:[function(e,t,a){"use strict";cc._RF.push(t,"57597d1KPZDm69UahPfwqNi","RunDragonSpineController");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("SpineController"),s=o("BattleNodeManager"),c=o("EnumAndConst");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.leftLegCollider=null,e.rightLegCollider=null,e.leftTopLegBone=null,e.leftBelowLegBone=null,e.rightTopLegBone=null,e.rightBelowLegBone=null,e}o=(n=cc._decorator).ccclass,n.property,l=r.SpineController,__extends(p,l),p.prototype.onEnable=function(){l.prototype.onEnable.call(this),this.leftLegCollider=null,this.rightLegCollider=null,this.leftTopLegBone=null,this.leftBelowLegBone=null,this.rightTopLegBone=null,this.rightBelowLegBone=null,this.leftTopLegBone=this.roleUpSpineAni.findBone("LEG_L_TOP"),this.leftBelowLegBone=this.roleUpSpineAni.findBone("LEG_L_BELOW"),this.rightTopLegBone=this.roleUpSpineAni.findBone("LEG_R_TOP"),this.rightBelowLegBone=this.roleUpSpineAni.findBone("LEG_R_BELOW")},p.prototype.update=function(){null==this.roleData||this.roleData.isDestroy||(this.bodyNode.scaleX=this.roleData.orientation,this.refreshHead(),this.refreshBody(),this.refreshLegs())},p.prototype.bindData=function(e,t,a){this.roleData=e,null!=t&&(this.bodyCollider=t[0],this.leftLegCollider=t[1],this.rightLegCollider=t[2]),null!=a&&(this.headCollider=a),this.bodyNode=this.bodyCollider.node.parent},p.prototype.refreshHead=function(){var e,t;this.headBone&&this.headCollider&&(e=cc.v2(this.headBone.worldX,this.headBone.worldY),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(c.BattleNodeEnum.HELMET_NODE))&&(t=e.convertToNodeSpaceAR(t),this.headCollider.node.position=t,this.headCollider.node.angle=this.headBone.rotation*this.roleData.orientation))},p.prototype.refreshBody=function(){var e;this.bodyBone&&this.bodyCollider&&(e=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY),this.bodyCollider.node.position=e.add(cc.v2(-20,-29)),this.bodyCollider.node.angle=this.bodyBone.rotation)},p.prototype.refreshLegs=function(){if(this.leftTopLegBone&&this.leftBelowLegBone&&this.leftLegCollider){if(0==(o=cc.v2(this.leftTopLegBone.worldX,this.leftTopLegBone.worldY).sub(cc.v2(this.leftBelowLegBone.worldX,this.leftBelowLegBone.worldY))).x&&0==o.y)return;var e=cc.v2(this.leftBelowLegBone.worldX,this.leftBelowLegBone.worldY).add(o.mul(1)),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),a=this.bodyNode.convertToNodeSpaceAR(t),n=180*-o.signAngle(cc.Vec2.RIGHT)/Math.PI;this.leftLegCollider.node.position=a,this.leftLegCollider.node.angle=75-n}var o;this.rightTopLegBone&&this.rightBelowLegBone&&this.rightLegCollider&&(0==(o=cc.v2(this.rightTopLegBone.worldX,this.rightTopLegBone.worldY).sub(cc.v2(this.rightBelowLegBone.worldX,this.rightBelowLegBone.worldY))).x&&0==o.y||(e=cc.v2(this.rightBelowLegBone.worldX,this.rightBelowLegBone.worldY).add(o.mul(1)),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),a=this.bodyNode.convertToNodeSpaceAR(t),n=180*-o.signAngle(cc.Vec2.RIGHT)/Math.PI,this.rightLegCollider.node.position=a,this.rightLegCollider.node.angle=45-n))},o=__decorate([o],p),i.RunDragonSpineController=o,cc._RF.pop()},{}],RunDragon:[function(e,t,a){"use strict";cc._RF.push(t,"9382cauS8dOUawUULYSfC53","RunDragon");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("ShortRoleBase"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("RoleManager"),d=o("GameState"),u=o("EnumAndConst"),h=o("SkillSystem"),m=o("Util"),f=o("SpecailSkill"),g=o("BattleNumManager"),y=o("LocalSoundManager"),v=o("LocalData"),D=o("SingleEffectManager"),E=o("Timer"),S=o("GameManager"),A=o("EquipmentEffectSystem"),C=o("EnemyArea"),M=o("Head"),T=o("EffectCreate"),_=o("PlayerState");function k(){var e=null!==l&&l.apply(this,arguments)||this;return e.rushSpeed=400,e.moveSpeed=200,e.rushDistance=0,e}o=(n=cc._decorator).ccclass,n.property,l=r.ShortRoleBase,__extends(k,l),k.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.rushSpeed=400,this.moveSpeed=200,this.isMoving=!1,this.isHitAniRunning=!1,this.isWaitingRevive=!1,this.rushDistance=0},k.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},k.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),!this.roleData.isRecycled)){if(this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,d.GameState.isGaming&&this.isMoving&&this.moveToTarget(e),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!d.GameState.isGaming||this.roleData.isDead)return;this.spineController.playAnimation(u.SpineAniNameEnum.Fankui,!1,!1,null)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},k.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1;var n=a.getComponent(M.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.spineController.playAnimation(u.SpineAniNameEnum.Run,!1,!0,null,1),this.searchAttackTarget()},k.prototype.searchAttackTargetData=function(){var e=this;if(d.GameState.isGaming&&null!=this.roleData&&!this.roleData.isDead){var t=this.roleData.isEnemy?C.EnemyArea.friendDatas:C.EnemyArea.enemyDataArray;if(t.length<=0)this.attackTargetData=this.roleData.isEnemy?_.PlayerState.playerData:null;else{var a=[];if(t.forEach(function(t){null==t||null==t.logicPos||t.isDead||t.isTeleporting||e.roleData.isEnemy&&t.logicPos.x>=e.roleData.logicPos.x||!e.roleData.isEnemy&&e.roleData.attackModel==u.AttackModelTypeEnum.MELEE_ATTACK&&t.logicPos.x<=e.roleData.logicPos.x||e.roleData.attackModel==u.AttackModelTypeEnum.MELEE_ATTACK&&(20<e.roleData.logicPos.y-t.logicPos.y||40<t.logicPos.y-e.roleData.logicPos.y)||a.push(t)}),a.length<=0)this.attackTargetData=this.roleData.isEnemy?_.PlayerState.playerData:null;else{this.roleData.isEnemy&&a.push(_.PlayerState.playerData);for(var n=null,o=9999,i=0;i<a.length;i++){var l,r=a[i];null!=r&&(l=m.Util.getDistance(this.roleData.logicPos,r.logicPos),this.roleData.attackModel==u.AttackModelTypeEnum.MELEE_ATTACK?l<=120&&l<o&&(n=r,o=l):0<=r.logicPos.y&&50<l&&l<o&&(n=r,o=l))}this.attackTargetData=null!=n?n:this.roleData.isEnemy?_.PlayerState.playerData:null}}}},k.prototype.searchAttackTarget=function(){if(null!=this.roleData&&!this.roleData.isDead)if(this.searchAttackTargetData(),this.isMoving=!0,d.GameState.isGaming){if(this.attackTargetData.logicPos.sub(this.roleData.logicPos).mag()<=this.attackDis)return this.isMoving=!1,void this.setAttack();this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||this.isHitAniRunning||this.spineController.playAnimation(u.SpineAniNameEnum.Run,!1,!0,null,1)}else this.spineController.pauseAnimation(!0)},k.prototype.moveToTarget=function(e){if(null==this.roleData||this.roleData.isDead)this.isMoving=!1;else if(!(this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){var t=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),a=Math.abs(t.x),n=this.rushSpeed;if(n=t.x<0?-n:n,120<a)return this.rushDistance+=Math.abs(n*e),void(this.node.x+=n*e);this.isMoving=!1,null!=this.attackTargetData?100<this.rushDistance?this.rushAttack():this.setAttack():this.die()}},k.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=h.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!d.GameState.isGaming||this.spineController.playAnimation(u.SpineAniNameEnum.Fankui,!1,!0,null)))},k.prototype.rushAttack=function(){var e,t,a,n,o=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||null==(e=this.attackTargetData)||e.isDead||e.isTeleporting||(t=Math.abs(this.roleData.logicPos.x-e.logicPos.x),n=Math.abs(this.roleData.logicPos.y-e.logicPos.y),120<t||70<n||(t=0,this.roleData.isEnemy&&this.attackTargetData.isPlayer&&(t=h.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.DODGE)),this.attackTargetData.enemyEquipSkills.isHaveSkill(u.SkillTypeEnum.DODGE)&&(t=h.SkillSystem.getEquipedSkillInitData(u.SkillTypeEnum.DODGE),this.attackTargetData.isBoss&&d.GameState.heroModel&&(t*=2)),Math.random()<t?T.EffectCreate.createRoleTip(e.logicPos,0):(n=2*this.roleData.atk,e.hasEnemyShield?(e.hasEnemyShield=!1,a=Math.round(n),t=u.BattleNumTypeEnum.HP_REDUCE,g.BattleNumManager.createBattleNumEffect(t,a,e,e.logicPos),y.LocalSoundManager.playShieldResistAudio()):0<e.shieldDefense?(y.LocalSoundManager.playShieldResistAudio(),a=Math.round(n),p.RoleManager.equipmentIsDamaged(this.attackTargetData,v.EquipmentType.shield,this.roleData,a,cc.v2(e.logicPos.x+35,e.logicPos.y)),e.shieldDefense<=0&&(e.shieldDroped=!0)):0<e.helmetDefense?(y.LocalSoundManager.playHelmetResistAudio(),a=Math.round(n),p.RoleManager.equipmentIsDamaged(this.attackTargetData,v.EquipmentType.helmet,this.roleData,a,cc.v2(e.headPosition.x,e.headPosition.y)),e.helmetDefense<=0&&(e.helmetDroped=!0)):(n=Math.round(n),n*=1-e.bodyHurtReduction,p.RoleManager.roleIsDamaged(this.attackTargetData,this.roleData,n,e.logicPos,!0,!1,!0),e.invincibleTime<=0?(y.LocalSoundManager.playArrowHitAudio(),y.LocalSoundManager.playVibrateShort(),D.SingleEffectManager.showBloodEffect(e.logicPos,1,e),this.thunderSkill(e)):y.LocalSoundManager.playShieldResistAudio()),this.rushDistance=0,this.spineController.playAnimation(u.SpineAniNameEnum.St,!1,!0,null),E.TimerManager.addTimer(1,function(){o.setAttack()},this.node))))},k.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.rushDistance=0,this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);if(20<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||40<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||120<t||null!=e.attackTargetData&&e.attackTargetData.isDead)return e.node.stopAllActions(),void e.searchAttackTarget();d.GameState.isGaming?e.spineController.playAnimation(u.SpineAniNameEnum.Atk,!1,!1,function(){e.spineController.playAnimation(u.SpineAniNameEnum.St,!1,!0,null)}):e.node.stopAllActions()}),cc.delayTime(.8),cc.callFunc(function(){var t,a,n,o=e.attackTargetData;null==o||o.isDead||o.isTeleporting||(t=Math.abs(e.roleData.logicPos.x-o.logicPos.x),n=Math.abs(e.roleData.logicPos.y-o.logicPos.y),120<t||70<n||(t=0,e.roleData.isEnemy&&e.attackTargetData.isPlayer&&(t=h.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.DODGE)),e.attackTargetData.enemyEquipSkills.isHaveSkill(u.SkillTypeEnum.DODGE)&&(t=h.SkillSystem.getEquipedSkillInitData(u.SkillTypeEnum.DODGE),e.attackTargetData.isBoss&&d.GameState.heroModel&&(t*=2)),Math.random()<t?T.EffectCreate.createRoleTip(o.logicPos,0):(n=e.roleData.atk,o.hasEnemyShield?(o.hasEnemyShield=!1,a=Math.round(n),t=u.BattleNumTypeEnum.HP_REDUCE,g.BattleNumManager.createBattleNumEffect(t,a,o,o.logicPos),y.LocalSoundManager.playShieldResistAudio()):0<o.shieldDefense?(y.LocalSoundManager.playShieldResistAudio(),a=Math.round(n),p.RoleManager.equipmentIsDamaged(e.attackTargetData,v.EquipmentType.shield,e.roleData,a,cc.v2(o.logicPos.x+35,o.logicPos.y)),o.shieldDefense<=0&&(o.shieldDroped=!0)):0<o.helmetDefense?(y.LocalSoundManager.playHelmetResistAudio(),a=Math.round(n),p.RoleManager.equipmentIsDamaged(e.attackTargetData,v.EquipmentType.helmet,e.roleData,a,cc.v2(o.headPosition.x,o.headPosition.y)),o.helmetDefense<=0&&(o.helmetDroped=!0)):(n=Math.round(n),n*=1-o.bodyHurtReduction,p.RoleManager.roleIsDamaged(e.attackTargetData,e.roleData,n,o.logicPos),o.invincibleTime<=0?(y.LocalSoundManager.playArrowHitAudio(),y.LocalSoundManager.playVibrateShort(),D.SingleEffectManager.showBloodEffect(o.logicPos,1,o),e.thunderSkill(o)):y.LocalSoundManager.playShieldResistAudio()))))}),cc.delayTime(m.Util.getRandomFloatNum(1,1.5))))))},k.prototype.thunderSkill=function(e){var t,a;0<e.thunderImmuneTime||(t=(t=(t=[]).concat([_.PlayerState.playerData])).concat(C.EnemyArea.friendDatas),a=h.SkillSystem.getEquipedSkillInitData(u.SkillTypeEnum.THUNDER),f.SpecailSkill.thunderSkill(this.roleData,e,t,a,!1))},k.prototype.isHit=function(){var e=this;null!=this.roleData&&!this.roleData.isDead&&this.roleData.isMoveModel?this.isMoving&&this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(this.isHitAniRunning=!0,this.node.stopAllActions(),this.spineController.playAnimation(u.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,d.GameState.isGaming&&!e.roleData.isDead&&e.spineController.playAnimation(u.SpineAniNameEnum.Run,!1,!0,null))},1.5),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0)):this.isHitAniRunning=!1},k.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.node.stopAllActions(),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},k.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isEnemy?(this.searchAttackTarget(),p.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5):this.searchAttackTarget())},k.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&this.close()},k.prototype.die=function(){var e=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.node.stopAllActions(),E.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?S.GameManager.killEnemy(this.roleData):S.GameManager.friendDie(this.roleData),A.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),this.spineController.playAnimation("Dead",!1,!1,function(){var t=null!=C.EnemyArea.necromancer&&C.EnemyArea.reviveReady&&null==C.EnemyArea.necromancer.targetData;if(e.roleData.isEnemy&&t)return e.isWaitingRevive=!0,void C.EnemyArea.necromancer.reviveEnemy(e.roleData);E.TimerManager.addTimer(.1,function(){null!=e.roleData&&(e.roleData.isDestroy=!0,e.close(),f.SpecailSkill.killBlast(e.roleData))},e.node)}))},o=__decorate([o],k),i.RunDragon=o,cc._RF.pop()},{}],SelectMapUI:[function(e,t,a){"use strict";cc._RF.push(t,"b695alG/a1AOJCAtMU7XFgC","SelectMapUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("MapItem"),c=n("LocalData"),p=n("TipManager"),d=n("LocalSoundManager"),u=n("WorldEventManager"),h=n("LocalWorldEventType"),m=n("UIManager"),f=n("GameConfigData");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.mapItem=null,e.mapContent=null,e.enterBtnSprite=null,e.enterBtnSpriteFrames=[],e.mapItems=[],e.selectChapter=1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.onLoad=function(){m.UIManager.createCurrencyUI(this.node),this.showMaps()},g.prototype.refreshMapItems=function(){this.selectChapter<=c.LocalData.data.currentChapter?this.enterBtnSprite.spriteFrame=this.enterBtnSpriteFrames[0]:this.enterBtnSprite.spriteFrame=this.enterBtnSpriteFrames[1];for(var e=0;e<this.mapItems.length;e++){var t=this.mapItems[e];null!=t&&(t.chapter==this.selectChapter?t.refreshSkillButton(!0):t.refreshSkillButton(!1))}},g.prototype.changeSelectMap=function(e){this.selectChapter=e+1,this.refreshMapItems()},g.prototype.showMaps=function(){for(var e=f.GameConfigData.data.MAX_CHAPTER_COUNT,t=0;t<e;t++){var a=r.GameCommonPool.requestInstant(this.mapItem);if(null==a)return;var n=a.getComponent(s.MapItem);if(null==n)return;n.bindData(t+1),a.setParent(this.mapContent),this.mapItems.push(n)}},g.prototype.clickEnter=function(){if(d.LocalSoundManager.playAudio("click"),this.selectChapter>f.GameConfigData.data.MAX_CHAPTER_COUNT)p.TipManager.showTip("\u656c\u8bf7\u671f\u5f85");else if(this.selectChapter>c.LocalData.data.currentChapter)p.TipManager.showTip("\u8bf7\u5148\u901a\u8fc7\u4e0a\u4e00\u7ae0\u8282");else{switch(c.LocalData.data.selectChapter=this.selectChapter,this.selectChapter){case 1:case 2:case 3:case 4:case 5:u.WorldEventManager.triggerEvent(h.LocalWorldEventType.ShowBubble,{type:12+this.selectChapter});break;case 6:u.WorldEventManager.triggerEvent(h.LocalWorldEventType.ShowBubble,{type:48});break;case 7:u.WorldEventManager.triggerEvent(h.LocalWorldEventType.ShowBubble,{type:49})}this.close()}},g.prototype.clickBack=function(){d.LocalSoundManager.playAudio("click"),this.close()},g.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5730\u56feitem",type:cc.Prefab})],g.prototype,"mapItem",void 0),__decorate([o({displayName:"\u5730\u56feitem\u7236\u8282\u70b9",type:cc.Node})],g.prototype,"mapContent",void 0),__decorate([o({displayName:"\u8fdb\u5165\u6309\u94ae",type:cc.Sprite})],g.prototype,"enterBtnSprite",void 0),__decorate([o({displayName:"\u8fdb\u5165\u6309\u94ae\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],g.prototype,"enterBtnSpriteFrames",void 0),n=__decorate([n],g),i.SelectMapUI=n,cc._RF.pop()},{}],SelectSkillPop:[function(e,t,a){"use strict";cc._RF.push(t,"7cf1b8pGjBOXYZ0KMafhY50","SelectSkillPop");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("SkillItem"),c=n("Util"),p=n("SkillSystem"),d=n("LocalSoundManager"),u=n("ShareVideoControl"),h=n("LocalData"),m=n("ConfigData"),f=n("UIManager"),g=n("ShareManager"),y=n("EnumAndConst"),v=n("GameConfigData"),D=n("GameState"),E=n("PlayerState"),S=n("EndlessModelConfigData"),A=n("AdManager");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.widgets=[],e.finger=null,e.resetTip=null,e.resetBtn=null,e.videoIcon=null,e.skillContent=null,e.selectSkillItem=null,e.skillItems=[],e.alreadyRandomIndexes=[],e.fullLevelIndexes=[],e.closeAction=null,e.isReset=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(C,l),C.prototype.onEnable=function(){null!=this.widgets&&0<this.widgets.length&&this.widgets.forEach(function(e){e.updateAlignment()}),h.LocalData.data.resetSkillVideo?this.videoIcon.active=!0:this.videoIcon.active=!1,this.isReset=!1,this.alreadyRandomIndexes=[]},C.prototype.update=function(){f.UIManager.isMainUI&&r.GameCommonPool.returnInstant(this.node)},C.prototype.bindData=function(e){this.closeAction=e,this.randomThreeSkill(),this.refreshSelectSkillTip()},C.prototype.refreshSelectSkillTip=function(){var e=this;0==h.LocalData.data.selectSkillTip?(this.resetTip.active=!1,this.resetBtn.node.active=!1,this.finger.active=!0,this.finger.opacity=0,this.finger.scale=1.5,this.finger.x=-195,this.finger.y=40,this.finger.stopAllActions(),this.finger.runAction(cc.repeatForever(cc.sequence(cc.spawn(cc.scaleTo(.5,1),cc.fadeIn(.5)),cc.scaleTo(.5,1.5),cc.scaleTo(.5,1),cc.spawn(cc.scaleTo(.5,1.5),cc.fadeOut(.5)),cc.delayTime(.5),cc.callFunc(function(){e.finger.x+=195,195<e.finger.x&&(e.finger.x=-195)}))))):1==h.LocalData.data.selectSkillTip?(this.resetTip.active=!0,this.resetBtn.node.active=!0,this.finger.active=!0,this.finger.opacity=0,this.finger.scale=1.5,this.finger.position=cc.v2(0,-200),this.finger.stopAllActions(),this.finger.runAction(cc.sequence(cc.spawn(cc.scaleTo(.5,1),cc.fadeIn(.5)),cc.callFunc(function(){e.finger.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,1.5),cc.scaleTo(.5,1))))})))):(this.resetTip.active=!0,this.resetBtn.node.active=!0,this.finger.active=!1)},C.prototype.randomThreeSkill=function(){var e=this;this.fullLevelIndexes=[],3<this.alreadyRandomIndexes.length&&this.alreadyRandomIndexes.splice(0,3);for(var t=0;t<=v.GameConfigData.data.skillMaxLevel.length;t++)p.SkillSystem.isSkillFullLevel(t)&&this.fullLevelIndexes.push(t);if(this.fullLevelIndexes.length>v.GameConfigData.data.skillMaxLevel.length-8)this.close();else{var a,n=[];for(t=0;t<3;t++){var o=this.getSkill(t+1);n.push(o),-1==(a=this.alreadyRandomIndexes.indexOf(o))&&this.alreadyRandomIndexes.push(o)}for(t=0;t<n.length;t++)if(null!=(a=n[t])){if(null==this.skillItems[t]){var i=r.GameCommonPool.requestInstant(this.selectSkillItem);if(null==i)continue;if(i.setParent(this.skillContent),i.y=0,null==(i=i.getComponent(s.SkillItem)))continue;this.skillItems[t]=i}this.skillItems[t].bindInfo(a,1,!0,function(){0==h.LocalData.data.selectSkillTip&&h.LocalData.data.selectSkillTip++,r.GameCommonPool.returnInstant(e.node)},function(){e.closeAction&&e.closeAction(),e.closeAction=null})}}},C.prototype.getSkill=function(e){if(!D.GameState.endlessModel&&h.LocalData.data.selectSkillTip<1){var t=[];t.push(y.SkillTypeEnum.DIVISION),t.push(y.SkillTypeEnum.RUNNINGFIRE),t.push(y.SkillTypeEnum.CATAPULT),t.push(y.SkillTypeEnum.PENETRATE),t.push(y.SkillTypeEnum.THUNDER),t.push(y.SkillTypeEnum.FROZEN),t.push(y.SkillTypeEnum.IGNITE);for(var a=0,n=this.alreadyRandomIndexes;a<n.length;a++){var o=n[a];null!=o&&-1!=t.indexOf(o)&&t.splice(t.indexOf(o),1)}return t[c.Util.getRandomNum(0,t.length-1)]}for(var i=D.GameState.skillPool,l=h.LocalData.data.passChapter,r=D.GameState.currentChapter,s=E.PlayerState.playerData.level,p=[0,1,2,3],d=0,u=(d=D.GameState.endlessModel?S.EndlessModelConfigData.getEndlessSkillArrayIndex(s-1,this.isReset,e):l<=0?-1:m.ConfigData.getSkillArrayIndex(r,s-1,this.isReset,e),m.ConfigData.getSkillArray(d,this.alreadyRandomIndexes,this.fullLevelIndexes,i)),f=0;f<p.length&&(null==u||u.length<=0);f++)p.splice(p.indexOf(d),1),d=this.isReset&&1<p.length?p[c.Util.getRandomNum(1,p.length-1)]:p[c.Util.getRandomNum(0,p.length-1)],u=m.ConfigData.getSkillArray(d,this.alreadyRandomIndexes,this.fullLevelIndexes,i),f--;if(!(null==u||u.length<=0))return u[c.Util.getRandomNum(0,u.length-1)]},C.prototype.onClickReset=function(){var e=this;function t(){e.isReset=!0,e.randomThreeSkill(),A.AdManager.canShowInterstitial=!1}if(d.LocalSoundManager.playAudio("click"),1==h.LocalData.data.selectSkillTip&&(this.finger.stopAllActions(),this.finger.active=!1,h.LocalData.data.selectSkillTip++),!h.LocalData.data.resetSkillVideo)return h.LocalData.data.resetSkillVideo=!0,this.videoIcon.active=!0,void t();g.ShareManager.getShareControlType()!=g.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?u.ShareVideoControl.videoFunc("\u91cd\u7f6e\u6280\u80fd",t,null,t,null,null,u.VideoAdIdEnum.RESET_SKILL_ID):t()},C.prototype.close=function(){0==h.LocalData.data.selectSkillTip&&h.LocalData.data.selectSkillTip++,this.closeAction&&this.closeAction(),r.GameCommonPool.returnInstant(this.node)},__decorate([o({type:cc.Widget})],C.prototype,"widgets",void 0),__decorate([o({displayName:"\u624b\u6307",type:cc.Node})],C.prototype,"finger",void 0),__decorate([o({displayName:"\u91cd\u7f6e\u63d0\u793a",type:cc.Node})],C.prototype,"resetTip",void 0),__decorate([o({displayName:"\u91cd\u7f6e\u6309\u94ae",type:cc.Sprite})],C.prototype,"resetBtn",void 0),__decorate([o({displayName:"\u91cd\u7f6e\u6309\u94ae\u89c6\u9891\u89d2\u6807",type:cc.Node})],C.prototype,"videoIcon",void 0),__decorate([o({displayName:"\u6280\u80fd\u5185\u5bb9\u8282\u70b9",type:cc.Node})],C.prototype,"skillContent",void 0),__decorate([o({displayName:"\u9009\u62e9\u6280\u80fditem",type:cc.Prefab})],C.prototype,"selectSkillItem",void 0),n=__decorate([n],C),i.SelectSkillPop=n,cc._RF.pop()},{}],SettlementUI:[function(e,t,a){"use strict";cc._RF.push(t,"9a36a1dS2JNQI8QuGWFBtMr","SettlementUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("RewardItem"),c=n("SkillItem"),p=n("GameCommonPool"),d=n("GameManager"),u=n("UIManager"),h=n("SkillSystem"),m=n("WorldEventManager"),f=n("LocalWorldEventType"),g=n("EnumAndConst"),y=n("LocalData"),v=n("LocalSoundManager"),D=n("ShareVideoControl"),E=n("TipManager"),S=n("Util"),A=n("GameConfigData"),C=n("RankingManager"),M=n("ShareManager"),T=n("GameState"),_=n("PlayerState"),k=n("WorldRankingManager"),P=n("Connecting"),R=n("DropManager");function I(){var e=null!==l&&l.apply(this,arguments)||this;return e.chapterLabel=null,e.partNum=null,e.percentNum=null,e.defeatText=null,e.skillContent=null,e.rewardContent=null,e.allBg=null,e.skillItem=null,e.rewardItem=null,e.tripleGetBtn=null,e.shareBtn=null,e.tripleGetSelectBtn=null,e.selected=null,e.tittleSprite=null,e.tittleSpriteFrames=[],e.tipLabel=null,e.videoIcon=null,e.rewardCoin1=null,e.rewardCoin2=null,e.rewardItems=[],e.skillItems=[],e.rewardDatas=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(I,l),I.prototype.onEnable=function(){this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3))),this.rewardDatas=[],this.selected.active=!0,this.videoIcon.active=!0,this.rewardCoin1=null,this.rewardCoin2=null,this.refresh()},I.prototype.onDisable=function(){for(var e=0;e<this.rewardItems.length;e++){var t=this.rewardItems[e];null!=t&&p.GameCommonPool.returnInstant(t),this.rewardItems.splice(e,1),e--}for(e=0;e<this.skillItems.length;e++){var a=this.skillItems[e];null!=a&&p.GameCommonPool.returnInstant(a),this.skillItems.splice(e,1),e--}},I.prototype.update=function(){u.UIManager.isMainUI&&p.GameCommonPool.returnInstant(this.node)},I.prototype.refresh=function(){this.partNum.value=T.GameState.currentPart+"",T.GameState.endlessModel?(this.chapterLabel.string="\u65e0\u5c3d\u6a21\u5f0f",this.defeatText.active=!1,2<=T.GameState.currentPart&&T.GameState.currentPart<=600&&(C.RankingManager.submitData(g.OpenDataKeyEnum.ENDLESS_PART,T.GameState.currentPart-1),k.WorldRankingManager.postUserWorldData(T.GameState.currentPart-1))):(this.chapterLabel.string="\u7ae0\u8282"+T.GameState.currentChapter,T.GameState.gameFail=T.GameState.currentPart<20,e=T.GameState.win?20:T.GameState.currentPart-1,y.LocalData.setChapterMaxPart(T.GameState.heroModel,T.GameState.currentChapter,e),(t=y.LocalData.getChapterRecord(T.GameState.currentChapter,e,T.GameState.heroModel))>y.LocalData.data.chapterRecord&&(y.LocalData.data.chapterRecord=t,C.RankingManager.submitData(g.OpenDataKeyEnum.PART,y.LocalData.data.chapterRecord)),T.GameState.currentPart<=1?this.defeatText.active=!1:(s=Math.round(T.GameState.win?5*T.GameState.currentPart:5*(T.GameState.currentPart-1)),r=S.Util.getRandomNum(s-4,s+4),r=Math.min(r,100),r=Math.max(r,0),this.defeatText.active=!0,this.percentNum.value=r+""));var e=T.GameState.win?A.GameConfigData.data.victoryText:A.GameConfigData.data.defeatText;if(!(null==e||e.length<=0)){var t=S.Util.getRandomNum(0,e.length-1);if(!(t<0||t>=e.length)){this.tipLabel.string=e[t],20<=T.GameState.currentChapter?this.tittleSprite.spriteFrame=this.tittleSpriteFrames[0]:this.tittleSprite.spriteFrame=this.tittleSpriteFrames[1];for(var a=h.SkillSystem.chooseSkills,n=0;n<a.length;n++){var o=a[n],i=p.GameCommonPool.requestInstant(this.skillItem);if(null==i)return;var l=i.getComponent(c.SkillItem);if(null==l)return;l.bindInfo(o,1,!1,null,null),i.setParent(this.skillContent),this.skillItems.push(i)}var r,s=_.PlayerState.playerData;null!=s&&(r=Math.round(s.rewardCoin),(e=new g.RewardData).rewardType=1,e.rewardCount=r,(t=new g.RewardData).rewardType=2,t.rewardCount=0,T.GameState.heroModel&&(s=S.Util.getRandomNum(A.GameConfigData.data.dropMinGem[T.GameState.currentChapter-1],A.GameConfigData.data.dropMaxGem[T.GameState.currentChapter-1]),T.GameState.win?t.rewardCount=s:10<T.GameState.currentPart&&T.GameState.currentPart<20&&(t.rewardCount=Math.round(s/3))),this.showCoinRewardItem(e),this.showGemRewardItem(t),this.showEquipmentsRewardItems(),this.rewardCoin1=this.copyCoinItem(e),this.rewardCoin2=this.copyCoinItem(e),r<500?this.clickSelectTriple():this.coinAnimation())}}},I.prototype.showCoinRewardItem=function(e){if(null!=e){if(e.rewardCount<=0)return this.tripleGetBtn.node.active=!1,this.tripleGetSelectBtn.active=!1,void(this.shareBtn.active=!1);this.tripleGetBtn.node.active=!0,this.tripleGetSelectBtn.active=!0,this.shareBtn.active=!0;var t,a=p.GameCommonPool.requestInstant(this.rewardItem);null!=a&&(a.setParent(this.rewardContent),null!=(t=a.getComponent(s.RewardItem))&&(t.bindData(e),this.rewardItems.push(a),this.rewardDatas.push(e)))}},I.prototype.showGemRewardItem=function(e){var t,a;null==e||e.rewardCount<=0||null!=(t=p.GameCommonPool.requestInstant(this.rewardItem))&&(t.setParent(this.rewardContent),null!=(a=t.getComponent(s.RewardItem))&&(a.bindData(e),this.rewardItems.push(t),this.rewardDatas.push(e)))},I.prototype.copyCoinItem=function(e){if(null!=e){var t=p.GameCommonPool.requestInstant(this.rewardItem);if(null!=t){t.setParent(this.rewardContent);var a=t.getComponent(s.RewardItem);if(null!=a)return a.bindData(e),this.rewardItems.push(t),t}}},I.prototype.showEquipmentsRewardItems=function(){var e,t=this,a=R.DropManager.dropedEquipmentDataArray;null!=a&&(e=[],a.forEach(function(t){if(null!=t){for(var a,n=!1,o=0;o<e.length;o++){var i=e[o].equipmentData;null!=i&&t.type==i.type&&t.index==i.index&&t.rank==i.rank&&(n=!0,null==e[o].rewardCount?e[o].rewardCount=1:e[o].rewardCount++)}n||((a=new g.RewardData).rewardType=g.RewardTypeEnum.EQUIPMENT,a.equipmentData=t,e.push(a))}}),e.sort(function(e,t){return e.equipmentData.rank==t.equipmentData.rank?e.equipmentData.level==t.equipmentData.level?t.equipmentData.index-e.equipmentData.index:t.equipmentData.level-e.equipmentData.level:t.equipmentData.rank-e.equipmentData.rank}),e.forEach(function(e){var a,n=p.GameCommonPool.requestInstant(t.rewardItem);null!=n&&(n.setParent(t.rewardContent),null!=(a=n.getComponent(s.RewardItem))&&(a.bindData(e),t.rewardItems.push(n),t.rewardDatas.push(e)))}))},I.prototype.coinAnimation=function(){this.rewardCoin1.stopAllActions(),this.rewardCoin1.scale=1,this.rewardCoin1.runAction(cc.sequence(cc.scaleTo(.2,1.5),cc.scaleTo(.2,1))),this.rewardCoin2.stopAllActions(),this.rewardCoin2.scale=1,this.rewardCoin2.runAction(cc.sequence(cc.scaleTo(.2,1.5),cc.scaleTo(.2,1)))},I.prototype.clickTripleGet=function(){var e,t=this;this.selected.active?(v.LocalSoundManager.playAudio("click"),e=function(){for(var e=0;e<t.rewardDatas.length;e++){var a=t.rewardDatas[e];if(null!=a)if(1==a.rewardType)y.LocalData.changeCoin(3*a.rewardCount),E.TipManager.showTip("\u606d\u559c\u83b7\u5f97"+3*a.rewardCount+"\u91d1\u5e01");else if(2==a.rewardType)y.LocalData.changeGem(a.rewardCount);else if(3==a.rewardType)for(var n=0;n<a.rewardCount;n++)y.LocalData.rewardEquipment(a.equipmentData.type,a.equipmentData.index,a.equipmentData.rank)}t.close()},M.ShareManager.getShareControlType()!=M.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?D.ShareVideoControl.videoFunc("\u7ed3\u7b97\u4e09\u500d\u83b7\u5f97",e,null,e,null,null,D.VideoAdIdEnum.THRIPLE_RECEIVE_ID):e()):this.clickClose()},I.prototype.clickClose=function(){v.LocalSoundManager.playAudio("click");for(var e=0;e<this.rewardDatas.length;e++){var t=this.rewardDatas[e];if(null!=t)if(1==t.rewardType)y.LocalData.changeCoin(t.rewardCount);else if(2==t.rewardType)y.LocalData.changeGem(t.rewardCount);else if(3==t.rewardType)for(var a=0;a<t.rewardCount;a++)y.LocalData.rewardEquipment(t.equipmentData.type,t.equipmentData.index,t.equipmentData.rank)}this.close()},I.prototype.clickSelectTriple=function(){this.selected.active=!this.selected.active,this.videoIcon.active=this.selected.active,this.selected.active?(this.rewardCoin1.active=!0,this.rewardCoin2.active=!0,this.coinAnimation()):(this.rewardCoin1.active=!1,this.rewardCoin2.active=!1)},I.prototype.close=function(){m.WorldEventManager.triggerEvent(f.LocalWorldEventType.BackHome,null),d.GameManager.backHome(),P.Connecting.enterMainScene(function(){u.UIManager.showMainBoard()}),p.GameCommonPool.returnInstant(this.node)},I.prototype.clcikShare=function(){if(cc.sys.platform===cc.sys.WECHAT_GAME)try{wx.shareAppMessage({title:"\u7ec8\u4e8e\u6253\u5230\u8fd9\u5173\u4e86\uff01\u4f60\u8981\u4e0d\u8981\u4e5f\u6765\u8bd5\u8bd5\u770b\uff1f",imageUrl:canvas.toTempFilePathSync({x:(canvas.width-.72*1.25*canvas.height)/2,y:0,width:.72*1.25*canvas.height,height:.72*canvas.height,destWidth:500,destHeight:400})})}catch(n){console.error(n)}},__decorate([o({type:cc.Label,displayName:"\u7ae0\u8282\u6570"})],I.prototype,"chapterLabel",void 0),__decorate([o({type:r.NumberImg,displayName:"\u5173\u5361\u6570"})],I.prototype,"partNum",void 0),__decorate([o({type:r.NumberImg,displayName:"\u51fb\u8d25\u73a9\u5bb6\u767e\u5206\u6bd4\u6570"})],I.prototype,"percentNum",void 0),__decorate([o({displayName:"\u51fb\u8d25\u73a9\u5bb6\u6587\u672c",type:cc.Node})],I.prototype,"defeatText",void 0),__decorate([o({type:cc.Node,displayName:"\u4f7f\u7528\u6280\u80fd"})],I.prototype,"skillContent",void 0),__decorate([o({type:cc.Node,displayName:"\u6218\u5229\u54c1"})],I.prototype,"rewardContent",void 0),__decorate([o({type:cc.Node,displayName:"\u6574\u4f53"})],I.prototype,"allBg",void 0),__decorate([o({displayName:"\u6280\u80fditem",type:cc.Prefab})],I.prototype,"skillItem",void 0),__decorate([o({displayName:"\u5956\u52b1item",type:cc.Prefab})],I.prototype,"rewardItem",void 0),__decorate([o({type:cc.Sprite,displayName:"\u4e09\u500d\u9886\u53d6\u6309\u94ae"})],I.prototype,"tripleGetBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u5206\u4eab\u6309\u94ae"})],I.prototype,"shareBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u4e09\u500d\u9886\u53d6\u9009\u62e9\u6309\u94ae"})],I.prototype,"tripleGetSelectBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u5df2\u9009\u62e9"})],I.prototype,"selected",void 0),__decorate([o({displayName:"\u6807\u9898\u56fe\u7247",type:cc.Sprite})],I.prototype,"tittleSprite",void 0),__decorate([o({displayName:"\u6807\u9898\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],I.prototype,"tittleSpriteFrames",void 0),__decorate([o({displayName:"\u63d0\u793a\u6587\u672c",type:cc.Label})],I.prototype,"tipLabel",void 0),__decorate([o({displayName:"\u89c6\u9891\u89d2\u6807",type:cc.Node})],I.prototype,"videoIcon",void 0),n=__decorate([n],I),i.SettlementUI=n,cc._RF.pop()},{}],ShareManager:[function(e,t,a){"use strict";cc._RF.push(t,"7dadcLahatH973rAT9t0Qj7","ShareManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("GameCommonHttp"),l=n("GameCommon"),r=(s.resetDomainName=function(e){null!=e&&(this.newStatisticUrl=this.newStatisticUrl.replace("dcgstd.cn",e),this.getNewShareFlagUrl=this.getNewShareFlagUrl.replace("dcgstd.cn",e),this.getShareConfigUrl=this.getShareConfigUrl.replace("dcgstd.cn",e),this.cdnFileUrl=this.cdnFileUrl.replace("dcgstd.cn",e),this.dataStorageUrl=this.dataStorageUrl.replace("dcgstd.cn",e))},s.init=function(e){void 0===e&&(e=null);var t=l.GameConfig.wxAppName;this.getShareConfigUrl=this.cdnFileUrl+"/game-common/"+t+"/newConfig.txt?time="+Date.now(),this.defaultShareInfo=new p("default","\u53c8\u53d1\u73b0\u4e00\u4e2a\u597d\u73a9\u7684\u5c0f\u6e38\u620f\uff0c\u6765\u8bd5\u8bd5\u5427~",this.cdnFileUrl+"/game-common/"+t+"/default.png");var a=this;this.initShareConfig(function(){a.initShareControl(l.GameConfig.wxAppId,l.GameConfig.versionCode,function(){null!=e&&e()})})},s.initShareConfig=function(e){var t=this;i.GameCommonHttp.wxHttpGet(this.getShareConfigUrl,function(a,n){if(0==a&&null!=n){if(null!=(s.configData=n).newStatisticUrl&&(s.newStatisticUrl=n.newStatisticUrl,console.log(n.newStatisticUrl)),null!=n.getNewShareFlagUrl&&(s.getNewShareFlagUrl=n.getNewShareFlagUrl,console.log(n.getNewShareFlagUrl)),null!=(n=n.shareInfos))for(var o=0,i=n;o<i.length;o++){var l=i[o];t.addShareInfo(l.shareKey,l.shareText,l.shareImgUrl,l.shareImgName)}null!=e&&e()}else null!=e&&e()})},s.initShareControl=function(e,t,a){var n=this.cdnFileUrl+"/game-common/"+l.GameConfig.wxAppName+"/shareFlags/"+l.GameConfig.versionCode+".json";i.GameCommonHttp.wxHttpGet(n,function(e,t){var n;0==e&&null!=t&&null!=(n=t)&&(null!=(s.shareFlags=n).masterControl&&(s.masterControl=n.masterControl),null!=n.shareControl&&(s.shareControl=n.shareControl),null!=n.abnormalShareControl&&(s.abnormalShareControl=n.abnormalShareControl),null!=n.shareImgControl&&(s.shareImgControl=n.shareImgControl),null!=n.moreGameControl&&(s.moreGameControl=n.moreGameControl),null!=n.carouseControl&&(s.carouseControl=n.carouseControl),null!=n.horizontalControl&&(s.horizontalControl=n.horizontalControl),null!=n.passAllControl&&(s.passAllControl=n.passAllControl),null!=n.passPartControl&&(s.passPartControl=n.passPartControl),null!=n.fullScreenControl&&(s.fullScreenControl=n.fullScreenControl),null!=n.adFramesControl&&(s.adFramesControl=n.adFramesControl),null!=n.volationShareControl&&(s.volationShareControl=n.volationShareControl),null!=n.adControl&&(s.adControl=n.adControl),null!=n.bannerAdControl&&(s.bannerAdControl=n.bannerAdControl),null!=n.spriteControl&&(s.spriteControl=n.spriteControl),null!=n.bannerMistakeTouchControl&&(s.bannerMistakeTouchControl=n.bannerMistakeTouchControl),null!=n.interstitialAdControl&&(s.interstitialAdControl=n.interstitialAdControl),null!=n.violenceControl&&(s.violenceControl=n.violenceControl)),null!=a&&a()})},s.addShareInfo=function(e,t,a,n){null!=e&&null!=t&&null!=a&&((a=new p(e,t,a)).shareImgName=n,("high"==e?this.highShareInfos:this.lowShareInfos).push(a))},s.getShareControlType=function(){return this.masterControl?this.shareControl?this.volationShareControl?c.ShareAndAdOpen:c.VolationShareCloseAndAdOpen:c.ShareCloseAndAdOpen:c.ShareAndAdClose},s.getAbonormalShareControl=function(){return this.masterControl&&this.abnormalShareControl},s.getMoreGameControl=function(){return this.moreGameControl&&this.masterControl},s.getCarouseControl=function(){return this.carouseControl&&this.masterControl},s.getHorizontalControl=function(){return this.horizontalControl&&this.masterControl},s.getPassAllControl=function(){return this.passAllControl&&this.masterControl},s.getFullScreenControl=function(){return this.fullScreenControl&&this.masterControl},s.getAdFramesControl=function(){return this.adFramesControl&&this.masterControl},s.getPassPartControl=function(){return this.passPartControl&&this.masterControl},s.getBannerAdControl=function(){return this.bannerAdControl&&this.masterControl&&this.adControl},s.getVideoAdControl=function(){return this.adControl},s.getBannerMistakeControl=function(){return this.masterControl&&this.bannerMistakeTouchControl},s.getInterstitialAdControl=function(){return this.masterControl&&this.interstitialAdControl},s.getSpriteControl=function(){return this.spriteControl},s.getViolenceControl=function(){return this.violenceControl},s.getCityShareInfo=function(){return this.masterControl&&this.shareControl&&this.shareImgControl?this.getLowShareInfo():this.getHighShareInfo()},s.getHighShareInfo=function(){var e=this.highShareInfos.length;return e<=0?this.getDefaultShareInfo():(e=Math.round(Math.random()*(e-1)),this.highShareInfos[e])},s.getLowShareInfo=function(){var e=this.lowShareInfos.length;return e<=0?this.getDefaultShareInfo():(e=Math.round(Math.random()*(e-1)),this.lowShareInfos[e])},s.getDefaultShareInfo=function(){return this.defaultShareInfo},s.newStatisticUrl="https://hfws.dcgstd.cn/statistic-service/",s.getNewShareFlagUrl="https://hfapi2.dcgstd.cn/wegame-service/new/shareFlags/query",s.getShareConfigUrl="https://hffile.dcgstd.cn/share/",s.cdnFileUrl="https://hffile.dcgstd.cn",s.dataStorageUrl="https://game.dcgstd.cn/api/v1/account/save-data/10/",s.defaultShareInfo=null,s.lowShareInfos=new Array,s.highShareInfos=new Array,s.masterControl=!0,s.shareControl=!0,s.abnormalShareControl=!0,s.shareImgControl=!0,s.volationShareControl=!0,s.bannerAdControl=!0,s.adControl=!0,s.interstitialAdControl=!0,s.spriteControl=!0,s.moreGameControl=!0,s.carouseControl=!0,s.horizontalControl=!0,s.passAllControl=!0,s.passPartControl=!0,s.fullScreenControl=!0,s.adFramesControl=!0,s.bannerMistakeTouchControl=!0,s.violenceControl=!0,s.city=null,s.shareFlags=null,s.configData=null,s);function s(){}o.ShareManager=r;var c,p=(Object.defineProperty(d.prototype,"shareKey",{get:function(){return this._shareKey},set:function(e){this._shareKey=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"shareText",{get:function(){return this._shareText},set:function(e){this._shareText=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"shareImgUrl",{get:function(){return this._shareImgUrl},set:function(e){this._shareImgUrl=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"shareImgName",{get:function(){return this._shareImgName},set:function(e){this._shareImgName=e},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"convertCityText",{get:function(){return null==r.city||"null"==r.city?this.shareText.replace("[\u57ce\u5e02]","\u5e7f\u5dde"):null!=this.shareText&&null!=r.city?this.shareText.replace("[\u57ce\u5e02]",r.city):this.shareText},enumerable:!0,configurable:!0}),d);function d(e,t,a){this._shareKey=null,this._shareText=null,this._shareImgUrl=null,this._shareImgName="\u9ed8\u8ba4\u56fe",this.shareKey=e,this.shareText=t,this.shareImgUrl=a}o.ShareInfo=p,(n=c=o.ShareControlType||(o.ShareControlType={}))[n.ShareAndAdClose=1]="ShareAndAdClose",n[n.ShareAndAdOpen=2]="ShareAndAdOpen",n[n.ShareCloseAndAdOpen=3]="ShareCloseAndAdOpen",n[n.VolationShareCloseAndAdOpen=4]="VolationShareCloseAndAdOpen",(o=o.BlockExportType||(o.BlockExportType={}))[o.EQUIPMENT_UI=0]="EQUIPMENT_UI",o[o.SETTLEMENT_UI=1]="SETTLEMENT_UI",o[o.REVIVE_UI=2]="REVIVE_UI",o[o.SELL_EQUIP_UI=3]="SELL_EQUIP_UI",o[o.OTHER_UI=4]="OTHER_UI",cc._RF.pop()},{}],ShareVideoControl:[function(e,t,a){"use strict";cc._RF.push(t,"ae09bynKMpJVa/9yU3DRXdO","ShareVideoControl");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("ShareManager"),l=n("VideoManager"),r=n("GameCommon"),s=n("TipManager"),c=n("LocalData");function p(){}p.videoFunc=function(e,t,a,n,o,p,d){void 0===p&&(p=null),void 0===d&&(d=null);var u=i.ShareManager.getShareControlType();if(i.ShareManager.getVideoAdControl()){var h=function(){p&&p(),cc.sys.platform===cc.sys.WECHAT_GAME&&"function"==typeof wx.hideLoading&&wx.hideLoading()};window.gameCommon.getSDK.showWxLoading("loading",null,5e3);var m=l.VideoManager.getVideoIns(d||r.GameConfig.videoAdUnitId);if(null!=m)return m.hasVideoAd()||u!=i.ShareControlType.ShareAndAdOpen?(m.showVideoAd(n,o,h),void c.LocalData.data.showAdTimes++):void window.gameCommon.getSDK.share(e,null,null,function(e,n){n?t&&t():a&&a()},!0);l.VideoManager.createAndShowVideoIns(d||r.GameConfig.videoAdUnitId,n,o,h,function(){o&&o(),u!=i.ShareControlType.ShareAndAdOpen?s.TipManager.showTip("\u554a\u5440\uff0c\u89c6\u9891\u8fd8\u6ca1\u9001\u8fbe\uff0c\u7b49\u4e00\u4e0b\u518d\u8bd5\u8bd5\u5427~"):window.gameCommon.getSDK.share(e,null,null,function(e,n){n?t&&t():a&&a()},!0)})}else u==i.ShareControlType.ShareAndAdClose||u!=i.ShareControlType.ShareAndAdOpen?t&&t():window.gameCommon.getSDK.share(e,null,null,function(e,n){n?t&&t():a&&a()},!0)},n=p,o.ShareVideoControl=n,(o=o.VideoAdIdEnum||(o.VideoAdIdEnum={})).NORMAL_BOX_ID="adunit-6454be06c5e97070",o.LEGEND_BOX_ID="adunit-28129e63aabeaa2b",o.WEAPON_BOX_ID="adunit-c25b365ac7633b7d",o.GET_GEM_ID="adunit-cc7da20fefefe864",o.GET_ENERGY_ID="adunit-336b6b0a3bbd6724",o.RESET_SKILL_ID="adunit-712d0d2f9c5f1019",o.RECULSE_ID="adunit-52074d06ca50aea4",o.PROFITEER_ID="adunit-53cd3e8b24d44afc",o.REVIVE_ID="adunit-dfe8e22271e04bf1",o.THRIPLE_RECEIVE_ID="adunit-b2d57be0ef9d11e1",o.AUTO_ATK_ID="adunit-8bdd2b8504c0c048",o.DOUBBLE_BOX="adunit-9a5b25fad5f03372",cc._RF.pop()},{}],Sharker:[function(e,t,a){"use strict";cc._RF.push(t,"17531MZW31EcYx7TCNOglY1","Sharker");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("Head"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("GameManager"),d=o("SkillSystem"),u=o("EnumAndConst"),h=o("Util"),m=o("GameCommonPool"),f=o("Timer"),g=o("EnemyArea"),y=o("ShortRoleBase"),v=o("RoleManager"),D=o("GameState"),E=o("SpecailSkill"),S=o("EquipmentEffectSystem"),A=o("EvilDragonSpineController");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.moveSpeed=300,e.bossTargetData=null,e}o=(n=cc._decorator).ccclass,n.property,l=y.ShortRoleBase,__extends(C,l),C.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.sword=null,this.head=null,this.moveSpeed=300,this.isMoving=!1,this.isHitAniRunning=!1,this.isWaitingRevive=!1},C.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},C.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refresReviveState(),!this.roleData.isRecycled)){if(this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,D.GameState.isGaming&&this.isMoving&&this.moveToTarget(e),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.roleData.isDead)return;this.spineController.playAnimation(u.SpineAniNameEnum.Run2,!1,!0,null,1.5)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},C.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},C.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipSword(),this.searchAttackTarget(),this.roleData.isEnemy||this.equipFootRest()},C.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTargetData(),this.isMoving=!0,D.GameState.isGaming?this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||this.isHitAniRunning||this.spineController.playAnimation(u.SpineAniNameEnum.Run2,!1,!0,null,1.5):this.spineController.pauseAnimation(!0))},C.prototype.searchAttackTargetData=function(){if(D.GameState.isGaming&&null!=this.roleData&&!this.roleData.isDead){var e=p.GameManager.getBossData();if(!this.roleData.isEnemy&&7==D.GameState.currentChapter&&null!=e&&!e.isDead&&this.bossInAttackRange(e))return this.attackTargetData=e,this.bossTargetData=e,this.isMoving=!1,void this.setAttack();l.prototype.searchAttackTargetData.call(this)}},C.prototype.bossInAttackRange=function(e){if(null!=(e=v.RoleManager.getRole(e.id))&&null!=e.node&&e.node.isValid){if(null!=(e=e.node.getComponent(A.DragonSpineController)))return e.isInEnemyAttackRange(this.roleData,80,30);l.prototype.searchAttackTargetData.call(this)}else l.prototype.searchAttackTargetData.call(this)},C.prototype.moveToTarget=function(e){var t,a;null==this.roleData||this.roleData.isDead?this.isMoving=!1:this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(a=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),t=Math.abs(a.x),a=a.x<0?-this.moveSpeed:this.moveSpeed,t>this.attackDis?this.node.x+=a*e:(this.isMoving=!1,null!=this.attackTargetData?this.setAttack():this.die()))},C.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=d.SkillSystem.getEquipedSkillData(u.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e*this.roleData.orientation,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.spineController.playAnimation(u.SpineAniNameEnum.Run2,!1,!0,null,1.5)))},C.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.sword.stopAttack(),this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){if(null!=e.bossTargetData&&(!e.bossInAttackRange(e.bossTargetData)||e.bossTargetData.isDead))return e.bossTargetData=null,e.sword.stopAttack(),e.node.stopAllActions(),void e.searchAttackTarget();if(null!=e.attackTargetData&&null==e.bossTargetData){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);if(30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead)return e.sword.stopAttack(),e.node.stopAllActions(),void e.searchAttackTarget()}if(!D.GameState.isGaming||e.roleData.isDead)return e.sword.stopAttack(),void e.node.stopAllActions();e.spineController.playAnimation(u.SpineAniNameEnum.Melee_cut,!1,!1,function(){e.sword.stopAttack()},1.5)}),cc.delayTime(.4),cc.callFunc(function(){e.sword.startAttack()}),cc.delayTime(h.Util.getRandomFloatNum(.5,1))))))},C.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead?this.isHitAniRunning=!1:(this.isHitAniRunning=!0,this.sword.stopAttack(),this.node.stopAllActions(),this.spineController.playAnimation(u.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,D.GameState.isGaming&&!e.roleData.isDead&&e.spineController.playAnimation(u.SpineAniNameEnum.Run2,!1,!0,null,1.5))},1.5),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},C.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.sword.stopAttack(),this.node.stopAllActions(),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},C.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isEnemy?(this.searchAttackTarget(),v.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5):this.searchAttackTarget())},C.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(m.GameCommonPool.returnInstant(this.sword.node),this.sword=null,this.close())},C.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.sword.stopAttack(),this.node.stopAllActions(),f.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?p.GameManager.killEnemy(this.roleData):p.GameManager.friendDie(this.roleData),S.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?u.SpineAniNameEnum.D2:u.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){var e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady&&null==g.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void g.EnemyArea.necromancer.reviveEnemy(t.roleData);f.TimerManager.addTimer(.1,function(){null!=t.roleData&&(null!=t.footRest&&(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null),m.GameCommonPool.returnInstant(t.sword.node),t.sword=null,t.roleData.isDestroy=!0,t.close(),E.SpecailSkill.turnHeart(t.roleData,D.GameState.isGaming,g.EnemyArea.turnedEnemyCount)?g.EnemyArea.createTurnedEnemy(t.roleData):E.SpecailSkill.killBlast(t.roleData))},t.node)}))},o=__decorate([o],C),i.Sharker=o,cc._RF.pop()},{}],ShieldDefender:[function(e,t,a){"use strict";cc._RF.push(t,"c8ef2ZY+tpBGboigwacaiOO","ShieldDefender");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("Head"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("GameManager"),d=o("EnumAndConst"),u=o("SkillSystem"),h=o("Util"),m=o("GameCommonPool"),f=o("Timer"),g=o("EnemyArea"),y=o("ShortRoleBase"),v=o("RoleManager"),D=o("GameState"),E=o("ConfigData"),S=o("SpecailSkill"),A=o("EquipmentEffectSystem");function C(){var e=null!==l&&l.apply(this,arguments)||this;return e.deadAniRunning=!1,e.runningFast=!1,e.isStopRun=!1,e.defenderState=null,e.defendingTime=10,e}o=(n=cc._decorator).ccclass,n.property,l=y.ShortRoleBase,__extends(C,l),C.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.sword=null,this.head=null,this.footRest=null,this.shield=null,this.moveSpeed=200,this.isMoving=!1,this.deadAniRunning=!1,this.runningFast=!1,this.isStopRun=!1,this.defenderState=null,this.defendingTime=10,this.isHitAniRunning=!1,this.isWaitingRevive=!1},C.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},C.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),!this.roleData.isRecycled)){if(this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,this.defenderState==d.ShieldDefenderState.DEFENDING&&this.defend(e),D.GameState.isGaming&&(this.isMoving&&this.moveToTarget(e),this.moveSpeed=0==this.roleData.shieldDefense?150:75),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.roleData.isDead)return;this.run(!0)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},C.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},C.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1;var n=a.getComponent(r.Head);if(null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.moveSpeed=0==this.roleData.shieldDefense?150:75,this.deadAniRunning=!1,this.isMoving=!1,0<=this.roleData.logicPos.y&&this.equipFootRest(),this.equipHelmet(),this.equipShield(),this.equipSword(),!this.roleData.isEnemy||this.roleData.logicPos.y<0)return this.defenderState=d.ShieldDefenderState.MOVING,this.defendingTime=0,void this.searchAttackTarget();this.defenderState=d.ShieldDefenderState.DEFENDING,this.defendingTime=10,this.spineController.playAnimation(d.SpineAniNameEnum.Def,!1,!0,null)},C.prototype.defend=function(e){!D.GameState.isGaming||null==this.roleData||this.roleData.isDead||this.roleData.isDestroy||this.roleData.isFrozening||this.defenderState==d.ShieldDefenderState.DEFENDING&&(this.defendingTime<=0||this.roleData.shieldDefense<=0?this.fallToGround():this.defendingTime-=e)},C.prototype.fallToGround=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.defenderState=d.ShieldDefenderState.FALLING,e=Math.abs(this.roleData.logicPos.y-E.ConfigData.PLYAER_POS.y)/300,e=Math.max(0,e),this.node.runAction(cc.sequence(cc.moveTo(e,this.roleData.logicPos.x,E.ConfigData.PLYAER_POS.y),cc.callFunc(function(){var e;t.defenderState=d.ShieldDefenderState.MOVING,t.isMoving=!0,t.roleData.isMoveModel=!0,t.roleData.isDead?t.deadAniRunning||(e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady,t.roleData.isEnemy&&e?g.EnemyArea.necromancer.reviveEnemy(t.roleData):f.TimerManager.addTimer(.1,function(){if(null!=t.roleData)return S.SpecailSkill.turnHeart(t.roleData,D.GameState.isGaming,g.EnemyArea.turnedEnemyCount)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,t.close(),void g.EnemyArea.createTurnedEnemy(t.roleData)):S.SpecailSkill.killBlast(t.roleData)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close()):void(null!=t.footRest?(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close()))},t.node)):t.searchAttackTarget()}))))},C.prototype.searchAttackTarget=function(){if(null!=this.roleData&&!this.roleData.isDead){if(this.searchAttackTargetData(),this.isMoving=!0,!D.GameState.isGaming){var e=this.roleData.shieldDefense<=0?d.SpineAniNameEnum.Run2:d.SpineAniNameEnum.Run;return this.spineController.playAnimation(e,!1,!0,null),void this.spineController.pauseAnimation(!0)}this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(this.roleData.shieldDefense<=0?this.runningFast=!1:this.runningFast=!0,this.run(!1))}},C.prototype.moveToTarget=function(e){var t,a;null==this.roleData||this.roleData.isDead?this.isMoving=!1:this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(a=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),t=Math.abs(a.x),a=a.x<0?-this.moveSpeed:this.moveSpeed,this.run(!1),t>this.attackDis?this.node.x+=a*e:(this.isMoving=!1,null!=this.attackTargetData?this.setAttack():this.die()))},C.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=u.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.run(!0)))},C.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.sword.stopAttack(),this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);return 30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead?(e.sword.stopAttack(),e.node.stopAllActions(),void e.searchAttackTarget()):!D.GameState.isGaming||e.roleData.isDead?(e.sword.stopAttack(),void e.node.stopAllActions()):void e.spineController.playAnimation(d.SpineAniNameEnum.Melee_cut,!1,!1,function(){e.sword.stopAttack()})}),cc.delayTime(.4),cc.callFunc(function(){e.sword.startAttack()}),cc.delayTime(h.Util.getRandomFloatNum(1,1.5))))))},C.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.defenderState==d.ShieldDefenderState.DEFENDING||this.defenderState==d.ShieldDefenderState.FALLING?this.isHitAniRunning=!1:(this.isHitAniRunning=!0,this.sword.stopAttack(),this.node.stopAllActions(),this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,D.GameState.isGaming&&e.run(!0))}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},C.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.isStopRun=!0,this.defenderState!=d.ShieldDefenderState.FALLING&&(this.sword.stopAttack(),this.node.stopAllActions()),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},C.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isEnemy?(this.defenderState==d.ShieldDefenderState.MOVING&&(this.roleData.reviveRepelTime=.5,this.searchAttackTarget()),v.RoleManager.hitRole(this.roleData)):this.searchAttackTarget())},C.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(null!=this.footRest?(m.GameCommonPool.returnInstant(this.sword.node),this.sword=null,m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null):(m.GameCommonPool.returnInstant(this.sword.node),this.sword=null),this.close())},C.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.deadAniRunning=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.sword.stopAttack(),this.defenderState==d.ShieldDefenderState.FALLING?this.node.resumeAllActions():this.node.stopAllActions(),f.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?p.GameManager.killEnemy(this.roleData):p.GameManager.friendDie(this.roleData),A.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?d.SpineAniNameEnum.D2:d.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){if(t.deadAniRunning=!1,t.defenderState!=d.ShieldDefenderState.FALLING){var e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady&&null==g.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void g.EnemyArea.necromancer.reviveEnemy(t.roleData);f.TimerManager.addTimer(.1,function(){if(null!=t.roleData)return S.SpecailSkill.turnHeart(t.roleData,D.GameState.isGaming,g.EnemyArea.turnedEnemyCount)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,t.close(),void g.EnemyArea.createTurnedEnemy(t.roleData)):S.SpecailSkill.killBlast(t.roleData)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close()):void(null!=t.footRest?(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close()))})}}))},C.prototype.run=function(e){if(D.GameState.isGaming&&!this.isHitAniRunning&&null!=this.roleData&&!this.roleData.isDead&&!this.roleData.isDestroy){var t=this.roleData.shieldDefense<=0,a=t?d.SpineAniNameEnum.Run2:d.SpineAniNameEnum.Run;if(e)this.spineController.playAnimation(a,!1,!0,null);else{if(this.isStopRun&&(this.isStopRun=!1,this.runningFast?this.spineController.playAnimation(d.SpineAniNameEnum.Run2,!1,!0,null):this.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null)),t&&!this.runningFast)return this.runningFast=!0,void this.spineController.playAnimation(d.SpineAniNameEnum.Run2,!1,!0,null);!t&&this.runningFast&&(this.runningFast=!1,this.spineController.playAnimation(d.SpineAniNameEnum.Run,!1,!0,null))}}},o=__decorate([o],C),i.ShieldDefender=o,cc._RF.pop()},{}],ShieldWizard:[function(e,t,a){"use strict";cc._RF.push(t,"bf1f9R+pPNOpI0CeVPifjbt","ShieldWizard");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Head"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("GameManager"),d=n("EnumAndConst"),u=n("Timer"),h=n("EnemyArea"),m=n("GameCommonPool"),f=n("BattleNodeManager"),g=n("Util"),y=n("SingleEffectManager"),v=n("RoleBase"),D=n("RoleManager"),E=n("GameState"),S=n("EnemyShield"),A=n("SpecailSkill"),C=n("EquipmentEffectSystem");function M(){var e=null!==l&&l.apply(this,arguments)||this;return e.enemyShield=null,e.isConjuring=!1,e.prepareSkillTimer=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=v.RoleBase,__extends(M,l),M.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.isConjuring=!1,this.isHitAniRunning=!1,this.prepareSkillTimer=null,this.isWaitingRevive=!1},M.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},M.prototype.update=function(){this.refreshDeadState(),this.refresReviveState()},M.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},M.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null),this.equipFootRest(),this.prepareShieldSkill(!0)},M.prototype.prepareShieldSkill=function(e){var t=this;null==this.roleData||this.roleData.isDead||(e=e?2:4,E.GameState.heroModel&&(e*=.75),this.prepareSkillTimer=u.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.useShieldSkill(),t.prepareSkillTimer=null)},this.node))},M.prototype.useShieldSkill=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead&&null!=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHIRLD_NODE)){this.isConjuring=!0;var t=[];this.roleData.hasEnemyShield||t.push(this.roleData);for(var a=[],n=h.EnemyArea.enemyDataArray,o=0;o<n.length;o++){var i=n[o];null==i||i==this.roleData||i.hasEnemyShield||i.isDead||i.isDestroy||a.push(i)}var l=1<=a.length?1:a.length;for(o=0;o<l&&!(a.length<=0);o++){var r=g.Util.getRandomNum(0,a.length-1),s=a[r];null==s||s.isDead||(t.push(s),a.splice(r,1))}t.length<=0?this.prepareShieldSkill(!1):(t.forEach(function(t){e.createEnemyShield(t)}),this.spineController.playAnimation(d.SpineAniNameEnum.Atk,!1,!1,function(){e.prepareShieldSkill(!1),e.isConjuring=!1,e.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null)}))}},M.prototype.createEnemyShield=function(e){var t,a,n;null==h.EnemyArea.instance||null!=(t=f.BattleNodeManager.getParentNode(d.BattleNodeEnum.SHIRLD_NODE))&&(null==(a=m.GameCommonPool.requestInstant(this.enemyShield))||null!=(n=a.getComponent(S.EnemyShield))&&(n.bindData(e),a.setParent(t),a.setPosition(e.logicPos)))},M.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isConjuring?this.isHitAniRunning=!1:this.isHitAniRunning||(this.prepareSkillTimer&&this.prepareSkillTimer.pauseTimer(),this.node.stopAllActions(),this.isHitAniRunning=!0,this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,e.spineController.playAnimation(d.SpineAniNameEnum.St,!1,!0,null),e.prepareSkillTimer&&e.prepareSkillTimer.resumeTimer()}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},M.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.spineController.pauseAnimation(!0),u.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,u.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),u.TimerManager.resumeAllTimers(t.node))},this.node))},M.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||this.prepareSkillTimer&&this.prepareSkillTimer.pauseTimer()},M.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.prepareSkillTimer&&this.prepareSkillTimer.resumeTimer(),D.RoleManager.hitRole(this.roleData))},M.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.close())},M.prototype.die=function(){var e=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,y.SingleEffectManager.clearInsertArrows(this.roleData),this.roleData.isFrozening=!1,this.node.stopAllActions(),this.spineController.pauseAnimation(!1),u.TimerManager.removeAllTimers(this.node),p.GameManager.killEnemy(this.roleData),C.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),this.spineController.playAnimation(d.SpineAniNameEnum.D,!1,!1,function(){var t=null!=h.EnemyArea.necromancer&&h.EnemyArea.reviveReady&&null==h.EnemyArea.necromancer.targetData;if(e.roleData.isEnemy&&t)return e.isWaitingRevive=!0,void h.EnemyArea.necromancer.reviveEnemy(e.roleData);u.TimerManager.addTimer(.1,function(){if(null!=e.roleData){if(m.GameCommonPool.returnInstant(e.footRest.node),e.footRest=null,A.SpecailSkill.killBlast(e.roleData))return e.roleData.isDestroy=!0,h.EnemyArea.shieldWizard=null,void e.close();e.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){e.roleData.isDestroy=!0,h.EnemyArea.shieldWizard=null,e.close()})))}},e.node)}))},__decorate([o({displayName:"\u654c\u4eba\u9632\u62a4\u7f69",type:cc.Prefab})],M.prototype,"enemyShield",void 0),n=__decorate([n],M),i.ShieldWizard=n,cc._RF.pop()},{}],Shield:[function(e,t,a){"use strict";cc._RF.push(t,"f70b6ZSuXFDJbGZuGgnyANQ","Shield");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameManager"),s=n("Util"),c=n("SpriteFrameManager"),p=n("WorldEventManager"),d=n("LocalWorldEventType"),u=n("LocalData"),h=n("GameCommonPool"),m=n("ConfigData"),f=n("GameState"),g=n("EndlessModelConfigData");function y(){var e=null!==l&&l.apply(this,arguments)||this;return e.shieldSprite=null,e.circleCollider=null,e.boxCollider=null,e.roleData=null,e.isDroping=!1,e.horizontalSpeed=0,e.verticalSpeed=0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(y,l),y.prototype.onEnable=function(){p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this),this.roleData=null,this.isDroping=!1,this.horizontalSpeed=0,this.verticalSpeed=0},y.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},y.prototype.update=function(e){this.isDroping&&(800<=this.node.x||this.node.x<=-800||this.node.y<=-300)||null!=this.roleData&&!this.isDroping&&this.roleData.isDestroy?this.close():this.isDroping&&this.deltaMove(e)},y.prototype.deltaMove=function(e){var t=r.GameManager.getGravity(),a=this.node.position;this.verticalSpeed=this.verticalSpeed+t*e,t=this.verticalSpeed*e,e=this.horizontalSpeed*e,t=cc.v2(e,t),this.node.setPosition(a.add(t))},y.prototype.drop=function(e,t){this.verticalSpeed=t,this.horizontalSpeed=e,this.isDroping=!0,this.roleData.shieldDroped=!0,this.roleData=null,t=s.Util.getRandomFloatNum(.5,2),e=.5<Math.random()?360:-360,this.node.runAction(cc.repeatForever(cc.rotateBy(t,e))),this.circleCollider.enabled=!1,this.boxCollider.enabled=!1},y.prototype.bindData=function(e){this.roleData=e,e=1,e=this.roleData.isPlayer?u.LocalData.getEquippedEquipment(u.EquipmentType.shield).rank:f.GameState.endlessModel?g.EndlessModelConfigData.getEndlessEnemyEqeuipmentRank(f.GameState.currentPart):m.ConfigData.getEnemyEquipmentRank(f.GameState.currentChapter),this.shieldSprite.spriteFrame=c.SpriteFrameManager.getShieldSpriteFrame(this.roleData.shieldIndex,e),0==this.roleData.shieldIndex?(this.circleCollider.enabled=!0,this.boxCollider.enabled=!1,this.circleCollider.radius=this.node.width/2):(this.circleCollider.enabled=!1,this.boxCollider.enabled=!0,this.boxCollider.size=new cc.Size(this.node.width,this.node.height))},y.prototype.close=function(){h.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u56fe\u7247",type:cc.Sprite})],y.prototype,"shieldSprite",void 0),__decorate([o({displayName:"\u5706\u5f62\u78b0\u649e\u76d2",type:cc.CircleCollider})],y.prototype,"circleCollider",void 0),__decorate([o({displayName:"\u77e9\u5f62\u78b0\u649e\u76d2",type:cc.BoxCollider})],y.prototype,"boxCollider",void 0),n=__decorate([n],y),i.Shield=n,cc._RF.pop()},{}],ShortEnemy:[function(e,t,a){"use strict";cc._RF.push(t,"8535fyCEXpOnJIQ7+Bg/3s0","ShortEnemy");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("EnumAndConst"),s=o("GameManager"),c=o("Head"),p=o("Util"),d=o("Timer"),u=o("SkillSystem"),h=o("WorldEventManager"),m=o("LocalWorldEventType"),f=o("GameCommonPool"),g=o("EnemyArea"),y=o("ShortRoleBase"),v=o("RoleManager"),D=o("GameState"),E=o("SpecailSkill"),S=o("EquipmentEffectSystem");function A(){var e=null!==l&&l.apply(this,arguments)||this;return e.runningFast=!1,e.isStopRun=!1,e}o=(n=cc._decorator).ccclass,n.property,l=y.ShortRoleBase,__extends(A,l),A.prototype.onEnable=function(){h.WorldEventManager.addListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerDead,this.stopActing,this),h.WorldEventManager.addListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),h.WorldEventManager.addListener(m.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.sword=null,this.head=null,this.shield=null,this.moveSpeed=200,this.isMoving=!1,this.runningFast=!1,this.isStopRun=!1,this.isHitAniRunning=!1,this.isWaitingRevive=!1},A.prototype.onDisable=function(){h.WorldEventManager.removeListener(m.LocalWorldEventType.BackHome,this.close,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerDead,this.stopActing,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),h.WorldEventManager.removeListener(m.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},A.prototype.update=function(e){if(null!=this.roleData){if(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,D.GameState.isGaming&&(this.isMoving&&this.moveToTarget(e),this.moveSpeed=0==this.roleData.shieldDefense?150:75),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.roleData.isDead)return;this.run(!0)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},A.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},A.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1;var n=a.getComponent(c.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.moveSpeed=0==this.roleData.shieldDefense?150:75,this.equipHelmet(),this.equipShield(),this.equipSword(),this.searchAttackTarget()},A.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTargetData(),this.isMoving=!0,D.GameState.isGaming?this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(this.roleData.shieldDefense<=0?this.runningFast=!1:this.runningFast=!0,this.run(!1)):this.spineController.pauseAnimation(!0))},A.prototype.moveToTarget=function(e){var t,a;null==this.roleData||this.roleData.isDead?this.isMoving=!1:this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(a=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),t=Math.abs(a.x),a=a.x<0?-this.moveSpeed:this.moveSpeed,this.run(!1),t>this.attackDis?this.node.x+=a*e:(this.isMoving=!1,null!=this.attackTargetData?this.setAttack():this.die()))},A.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=u.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!D.GameState.isGaming||this.run(!0)))},A.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.sword.stopAttack(),this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);return 30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead?(e.sword.stopAttack(),e.node.stopAllActions(),void e.searchAttackTarget()):!D.GameState.isGaming||e.roleData.isDead?(e.sword.stopAttack(),void e.node.stopAllActions()):void e.spineController.playAnimation(r.SpineAniNameEnum.Melee_cut,!1,!1,function(){e.sword.stopAttack()})}),cc.delayTime(.4),cc.callFunc(function(){e.sword.startAttack()}),cc.delayTime(p.Util.getRandomFloatNum(1,1.5))))))},A.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead?this.isHitAniRunning=!1:(this.isHitAniRunning=!0,this.sword.stopAttack(),this.node.stopAllActions(),this.spineController.playAnimation(r.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,D.GameState.isGaming&&e.run(!0))}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},A.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.isStopRun=!0,this.sword.stopAttack(),this.node.stopAllActions(),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},A.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.roleData.isEnemy?(this.searchAttackTarget(),v.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5):this.searchAttackTarget())},A.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(f.GameCommonPool.returnInstant(this.sword.node),this.sword=null,this.close())},A.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.sword.stopAttack(),this.node.stopAllActions(),this.spineController.pauseAnimation(!1),d.TimerManager.removeAllTimers(this.node),this.roleData.isEnemy?s.GameManager.killEnemy(this.roleData):s.GameManager.friendDie(this.roleData),S.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?r.SpineAniNameEnum.D2:r.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){var e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady&&null==g.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void g.EnemyArea.necromancer.reviveEnemy(t.roleData);d.TimerManager.addTimer(.1,function(){null!=t.roleData&&(f.GameCommonPool.returnInstant(t.sword.node),t.sword=null,t.roleData.isDestroy=!0,t.close(),E.SpecailSkill.turnHeart(t.roleData,D.GameState.isGaming,g.EnemyArea.turnedEnemyCount)?g.EnemyArea.createTurnedEnemy(t.roleData):E.SpecailSkill.killBlast(t.roleData))},t.node)}))},A.prototype.run=function(e){if(D.GameState.isGaming&&!this.isHitAniRunning&&null!=this.roleData&&!this.roleData.isDead&&!this.roleData.isDestroy){var t=this.roleData.shieldDefense<=0,a=t?r.SpineAniNameEnum.Run2:r.SpineAniNameEnum.Run;if(e)this.spineController.playAnimation(a,!1,!0,null);else{if(this.isStopRun&&(this.isStopRun=!1,this.runningFast?this.spineController.playAnimation(r.SpineAniNameEnum.Run2,!1,!0,null):this.spineController.playAnimation(r.SpineAniNameEnum.Run,!1,!0,null)),t&&!this.runningFast)return this.runningFast=!0,void this.spineController.playAnimation(r.SpineAniNameEnum.Run2,!1,!0,null);!t&&this.runningFast&&(this.runningFast=!1,this.spineController.playAnimation(r.SpineAniNameEnum.Run,!1,!0,null))}}},o=__decorate([o],A),i.ShortEnemy=o,cc._RF.pop()},{}],ShortRoleBase:[function(e,t,a){"use strict";cc._RF.push(t,"04d772Kcb1AaLhgfMqoHfBk","ShortRoleBase");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("RoleBase"),s=n("GameCommonPool"),c=n("BattleNodeManager"),p=n("EnumAndConst"),d=n("Sword");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.swordPrefab=null,e.moveSpeed=200,e.attackDis=80,e.isMoving=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=r.RoleBase,__extends(u,l),u.prototype.equipSword=function(){var e,t=s.GameCommonPool.requestInstant(this.swordPrefab);null==t||null!=(e=c.BattleNodeManager.getParentNode(p.BattleNodeEnum.SWORD_NODE))&&(t.setParent(e),t.setPosition(cc.v2(9999,9999)),null!=(t=t.getComponent(d.Sword))&&(t.bindData(this.roleData),this.sword=t,this.spineController.equipWeapon(this.sword.node)))},__decorate([o({displayName:"\u5200\u5251\u9884\u8bbe",type:cc.Prefab})],u.prototype,"swordPrefab",void 0),n=__decorate([n],u),i.ShortRoleBase=n,cc._RF.pop()},{}],ShortZombie:[function(e,t,a){"use strict";cc._RF.push(t,"5b2ddHOol9D0aRAKxaOQUQB","ShortZombie");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("Head"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("GameManager"),d=o("EnumAndConst"),u=o("SkillSystem"),h=o("Util"),m=o("GameCommonPool"),f=o("Timer"),g=o("LocalSoundManager"),y=o("EnemyArea"),v=o("SpecailSkill"),D=o("SingleEffectManager"),E=o("ShortRoleBase"),S=o("LocalData"),A=o("RoleManager"),C=o("GameState"),M=o("BattleNumManager"),T=o("ConfigData"),_=o("EquipmentEffectSystem"),k=o("EffectCreate");function P(){var e=null!==l&&l.apply(this,arguments)||this;return e.deadAniRunning=!1,e.isFalling=!1,e}o=(n=cc._decorator).ccclass,n.property,l=E.ShortRoleBase,__extends(P,l),P.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.addListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.addListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.footRest=null,this.moveSpeed=200,this.isMoving=!1,this.deadAniRunning=!1,this.isFalling=!1,this.isHitAniRunning=!1,this.isWaitingRevive=!1},P.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerDead,this.stopActing,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),s.WorldEventManager.removeListener(c.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},P.prototype.update=function(e){if(null!=this.roleData&&(this.refreshDeadState(),this.refreshEquipmentState(),this.refresReviveState(),!this.roleData.isRecycled)){if(this.isMoving&&this.isSearch?(this.searchAttackTargetData(),this.isSearch=!1):this.isSearch=!0,this.roleData.logicPos=this.node.position,C.GameState.isGaming&&this.isMoving&&this.moveToTarget(e),this.isBeRepeled(e),700<=this.roleData.logicPos.x&&(0<this.roleData.repelTime||0<this.roleData.reviveRepelTime)){if(this.roleData.repelTime=0,this.roleData.reviveRepelTime=0,this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!C.GameState.isGaming||this.roleData.isDead)return;this.spineController.playAnimation(d.SpineAniNameEnum.Zb_run,!1,!0,null)}this.roleData.isEnemy&&this.node.x<-370&&(this.node.x=-370)}},P.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},P.prototype.bindData=function(e,t,a){this.roleData=e,this.roleUp.scaleX=this.roleData.isEnemy?1:-1;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.moveSpeed=75,this.deadAniRunning=!1,0<=this.roleData.logicPos.y&&this.equipFootRest(),this.equipHelmet(),this.searchAttackTarget()},P.prototype.searchAttackTarget=function(){null==this.roleData||this.roleData.isDead||(this.searchAttackTargetData(),this.isMoving=!0,C.GameState.isGaming?this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||this.isHitAniRunning||this.spineController.playAnimation(d.SpineAniNameEnum.Zb_run,!1,!0,null):this.spineController.pauseAnimation(!0))},P.prototype.moveToTarget=function(e){var t,a;null==this.roleData||this.roleData.isDead?this.isMoving=!1:this.isHitAniRunning||this.roleData.isFrozening||0<this.roleData.repelTime||0<this.roleData.reviveRepelTime||(a=(null==this.attackTargetData?this.roleData.isEnemy?cc.v2(-900,this.roleData.logicPos.y):cc.v2(900,this.roleData.logicPos.y):this.attackTargetData.logicPos).sub(this.node.position),t=Math.abs(a.x),a=a.x<0?-this.moveSpeed:this.moveSpeed,t>this.attackDis?this.node.x+=a*e:(this.isMoving=!1,null!=this.attackTargetData?this.attackTargetData.isPlayer&&null!=this.footRest?this.fallToGround():this.setAttack():this.die()))},P.prototype.isBeRepeled=function(e){var t;null==this.roleData||this.roleData.isDead||this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0||(0<this.roleData.repelTime&&(t=u.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.REPEL),this.node.x+=t*e,this.roleData.repelTime-=e),0<this.roleData.reviveRepelTime&&(this.node.x+=(t=400)*e,this.roleData.reviveRepelTime-=e),this.roleData.repelTime<=0&&this.roleData.reviveRepelTime<=0&&(this.isMoving=!0,this.roleData.isFrozening||this.isHitAniRunning||!C.GameState.isGaming||this.spineController.playAnimation(d.SpineAniNameEnum.Zb_run,!1,!0,null)))},P.prototype.fallToGround=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.isMoving=!1,this.isFalling=!0,this.spineController.pauseAnimation(!0),this.roleData.isMoveModel=!1,e=(this.roleData.logicPos.y-T.ConfigData.PLYAER_POS.y)/300,e=Math.max(0,e),this.node.runAction(cc.sequence(cc.moveTo(e,this.roleData.logicPos.x,T.ConfigData.PLYAER_POS.y),cc.callFunc(function(){var e;t.roleData.isMoveModel=!0,t.isFalling=!1,t.roleData.isDead?t.deadAniRunning||(e=null!=y.EnemyArea.necromancer&&y.EnemyArea.reviveReady,t.roleData.isEnemy&&e?y.EnemyArea.necromancer.reviveEnemy(t.roleData):f.TimerManager.addTimer(.1,function(){if(null!=t.roleData)return v.SpecailSkill.turnHeart(t.roleData,C.GameState.isGaming,y.EnemyArea.turnedEnemyCount)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,t.close(),void y.EnemyArea.createTurnedEnemy(t.roleData)):v.SpecailSkill.killBlast(t.roleData)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close()):void(null!=t.footRest?(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close()))},t.node)):(t.spineController.pauseAnimation(!1),t.setAttack())}))))},P.prototype.setAttack=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isHitAniRunning||(this.node.stopAllActions(),this.node.runAction(cc.repeatForever(cc.sequence(cc.callFunc(function(){var t=Math.abs(e.roleData.logicPos.x-e.attackTargetData.logicPos.x);if(30<e.roleData.logicPos.y-e.attackTargetData.logicPos.y||50<e.attackTargetData.logicPos.y-e.roleData.logicPos.y||80<t||null!=e.attackTargetData&&e.attackTargetData.isDead)return e.node.stopAllActions(),void e.searchAttackTarget();C.GameState.isGaming?e.spineController.playAnimation(d.SpineAniNameEnum.Zb_atk,!1,!1,null):e.node.stopAllActions()}),cc.delayTime(.4),cc.callFunc(function(){var t,a,n,o,i=e.attackTargetData;null==i||i.isDead||i.isTeleporting||(t=Math.abs(e.roleData.logicPos.x-i.logicPos.x),n=Math.abs(e.roleData.logicPos.y-i.logicPos.y),90<t||90<n||(n=0,e.roleData.isEnemy&&e.attackTargetData.isPlayer&&(n=u.SkillSystem.getEquipedSkillData(d.SkillTypeEnum.DODGE)),e.attackTargetData.enemyEquipSkills.isHaveSkill(d.SkillTypeEnum.DODGE)&&(n=u.SkillSystem.getEquipedSkillInitData(d.SkillTypeEnum.DODGE),e.attackTargetData.isBoss&&C.GameState.heroModel&&(n*=2)),Math.random()<n?k.EffectCreate.createRoleTip(i.logicPos,0):i.hasEnemyShield?(i.hasEnemyShield=!1,a=Math.round(e.roleData.atk),n=d.BattleNumTypeEnum.HP_REDUCE,M.BattleNumManager.createBattleNumEffect(n,a,i,i.logicPos),g.LocalSoundManager.playShieldResistAudio()):0<i.shieldDefense?(g.LocalSoundManager.playShieldResistAudio(),a=Math.round(e.roleData.atk),A.RoleManager.equipmentIsDamaged(e.attackTargetData,S.EquipmentType.shield,e.roleData,a,cc.v2(i.logicPos.x+35,i.logicPos.y)),i.shieldDefense<=0&&(i.shieldDroped=!0)):0<i.helmetDefense?(g.LocalSoundManager.playHelmetResistAudio(),o=Math.round(e.roleData.atk),A.RoleManager.equipmentIsDamaged(e.attackTargetData,S.EquipmentType.helmet,e.roleData,o,cc.v2(i.headPosition.x,i.headPosition.y)),i.helmetDefense<=0&&(i.helmetDroped=!0)):(o=Math.round(e.roleData.atk),o*=1-i.bodyHurtReduction,A.RoleManager.roleIsDamaged(e.attackTargetData,e.roleData,o,i.logicPos),i.invincibleTime<=0?(g.LocalSoundManager.playArrowHitAudio(),g.LocalSoundManager.playVibrateShort(),D.SingleEffectManager.showBloodEffect(i.logicPos,1,i)):g.LocalSoundManager.playShieldResistAudio())))}),cc.delayTime(h.Util.getRandomFloatNum(1,1.5))))))},P.prototype.isHit=function(){var e=this;null!=this.roleData&&!this.roleData.isDead&&this.roleData.isMoveModel?(this.isHitAniRunning=!0,this.node.stopAllActions(),this.spineController.playAnimation(d.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,0<e.roleData.repelTime||0<e.roleData.reviveRepelTime||(e.isMoving=!0,C.GameState.isGaming&&!e.roleData.isDead&&e.spineController.playAnimation(d.SpineAniNameEnum.Zb_run,!1,!0,null))}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0)):this.isHitAniRunning=!1},P.prototype.stopActing=function(){null==this.roleData||this.roleData.isDead||(this.isFalling||this.node.stopAllActions(),this.isMoving&&!this.isHitAniRunning&&this.spineController.pauseAnimation(!0))},P.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||this.isFalling||(this.roleData.isEnemy?(this.searchAttackTarget(),A.RoleManager.hitRole(this.roleData),this.roleData.reviveRepelTime=.5):this.searchAttackTarget())},P.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(null!=this.footRest&&(m.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null),this.close())},P.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.deadAniRunning=!0,this.isMoving=!1,this.roleData.isFrozening=!1,this.isFalling?this.node.resumeAllActions():this.node.stopAllActions(),f.TimerManager.removeAllTimers(this.node),this.spineController.pauseAnimation(!1),this.roleData.isEnemy?p.GameManager.killEnemy(this.roleData):p.GameManager.friendDie(this.roleData),_.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?d.SpineAniNameEnum.D2:d.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){if(t.deadAniRunning=!1,!t.isFalling){var e=null!=y.EnemyArea.necromancer&&y.EnemyArea.reviveReady&&null==y.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void y.EnemyArea.necromancer.reviveEnemy(t.roleData);f.TimerManager.addTimer(.1,function(){if(null!=t.roleData)return v.SpecailSkill.turnHeart(t.roleData,C.GameState.isGaming,y.EnemyArea.turnedEnemyCount)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,t.close(),void y.EnemyArea.createTurnedEnemy(t.roleData)):v.SpecailSkill.killBlast(t.roleData)?(t.footRest&&m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.roleData.isDestroy=!0,void t.close()):void(null!=t.footRest?(m.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))):(t.roleData.isDestroy=!0,t.close()))},t.node)}}))},o=__decorate([o],P),i.ShortZombie=o,cc._RF.pop()},{}],SingleEffectManager:[function(e,t,a){"use strict";cc._RF.push(t,"622426MrVNFxoxO0nJNueiA","SingleEffectManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l=n("ThornsChainsEffect"),r=n("ShareManager"),s=n("GameCommonPool"),c=n("Timer"),p=n("SpecailSkill"),d=n("EnumAndConst"),u=n("IgniteEffect"),h=n("EmergencyEquipmentEffect"),m=n("RestoreEffect"),f=n("EffectCreate"),g=n("PlayerState"),y=n("GameState");function v(){}v.initSingleEffects=function(){this.insertArrowsMap=new Map,this.bloodEffectMap=new Map,this.hpUpEffectMap=new Map,this.repairEffectMap=new Map,this.igniteEffectMap=new Map,this.frozenEffectMap=new Map,this.thornsChainsEffect=null,this.moveThornsChainsEffects=[],this.furyEffect=null,this.spottingArrow=null,this.inspireWallEffect=null,this.lifeMachineEffect=null,this.emergencyEquipmentEffect=null,this.reviveHoleEffect=null},v.insertArrow=function(e,t){if(null!=e&&null!=t){null==this.insertArrowsMap&&(this.insertArrowsMap=new Map),this.insertArrowsMap.has(e)||this.insertArrowsMap.set(e,[]);for(var a=this.insertArrowsMap.get(e),n=0;n<a.length;n++)a[n].isValid||a.splice(n,1);a.push(t),a.length<=3||null!=(t=a.shift())&&t.destroy()}},v.clearInsertArrows=function(e){if(null==this.insertArrowsMap&&(this.insertArrowsMap=new Map),this.insertArrowsMap.has(e)){var t=this.insertArrowsMap.get(e);if(!(null==t||t.length<=0)){for(var a=0;a<t.length;a++){var n=t[a];null!=n&&n.isValid&&(n.destroy(),t.splice(a,1),a--)}this.insertArrowsMap.delete(e)}}},v.showBloodEffect=function(e,t,a){var n,o=this;r.ShareManager.getViolenceControl()&&null!=e&&null!=t&&null!=a&&(null==this.bloodEffectMap&&(this.bloodEffectMap=new Map),!this.bloodEffectMap.has(a))&&(null==(n=f.EffectCreate.createBlood(e,t))||null!=(t=n.getComponent(cc.ParticleSystem))&&(t.resetSystem(),c.TimerManager.addTimer(.5,function(){s.GameCommonPool.returnInstant(n),o.bloodEffectMap.delete(a)},n),a.isBoss&&7==y.GameState.currentChapter||this.bloodEffectMap.set(a,n)))},v.showHpUpEffect=function(e){var t=this;null!=e&&(null!=this.hpUpEffectMap?this.hpUpEffectMap.has(e)||p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.HP_UP,e,function(a){c.TimerManager.addTimer(1.6,function(){var n=a.getComponent(m.RestoreEffect);null!=n&&(n.close(),t.hpUpEffectMap.delete(e))},a),t.hpUpEffectMap.set(e,a)}):this.hpUpEffectMap=new Map)},v.showRepairEffect=function(e){var t=this;null!=e&&(null!=this.repairEffectMap?this.repairEffectMap.has(e)||p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.SHIELD_UP,e,function(a){c.TimerManager.addTimer(1.6,function(){var n=a.getComponent(m.RestoreEffect);null!=n&&(n.close(),t.repairEffectMap.delete(e))},a),t.repairEffectMap.set(e,a)}):this.repairEffectMap=new Map)},v.showIgniteEffect=function(e,t){var a,n,o=this;null!=e&&null!=t&&(null!=this.igniteEffectMap?(a=function(){v.deleteEffect(t,i.IGNITE_EFFECT)},this.igniteEffectMap.has(t)?null==(n=this.igniteEffectMap.get(t))||null!=(n=n.getComponent(u.IgniteEffect))&&n.bindData(e,t,a):p.SpecailSkill.createSkillEffectInEnemy(d.SkillTypeEnum.IGNITE,e,t,function(n){var i;null==n||null!=(i=n.getComponent(u.IgniteEffect))&&(i.bindData(e,t,a),o.igniteEffectMap.set(t,n))})):this.igniteEffectMap=new Map)},v.showFrozenEffect=function(e,t,a){var n=this;null!=e&&null!=t&&(null!=this.frozenEffectMap?this.frozenEffectMap.has(t)||p.SpecailSkill.createSkillEffectInEnemy(d.SkillTypeEnum.FROZEN,e,t,function(e){null!=e&&n.frozenEffectMap.set(t,e)},a):this.frozenEffectMap=new Map)},v.showThornsChainsEffect=function(e,t){var a=this;void 0===t&&(t=2);var n=g.PlayerState.playerData;if(null!=n)if(e){if(null!=this.thornsChainsEffect){this.thornsChainsEffect.playDownAnimation(.5),this.thornsChainsEffect.playMoveAnimation(),this.thornsChainsEffect=null;for(var o=0,i=Math.ceil(t/.2),r=0;r<i;r++)c.TimerManager.addTimer(.2+.2*r,function(){o++,p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.THORNS_CHAINS,n,function(e){if(null!=e){var t=e.getComponent(l.ThornsChainsEffect);if(null!=t){if(t.init(function(){v.deleteMoveThornsChainsEffect(t)}),i<=o)return t.playUpAnimation(!1),void(a.thornsChainsEffect=t);t.playUpAnimation(!0),t.playMoveAnimation(),null==a.moveThornsChainsEffects&&(a.moveThornsChainsEffects=[]),a.moveThornsChainsEffects.push(t)}}})})}}else null==this.thornsChainsEffect&&p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.THORNS_CHAINS,n,function(e){var t;null==e||null!=(t=e.getComponent(l.ThornsChainsEffect))&&(t.init(function(){v.deleteMoveThornsChainsEffect(t)}),t.playUpAnimation(!1),a.thornsChainsEffect=t)})},v.stopMoveThornsChainsEffects=function(){null==this.moveThornsChainsEffects||this.moveThornsChainsEffects.length<=0||this.moveThornsChainsEffects.forEach(function(e){e.stopMoveAnimation()})},v.deleteMoveThornsChainsEffect=function(e){if(null!=e)-1!=(e=this.moveThornsChainsEffects.indexOf(e))&&this.moveThornsChainsEffects.splice(e,1);else if(!(null==this.moveThornsChainsEffects||this.moveThornsChainsEffects.length<=0))for(var t=0;t<this.moveThornsChainsEffects.length;t++){var a=this.moveThornsChainsEffects[t];null!=a&&(s.GameCommonPool.returnInstant(a.node),this.moveThornsChainsEffects.splice(t,1),t--)}},v.showFuryEffect=function(){var e=this;null==this.furyEffect&&p.SpecailSkill.createSkillEffectInBottom(d.SkillTypeEnum.FURY,cc.v2(-450,-184),function(t){null!=t&&(e.furyEffect=t)})},v.showSpottingArrow=function(){var e=this;null==this.spottingArrow&&p.SpecailSkill.createSkillEffectInBottom(d.SkillTypeEnum.SPOTTING_ARROW,cc.v2(-700,0),function(t){null!=t&&(e.spottingArrow=t)})},v.showInspireWallEffect=function(){var e=this;null==this.inspireWallEffect&&p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.INSPIRE_WALL,g.PlayerState.playerData,function(t){null!=t&&(e.inspireWallEffect=t)})},v.showLifeMachineEffect=function(){var e=this;null==this.lifeMachineEffect&&p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.LIFE_MEACHINE,g.PlayerState.playerData,function(t){null!=t&&(c.TimerManager.addTimer(1.2,function(){var a=t.getComponent(m.RestoreEffect);null!=a&&(a.close(),e.lifeMachineEffect=null)},t),e.lifeMachineEffect=t)})},v.showEmergencyEquipmentEffect=function(e,t){function a(){v.deleteEffect(g.PlayerState.playerData,i.EMERGENCY_EQUIPMENT)}var n,o=this;null==this.emergencyEquipmentEffect?p.SpecailSkill.createEmergencyEquipmentEffect(function(n){var i;null==n||null!=(i=n.getComponent(h.EmergencyEquipmentEffect))&&(i.bindData(e,t,a),o.emergencyEquipmentEffect=n)}):null!=(n=this.emergencyEquipmentEffect.getComponent(h.EmergencyEquipmentEffect))&&n.bindData(e,t,a)},v.showReviveHoleEffect=function(){var e=this;null==this.reviveHoleEffect&&p.SpecailSkill.createSkillEffectInPlayer(d.SkillTypeEnum.REVIVE_HALO,g.PlayerState.playerData,function(t){null!=t&&(e.reviveHoleEffect=t)})},v.deleteEffect=function(e,t){if(void 0===t&&(t=null),null!=e){if(null==t)return this.bloodEffectMap.delete(e),this.hpUpEffectMap.delete(e),this.repairEffectMap.delete(e),this.thornsChainsEffect=null,this.igniteEffectMap.delete(e),this.frozenEffectMap.delete(e),this.furyEffect=null,this.inspireWallEffect=null,this.spottingArrow=null,this.lifeMachineEffect=null,this.emergencyEquipmentEffect=null,void(this.reviveHoleEffect=null);switch(t){case 0:return void this.bloodEffectMap.delete(e);case 1:return void this.hpUpEffectMap.delete(e);case 2:return void this.repairEffectMap.delete(e);case 3:return void(this.thornsChainsEffect=null);case 4:return void this.igniteEffectMap.delete(e);case 5:return void this.frozenEffectMap.delete(e);case 6:return void(this.furyEffect=null);case 7:return void(this.inspireWallEffect=null);case 8:return void(this.spottingArrow=null);case 9:return void(this.lifeMachineEffect=null);case 10:return void(this.emergencyEquipmentEffect=null);case 11:this.reviveHoleEffect=null;default:return}}},v.returnPermanentEffects=function(e){if(null!=e){for(var t=!1,a=!1,n=!1,o=!1,i=0;i<e.length;i++){var l=i,r=e[l];null==r||r<=0||(l==d.SkillTypeEnum.SPOTTING_ARROW&&(t=!0),l==d.SkillTypeEnum.THORNS_CHAINS&&(a=!0),l==d.SkillTypeEnum.FURY&&(n=!0),l==d.SkillTypeEnum.REVIVE_HALO&&(o=!0))}null==this.spottingArrow||t||(s.GameCommonPool.returnInstant(this.spottingArrow),this.spottingArrow=null),null==this.thornsChainsEffect||a||(this.thornsChainsEffect.playDownAnimation(),this.thornsChainsEffect=null),null==this.furyEffect||n||(s.GameCommonPool.returnInstant(this.furyEffect),this.furyEffect=null),null==this.reviveHoleEffect||o||(s.GameCommonPool.returnInstant(this.reviveHoleEffect),this.reviveHoleEffect=null,g.PlayerState.playerData.skillRevive=0)}},v.insertArrowsMap=null,v.bloodEffectMap=null,v.hpUpEffectMap=null,v.repairEffectMap=null,v.igniteEffectMap=null,v.frozenEffectMap=null,v.thornsChainsEffect=null,v.moveThornsChainsEffects=[],v.furyEffect=null,v.spottingArrow=null,v.inspireWallEffect=null,v.lifeMachineEffect=null,v.emergencyEquipmentEffect=null,v.reviveHoleEffect=null,n=v,o.SingleEffectManager=n,(o=i=o.SingleEffectTypeEnum||(o.SingleEffectTypeEnum={}))[o.BLOOD_EFFECT=0]="BLOOD_EFFECT",o[o.HP_UP_EFFECT=1]="HP_UP_EFFECT",o[o.REPAIR_EFFECT=2]="REPAIR_EFFECT",o[o.THORNS_CHAINS_EFFECT=3]="THORNS_CHAINS_EFFECT",o[o.IGNITE_EFFECT=4]="IGNITE_EFFECT",o[o.FROZEN_EFFCT=5]="FROZEN_EFFCT",o[o.FURY_EFFECT=6]="FURY_EFFECT",o[o.INSPIRE_WALL_EFFECT=7]="INSPIRE_WALL_EFFECT",o[o.SPOTTING_ARROW=8]="SPOTTING_ARROW",o[o.LIFE_MEACHINE=9]="LIFE_MEACHINE",o[o.EMERGENCY_EQUIPMENT=10]="EMERGENCY_EQUIPMENT",o[o.REVIVE_HOLE_EFFECT=11]="REVIVE_HOLE_EFFECT",cc._RF.pop()},{}],SkillData:[function(e,t,a){"use strict";cc._RF.push(t,"49948grN6RFu5BI3bfdp9Gl","SkillData");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator;function l(){this.skills=[]}n=i.ccclass,i.property,l.prototype.isHaveSkill=function(e){return!(null==this.skills||this.skills.length<=0)&&-1!=this.skills.indexOf(e)},l.prototype.addSkill=function(e){this.isHaveSkill(e)||this.skills.push(e)},l.prototype.addSkills=function(e){if(!(null==e||e.length<=0))for(var t=0;t<e.length;t++){var a=e[t];this.isHaveSkill(a)||this.addSkill(a)}},l.prototype.getSkills=function(){return this.skills},n=__decorate([n],l),o.SkillData=n,cc._RF.pop()},{}],SkillDescribeEffect:[function(e,t,a){"use strict";cc._RF.push(t,"38a3d+NUhNOMZHurtXbEpF4","SkillDescribeEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("ConfigData"),s=n("SkillSystem");function c(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillDescribeLabel=null,e.skillIndex=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(c,l),c.prototype.onEnable=function(){var e=this;this.node.opacity=255;var t=s.SkillSystem.getSkillLevel(this.skillIndex),a=r.ConfigData.skillDescribe[this.skillIndex],n=r.ConfigData.skillUpDescribe[this.skillIndex];this.skillDescribeLabel.string=t<=0?a:a+n,n=this.skillDescribeLabel.string.length*this.skillDescribeLabel.fontSize,this.node.setContentSize(n+2*this.skillDescribeLabel.fontSize,this.node.getContentSize().height),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(4),cc.fadeOut(1),cc.callFunc(function(){e.node.active=!1})))},__decorate([o({displayName:"\u6280\u80fd\u63cf\u8ff0label",type:cc.Label})],c.prototype,"skillDescribeLabel",void 0),n=__decorate([n],c),i.SkillDescribeEffect=n,cc._RF.pop()},{}],SkillDescriptionUI:[function(e,t,a){"use strict";cc._RF.push(t,"f7f8cSjbZFNZpOrftAgrMvw","SkillDescriptionUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("ConfigData"),s=n("SpriteFrameManager"),c=n("GameCommonPool");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.boardNode=null,e.skillDetailName=null,e.skillDetailIcon=null,e.skillDescription=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.bindData=function(e,t){null!=e&&(this.boardNode.y=t,this.skillDetailName.string=r.ConfigData.skillName[e],this.skillDetailIcon.spriteFrame=s.SpriteFrameManager.getSkillSpriteFrame(e),this.skillDescription.string=r.ConfigData.skillDescribe[e])},p.prototype.clickClose=function(){this.close()},p.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"board\u8282\u70b9",type:cc.Node})],p.prototype,"boardNode",void 0),__decorate([o({displayName:"\u8be6\u60c5\u9875\u6280\u80fd\u540d\u79f0",type:cc.Label})],p.prototype,"skillDetailName",void 0),__decorate([o({displayName:"\u8be6\u60c5\u9875\u6280\u80fdicon",type:cc.Sprite})],p.prototype,"skillDetailIcon",void 0),__decorate([o({displayName:"\u8be6\u60c5\u9875\u6280\u80fd\u4ecb\u7ecd",type:cc.Label})],p.prototype,"skillDescription",void 0),n=__decorate([n],p),i.SkillDescriptionUI=n,cc._RF.pop()},{}],SkillItem:[function(e,t,a){"use strict";cc._RF.push(t,"c4c40RS7zRI14VMqnp22n5J","SkillItem");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("SkillSystem"),s=n("ConfigData"),c=n("SpriteFrameManager"),p=n("LocalSoundManager"),d=n("GameConfigData"),u=n("GameState"),h=n("PlayerState"),m=n("UIManager");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillNameLabel=null,e.skillIconSprite=null,e.levelStars=[],e.buttonMask=null,e.skillIndex=null,e.clickCallback=null,e.skillUICloseAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),f.prototype.bindInfo=function(e,t,a,n,o){if(null!=(this.skillIndex=e)){if(this.node.setScale(t),this.buttonMask&&(this.buttonMask.active=!a),this.skillIconSprite.spriteFrame=c.SpriteFrameManager.getSkillSpriteFrame(e),t=d.GameConfigData.data.skillMaxLevel[e],a=r.SkillSystem.getSkillLevel(e),null!=this.levelStars&&0<this.levelStars.length)if(99==t)for(var i=0;i<this.levelStars.length;i++)null!=(l=this.levelStars[i])&&(l.active=!1);else{var l,p=a+1;for(i=0;i<this.levelStars.length;i++)null!=(l=this.levelStars[i])&&(l.active=i+1<=p)}null!=(e=s.ConfigData.getSkillName(e))&&(this.skillNameLabel&&(this.skillNameLabel.string=e),this.clickCallback=n,this.skillUICloseAction=o)}},f.prototype.onClickPick=function(){var e=this;p.LocalSoundManager.playAudio("click");var t=h.PlayerState.playerData;if(null!=t){var a=r.SkillSystem.isImmediateSkill(this.skillIndex);if(r.SkillSystem.chooseSkill(this.skillIndex),a?r.SkillSystem.useImmediateSkill(this.skillIndex,null):(r.SkillSystem.equipSkill(this.skillIndex),21==this.skillIndex&&(t.skillRevive=1)),null!=(t=h.PlayerState.player)&&t.changeWeapon(),this.clickCallback&&this.clickCallback(),this.clickCallback=null,t=function(){e.skillUICloseAction&&e.skillUICloseAction()},1!=u.GameState.currentPart&&!r.SkillSystem.isGotDoubleSkill)return r.SkillSystem.isSkillFullLevel(this.skillIndex)?(r.SkillSystem.isNextDoubleSkill=!0,void m.UIManager.showGetSkillUI(this.skillIndex,!1,t)):r.SkillSystem.isNextDoubleSkill?(r.SkillSystem.isGotDoubleSkill=!0,r.SkillSystem.isNextDoubleSkill=!1,void m.UIManager.showGetSkillUI(this.skillIndex,!0,t)):void(Math.random()<.5?(r.SkillSystem.isGotDoubleSkill=!0,r.SkillSystem.isNextDoubleSkill=!1,m.UIManager.showGetSkillUI(this.skillIndex,!0,t)):m.UIManager.showGetSkillUI(this.skillIndex,!1,t));m.UIManager.showGetSkillUI(this.skillIndex,!1,t)}},__decorate([o({displayName:"\u6280\u80fd\u540d\u5b57",type:cc.Label})],f.prototype,"skillNameLabel",void 0),__decorate([o({displayName:"\u6280\u80fd\u56fe\u6807",type:cc.Sprite})],f.prototype,"skillIconSprite",void 0),__decorate([o({displayName:"\u6280\u80fd\u7b49\u7ea7\u661f\u661f",type:cc.Node})],f.prototype,"levelStars",void 0),__decorate([o({displayName:"\u6309\u94ae\u906e\u7f69",type:cc.Node})],f.prototype,"buttonMask",void 0),n=__decorate([n],f),i.SkillItem=n,cc._RF.pop()},{}],SkillSystem:[function(e,t,a){"use strict";cc._RF.push(t,"780e1qO0S9My6XivmR3hWJ2","SkillSystem");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("EnumAndConst"),l=n("LocalData"),r=n("GameConfigData"),s=n("PlayerState"),c=n("SpecailSkill"),p=n("SingleEffectManager"),d=n("GameState");function u(){}u.initSkill=function(e,t,a,n,o){if(this.equipedSkillLevels=e||[],this.equipmentSkillLevels=a||[],this.chooseSkills=t||[],this.inheritSkillLevels=n||[],this.isGotDoubleSkill=!1,this.isNextDoubleSkill=!1,o){var i=0;if(0<this.inheritSkillLevels.length)for(var l=0;l<this.inheritSkillLevels.length;l++)if(5<=i)d.GameState.inheritSkillCount=5,this.inheritSkillLevels[l]=0;else if(this.isImmediateSkill(l))this.inheritSkillLevels[l]=0;else if(!(null==(u=this.inheritSkillLevels[l])||u<=0)){var s=r.GameConfigData.data.skillMaxLevel[l];s<=u&&(this.inheritSkillLevels[l]=u=s);for(var c=0,p=0;p<u;p++)if(c+=1,i+=1,this.equipSkill(l),this.chooseSkill(l),5<=i){d.GameState.inheritSkillCount=5,this.inheritSkillLevels[l]=c;break}}}if(0<this.equipmentSkillLevels.length)for(l=0;l<this.equipmentSkillLevels.length;l++){var u=this.equipmentSkillLevels[l];for(p=0;p<u;p++)this.equipSkill(l)}},u.chooseSkill=function(e){this.chooseSkills.push(e);var t=s.PlayerState.playerData;null!=t&&(e==i.SkillTypeEnum.DAMAGE_UP&&c.SpecailSkill.createSkillEffectInPlayer(i.SkillTypeEnum.DAMAGE_UP,t),e==i.SkillTypeEnum.REVIVE_HALO&&p.SingleEffectManager.showReviveHoleEffect(),e==i.SkillTypeEnum.THORNS_CHAINS&&p.SingleEffectManager.showThornsChainsEffect(!1),e==i.SkillTypeEnum.FURY&&p.SingleEffectManager.showFuryEffect(),e==i.SkillTypeEnum.SPOTTING_ARROW&&p.SingleEffectManager.showSpottingArrow())},u.useImmediateSkill=function(e,t){if(null!=e&&null!=t){var a=s.PlayerState.playerData;if(null!=a){var n=0;switch(e){case 11:if(null==a.shieldIndex)return;if(n=Math.round(a.maxShieldDefense*t),a.shieldDefense<=0)return s.PlayerState.player.repairEquipment(l.EquipmentType.shield,n,!1),s.PlayerState.player.equipShield(),n;s.PlayerState.player.repairEquipment(l.EquipmentType.shield,n,!1);break;case 12:n=Math.round(a.maxHp*t),s.PlayerState.player.restoreHp(n,!1);break;case 13:n=Math.round(a.initMaxHp*t),a.maxHp+=n,a.extraHp+=n,s.PlayerState.player.restoreHp(n,!1);break;case 14:if(null==a.helmetIndex)return;if(n=Math.round(a.maxHelmetDefense*t),a.helmetDefense<=0)return s.PlayerState.player.repairEquipment(l.EquipmentType.helmet,n,!1),s.PlayerState.player.equipHelmet(),n;s.PlayerState.player.repairEquipment(l.EquipmentType.helmet,n,!1)}return n}}},u.equipSkill=function(e){var t;null==this.equipedSkillLevels&&(this.equipedSkillLevels=[]),null!=e&&(null!=this.equipedSkillLevels[e]?(t=this.equipedSkillLevels[e]+1,this.equipedSkillLevels[e]=t):this.equipedSkillLevels[e]=1)},u.equipEquipmentSkill=function(e){var t;null==this.equipmentSkillLevels&&(this.equipmentSkillLevels=[]),null!=e&&(this.equipSkill(e),null!=this.equipmentSkillLevels[e]?(t=this.equipmentSkillLevels[e]+1,this.equipmentSkillLevels[e]=t):this.equipmentSkillLevels[e]=1)},u.inheritSkill=function(e){var t;null==this.inheritSkillLevels&&(this.inheritSkillLevels=[]),null!=e&&(null!=this.inheritSkillLevels[e]?(t=this.inheritSkillLevels[e]+1,this.inheritSkillLevels[e]=t):this.inheritSkillLevels[e]=1)},u.getSkillsBySelect=function(){for(var e=[],t=0;t<r.GameConfigData.data.skillMaxLevel.length;t++){var a=t,n=this.equipedSkillLevels[a];null==n&&(n=0);var o=n-(o=null==(o=this.equipmentSkillLevels[a])?0:o)-(null==(o=this.inheritSkillLevels[a])?0:o);0<(o=Math.max(0,o))&&e.push(a)}return e},u.getSkillsExceptEquipmentSkillLevels=function(){for(var e=[],t=0;t<r.GameConfigData.data.skillMaxLevel.length;t++){var a=t,n=(n=null==(n=this.equipedSkillLevels[a])?0:n)-(null==(n=this.equipmentSkillLevels[a])?0:n);n=Math.max(0,n),e[a]=n}return e},u.getSkillLevel=function(e){if(null==e)return 0;var t=this.equipedSkillLevels[e];null==this.equipedSkillLevels[e]&&(t=this.equipedSkillLevels[e]=0);var a=r.GameConfigData.data.skillMaxLevel[e];return(t=a<t?this.equipedSkillLevels[e]=a:t)<0?this.equipedSkillLevels[e]=0:t},u.isSkillFullLevel=function(e){if(null!=e)return this.getSkillLevel(e)>=r.GameConfigData.data.skillMaxLevel[e]},u.isImmediateSkill=function(e){if(null!=e)switch(e){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:return!1;case 11:case 12:case 13:case 14:return!0}},u.getEquipedSkillData=function(e){if(null==e)return 0;var t=this.getSkillLevel(e);if(t<=0)return 0;var a=this.getEquipedSkillInitData(e);return(a=null==a?0:a)+(e=null==(e=this.getEquipedSkillUpOffsetData(e))?0:e)*(t-1)},u.getEquipedSkillInitData=function(e){if(null!=e)return r.GameConfigData.data.skillInitData[e]},u.getEquipedSkillUpOffsetData=function(e){if(null!=e)return r.GameConfigData.data.skillUpOffsetData[e]},u.equipedSkillLevels=[],u.equipmentSkillLevels=[],u.chooseSkills=[],u.inheritSkillLevels=[],u.isGotDoubleSkill=!1,u.isNextDoubleSkill=!1,n=u,o.SkillSystem=n,cc._RF.pop()},{}],SliderLayout:[function(e,t,a){"use strict";cc._RF.push(t,"c3daf+FuitH6YViq44Ivn/v","SliderLayout");var n=a;Object.defineProperty(n,"__esModule",{value:!0});var o,i=(p=cc._decorator).ccclass,l=p.property,r=p.executeInEditMode,s=p.menu,c=p.playOnFocus,p=p.disallowMultiple;function d(){var e=null!==o&&o.apply(this,arguments)||this;return e.defaultRect=!0,e.defineRect=new cc.Vec2(0,0),e.distance=0,e.slideSensitivity=15,e.itemScale=new cc.Vec2(1.5,1),e.centerNodeColor=cc.Color.WHITE,e.edgeNodeColor=cc.Color.WHITE,e.changeIndexEvents=[],e.itemWidth=0,e.followLastPosX=0,e.followLastTime=0,e.endX=0,e.endTime=0,e.speed=0,e.followMoveDis=0,e.lastMoveX=0,e.interval=0,e.lastIndex=-1,e}o=cc.Component,__extends(d,o),d.prototype.start=function(){this.initItems()},d.prototype.initItems=function(){if(!(this.node.childrenCount<=0)){this.itemWidth=this.node.children[0].width,this.interval=this.itemWidth+this.distance;for(var e=0;e<this.node.childrenCount;e++)this.node.children[e].setPosition(this.interval*e,0)}},d.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},d.prototype.onTouchStart=function(e){this.stopAllMove(),this.followLastPosX=e.getLocationX(),this.followMoveDis=0,this.speed=0,this.lastMoveX=0},d.prototype.onTouchMove=function(e){e=e.getLocationX(),this.lastMoveX=e-this.followLastPosX,this.followMoveDis+=this.lastMoveX,this.followMove(e),this.followLastPosX=e,this.followLastTime=Date.now()},d.prototype.onTouchEnd=function(e){this.endX=e.getLocationX(),this.endTime=Date.now(),this.speed=this.lastMoveX,20<Math.abs(this.speed)&&(this.speed=20*this.sign(this.speed)),this.doMove(this.speed)},d.prototype.stopAllMove=function(){for(var e=0,t=this.node.children;e<t.length;e++)t[e].stopAllActions()},d.prototype.followMove=function(e){for(var t=0,a=this.node.children;t<a.length;t++){var n=a[t],o=n.position.add(cc.v2(e-this.followLastPosX,0));n.setPosition(o)}},d.prototype.doMove=function(e){for(var t=0<=e?Math.floor(e/this.slideSensitivity):Math.ceil(Math.floor(e)/this.slideSensitivity),a=(t=this.moveNumLimit(t),0);a<this.node.childrenCount;a++){var n=this.getCurIndex(this.node.children[0])+a+t,o=(n=this.nodeNumLimit(a,n),cc.v2(n*this.interval,0));n=Math.max(.5,.5*Math.abs(t)),o=cc.moveTo(n,o).easing(cc.easeSineOut()),this.node.children[a].runAction(o)}},d.prototype.update=function(){var e=this;this.node.children.forEach(function(t,a){var n;0!=e.getCurIndex(t)||a!=e.lastIndex&&(n=a,e.changeIndexEvents.forEach(function(e){e.emit([n])}),e.lastIndex=a)}),this.showChildren()},d.prototype.showChildren=function(){var e=this;this.node.children.forEach(function(t){var a=Math.abs(t.x);t.scale=e.lerp(a/e.interval,e.itemScale.x,e.itemScale.y),a=e.lerp(a/e.interval,e.centerNodeColor,e.edgeNodeColor),t.color=cc.color(a.getR(),a.getG(),a.getB()),t.opacity=a.getA()})},d.prototype.getCurIndex=function(e){var t=Math.round(e.x),a=t%this.interval;return e=0,e=0<=t?Math.floor(t/this.interval):Math.ceil(t/this.interval),Math.abs(a)<this.interval/2?Math.round(e):Math.abs(a)>this.interval/2?Math.round(e+a/Math.abs(a)):Math.abs(a)==this.interval/2?Math.round(e-1):void 0},d.prototype.moveNumLimit=function(e){if(!(this.node.childrenCount<=0)){var t=-this.node.childrenCount,a=this.node.childrenCount,n=this.getCurIndex(this.node.children[0]),o=this.getCurIndex(this.node.children[this.node.childrenCount-1]);return n+e<t?t-n:a<o+e?a-o:e}},d.prototype.nodeNumLimit=function(e,t){var a=1-this.node.childrenCount+e;return t<a?a:e<t?e:t},d.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this.onTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this.onTouchEnd,this)},d.prototype.lerp=function(e,t,a){if(e=cc.misc.clampf(e,0,1),"number"==typeof t&&"number"==typeof a)return t+(a-t)*e;if(t instanceof cc.Vec2&&a instanceof cc.Vec2){var n=t,o=a,i=this.lerp(e,n.x,o.x),l=this.lerp(e,n.y,o.y);return cc.v2(i,l)}return t instanceof cc.Color&&a instanceof cc.Color?(n=t,o=a,l=this.lerp(e,n.getR(),o.getR()),t=this.lerp(e,n.getG(),o.getG()),a=this.lerp(e,n.getB(),o.getB()),o=this.lerp(e,n.getA(),o.getA()),cc.color(l,t,a,o)):void 0},d.prototype.sign=function(e){return 0<e?1:e<0?-1:0},__decorate([l({visible:!0,serializable:!0,displayName:"\u6ed1\u52a8\u7a97\u53e3\u9ed8\u8ba4\u672c\u8282\u70b9\u8303\u56f4"})],d.prototype,"defaultRect",void 0),__decorate([l({displayName:"\u81ea\u5b9a\u4e49\u7a97\u53e3\u8303\u56f4",tooltip:"\u4f1a\u6539\u53d8\u8282\u70b9\u5bbd\u9ad8\uff0c\u5982\u679c\u6709\u56fe\u7247\u5219\u4f1a\u62c9\u4f38"})],d.prototype,"defineRect",void 0),__decorate([l({visible:!0,displayName:"\u95f4\u9694\u8ddd\u79bb"})],d.prototype,"distance",void 0),__decorate([l({displayName:"\u6ed1\u52a8\u7075\u654f\u5ea6",tooltip:"\u8d8a\u5c0f\u8d8a\u7075\u654f",slide:!0,min:.1,max:50})],d.prototype,"slideSensitivity",void 0),__decorate([l({displayName:"\u4e2d\u95f4\u7f29\u653e-\u4e24\u8fb9\u7f29\u653e"})],d.prototype,"itemScale",void 0),__decorate([l({displayName:"\u4e2d\u95f4\u8282\u70b9\u989c\u8272"})],d.prototype,"centerNodeColor",void 0),__decorate([l({displayName:"\u4e24\u8fb9\u8282\u70b9\u989c\u8272"})],d.prototype,"edgeNodeColor",void 0),__decorate([l({type:cc.Component.EventHandler,displayName:"\u7d22\u5f15\u6539\u53d8\u63a5\u53e3",tooltip:"\u81ea\u52a8\u4f20\u5165\u5f53\u524d\u7d22\u5f15\u503c\uff0c\u9700\u8981\u6709number\u53c2\u6570\u7684\u65b9\u6cd5\u63a5\u53d7\u8be5\u4e8b\u4ef6"})],d.prototype,"changeIndexEvents",void 0),p=__decorate([i,r,s("\u81ea\u5b9a\u4e49\u7ec4\u4ef6/\u5e03\u5c40\u7ec4\u4ef6/SliderLayout"),c,p],d),n.SliderLayout=p,cc._RF.pop()},{}],SoundManager:[function(e,t,a){"use strict";cc._RF.push(t,"bd440hT+LdGoLxne6j/Wzyo","SoundManager");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=o("UserData");function c(){return null!==l&&l.apply(this,arguments)||this}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(c,l),(r=c).getAudioByName=function(e,t){var a;null!=e&&(null==(a=this.gameSoundMap.get(e))?cc.loader.loadRes("Audio/"+e,cc.AudioClip,function(a,n){a||null==n?console.error(a):(t&&t(n),r.gameSoundMap.set(e,n))}):t&&t(a))},c.playAudio=function(e){var t=this;s.UserData.data.gameSound&&this.getAudioByName(e,function(e){var a,n;null!=e&&(t._dic.has(e)&&(a=t._dic.get(e),null!=(n=cc.audioEngine._id2audio[a])&&n.destroy()),a=cc.audioEngine.playEffect(e,!1),t._dic.set(e,a))})},c.stop=function(e){var t=this;this.getAudioByName(e,function(e){null!=e&&t._dic.has(e)&&(e=t._dic.get(e),(e=cc.audioEngine._id2audio[e])&&e.stop())})},c.gameSoundMap=new Map,c._dic=new Map,o=r=__decorate([o],c),i.SoundManager=o,cc._RF.pop()},{}],SoundSwitch:[function(e,t,a){"use strict";cc._RF.push(t,"0b5dc9ByW5D3bWrtgsxu1y7","SoundSwitch");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("UserData"),s=n("LocalData"),c=n("LocalSoundManager"),p=n("GameCommonPool");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.soundSwitchSprite=null,e.soundSwitchSpriteFrames=[],e.vibrateSwitchSprite=null,e.vibrateSwitchSpriteFrames=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){var e;(null!=this.soundSwitchSprite||null!=this.soundSwitchSpriteFrames||2<=this.soundSwitchSpriteFrames.length)&&(e=r.UserData.data.gameSound?0:1,this.soundSwitchSprite.spriteFrame=this.soundSwitchSpriteFrames[e]),(null!=this.vibrateSwitchSprite||null!=this.vibrateSwitchSpriteFrames||2<=this.vibrateSwitchSpriteFrames.length)&&(e=s.LocalData.data.vibrateOpened?0:1,this.vibrateSwitchSprite.spriteFrame=this.vibrateSwitchSpriteFrames[e])},d.prototype.clickSwitchSound=function(){c.LocalSoundManager.playAudio("click"),r.UserData.data.gameSound=!r.UserData.data.gameSound,null==this.soundSwitchSprite||null==this.soundSwitchSpriteFrames||this.soundSwitchSpriteFrames.length<2||(r.UserData.data.gameSound?this.soundSwitchSprite.spriteFrame=this.soundSwitchSpriteFrames[0]:this.soundSwitchSprite.spriteFrame=this.soundSwitchSpriteFrames[1])},d.prototype.clickSwitchVibrate=function(){c.LocalSoundManager.playAudio("click"),s.LocalData.data.vibrateOpened=!s.LocalData.data.vibrateOpened,null==this.vibrateSwitchSprite||null==this.vibrateSwitchSpriteFrames||this.vibrateSwitchSpriteFrames.length<2||(s.LocalData.data.vibrateOpened?this.vibrateSwitchSprite.spriteFrame=this.vibrateSwitchSpriteFrames[0]:this.vibrateSwitchSprite.spriteFrame=this.vibrateSwitchSpriteFrames[1])},d.prototype.clickClose=function(){c.LocalSoundManager.playAudio("click"),p.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u97f3\u6548\u5f00\u5173\u56fe\u7247",type:cc.Sprite})],d.prototype,"soundSwitchSprite",void 0),__decorate([o({displayName:"\u97f3\u6548\u5f00\u5173\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],d.prototype,"soundSwitchSpriteFrames",void 0),__decorate([o({displayName:"\u9707\u52a8\u5f00\u5173\u56fe\u7247",type:cc.Sprite})],d.prototype,"vibrateSwitchSprite",void 0),__decorate([o({displayName:"\u9707\u52a8\u5f00\u5173\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],d.prototype,"vibrateSwitchSpriteFrames",void 0),n=__decorate([n],d),i.SoundSwitch=n,cc._RF.pop()},{}],SparkEffect:[function(e,t,a){"use strict";cc._RF.push(t,"ef3c8SBqnBDRoAY91HXluKA","SparkEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.sparkAnimation=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.sparkAnimation.play("Spark"),this.sparkAnimation.on("finished",this.close,this)},p.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),this.sparkAnimation.off("finished",this.close,this)},p.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u7ec4\u4ef6",type:cc.Animation})],p.prototype,"sparkAnimation",void 0),n=__decorate([n],p),i.SparkEffect=n,cc._RF.pop()},{}],SpecailSkill:[function(e,t,a){"use strict";cc._RF.push(t,"cdcbfZddyRFuKgsR8aDn9q/","SpecailSkill");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("GameCommonPool"),s=o("EnumAndConst"),c=o("BlastEffect"),p=o("FrozenEffect"),d=o("ThunderEffect"),u=o("BattleNodeManager"),h=o("ThunderImmuneEffect"),m=o("RoleManager"),f=o("PlayerTip"),g=o("RestoreEffect"),y=o("ThornsChainsDamageEffect"),v=o("TurnHeartEffect"),D=o("PlayerManager"),E=o("PlayerState"),S=o("ConfigData"),A=o("PrefabUrl"),C=o("LocalData"),M=o("SkillSystem"),T=o("Util"),_=o("SingleEffectManager");function k(){}o=(n=cc._decorator).ccclass,n.property,(l=k).division=function(e,t){var a,n,o,i,l,r;null!=e&&(a=e.node.position,l=((n=e.node.angle)+90)*Math.PI/180,o=cc.v2(Math.cos(l),Math.sin(l)).normalize(),i=cc.v2(e.horizontalSpeed,e.verticalSpeed),null!=(l=D.PlayerManager.createArrow(a))&&(l.bindData(e.roleData,e),l.node.setPosition(a),l.node.angle=n,l.node.scaleX=S.ConfigData.getEquipmentScale(e.roleData,C.EquipmentType.weapon),r=l.launch(i,e.delayTime,t),l.node.stopAllActions(),l.node.runAction(cc.sequence(cc.delayTime(e.delayTime),cc.moveBy(600/Math.abs(e.horizontalSpeed),o.mul(80)))),m.RoleManager.addWaitingLaunchArrow(e.roleData,r)),t<=1||null!=(r=D.PlayerManager.createArrow(a))&&(r.bindData(e.roleData,e),r.node.setPosition(a),r.node.angle=n,r.node.scaleX=S.ConfigData.getEquipmentScale(e.roleData,C.EquipmentType.weapon),t=r.launch(i,e.delayTime,t),r.node.stopAllActions(),r.node.runAction(cc.sequence(cc.delayTime(e.delayTime),cc.moveBy(600/Math.abs(e.horizontalSpeed),o.mul(-80)))),m.RoleManager.addWaitingLaunchArrow(e.roleData,t)))},k.killBlast=function(e){if(null==e||!e.isEnemy||null==e.killerData||!e.killerData.isPlayer)return!1;var t=!1;return 0<M.SkillSystem.getSkillLevel(s.SkillTypeEnum.BLAST)&&(t=!0,l.createSkillEffectInEnemy(s.SkillTypeEnum.BLAST,e.killerData,e)),t},k.thunderSkill=function(e,t,a,n,o){var i=u.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE);if(null!=i&&!((e.isPlayer?M.SkillSystem.getSkillLevel(s.SkillTypeEnum.THUNDER):1)<=0)){var c=function(t,a,n){var o=t.logicPos,c=a.logicPos;n&&(t==a?(o=t.headPosition,c=o):o=t.headPosition),r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+A.EffectPrefabNameEnum.thunderEffect,function(e,t){t.setParent(i),t.setPosition(c),null!=(t=t.getComponent(d.ThunderEffect))&&t.bindData(o,c)}),a.thunderImmuneTime=1.5,m.RoleManager.roleIsDamaged(a,e,.2*e.atk,c),l.createSkillEffectInEnemy(s.SkillTypeEnum.THUNDER,e,a),a=c.x<=o.x?1:-1,_.SingleEffectManager.showBloodEffect(c,a,e)};c(t,t,o);for(var p=[t],h=t,f=0;f<n;f++){for(var g=9999,y=null,v=0;v<a.length;v++){var D,E=a[v];null==E||E.isDead||E.isTeleporting||0<E.invincibleTime||E.isFeignDeath||0<E.thunderImmuneTime||-1!=p.indexOf(E)||(D=T.Util.getDistance(h.logicPos,E.logicPos))<=g&&(g=D,y=E)}if(null==y)return;c(h,y,h==t&&o),p.push(y),h=y}}},k.turnHeart=function(e,t,a){if(null==e||null==a||null==t||!t)return!1;var n=M.SkillSystem.getSkillLevel(s.SkillTypeEnum.TURN_HEART);return t=M.SkillSystem.getEquipedSkillData(s.SkillTypeEnum.TURN_HEART),e=e.isEnemy&&null!=e.killerData&&e.killerData.isPlayer,!!(0<n&&a<t&&e)},k.createSkillEffectInEnemy=function(e,t,a,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var i=u.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE);if(null!=i){var l=null;switch(e){case s.SkillTypeEnum.BLAST:l=A.EffectPrefabNameEnum.blastEffect;break;case s.SkillTypeEnum.IGNITE:l=A.EffectPrefabNameEnum.igniteEffect;break;case s.SkillTypeEnum.FROZEN:l=A.EffectPrefabNameEnum.frozonEffect;break;case s.SkillTypeEnum.THUNDER:l=A.EffectPrefabNameEnum.thunderImmuneEffect;break;case s.SkillTypeEnum.THORNS_CHAINS:l=A.EffectPrefabNameEnum.thornsChainsDamageEffect;break;case s.SkillTypeEnum.TURN_HEART:l=A.EffectPrefabNameEnum.turnHeartEffect}r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+l,function(e,l){l.setParent(i),l.setPosition(a.logicPos);var r=l.getComponent(c.BlastEffect);null!=r&&r.bindData(t),null!=(r=l.getComponent(p.FrozenEffect))&&r.bindData(t,a,o),null!=(r=l.getComponent(h.ThunderImmuneEffect))&&r.bindData(a),null!=(r=l.getComponent(y.ThornsChainsDamageEffect))&&r.bindData(a),null!=(r=l.getComponent(v.TurnHeartEffect))&&r.bindData(a),n&&n(l)})}},k.createSkillEffectInPlayer=function(e,t,a){void 0===a&&(a=null);var n=null;switch(e){case s.SkillTypeEnum.HP_UP:case s.SkillTypeEnum.MAX_HP_UP:case s.SkillTypeEnum.SHIELD_UP:case s.SkillTypeEnum.HELMET_UP:case s.SkillTypeEnum.LIFE_MEACHINE:n=A.EffectPrefabNameEnum.restoreEffect;break;case s.SkillTypeEnum.DAMAGE_UP:n=A.EffectPrefabNameEnum.damageUpEffect;break;case s.SkillTypeEnum.REVIVE_HALO:n=A.EffectPrefabNameEnum.reviveHaloEffect;break;case s.SkillTypeEnum.DODGE:n=A.EffectPrefabNameEnum.roleTip;break;case s.SkillTypeEnum.THORNS_CHAINS:n=A.EffectPrefabNameEnum.thornsChainsEffect;break;case s.SkillTypeEnum.INSPIRE_WALL:n=A.EffectPrefabNameEnum.inspireWallEffect;break;case s.SkillTypeEnum.DIVINE_SHIELD:n=A.EffectPrefabNameEnum.divineShieldEffect}r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+n,function(n,o){var i;null==o||null!=(i=u.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE))&&(o.setParent(i),o.setPosition(t.logicPos),null!=(i=o.getComponent(f.PlayerTip))&&i.bindData(0),null!=(i=o.getComponent(g.RestoreEffect))&&i.bindData(e),a&&a(o))})},k.createSkillEffectInArrow=function(e,t){var a=null;switch(e){case s.SkillTypeEnum.IGNITE:a=A.EffectPrefabNameEnum.fireArrowEffect;break;case s.SkillTypeEnum.FROZEN:a=A.EffectPrefabNameEnum.iceArrowEffect;break;case s.SkillTypeEnum.THUNDER:a=A.EffectPrefabNameEnum.thunderArrowEffect}r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+a,function(e,a){null!=a&&(a.setPosition(cc.v2(999,999)),t&&t(a))})},k.createSkillEffectInBottom=function(e,t,a){var n=null;switch(e){case s.SkillTypeEnum.FURY:n=A.EffectPrefabNameEnum.furyEffect;break;case s.SkillTypeEnum.SPOTTING_ARROW:n=A.EffectPrefabNameEnum.spottingArrow}r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+n,function(e,n){var o;null==n||null!=(o=u.BattleNodeManager.getParentNode(s.BattleNodeEnum.BOTTOM_EFFECT_NODE))&&(n.setParent(o),n.setPosition(t),a&&a(n))})},k.createEmergencyEquipmentEffect=function(e){var t=E.PlayerState.playerData;null!=t&&r.GameCommonPool.requestInstantByUrl(A.PrefabUrl.effectUrl+A.EffectPrefabNameEnum.emergencyEquipment,function(a,n){var o;null==n||null!=(o=u.BattleNodeManager.getParentNode(s.BattleNodeEnum.EFFECT_NODE))&&(n.setParent(o),n.setPosition(t.logicPos),e&&e(n))})},o=l=__decorate([o],k),i.SpecailSkill=o,cc._RF.pop()},{}],SpineController:[function(e,t,a){"use strict";cc._RF.push(t,"8ac36aGz7BHlrjHyjwwj6si","SpineController");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("BattleNodeManager"),c=n("CloakController"),p=n("GameCommonPool");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.roleUpSpineAni=null,e.roleDownSpineAni=null,e.aimingLine=null,e.cloakNode=null,e.bodyNode=null,e.headCollider=null,e.bodyCollider=null,e.armRightCollider=null,e.armLeftCollider=null,e.legRightCollider=null,e.legLeftCollider=null,e.roleData=null,e.centerBone=null,e.headBone=null,e.shieldBone=null,e.weaponBone=null,e.bodyBone=null,e.armRightBellowBone=null,e.armRightBone=null,e.armLeftBellowBone=null,e.armLeftBone=null,e.legRightBone=null,e.legLeftBone=null,e.magicBone=null,e.cloakBone=null,e.rotateBone=null,e.helmetNode=null,e.shieldNode=null,e.weaponNode=null,e.wandNode=null,e.magicBalls=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){this.roleData=null,this.bodyNode=null,this.headCollider=null,this.bodyCollider=null,this.armRightCollider=null,this.armLeftCollider=null,this.legRightCollider=null,this.legLeftCollider=null,this.helmetNode=null,this.shieldNode=null,this.weaponNode=null,this.wandNode=null,this.magicBalls=[],this.centerBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.CENTER),this.headBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.HEAD),this.shieldBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.SHIELD),this.weaponBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.WEAPON),this.bodyBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.BODY),this.armRightBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.ARM_R_TOP),this.armLeftBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.ARM_L_TOP),this.armRightBellowBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.ARM_R_BELOW),this.armLeftBellowBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.ARM_L_BELOW),this.magicBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.MAGIC_E_M),this.cloakBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.CLOAK),this.legRightBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.LEG_R_TOP),this.legLeftBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.LEG_L_TOP),this.rotateBone=this.roleUpSpineAni.findBone(r.BoneNameEnum.Rotate)},d.prototype.lateUpdate=function(){null==this.roleData||this.roleData.isDestroy||(this.bodyNode.scaleX=this.roleData.orientation,this.refreshWeapon(),this.refreshShield(),this.refreshCloak(),this.refreshHead(),this.refreshBody(),this.refreshArms(),this.refreshMagicBalls(),this.refreshLegs())},d.prototype.bindData=function(e,t,a){this.roleData=e,null!=t&&(this.bodyCollider=t[0],this.armRightCollider=t[1],this.armLeftCollider=t[2],this.legRightCollider=t[3],this.legLeftCollider=t[4]),null!=a&&(this.headCollider=a),this.bodyNode=this.bodyCollider.node.parent},d.prototype.equipHelmet=function(e){this.helmetNode=e},d.prototype.equipShield=function(e){this.shieldNode=e},d.prototype.equipWeapon=function(e){this.weaponNode=e},d.prototype.eqiupWand=function(e){this.wandNode=e},d.prototype.equipCloak=function(e){var t;null!=e?(this.cloakNode.active=!0,null!=(t=this.cloakNode.getComponent(c.CloakController))&&t.selectCloak(e)):this.cloakNode.active=!1},d.prototype.refreshWeapon=function(){var e,t,a;this.roleData.attackModel==r.AttackModelTypeEnum.LONG_RANGE_ATTACK&&this.roleData.weaponLaunch&&(this.weaponNode=null),this.weaponBone&&(this.aimingLine||this.weaponNode&&this.weaponNode.isValid)&&(t=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY),this.aimingLine&&(e=this.roleUpSpineAni.node.convertToWorldSpaceAR(t),a=this.node.convertToNodeSpaceAR(e),this.aimingLine.position=a),this.weaponNode&&this.weaponNode.isValid&&(e=this.roleUpSpineAni.node.convertToWorldSpaceAR(t),null!=(t=s.BattleNodeManager.getParentNode(r.BattleNodeEnum.ARROW_NODE))&&(a=t.convertToNodeSpaceAR(e),this.weaponNode.position=a,this.roleData.attackModel==r.AttackModelTypeEnum.MELEE_ATTACK?0!=(a=cc.v2(this.weaponBone.worldX,this.weaponBone.worldY).sub(cc.v2(this.armLeftBone.worldX,this.armLeftBone.worldY))).x&&0!=a.y&&(a=180*-a.normalize().signAngle(cc.Vec2.RIGHT)/Math.PI,this.weaponNode.angle=this.roleData.orientation*(30+a)):this.weaponNode.angle=this.roleUpSpineAni.node.angle-30*this.roleData.orientation)))},d.prototype.refreshShield=function(){var e,t;this.roleData.shieldDroped&&(this.shieldNode=null),this.shieldBone&&(this.wandNode||this.shieldNode&&this.shieldNode.isValid)&&(e=cc.v2(this.shieldBone.worldX,this.shieldBone.worldY),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(r.BattleNodeEnum.SHIRLD_NODE))&&(t=e.convertToNodeSpaceAR(t),this.wandNode&&(this.wandNode.position=t,this.wandNode.angle=this.centerBone.rotation+this.roleUpSpineAni.node.angle),this.shieldNode&&this.shieldNode.isValid&&(this.shieldNode.position=t,this.shieldNode.angle=this.centerBone.rotation+this.roleUpSpineAni.node.angle)))},d.prototype.refreshCloak=function(){var e;this.cloakBone&&this.cloakNode&&this.cloakNode.active&&(e=cc.v2(this.cloakBone.worldX,this.cloakBone.worldY),e=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),e=this.node.convertToNodeSpaceAR(e),this.cloakNode.position=e,this.cloakNode.angle=this.roleUpSpineAni.node.angle)},d.prototype.refreshHead=function(){var e,t;this.roleData.helmetDroped&&(this.helmetNode=null),this.roleData.headDroped&&(this.headCollider=null),this.headBone&&(this.headCollider||this.helmetNode&&this.helmetNode.isValid)&&(e=cc.v2(this.headBone.worldX,this.headBone.worldY),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),null!=(e=s.BattleNodeManager.getParentNode(r.BattleNodeEnum.HELMET_NODE))&&(t=e.convertToNodeSpaceAR(t),this.headCollider&&(this.roleData.profession==r.ProfessionEnum.SHIELD_WIZARD||this.roleData.profession==r.ProfessionEnum.NECROMANCER||this.roleData.profession==r.ProfessionEnum.SHARKER?this.headCollider.node.position=t.add(cc.v2(0,4)):(this.headCollider.node.position=t,this.centerBone&&(this.headCollider.node.angle=this.centerBone.rotation+this.roleUpSpineAni.node.angle))),this.helmetNode&&this.helmetNode.isValid&&(this.helmetNode.position=t,this.centerBone&&(this.helmetNode.angle=this.centerBone.rotation+this.roleUpSpineAni.node.angle))))},d.prototype.refreshBody=function(){var e;this.bodyBone&&this.bodyCollider&&(e=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY),this.bodyCollider.node.position=e,this.roleData.profession!=r.ProfessionEnum.FIRE_DRAGON&&this.roleData.profession!=r.ProfessionEnum.ICE_DRAGON&&(this.roleData.profession==r.ProfessionEnum.SHIELD_WIZARD||this.roleData.profession==r.ProfessionEnum.NECROMANCER?this.bodyCollider.node.angle=(this.bodyBone.rotation+this.centerBone.rotation)*this.roleData.orientation+this.roleUpSpineAni.node.angle:this.bodyCollider.node.angle=((this.bodyBone.rotation-90+this.centerBone.rotation)*this.roleData.orientation+this.roleUpSpineAni.node.angle)*this.roleData.orientation))},d.prototype.refreshArms=function(){if(this.armRightBone&&this.armRightCollider){if(0==(o=cc.v2(this.armRightBone.worldX,this.armRightBone.worldY).sub(cc.v2(this.armRightBellowBone.worldX,this.armRightBellowBone.worldY))).x&&0==o.y)return;var e=cc.v2(this.armRightBellowBone.worldX,this.armRightBellowBone.worldY).add(o.mul(.5)),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),a=this.bodyNode.convertToNodeSpaceAR(t),n=180*-o.signAngle(cc.Vec2.RIGHT)/Math.PI;this.armRightCollider.node.position=a,this.armRightCollider.node.angle=(n*this.roleData.orientation+this.roleUpSpineAni.node.angle)*this.roleData.orientation}var o;this.armLeftBone&&this.armLeftCollider&&(0==(o=cc.v2(this.armLeftBone.worldX,this.armLeftBone.worldY).sub(cc.v2(this.armLeftBellowBone.worldX,this.armLeftBellowBone.worldY))).x&&0==o.y||(e=cc.v2(this.armLeftBellowBone.worldX,this.armLeftBellowBone.worldY).add(o.mul(.5)),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e),a=this.bodyNode.convertToNodeSpaceAR(t),n=180*-o.normalize().signAngle(cc.Vec2.RIGHT)/Math.PI,this.armLeftCollider.node.position=a,this.armLeftCollider.node.angle=(n*this.roleData.orientation+this.roleUpSpineAni.node.angle)*this.roleData.orientation))},d.prototype.refreshLegs=function(){if(this.legRightBone&&this.legRightCollider){if(0==(n=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY).sub(cc.v2(this.legRightBone.worldX,this.legRightBone.worldY))).x&&0==n.y)return;var e,t=cc.v2(this.legRightBone.worldX,this.legRightBone.worldY).add(n.mul(.5));-1==this.roleData.orientation&&(e=(null==this.roleDownSpineAni?this.roleUpSpineAni:this.roleDownSpineAni).node.convertToWorldSpaceAR(t),t=this.bodyNode.convertToNodeSpaceAR(e));var a=180*-n.normalize().signAngle(cc.Vec2.RIGHT)/Math.PI;this.legRightCollider.node.position=t,this.legRightCollider.node.angle=a*this.roleData.orientation*this.roleData.orientation}var n;this.legLeftBone&&this.legLeftCollider&&(0==(n=cc.v2(this.bodyBone.worldX,this.bodyBone.worldY).sub(cc.v2(this.legLeftBone.worldX,this.legLeftBone.worldY))).x&&0==n.y||(t=cc.v2(this.legLeftBone.worldX,this.legLeftBone.worldY).add(n.mul(.5)),-1==this.roleData.orientation&&(e=(null==this.roleDownSpineAni?this.roleUpSpineAni:this.roleDownSpineAni).node.convertToWorldSpaceAR(t),t=this.bodyNode.convertToNodeSpaceAR(e)),a=180*-n.normalize().signAngle(cc.Vec2.RIGHT)/Math.PI,this.legLeftCollider.node.position=t,this.legLeftCollider.node.angle=a*this.roleData.orientation*this.roleData.orientation))},d.prototype.refreshMagicBalls=function(){if(this.magicBone&&null!=this.magicBalls&&0<this.magicBalls.length)if(this.roleData.isDead||this.roleData.isDestroy)for(var e=this.magicBalls.length,t=0;t<e;t++){var a=this.magicBalls.shift();p.GameCommonPool.returnInstant(a)}else{var n,o,i=s.BattleNodeManager.getParentNode(r.BattleNodeEnum.PARTICLE_NODE);null!=i&&(n=cc.v2(this.magicBone.worldX,this.magicBone.worldY),n=this.roleUpSpineAni.node.convertToWorldSpaceAR(n),o=i.convertToNodeSpaceAR(n),this.magicBalls.forEach(function(e){null!=e&&(e.position=o)}))}},d.prototype.getShieldBoneLocalPos=function(){if(this.shieldBone){var e=cc.v2(this.shieldBone.worldX,this.shieldBone.worldY),t=this.roleUpSpineAni.node.convertToWorldSpaceAR(e);if(null!=(e=s.BattleNodeManager.getParentNode(r.BattleNodeEnum.SHIRLD_NODE)))return e.convertToNodeSpaceAR(t)}},d.prototype.getBoneWorldPos=function(e){if(null!=e&&null!=(e=this.roleUpSpineAni.findBone(e)))return cc.v2(e.worldX,e.worldY)},d.prototype.getBoneByName=function(e){if(null!=e)switch(e){case r.BoneNameEnum.Rotate:return this.rotateBone;case r.BoneNameEnum.WEAPON:return this.weaponBone;case r.BoneNameEnum.F_N_PLUS_L:var t=this.roleUpSpineAni.findBone(e);return null==t?void 0:t;default:return}},d.prototype.playAnimation=function(e,t,a,n,o){void 0===o&&(o=1),e==r.SpineAniNameEnum.Hero_st&&this.roleUpSpineAni.animation==r.SpineAniNameEnum.Hero_st||e==r.SpineAniNameEnum.Hero_st_nwp_a&&this.roleUpSpineAni.animation==r.SpineAniNameEnum.Hero_st_nwp_a||(this.roleUpSpineAni.paused=!1,this.roleUpSpineAni.loop=a,this.roleUpSpineAni.timeScale=o,this.roleUpSpineAni.animation=e,this.roleUpSpineAni.setCompleteListener(n),e!=r.SpineAniNameEnum.D&&e!=r.SpineAniNameEnum.D2||(this.roleUpSpineAni.node.angle=0),null!=this.roleDownSpineAni&&(this.roleDownSpineAni.node.active=!t))},d.prototype.setAniScale=function(e){this.roleUpSpineAni.timeScale=e},d.prototype.pauseAnimation=function(e){this.roleUpSpineAni.paused=e},__decorate([o({displayName:"\u4e0a\u534a\u8eab\u9aa8\u9abc\u52a8\u753b",type:sp.Skeleton})],d.prototype,"roleUpSpineAni",void 0),__decorate([o({displayName:"\u4e0b\u534a\u8eab\u9aa8\u9abc\u52a8\u753b",type:sp.Skeleton})],d.prototype,"roleDownSpineAni",void 0),__decorate([o({displayName:"\u7784\u51c6\u7ebf",type:cc.Node})],d.prototype,"aimingLine",void 0),__decorate([o({displayName:"\u62ab\u98ce",type:cc.Node})],d.prototype,"cloakNode",void 0),n=__decorate([n],d),i.SpineController=n,cc._RF.pop()},{}],SpottingArrow:[function(e,t,a){"use strict";cc._RF.push(t,"abb72SbR3pHnalyPbbNs56N","SpottingArrow");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("EllipseAction"),s=o("Util"),c=o("EnumAndConst"),p=o("Body"),d=o("SkillSystem"),u=o("LocalSoundManager"),h=o("SingleEffectManager"),m=o("Head"),f=o("EnemyShield"),g=o("BattleNumManager"),y=o("Shield"),v=o("RoleManager"),D=o("LocalData"),E=o("ConfigData"),S=o("GameState"),A=o("EffectCreate"),C=o("PlayerState");function M(){var e=null!==l&&l.apply(this,arguments)||this;return e.attackCD=10,e.ellipseAction=null,e.playerData=null,e.attackRemainCD=0,e.isShooting=!1,e.speed=1200,e.hurtDatas=[],e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(M,l),M.prototype.onEnable=function(){var e=this;this.playerData=C.PlayerState.playerData,this.hurtDatas=[],this.isShooting=!0;var t=cc.v2(-450,-30),a=s.Util.getDistance(this.node.position,t)/this.speed;this.node.angle=-s.Util.getVectorsAngle(t.sub(this.node.position).normalize(),cc.Vec2.RIGHT),this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(a,t),cc.callFunc(function(){e.isShooting=!1,e.attackRemainCD=5,e.ellipseAction=new r.EllipseAction(e.node,cc.v2(-450,0),150,30,360,270)})))},M.prototype.update=function(e){this.isShooting||null==this.playerData||null==this.ellipseAction||(this.ellipseAction&&this.ellipseAction.runAction(e),S.GameState.isGaming&&!this.playerData.isDead&&(this.attackRemainCD-=e,this.attackRemainCD<=0&&this.attack()))},M.prototype.attack=function(){var e=this;this.isShooting=!0;var t=null,a=Math.random(),n=(t=a<.7?cc.v2(700,s.Util.getRandomFloatNum(E.ConfigData.longEnemyMinPosY,E.ConfigData.longEnemyMaxPosY)):E.ConfigData.rightGroundBornPos).add(cc.v2(0,s.Util.getRandomFloatNum(-20,20))),o=cc.v2(-450,30),i=s.Util.getDistance(this.node.position,t)/this.speed,l=s.Util.getDistance(t,n)/this.speed;a=s.Util.getDistance(n,o)/this.speed,this.node.runAction(cc.sequence(cc.callFunc(function(){e.node.angle=-s.Util.getVectorsAngle(t.sub(e.node.position).normalize(),cc.Vec2.RIGHT)}),cc.moveTo(i,t),cc.callFunc(function(){e.hurtDatas=[],e.node.angle=-s.Util.getVectorsAngle(n.sub(e.node.position).normalize(),cc.Vec2.RIGHT)}),cc.moveTo(l,n),cc.callFunc(function(){e.node.angle=-s.Util.getVectorsAngle(o.sub(e.node.position).normalize(),cc.Vec2.RIGHT)}),cc.moveTo(a,o),cc.callFunc(function(){e.hurtDatas=[],e.isShooting=!1,e.attackRemainCD=e.attackCD,e.ellipseAction.setCurrentAnlge(90)})))},M.prototype.onCollisionEnter=function(e,t){var a;S.GameState.isGaming&&((a=e.node.group)!=c.GroupNameEnum.BODY?a!=c.GroupNameEnum.HEAD?a!=c.GroupNameEnum.SHIELD||this.collideShield(e,t):this.collideHead(e,t):this.collideBody(e,t))},M.prototype.collideBody=function(e){var t=this,a=e.getComponent(p.Body);if(null!=a){var n=a.roleData;if(null!=n&&!n.isTeleporting&&n.isEnemy&&!n.hasEnemyShield&&(n.profession!=c.ProfessionEnum.NECROMANCER&&n.profession!=c.ProfessionEnum.SHIELD_WIZARD||!(n.hp<=0))&&-1==this.hurtDatas.indexOf(n)){if(e=0,n.enemyEquipSkills.isHaveSkill(c.SkillTypeEnum.DODGE)&&(e=d.SkillSystem.getEquipedSkillInitData(c.SkillTypeEnum.DODGE),n.isBoss&&S.GameState.heroModel&&(e*=2)),Math.random()<e){var o=cc.v2(0,0);return o=n.isBoss&&7==S.GameState.currentChapter?n.headPosition:n.logicPos,A.EffectCreate.createRoleTip(o,0),void this.hurtDatas.push(n)}var i;e=!1,o=d.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.CRIT),Math.random()<o&&(e=!0),a.isSkinArmor&&(e=!1),a.isSkinArmor?u.LocalSoundManager.playShieldResistAudio():e?u.LocalSoundManager.playAudio("headAttack"):u.LocalSoundManager.playArrowHitAudio(),o=this.getFinalDamage(this.playerData.atk,2,n,e),a.isSkinArmor&&(o*=.1),v.RoleManager.roleIsDamaged(n,this.playerData,o,n.logicPos,!0,!1,e),a.isSkinArmor?(A.EffectCreate.createSpark(this.node.position,this.node.scaleX,!1),i=cc.v2(-450,30),a=s.Util.getDistance(this.node.position,i)/this.speed,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.moveTo(a,i),cc.callFunc(function(){t.hurtDatas=[],t.isShooting=!1,t.attackRemainCD=t.attackCD,t.ellipseAction.setCurrentAnlge(90)})))):(i=cc.v2(0,0),i=n.isBoss&&7==S.GameState.currentChapter?this.node.position:n.logicPos,h.SingleEffectManager.showBloodEffect(i,this.node.scaleX,n)),this.hurtDatas.push(n)}}},M.prototype.collideHead=function(e,t){var a=e.getComponent(m.Head);if(null!=a){var n=a.roleData;if(null!=n&&!n.isTeleporting&&n.isEnemy&&!(n.profession!=c.ProfessionEnum.FLY_HEAD_GHOST&&n.hasEnemyShield||(n.profession==c.ProfessionEnum.NECROMANCER||n.profession==c.ProfessionEnum.SHIELD_WIZARD)&&n.hp<=0||-1!=this.hurtDatas.indexOf(n))){var o=0;if(n.enemyEquipSkills.isHaveSkill(c.SkillTypeEnum.DODGE)&&(o=d.SkillSystem.getEquipedSkillInitData(c.SkillTypeEnum.DODGE),n.isBoss&&S.GameState.heroModel&&(o*=2)),Math.random()<o){cc.v2(0,0);var i=n.isBoss&&7==S.GameState.currentChapter?n.headPosition:n.logicPos;return A.EffectCreate.createRoleTip(i,0),void this.hurtDatas.push(n)}i=n.helmetDefense,null!=a.helmet&&0<i?this.collideHelmet(e,t,a,n):(t=a.isEye,a=this.playerData.atk,a=this.getFinalDamage(a,0,n,!1,t),u.LocalSoundManager.playAudio("headAttack"),v.RoleManager.roleIsDamaged(n,this.playerData,a,n.headPosition,!0,!0,!1,!1,!1,t),this.hurtDatas.push(n),t=cc.v2(0,0),t=n.isBoss&&7==S.GameState.currentChapter?this.node.position:n.headPosition,h.SingleEffectManager.showBloodEffect(t,this.node.scaleX,n))}}},M.prototype.collideHelmet=function(e,t,a,n){var o=this.playerData.atk;o=this.getFinalDamage(o,1,n),v.RoleManager.equipmentIsDamaged(n,D.EquipmentType.helmet,this.playerData,o,e.node.position),u.LocalSoundManager.playHelmetResistAudio(),o=e.node.x<=this.node.position.x?-1:1,A.EffectCreate.createSpark(e.node.position,o,!1),null!=a.helmet&&a.helmet.node.active&&n.helmetDefense<=0&&(a.helmet.drop(100,200),a.helmet=null)},M.prototype.collideShield=function(e,t){var a=this,n=e.getComponent(f.EnemyShield);if(null!=n){var o=n.roleData;if(null==o||o.isTeleporting)return;if(o.isBoss){A.EffectCreate.createSpark(this.node.position,this.node.scaleX,!1);var i=cc.v2(-450,30),l=s.Util.getDistance(this.node.position,i)/this.speed;return this.node.stopAllActions(),void this.node.runAction(cc.sequence(cc.moveTo(l,i),cc.callFunc(function(){a.hurtDatas=[],a.isShooting=!1,a.attackRemainCD=a.attackCD,a.ellipseAction.setCurrentAnlge(90)})))}return-1!=this.hurtDatas.indexOf(o)?void 0:null==(l=t.world)||null==(i=l.points)||i.length<=0||null==(l=this.node.parent)?void 0:(l=l.convertToNodeSpaceAR(i[3]),i=this.playerData.atk,i=this.getFinalDamage(i,3,o),this.hurtDatas.push(o),n.breaking(),n=i>=E.ConfigData.MAX_DAMAGE?c.BattleNumTypeEnum.BROKE_EQUIPMENT:c.BattleNumTypeEnum.HP_REDUCE,g.BattleNumManager.createBattleNumEffect(n,i,o,l),void u.LocalSoundManager.playShieldResistAudio())}if(null!=(i=e.getComponent(y.Shield))&&!(null==(o=i.roleData)||o.shieldDefense<0||o.isTeleporting||!o.isEnemy||o.hasEnemyShield)&&-1==this.hurtDatas.indexOf(o)&&S.GameState.isGaming){if(l=0,o.enemyEquipSkills.isHaveSkill(c.SkillTypeEnum.DODGE)&&(l=d.SkillSystem.getEquipedSkillInitData(c.SkillTypeEnum.DODGE),o.isBoss&&S.GameState.heroModel&&(l*=2)),Math.random()<l){cc.v2(0,0);var r=o.isBoss&&7==S.GameState.currentChapter?o.headPosition:o.logicPos;return A.EffectCreate.createRoleTip(r,0),void this.hurtDatas.push(o)}r=this.playerData.atk,r=this.getFinalDamage(r,3,o),this.hurtDatas.push(o),v.RoleManager.equipmentIsDamaged(o,D.EquipmentType.shield,this.playerData,r,e.node.position),u.LocalSoundManager.playShieldResistAudio(),r=e.node.x<=this.node.position.x?-1:1,A.EffectCreate.createSpark(e.node.position,r,!1),o.shieldDefense<=0&&i.drop(100,200)}},M.prototype.getFinalDamage=function(e,t,a,n,o){void 0===n&&(n=!1),void 0===o&&(o=!1);var i=e;if(!(0!=t&&2!=t||a.isDead||a.isBoss)){var l=d.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.SPOTTING_ARROW);if(Math.random()<l)return E.ConfigData.MAX_DAMAGE}var r=d.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.FURY);return e=0,null!=r&&0<r&&(l=(this.playerData.maxHp-this.playerData.hp)/this.playerData.maxHp,e=Math.floor(l/.1)*r),i*=1+d.SkillSystem.getEquipedSkillData(c.SkillTypeEnum.DAMAGE_UP)+e,0==t?(i*=2,o||(i*=1-a.headHurtReduction,i=Math.max(2,i))):2==t&&(i*=1-a.bodyHurtReduction,i=Math.max(1,i),n&&(i*=2)),Math.floor(i)},o=__decorate([o],M),i.SpottingArrow=o,cc._RF.pop()},{}],SpriteFrameManager:[function(e,t,a){"use strict";cc._RF.push(t,"465e8t9MhlC9pAEB5M2F4PB","SpriteFrameManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(r=cc._decorator).ccclass;var i,l,r=r.property;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.fullMapSpriteFrames=[],e.bossSpriteFrames=[],e.launchWeaponSpriteFrames=[],e.launchWeaponPlusSpriteFrames=[],e.shildSpriteFrames=[],e.shildPlusSpriteFrames=[],e.helmetSpriteFrames=[],e.helmetPlusSpriteFrames=[],e.bossWeaponSpriteFrames=[],e.equipmentLevelSpriteFrame=[],e.equipmentLevelNameSpriteFrame=[],e.skillSpriteFrame=[],e.cloakSpriteFrames=[],e}i=cc.Component,__extends(s,i),(l=s).prototype.onLoad=function(){l.instance=this},s.getFullMap=function(e){var t=l.instance;if(null!=t&&null!=e){var a=e-1;if(e=t.fullMapSpriteFrames.length,!(a<0||e<=a))return t.fullMapSpriteFrames[a]}},s.getBossSpriteFrame=function(e){var t=l.instance;if(null!=t&&null!=e){var a=e-1;if(e=t.bossSpriteFrames.length,!(a<0||e<=a))return t.bossSpriteFrames[a]}},s.getLaunchWeaponSpriteFrame=function(e,t){var a=l.instance;if(null==a||null==e)return null;var n=a.launchWeaponSpriteFrames.length;return e<0||n<=e?null:(4<=t?a.launchWeaponPlusSpriteFrames:a.launchWeaponSpriteFrames)[e]},s.getBossWeaponSpriteFrame=function(e){var t=l.instance;if(null==t||null==e)return null;var a=t.bossWeaponSpriteFrames.length;return e<0||a<=e?null:t.bossWeaponSpriteFrames[e]},s.getShieldSpriteFrame=function(e,t){var a=l.instance;if(null==a||null==e)return null;var n=a.shildSpriteFrames.length;return e<0||n<=e?null:(4<=t?a.shildPlusSpriteFrames:a.shildSpriteFrames)[e]},s.getHelmetSpriteFrame=function(e,t){var a=l.instance;if(null==a||null==e)return null;var n=a.helmetSpriteFrames.length;return e<0||n<=e?null:(4<=t?a.helmetPlusSpriteFrames:a.helmetSpriteFrames)[e]},s.getCloakSpriteFrame=function(e){var t=l.instance;if(null==t||null==e)return null;var a=t.cloakSpriteFrames.length;return e<0||a<=e?null:t.cloakSpriteFrames[e]},s.getSkillSpriteFrame=function(e){var t=l.instance;if(null!=t&&null!=e){var a=t.skillSpriteFrame.length;if(!(e<0||a<=e))return t.skillSpriteFrame[e]}},s.getEquipmentRankSpriteFrame=function(e){var t=l.instance;if(null!=t&&null!=e){var a=t.equipmentLevelSpriteFrame.length;if(!(e<0||a<=e))return t.equipmentLevelSpriteFrame[e]}},s.getEquipmentLevelNameSpriteFrame=function(e){var t=l.instance;if(null!=t&&null!=e){var a=t.equipmentLevelNameSpriteFrame.length;if(!(e<0||a<=e))return t.equipmentLevelNameSpriteFrame[e]}},s.instance=null,__decorate([r({displayName:"\u5b8c\u6574\u5730\u56fe\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"fullMapSpriteFrames",void 0),__decorate([r({type:cc.SpriteFrame,displayName:"boss\u56fe\u7247\u771f\u5b9e"})],s.prototype,"bossSpriteFrames",void 0),__decorate([r({displayName:"\u6295\u63b7\u7c7b\u6b66\u5668\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"launchWeaponSpriteFrames",void 0),__decorate([r({displayName:"\u6295\u63b7\u7c7b\u6b66\u5668\u5347\u7ea7\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"launchWeaponPlusSpriteFrames",void 0),__decorate([r({displayName:"\u76fe\u724c\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"shildSpriteFrames",void 0),__decorate([r({displayName:"\u76fe\u724c\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"shildPlusSpriteFrames",void 0),__decorate([r({displayName:"\u5934\u76d4\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"helmetSpriteFrames",void 0),__decorate([r({displayName:"\u5934\u76d4\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"helmetPlusSpriteFrames",void 0),__decorate([r({displayName:"Boss\u6b66\u5668\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"bossWeaponSpriteFrames",void 0),__decorate([r({type:cc.SpriteFrame,displayName:"\u88c5\u5907\u7b49\u7ea7\u56fe\u7247\u56fe\u96c6"})],s.prototype,"equipmentLevelSpriteFrame",void 0),__decorate([r({type:cc.SpriteFrame,displayName:"\u88c5\u5907\u7b49\u7ea7\u540d\u79f0\u56fe\u7247\u56fe\u96c6"})],s.prototype,"equipmentLevelNameSpriteFrame",void 0),__decorate([r({displayName:"\u6280\u80fd\u56fe\u6807\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"skillSpriteFrame",void 0),__decorate([r({displayName:"\u62ab\u98ce\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],s.prototype,"cloakSpriteFrames",void 0),n=l=__decorate([n],s),o.SpriteFrameManager=n,cc._RF.pop()},{}],StarUI:[function(e,t,a){"use strict";cc._RF.push(t,"695a5kXof9A7pWq3PoPx+3G","StarUI");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.delayTime=0,e}i=cc.Component,__extends(r,i),r.prototype.onEnable=function(){var e=this;this.node.scale=.01,this.node.stopAllActions(),this.node.runAction(cc.sequence(cc.delayTime(this.delayTime),cc.callFunc(function(){e.runAction()})))},r.prototype.runAction=function(){this.node.stopAllActions(),this.node.scale=.01,this.node.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.4,.8),cc.scaleTo(.4,.01))))},__decorate([l({displayName:"\u5ef6\u8fdf\u51fa\u73b0\u7684\u65f6\u95f4"})],r.prototype,"delayTime",void 0),n=__decorate([n],r),o.StarUI=n,cc._RF.pop()},{}],StatisticsManager:[function(e,t,a){"use strict";cc._RF.push(t,"da1031ELd5Ayo3FUuCO6Thm","StatisticsManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("GameCommonHttp"),l=n("GameCommon"),r=n("UserData"),s=n("ShareManager"),c=n("GameState");function p(){}p.uploadSharePictureRecord=function(e,t,a){var n=s.ShareManager.newStatisticUrl+"/picture/share",o={};o.appId=l.GameConfig.wxAppId,o.pictureName=t.shareImgName,o.pictureType=e,o.content=t.shareText,o.pictureUrl=t.shareImgUrl,o.uuid=r.UserData.data.playerId,o.phoneModel=a,o.version=l.GameConfig.versionCode,i.GameCommonHttp.wxHttpPost(n,o,null)},p.uploadClickPictureRecord=function(e,t,a,n,o,c){var p=s.ShareManager.newStatisticUrl+"/picture/click",d={};d.appId=l.GameConfig.wxAppId,d.pictureName=t,d.pictureType=e,d.content=a,d.pictureUrl=n,d.uuid=r.UserData.data.playerId,d.phoneModel=c,d.version=l.GameConfig.versionCode,d.shareTimeMillis=o,i.GameCommonHttp.wxHttpPost(p,d,null)},p.uploadJumpRecord=function(e,t,a,n,o,i,l){void 0===o&&(o=null),void 0===i&&(i=null),void 0===l&&(l=null),"jumpSuccess"==a&&r.UserData.addDetailExportsData(n,e,o,i),"playerClick"==a&&r.UserData.addDetailClicksData(n,e,o,i)},p.sendPartEvent=function(e,t){var a={mode:0};c.GameState.heroModel?a.mode=1:c.GameState.endlessModel&&(a.mode=2),a.chapter=c.GameState.currentChapter,a.part=c.GameState.currentPart,null!=t&&(a.reviveType=t),this.thirdSendEvent(e,a)},p.thirdSendEvent=function(e,t){void 0===t&&(t=null),null!=e&&cc.sys.platform===cc.sys.WECHAT_GAME&&wx.$$Rangers.event(e,t)},n=p,o.StatisticsManager=n,(o=o.StatisticsCode||(o.StatisticsCode={})).PART_ENTER="PART_ENTER",o.PART_PASS="PART_PASS",o.PART_DEATH="PART_DEATH",o.PART_REVIVE="PART_REVIVE",o.PART_FAIL="PART_FAIL",o.PART_QUIT="PART_QUIT",cc._RF.pop()},{}],StoreUI:[function(e,t,a){"use strict";cc._RF.push(t,"3e06be83e1MFr71Pz4Dx0sx","StoreUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("LocalData"),c=n("TipManager"),p=n("LocalSoundManager"),d=n("ShareVideoControl"),u=n("BoxReward"),h=n("ConfigData"),m=n("ShareManager"),f=n("GameConfigData");function g(){var e=null!==l&&l.apply(this,arguments)||this;return e.normalBoxTimesLabel=null,e.legendBoxTimes=null,e.gemTimesLabel=null,e.normalBox=null,e.legendBox=null,e.weaponBox=null,e.legendBoxParent=null,e.normalBoxParent=null,e.weaponBoxParent=null,e.coinGet=null,e.gemGet=null,e.normalBtn=[],e.legendBtn=[],e.weaponBtn=null,e.gemCost=[],e.costGet=[],e.normalBoxDetail=null,e.legendBoxDetail=null,e.weaponBoxDetail=null,e.leftBtn=null,e.rightBtn=null,e.btnSprite=[],e.allContent=null,e.storeScrollView=null,e.oneSecond=0,e.nowTime=null,e.normalBoxPos=null,e.legendBoxPos=null,e.weaponBoxPos=null,e.gemGetPos=null,e.coinGetPos=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(g,l),g.prototype.onLoad=function(){0<s.LocalData.data.normalBoxTimes?(this.normalBtn[0].active=!0,this.normalBtn[1].active=!1):(this.normalBtn[0].active=!1,this.normalBtn[1].active=!0),this.gemCost[0].value=f.GameConfigData.data.coin1Cost+"",this.gemCost[1].value=f.GameConfigData.data.coin2Cost+"",this.gemCost[2].value=f.GameConfigData.data.normalBoxCost+"",this.gemCost[3].value=f.GameConfigData.data.legendBoxCost+"",this.costGet[0].value=f.GameConfigData.data.coin1Get+"",this.costGet[1].value=f.GameConfigData.data.coin2Get+"",this.costGet[2].value=f.GameConfigData.data.gemNumGet+"",this.normalBoxDetail.string=h.ConfigData.normalBoxDetail,this.legendBoxDetail.string=h.ConfigData.legendBoxDetail,this.weaponBoxDetail.string=h.ConfigData.weaponBoxDetail,this.normalBoxPos=this.normalBoxParent.position,this.legendBoxPos=this.legendBoxParent.position,this.weaponBoxPos=this.weaponBoxParent.position,this.gemGetPos=this.gemGet.position,this.coinGetPos=this.coinGet.position},g.prototype.onEnable=function(){this.ainmation(),this.normalBoxTimesLabel.string="\u5269\u4f59\u514d\u8d39\u6b21\u6570\uff1a"+s.LocalData.data.normalBoxTimes,this.gemTimesLabel.string="\u5269\u4f59\u514d\u8d39\u6b21\u6570\uff1a"+s.LocalData.data.getGemTimes;var e=Date.now()/1e3;null==s.LocalData.data.lastOpenLegendBoxTime||e-s.LocalData.data.lastOpenLegendBoxTime>=f.GameConfigData.data.legendBoxTime?(this.legendBtn[0].active=!0,this.legendBtn[1].active=!1):(this.legendBtn[0].active=!1,this.legendBtn[1].active=!0),this.weaponBtn.active=0<s.LocalData.data.weaponBoxTime},g.prototype.update=function(e){if(this.allContent.x<=1-this.storeScrollView.getMaxScrollOffset().x?this.rightBtn.spriteFrame=this.btnSprite[0]:this.rightBtn.spriteFrame=this.btnSprite[1],-1<=this.allContent.x?this.leftBtn.spriteFrame=this.btnSprite[0]:this.leftBtn.spriteFrame=this.btnSprite[1],null==s.LocalData.data.lastOpenLegendBoxTime||Date.now()/1e3-s.LocalData.data.lastOpenLegendBoxTime>=f.GameConfigData.data.legendBoxTime)return this.numberToTime(0),this.legendBtn[0].active=!0,void(this.legendBtn[1].active=!1);null==s.LocalData.data.lastOpenLegendBoxTime&&(s.LocalData.data.lastOpenLegendBoxTime=Math.floor(Date.now()/1e3)),this.oneSecond-=e,1!=Math.ceil(this.oneSecond)&&(this.oneSecond=1,this.nowTime=Date.now()/1e3,e=Math.ceil(this.nowTime),e=Math.floor(e-s.LocalData.data.lastOpenLegendBoxTime),this.numberToTime(f.GameConfigData.data.legendBoxTime-e))},g.prototype.numberToTime=function(e){var t,a;e<=0?this.legendBoxTimes.string="\u7acb\u5373\u5f00\u542f\uff01":(t=Math.floor(e/3600),a=Math.floor(e/60)-60*t,e=Math.floor(e%60),t=t.toString().length<2?"0"+t:t,a=a.toString().length<2?"0"+a:a,e=e.toString().length<2?"0"+e:e,this.legendBoxTimes.string="\u8ddd\u79bb\u514d\u8d39\u5f00\u542f\u8fd8\u6709:"+t+":"+a+":"+e)},g.prototype.clickNormalSprite=function(){s.LocalData.data.normalBoxTimes<=0?this.clickBuyNormalBox():this.clickVideoGetNormalBox()},g.prototype.clickLegendSprite=function(){null==s.LocalData.data.lastOpenLegendBoxTime||Date.now()/1e3-s.LocalData.data.lastOpenLegendBoxTime>=f.GameConfigData.data.legendBoxTime?this.clickVideoGetLegendBox():this.clickBuyLegendBox()},g.prototype.clickVideoGetNormalBox=function(){var e,t,a=this;p.LocalSoundManager.playAudio("click"),s.LocalData.data.normalBoxTimes<1?c.TipManager.showTip("\u6b21\u6570\u4e0d\u8db3\uff01"):(u.BoxReward.isOpenBox=!1,e=function(){u.BoxReward.isOpenBox||(u.BoxReward.isOpenBox=!0,u.BoxReward.normalBoxReward(null,!1),s.LocalData.data.normalBoxTimes--,a.normalBoxTimesLabel.string="\u5269\u4f59\u514d\u8d39\u6b21\u6570\uff1a"+s.LocalData.data.normalBoxTimes,s.LocalData.data.normalBoxTimes<=0?(a.normalBtn[0].active=!1,a.normalBtn[1].active=!0):(a.normalBtn[0].active=!0,a.normalBtn[1].active=!1))},m.ShareManager.getShareControlType()!=m.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(t=m.ShareManager.configData&&m.ShareManager.configData.storeLimitAdTimes?m.ShareManager.configData.StoreLimitAdTimes:3,!m.ShareManager.shareFlags||!m.ShareManager.shareFlags.storeGetAdControl||s.LocalData.data.showAdTimes<t?d.ShareVideoControl.videoFunc("\u83b7\u5f97\u767d\u94f6\u5b9d\u7bb1",e,null,e,null,null,d.VideoAdIdEnum.NORMAL_BOX_ID):window.gameCommon.getSDK.share("\u83b7\u5f97\u767d\u94f6\u5b9d\u7bb1",null,null,function(t,a){a&&e()},!0)):e())},g.prototype.clickBuyNormalBox=function(){p.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=f.GameConfigData.data.normalBoxCost?(s.LocalData.changeGem(-f.GameConfigData.data.normalBoxCost),u.BoxReward.normalBoxReward(null,!1)):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},g.prototype.clickVideoGetLegendBox=function(){var e,t=this;function a(){u.BoxReward.isOpenBox||(u.BoxReward.isOpenBox=!0,u.BoxReward.legendBoxReward(null,!1),t.numberToTime(f.GameConfigData.data.legendBoxTime),s.LocalData.data.lastOpenLegendBoxTime=Date.now()/1e3,t.legendBtn[0].active=!1,t.legendBtn[1].active=!0)}p.LocalSoundManager.playAudio("click"),u.BoxReward.isOpenBox=!1,m.ShareManager.getShareControlType()!=m.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(e=m.ShareManager.configData&&m.ShareManager.configData.storeLimitAdTimes?m.ShareManager.configData.StoreLimitAdTimes:3,!m.ShareManager.shareFlags||!m.ShareManager.shareFlags.storeGetAdControl||s.LocalData.data.showAdTimes<e?d.ShareVideoControl.videoFunc("\u83b7\u5f97\u4f20\u5947\u5b9d\u7bb1",a,null,a,null,null,d.VideoAdIdEnum.LEGEND_BOX_ID):window.gameCommon.getSDK.share("\u83b7\u5f97\u4f20\u5947\u5b9d\u7bb1",null,null,function(e,t){t&&a()},!0)):a()},g.prototype.clickBuyLegendBox=function(){p.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=f.GameConfigData.data.legendBoxCost?(s.LocalData.changeGem(-f.GameConfigData.data.legendBoxCost),u.BoxReward.legendBoxReward(null,!1)):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},g.prototype.clickVideoGetGem=function(){var e,t,a=this;p.LocalSoundManager.playAudio("click"),s.LocalData.data.getGemTimes<1?c.TipManager.showTip("\u6b21\u6570\u4e0d\u8db3\uff01"):(e=function(){s.LocalData.changeGem(f.GameConfigData.data.gemNumGet),s.LocalData.data.getGemTimes--,c.TipManager.showTip("\u83b7\u5f97"+f.GameConfigData.data.gemNumGet+"\u94bb\u77f3"),a.gemTimesLabel.string="\u5269\u4f59\u514d\u8d39\u6b21\u6570\uff1a"+s.LocalData.data.getGemTimes},m.ShareManager.getShareControlType()!=m.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(t=m.ShareManager.configData&&m.ShareManager.configData.storeLimitAdTimes?m.ShareManager.configData.StoreLimitAdTimes:3,!m.ShareManager.shareFlags||!m.ShareManager.shareFlags.storeGetAdControl||s.LocalData.data.showAdTimes<t?d.ShareVideoControl.videoFunc("\u83b7\u5f97\u94bb\u77f3",e,null,e,null,null,d.VideoAdIdEnum.GET_GEM_ID):window.gameCommon.getSDK.share("\u83b7\u5f97\u94bb\u77f3",null,null,function(t,a){a&&e()},!0)):e())},g.prototype.clickBuyCoin1=function(){p.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=f.GameConfigData.data.coin1Cost?(s.LocalData.changeGem(-f.GameConfigData.data.coin1Cost),s.LocalData.changeCoin(f.GameConfigData.data.coin1Get),c.TipManager.showTip("\u83b7\u5f97"+f.GameConfigData.data.coin1Get+"\u91d1\u5e01")):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},g.prototype.clickBuyCoin2=function(){p.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=f.GameConfigData.data.coin2Cost?(s.LocalData.changeGem(-f.GameConfigData.data.coin2Cost),s.LocalData.changeCoin(f.GameConfigData.data.coin2Get),c.TipManager.showTip("\u83b7\u5f97"+f.GameConfigData.data.coin2Get+"\u91d1\u5e01")):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},g.prototype.clickVideoGetNewBox=function(){var e,t,a=this;p.LocalSoundManager.playAudio("click"),s.LocalData.data.weaponBoxTime<1?c.TipManager.showTip("\u8bf7\u660e\u5929\u518d\u6765!"):(u.BoxReward.isOpenBox=!1,e=function(){u.BoxReward.isOpenBox||(u.BoxReward.isOpenBox=!0,s.LocalData.data.weaponBoxTime--,u.BoxReward.weaponBoxReward(null,!1),a.weaponBtn.active=!1)},m.ShareManager.getShareControlType()!=m.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(t=m.ShareManager.configData&&m.ShareManager.configData.storeLimitAdTimes?m.ShareManager.configData.StoreLimitAdTimes:3,!m.ShareManager.shareFlags||!m.ShareManager.shareFlags.storeGetAdControl||s.LocalData.data.showAdTimes<t?d.ShareVideoControl.videoFunc("\u83b7\u5f97\u6b66\u5668\u5b9d\u7bb1",e,null,e,null,null,d.VideoAdIdEnum.WEAPON_BOX_ID):window.gameCommon.getSDK.share("\u83b7\u5f97\u6b66\u5668\u5b9d\u7bb1",null,null,function(t,a){a&&e()},!0)):e())},g.prototype.clickLeftBtn=function(){this.storeScrollView.scrollToLeft(.5),this.leftBtn.spriteFrame=this.btnSprite[0]},g.prototype.clickRightBtn=function(){this.storeScrollView.scrollToRight(.5),this.rightBtn.spriteFrame=this.btnSprite[0]},g.prototype.ainmation=function(){this.normalBoxParent.position=cc.v2(this.normalBoxPos.x,500),this.normalBoxParent.stopAllActions(),this.normalBoxParent.runAction(cc.sequence(cc.moveTo(.4,this.normalBoxPos.x,-371),cc.moveTo(.1,this.normalBoxPos.x,-331),cc.moveTo(.1,this.normalBoxPos.x,-351))),this.legendBoxParent.position=cc.v2(this.legendBoxPos.x,-1e3),this.legendBoxParent.stopAllActions(),this.legendBoxParent.runAction(cc.sequence(cc.moveTo(.4,this.legendBoxPos.x,-331),cc.moveTo(.1,this.legendBoxPos.x,-371),cc.moveTo(.1,this.legendBoxPos.x,-351))),this.weaponBoxParent.position=cc.v2(this.weaponBoxPos.x,-1e3),this.weaponBoxParent.stopAllActions(),this.weaponBoxParent.runAction(cc.sequence(cc.moveTo(.4,this.weaponBoxPos.x,-331),cc.moveTo(.1,this.weaponBoxPos.x,-371),cc.moveTo(.1,this.weaponBoxPos.x,-351))),this.coinGet.position=cc.v2(this.coinGetPos.x,-1e3),this.coinGet.stopAllActions(),this.coinGet.runAction(cc.sequence(cc.moveTo(.4,this.coinGetPos.x,-440),cc.moveTo(.1,this.coinGetPos.x,-480),cc.moveTo(.1,this.coinGetPos.x,-460))),this.gemGet.position=cc.v2(2e3,this.gemGetPos.y),this.gemGet.stopAllActions(),this.gemGet.runAction(cc.sequence(cc.moveTo(.4,this.gemGetPos.x-20,this.gemGetPos.y),cc.moveTo(.1,this.gemGetPos.x+20,this.gemGetPos.y),cc.moveTo(.1,this.gemGetPos.x,this.gemGetPos.y))),this.normalBox.angle=0,this.normalBox.stopAllActions(),this.normalBox.runAction(cc.repeatForever(cc.sequence(cc.delayTime(1.9),cc.rotateTo(.15,10),cc.rotateTo(.15,-10),cc.rotateTo(.15,5),cc.rotateTo(.15,-5),cc.rotateTo(.1,0)))),this.legendBox.angle=0,this.legendBox.stopAllActions(),this.legendBox.runAction(cc.repeatForever(cc.sequence(cc.delayTime(.6),cc.rotateTo(.15,10),cc.rotateTo(.15,-10),cc.rotateTo(.15,5),cc.rotateTo(.15,-5),cc.rotateTo(.1,0),cc.delayTime(1.3)))),this.weaponBox.position=cc.v2(0,0),this.weaponBox.stopAllActions(),this.weaponBox.runAction(cc.repeatForever(cc.sequence(cc.moveTo(.8,0,-10),cc.moveTo(.8,0,0))))},__decorate([o({type:cc.Label,displayName:"\u666e\u901a\u5b9d\u7bb1\u6b21\u6570"})],g.prototype,"normalBoxTimesLabel",void 0),__decorate([o({type:cc.Label,displayName:"\u4f20\u5947\u5b9d\u7bb1\u5012\u8ba1\u65f6"})],g.prototype,"legendBoxTimes",void 0),__decorate([o({type:cc.Label,displayName:"\u83b7\u5f97\u5b9d\u77f3\u6b21\u6570"})],g.prototype,"gemTimesLabel",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1"})],g.prototype,"normalBox",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1"})],g.prototype,"legendBox",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1"})],g.prototype,"weaponBox",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u7236\u7269\u4f53"})],g.prototype,"legendBoxParent",void 0),__decorate([o({type:cc.Node,displayName:"\u666e\u901a\u5b9d\u7bb1\u7236\u7269\u4f53"})],g.prototype,"normalBoxParent",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1\u7236\u7269\u4f53"})],g.prototype,"weaponBoxParent",void 0),__decorate([o({type:cc.Node,displayName:"\u91d1\u5e01"})],g.prototype,"coinGet",void 0),__decorate([o({type:cc.Node,displayName:"\u5b9d\u77f3"})],g.prototype,"gemGet",void 0),__decorate([o({type:cc.Node,displayName:"\u767d\u94f6\u5b9d\u7bb1\u6309\u94ae"})],g.prototype,"normalBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u4f20\u5947\u5b9d\u7bb1\u6309\u94ae"})],g.prototype,"legendBtn",void 0),__decorate([o({type:cc.Node,displayName:"\u6b66\u5668\u5b9d\u7bb1\u6309\u94ae"})],g.prototype,"weaponBtn",void 0),__decorate([o({type:r.NumberImg,displayName:"\u82b1\u8d39"})],g.prototype,"gemCost",void 0),__decorate([o({type:r.NumberImg,displayName:"\u83b7\u5f97"})],g.prototype,"costGet",void 0),__decorate([o({displayName:"\u767d\u94f6\u5b9d\u7bb1\u63cf\u8ff0",type:cc.Label})],g.prototype,"normalBoxDetail",void 0),__decorate([o({displayName:"\u4f20\u5947\u5b9d\u7bb1\u63cf\u8ff0",type:cc.Label})],g.prototype,"legendBoxDetail",void 0),__decorate([o({displayName:"\u6b66\u5668\u5b9d\u7bb1\u63cf\u8ff0",type:cc.Label})],g.prototype,"weaponBoxDetail",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5de6\u6309\u94ae"})],g.prototype,"leftBtn",void 0),__decorate([o({type:cc.Sprite,displayName:"\u53f3\u6309\u94ae"})],g.prototype,"rightBtn",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u6309\u94ae\u56fe\u7247"})],g.prototype,"btnSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u6ed1\u52a8\u7269\u4f53"})],g.prototype,"allContent",void 0),__decorate([o({type:cc.ScrollView,displayName:"\u6ed1\u52a8\u89c6\u56fe"})],g.prototype,"storeScrollView",void 0),n=__decorate([n],g),i.StoreUI=n,cc._RF.pop()},{}],SuperMagicBall:[function(e,t,a){"use strict";cc._RF.push(t,"d5073/8sZRJkqM7LgsRZuSv","SuperMagicBall");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("Util"),p=n("GameManager"),d=n("EnumAndConst"),u=n("Body"),h=n("Head"),m=n("Shield"),f=n("Arrow"),g=n("BattleNodeManager"),y=n("MagicBallBlast"),v=n("EnemyArea"),D=n("LocalSoundManager"),E=n("GameCommonPool"),S=n("SingleEffectManager"),A=n("RoleManager"),C=n("LocalData"),M=n("GameState"),T=n("PlayerState");function _(){var e=null!==l&&l.apply(this,arguments)||this;return e.partical=null,e.bigIceBall=null,e.roleData=null,e.isFire=!1,e.targetPos=null,e.isDestroy=!1,e.isBlending=!1,e.blendCount=0,e.moveSpeed=300,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(_,l),_.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.addListener(s.LocalWorldEventType.NextPart,this.close,this),r.WorldEventManager.addListener(s.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),this.partical.resetSystem(),this.bigIceBall.stopAllActions(),this.bigIceBall.runAction(cc.repeatForever(cc.rotateBy(1,360))),this.roleData=null,this.isFire=null,this.targetPos=null,this.isBlending=!1,this.blendCount=0,this.isDestroy=!1},_.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.NextPart,this.close,this),r.WorldEventManager.removeListener(s.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this)},_.prototype.update=function(e){var t;null!=this.targetPos&&null!=this.roleData&&(this.roleData.isBoss&&this.roleData.isDead?null!=(t=T.PlayerState.playerData)&&this.blast(t):(c.Util.getDistance(this.node.position,this.targetPos)<100*e||this.roleData.isDead)&&this.blast(null))},_.prototype.bindData=function(e,t){this.roleData=t,this.isFire=e,null!=(e=T.PlayerState.playerData)&&(e=e.logicPos,this.targetPos=e,this.blendCount=0,this.node.scale=1,this.isBlending=!0)},_.prototype.blendLittleMagicBall=function(){this.blendCount++,this.node.stopAllActions();var e=1+this.blendCount;1!=e?(this.node.stopAllActions(),this.node.runAction(cc.scaleTo(.5,e))):this.node.scale=1},_.prototype.reduceBlendCount=function(){var e;this.blendCount--,!this.isBlending&&this.blendCount<2&&p.GameManager.shakeEffect(0),this.blendCount<0?this.blast(null):(e=1+this.blendCount,this.isBlending&&this.node.stopAllActions(),this.node.runAction(cc.scaleTo(.5,e)))},_.prototype.moveAction=function(){var e;this.blendCount<0?this.close():(this.isBlending=!1,e=c.Util.getDistance(this.roleData.logicPos,this.targetPos)/this.moveSpeed,2<=this.blendCount&&p.GameManager.shakeEffect(e),this.node.runAction(cc.moveTo(e,this.targetPos)))},_.prototype.onCollisionEnter=function(e){if(null!=this.roleData&&!this.isDestroy){if(e.node.group==d.GroupNameEnum.ARROW){if(this.blendCount<0)return;var t=e.getComponent(f.Arrow);return null==t||t.arrowState!=d.ArrowStateEnum.LAUNCHING||(i=t.roleData)==this.roleData||i.isEnemy==this.roleData.isEnemy?void 0:(e.node.destroy(),void this.reduceBlendCount())}if(!this.isBlending)if(e.node.group!=d.GroupNameEnum.BODY){if(e.node.group!=d.GroupNameEnum.HEAD){if(e.node.group==d.GroupNameEnum.SHIELD&&null!=(n=e.getComponent(m.Shield))&&(i=n.roleData)!=this.roleData&&!i.isTeleporting){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);o=this.roleData.atk*(this.blendCount+1),A.RoleManager.equipmentIsDamaged(i,C.EquipmentType.shield,this.roleData,o,this.node.position),i.shieldDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),n.drop(200*a.x,200*a.y)),this.blast(null)}}else if(null!=(t=e.getComponent(h.Head))&&null!=(i=t.roleData)&&i!=this.roleData&&!i.isTeleporting){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);if(0<i.helmetDefense){var a,n=this.roleData.atk*(this.blendCount+1);return A.RoleManager.equipmentIsDamaged(i,C.EquipmentType.helmet,this.roleData,n,this.node.position),null!=t.helmet&&t.helmet.node.active&&i.helmetDefense<=0&&(a=this.targetPos.sub(this.node.position).normalize(),t.helmet.drop(200*a.x,200*a.y),t.helmet=null),void this.blast(null)}var o=this.roleData.atk*(this.blendCount+1);A.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0&&(l=this.node.x>i.logicPos.x?1:-1,S.SingleEffectManager.showBloodEffect(i.headPosition,l,i)),this.blast(i)}}else{var i;if(null!=(e=e.getComponent(u.Body))&&null!=(i=e.roleData)&&i!=this.roleData&&!i.isTeleporting){if(!M.GameState.isGaming)return this.node.stopAllActions(),void this.blast(null);var l;o=this.roleData.atk*(this.blendCount+1),A.RoleManager.roleIsDamaged(i,this.roleData,o,this.node.position),i.invincibleTime<=0&&(l=this.node.x>i.logicPos.x?1:-1,S.SingleEffectManager.showBloodEffect(i.logicPos,l,i)),this.blast(i)}}}},_.prototype.blast=function(e){if(null!=this.roleData){p.GameManager.shakeEffect(0),D.LocalSoundManager.playBlastAudio();var t=g.BattleNodeManager.getParentNode(d.BattleNodeEnum.EFFECT_NODE);if(null!=t){var a=v.EnemyArea.createMaigcBallBlast();if(null!=a){var n=a.getComponent(y.MagicBallBlast);if(null!=n){if(a.setParent(t),a.setPosition(this.node.position),n.showBlast(this.roleData,e,this.isFire,this.node.scale),this.isBlending&&!this.roleData.isDestroy)return this.node.stopAllActions(),void(this.node.scale=0);this.isDestroy||(this.isDestroy=!0,this.close())}}}}},_.prototype.isReviveKnocked=function(){null!=this.roleData&&this.reduceBlendCount()},_.prototype.close=function(){null!=this.node&&E.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7c92\u5b50",type:cc.ParticleSystem})],_.prototype,"partical",void 0),__decorate([o({displayName:"\u5927\u51b0\u7403",type:cc.Node})],_.prototype,"bigIceBall",void 0),n=__decorate([n],_),i.SuperMagicBall=n,cc._RF.pop()},{}],Sword:[function(e,t,a){"use strict";cc._RF.push(t,"81926LzVvtKYI5GmNcQBXWa","Sword");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("EnumAndConst"),s=n("Body"),c=n("Shield"),p=n("LocalSoundManager"),d=n("SkillSystem"),u=n("GameCommonPool"),h=n("SingleEffectManager"),m=n("RoleManager"),f=n("LocalData"),g=n("EnemyShield"),y=n("BattleNumManager"),v=n("Head"),D=n("GameState"),E=n("EffectCreate"),S=n("ConfigData");function A(){var e=null!==l&&l.apply(this,arguments)||this;return e.swordSprite=null,e.swordSpriteFrames=[],e.roleData=null,e.isHited=!1,e.hurtDatas=[],e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(A,l),A.prototype.onEnable=function(){this.node.angle=-110,this.node.stopAllActions(),this.stopAttack()},A.prototype.update=function(){null!=this.roleData&&(this.roleData.isDead&&this.stopAttack(),this.roleData.isDestroy&&this.close())},A.prototype.bindData=function(e){this.roleData=e,null!=this.roleData&&(e=0,S.ConfigData.isRobotProfession(this.roleData.profession)&&(e=1),this.swordSprite.spriteFrame=this.swordSpriteFrames[e],this.node.scaleX=S.ConfigData.getEquipmentScale(this.roleData,f.EquipmentType.weapon))},A.prototype.onCollisionEnter=function(e,t){this.isHited&&(e.node.group!=r.GroupNameEnum.BODY?e.node.group!=r.GroupNameEnum.HEAD?e.node.group==r.GroupNameEnum.SHIELD&&this.collideShield(e,t):this.collideHead(e,t):this.collideBody(e,t))},A.prototype.onCollisionStay=function(e,t){this.isHited&&e.node.group==r.GroupNameEnum.SHIELD&&this.collideShield(e,t)},A.prototype.collideBody=function(e){var t=e.getComponent(s.Body);if(null!=t){var a=t.roleData;if(!(null==a||a.isTeleporting||a==this.roleData||a.isEnemy==this.roleData.isEnemy||a.hasEnemyShield||0<a.shieldDefense||0<a.helmetDefense||-1!=this.hurtDatas.indexOf(a))){if(e=0,this.roleData.isEnemy&&a.isPlayer&&(e=d.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.DODGE)),a.enemyEquipSkills.isHaveSkill(r.SkillTypeEnum.DODGE)&&(e=d.SkillSystem.getEquipedSkillInitData(r.SkillTypeEnum.DODGE),a.isBoss&&D.GameState.heroModel&&(e*=2)),Math.random()<e){var n=cc.v2(0,0);return n=a.isBoss&&7==D.GameState.currentChapter?a.headPosition:a.logicPos,E.EffectCreate.createRoleTip(n,0),void this.hurtDatas.push(a)}this.hurtDatas.push(a),e=this.roleData.atk,e*=1-a.bodyHurtReduction,e=Math.max(1,e),t.isSkinArmor&&(e*=.1),n=a.isBoss&&7==D.GameState.currentChapter?this.node.position:a.logicPos,m.RoleManager.roleIsDamaged(a,this.roleData,e,n),0<a.invincibleTime?p.LocalSoundManager.playShieldResistAudio():(t.isSkinArmor?p.LocalSoundManager.playShieldResistAudio():p.LocalSoundManager.playArrowHitAudio(),n=-this.node.scaleX,t.isSkinArmor?(this.roleData.reviveRepelTime=.5,m.RoleManager.hitRole(this.roleData),E.EffectCreate.createSpark(this.node.position,n,!1)):(t=cc.v2(0,0),t=a.isBoss&&7==D.GameState.currentChapter?this.node.position:a.logicPos,h.SingleEffectManager.showBloodEffect(t,n,a)))}}},A.prototype.collideHead=function(e,t){var a=e.getComponent(v.Head);if(null!=a){var n=a.roleData;if(null!=n&&!n.isTeleporting&&n!=this.roleData&&n.isEnemy!=this.roleData.isEnemy&&(n.isBoss&&7==D.GameState.currentChapter||!n.hasEnemyShield)&&(n.isBoss||!(0<n.shieldDefense||n.helmetDefense<=0))&&-1==this.hurtDatas.indexOf(n)&&!this.dodgeSkill(n)){var o=n.helmetDefense;if(null!=a.helmet&&0<o)return this.hurtDatas.push(n),void this.collideHelmet(e,t,a,n);this.hurtDatas.push(n),t=this.roleData.atk,t*=1-n.headHurtReduction,t=Math.max(1,t),a=n.isBoss&&7==D.GameState.currentChapter?this.node.position:n.logicPos,m.RoleManager.roleIsDamaged(n,this.roleData,t,a),0<n.invincibleTime?p.LocalSoundManager.playShieldResistAudio():(p.LocalSoundManager.playArrowHitAudio(),t=-this.node.scaleX,a=cc.v2(0,0),a=n.isBoss&&7==D.GameState.currentChapter?this.node.position:n.logicPos,h.SingleEffectManager.showBloodEffect(a,t,n))}}},A.prototype.collideHelmet=function(e,t,a,n){e=e.node.parent.convertToWorldSpaceAR(e.node.position),n.invincibleTime<=0&&E.EffectCreate.createSpark(e,-this.node.scaleX,!0),p.LocalSoundManager.playHelmetResistAudio(),e=Math.round(this.roleData.atk),m.RoleManager.equipmentIsDamaged(n,f.EquipmentType.helmet,this.roleData,e,n.headPosition),null!=a.helmet&&a.helmet.node.active&&n.helmetDefense<=0&&(a.helmet.drop(100,200),a.helmet=null)},A.prototype.collideShield=function(e){var t=e.getComponent(g.EnemyShield);if(null!=t){var a=t.roleData;if(null==a||a.isTeleporting||this.roleData.isEnemy==a.isEnemy)return;if(a.isBoss&&7==D.GameState.currentChapter){if(-1!=this.hurtDatas.indexOf(a))return;this.hurtDatas.push(a);var n=Math.round(this.roleData.atk);return m.RoleManager.roleIsDamaged(this.roleData,this.roleData,n,this.roleData.logicPos),p.LocalSoundManager.playShieldResistAudio(),E.EffectCreate.createSpark(this.node.position,-this.node.scaleX,!1),this.roleData.reviveRepelTime=.5,void this.stopAttack()}if(-1!=this.hurtDatas.indexOf(a))return;var o=Math.round(this.roleData.atk);return t.breaking(),this.hurtDatas.push(a),n=o>=S.ConfigData.MAX_DAMAGE?r.BattleNumTypeEnum.BROKE_EQUIPMENT:r.BattleNumTypeEnum.HP_REDUCE,y.BattleNumManager.createBattleNumEffect(n,o,a,a.logicPos),void p.LocalSoundManager.playShieldResistAudio()}if(null!=(n=e.getComponent(c.Shield))&&!(null==(o=n.roleData)||o.isTeleporting||o==this.roleData||o.hasEnemyShield||o.isEnemy==this.roleData.isEnemy||o.shieldDefense<=0)&&-1==this.hurtDatas.indexOf(o)){if(a=0,this.roleData.isEnemy&&o.isPlayer&&(a=d.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.DODGE)),o.enemyEquipSkills.isHaveSkill(r.SkillTypeEnum.DODGE)&&(a=d.SkillSystem.getEquipedSkillInitData(r.SkillTypeEnum.DODGE),o.isBoss&&D.GameState.heroModel&&(a*=2)),Math.random()<a){cc.v2(0,0);var i=o.isBoss&&7==D.GameState.currentChapter?o.headPosition:o.logicPos;return E.EffectCreate.createRoleTip(i,0),void this.hurtDatas.push(o)}this.hurtDatas.push(o),i=Math.round(this.roleData.atk),m.RoleManager.equipmentIsDamaged(o,f.EquipmentType.shield,this.roleData,i,e.node.position),o.shieldDefense<=0&&n.drop(100,200),e=e.node.parent.convertToWorldSpaceAR(e.node.position),p.LocalSoundManager.playShieldResistAudio(),o.invincibleTime<=0&&E.EffectCreate.createSpark(e,-this.node.scaleX,!0)}},A.prototype.dodgeSkill=function(e){if(e.isDead)return!1;var t=0;return this.roleData.isEnemy&&e.isPlayer&&(t=d.SkillSystem.getEquipedSkillData(r.SkillTypeEnum.DODGE)),e.enemyEquipSkills.isHaveSkill(r.SkillTypeEnum.DODGE)&&(t=d.SkillSystem.getEquipedSkillInitData(r.SkillTypeEnum.DODGE),e.isBoss&&D.GameState.heroModel&&(t*=2)),Math.random()<t&&(t=cc.v2(0,0),t=e.isBoss&&7==D.GameState.currentChapter?e.headPosition:e.logicPos,E.EffectCreate.createRoleTip(t,0),this.hurtDatas.push(e),!0)},A.prototype.startAttack=function(){this.hurtDatas=[],this.isHited=!0},A.prototype.stopAttack=function(){this.hurtDatas=[],this.isHited=!1},A.prototype.close=function(){u.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6b66\u5668\u56fe\u7247",type:cc.Sprite})],A.prototype,"swordSprite",void 0),__decorate([o({displayName:"\u8fd1\u6218\u6b66\u5668\u56fe\u7247\u96c6\u5408",type:cc.SpriteFrame})],A.prototype,"swordSpriteFrames",void 0),n=__decorate([n],A),i.Sword=n,cc._RF.pop()},{}],TalentUI:[function(e,t,a){"use strict";cc._RF.push(t,"bf44eRHU0FMhoC7lMeXvUuW","TalentUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("ConfigData"),s=n("LocalData"),c=n("NumberImg"),p=n("Util"),d=n("UserData"),u=n("TipManager"),h=n("LocalSoundManager"),m=n("GameConfigData"),f=n("WorldEventManager"),g=n("LocalWorldEventType"),y=n("UIManager"),v=n("CommonMask");function D(){var e=null!==l&&l.apply(this,arguments)||this;return e.allTalentSprite=null,e.allTalentDetail=null,e.explainBg=null,e.talentLabel=null,e.talentSprites=[],e.talentLevelLabel=[],e.talentSpriteFrames=[],e.selectSprites=[],e.talentCost=null,e.extractBtn=null,e.talentDetailLabel=[],e.talentIndex=0,e.positionArray=[cc.v2(138,-4),cc.v2(275,-4),cc.v2(365,-95),cc.v2(275,-182),cc.v2(138,-182),cc.v2(52,-95)],e.maxLevelTalentArray=[],e.detailPos=null,e.spritePos=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(D,l),D.prototype.onLoad=function(){this.detailPos=this.allTalentDetail.position,this.spritePos=this.allTalentSprite.position,this.talentCost.value=m.GameConfigData.data.talentCost*(s.LocalData.data.talentExtractTimes+1)+"";for(var e=0;e<m.GameConfigData.data.maxTalentCount;e++){var t,a=s.LocalData.getTalentLevel(e);null!=a&&0!=a?(this.talentLevelLabel[e].node.parent.active=!0,this.talentSprites[e].spriteFrame=this.talentSpriteFrames[e],a>=m.GameConfigData.data.talentMaxLevel[e]?(this.talentLevelLabel[e].value="lv."+m.GameConfigData.data.talentMaxLevel[e],t=this.selectSprites[e],this.maxLevelTalentArray.push(t),this.selectSprites[e]=null):this.talentLevelLabel[e].value="lv."+a):(s.LocalData.data.talentLevel[e]=0,this.talentSprites[e].spriteFrame=this.talentSpriteFrames[m.GameConfigData.data.maxTalentCount],this.talentLevelLabel[e].node.parent.active=!1)}y.UIManager.createBubbleText(this.node,cc.v2(-240,106),!1,2)},D.prototype.onEnable=function(){this.explainBg.active=!1;for(var e=0,t=this.maxLevelTalentArray;e<t.length;e++){var a=t[e];null!=a&&(a.active=!1)}for(var n=0,o=this.selectSprites;n<o.length;n++){var i=o[n];null!=i&&(i.active=!1)}for(var l=0,r=this.talentSprites;l<r.length;l++){var s=r[l];null!=s&&(s.node.scale=1)}this.allTalentDetail.position=cc.v2(this.detailPos.x,-800),this.allTalentSprite.position=cc.v2(1500,this.spritePos.y),this.allTalentDetail.stopAllActions(),this.allTalentDetail.runAction(cc.sequence(cc.moveTo(.4,this.detailPos.x,this.detailPos.y+10),cc.moveTo(.1,this.detailPos.x,this.detailPos.y-10),cc.moveTo(.1,this.detailPos))),this.allTalentSprite.stopAllActions(),this.allTalentSprite.runAction(cc.sequence(cc.moveTo(.4,this.spritePos.x-20,this.spritePos.y),cc.moveTo(.1,this.spritePos.x+20,this.spritePos.y),cc.moveTo(.1,this.spritePos))),this.refreshDetail()},D.prototype.showTalent=function(e){switch(e){case 0:this.talentLabel.string=r.ConfigData.talentContent[0]+m.GameConfigData.data.talentData[0]*s.LocalData.getTalentLevel(0);break;case 1:this.talentLabel.string=r.ConfigData.talentContent[1]+Math.round(m.GameConfigData.data.talentData[1]*s.LocalData.getTalentLevel(1)*100)+"%";break;case 2:this.talentLabel.string=r.ConfigData.talentContent[2]+Math.round(m.GameConfigData.data.talentData[2]*s.LocalData.getTalentLevel(2));break;case 3:this.talentLabel.string=r.ConfigData.talentContent[3]+Math.round(m.GameConfigData.data.talentData[3]*s.LocalData.getTalentLevel(3)*100)+"%";break;case 4:this.talentLabel.string=r.ConfigData.talentContent[4]+Math.round(m.GameConfigData.data.talentData[4]*s.LocalData.getTalentLevel(4)*100)+"%";break;case 5:this.talentLabel.string=r.ConfigData.talentContent[5]}this.refreshDetail()},D.prototype.clickExtractBtn=function(){var e;h.LocalSoundManager.playAudio("click"),this.maxLevelTalentArray.length>=m.GameConfigData.data.maxTalentCount?u.TipManager.showTip("\u5929\u8d4b\u5df2\u5168\u90e8\u6ee1\u7ea7\uff01"):(e=m.GameConfigData.data.talentCost*(s.LocalData.data.talentExtractTimes+1),d.UserData.data.coin<e?u.TipManager.showTip("\u91d1\u5e01\u4e0d\u8db3\uff01"):(s.LocalData.changeCoin(-e),this.extractBtn.interactable=!1,this.explainBg.active=!1,s.LocalData.data.talentExtractTimes++,this.talentCost.value=m.GameConfigData.data.talentCost*(s.LocalData.data.talentExtractTimes+1)+"",v.CommonMask.showMask(),this.extractAnimation()))},D.prototype.select=function(e){var t;this.talentSprites[e].spriteFrame!=this.talentSpriteFrames[m.GameConfigData.data.maxTalentCount]&&(this.explainBg.active=!0,this.showTalent(e),t=this.talentLabel.string.length*this.talentLabel.fontSize,this.explainBg.setContentSize(t+2*this.talentLabel.fontSize,this.explainBg.getContentSize().height),this.explainBg.position=this.positionArray[e].sub(cc.v2(t/2-115+20,0)))},D.prototype.clickTalent0=function(){this.select(0)},D.prototype.clickTalent1=function(){this.select(1)},D.prototype.clickTalent2=function(){this.select(2)},D.prototype.clickTalent3=function(){this.select(3)},D.prototype.clickTalent4=function(){this.select(4)},D.prototype.clickTalent5=function(){this.select(5)},D.prototype.clickEmpty=function(){this.explainBg.active=!1},D.prototype.extractAnimation=function(){for(var e=p.Util.getRandomNum(21,26),t=0,a=this.maxLevelTalentArray;t<a.length;t++){var n=a[t];null!=n&&(n.active=!1)}for(var o=this.maxLevelTalentArray.length,i=(e=o==m.GameConfigData.data.maxTalentCount-1?1:e)%(m.GameConfigData.data.maxTalentCount-o),l=this.talentIndex=0,r=this.selectSprites;l<r.length;l++){var c=r[l];if(null!=c){if(0==i){i=this.selectSprites.indexOf(c);break}i--}}s.LocalData.data.talentLevel[i]++,this.scheduleRepeat(.1,e,0)},D.prototype.scheduleRepeat=function(e,t,a){var n=this;this.unscheduleAllCallbacks(),this.schedule(function(){e=1/(t-a+1),n.talentIndex>=n.selectSprites.length&&(n.talentIndex=0);var o=n.selectSprites[n.talentIndex];if(null==o)return n.talentIndex++,void n.scheduleRepeat(0,t,a);for(var i=0,l=n.selectSprites;i<l.length;i++){var r=l[i];null!=r&&(r.active=!1)}if(h.LocalSoundManager.playAudio("click"),o.active=!0,a==t)return n.talentSprites[n.talentIndex].node.stopAllActions(),n.talentSprites[n.talentIndex].node.runAction(cc.sequence(cc.delayTime(.5),cc.scaleTo(.3,0,1),cc.callFunc(function(){switch(n.talentLevelLabel[n.talentIndex].node.parent.active=!0,n.talentSprites[n.talentIndex].spriteFrame=n.talentSpriteFrames[n.talentIndex],n.select(n.talentIndex),n.talentIndex){case 0:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:9});break;case 1:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:10});break;case 2:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:6});break;case 3:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:8});break;case 4:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:7});break;case 5:f.WorldEventManager.triggerEvent(g.LocalWorldEventType.ShowBubble,{type:11})}var e;s.LocalData.getTalentLevel(n.talentIndex)>=m.GameConfigData.data.talentMaxLevel[n.talentIndex]?(n.talentLevelLabel[n.talentIndex].value="lv."+m.GameConfigData.data.talentMaxLevel[n.talentIndex],e=n.selectSprites[n.talentIndex],n.maxLevelTalentArray.push(e),n.selectSprites[n.talentIndex]=null):n.talentLevelLabel[n.talentIndex].value="lv."+s.LocalData.getTalentLevel(n.talentIndex),n.extractBtn.interactable=!0,v.CommonMask.hideMask()}),cc.scaleTo(.3,1))),void n.unscheduleAllCallbacks();n.talentIndex++,a++,n.scheduleRepeat(e,t,a)},e,1,0)},D.prototype.refreshDetail=function(){for(var e=s.LocalData.data.talentLevel,t=0,a=0,n=this.talentDetailLabel;a<n.length;a++)n[a].node.active=0<e[t],t++;this.talentDetailLabel[0].string="lv."+e[0]+" "+r.ConfigData.talentContent[0]+Math.round(m.GameConfigData.data.talentData[0]*s.LocalData.getTalentLevel(0)),this.talentDetailLabel[1].string="lv."+e[1]+" "+r.ConfigData.talentContent[1]+Math.round(m.GameConfigData.data.talentData[1]*s.LocalData.getTalentLevel(1)*100)+"%",this.talentDetailLabel[2].string="lv."+e[2]+" "+r.ConfigData.talentContent[2]+Math.round(m.GameConfigData.data.talentData[2]*s.LocalData.getTalentLevel(2)),this.talentDetailLabel[3].string="lv."+e[3]+" "+r.ConfigData.talentContent[3]+Math.round(m.GameConfigData.data.talentData[3]*s.LocalData.getTalentLevel(3)*100)+"%",this.talentDetailLabel[4].string="lv."+e[4]+" "+r.ConfigData.talentContent[4]+Math.round(m.GameConfigData.data.talentData[4]*s.LocalData.getTalentLevel(4)*100)+"%",this.talentDetailLabel[5].string="lv."+e[5]+" "+r.ConfigData.talentContent[5]},__decorate([o({type:cc.Node,displayName:"\u6240\u6709\u5929\u8d4b\u56fe\u7247"})],D.prototype,"allTalentSprite",void 0),__decorate([o({type:cc.Node,displayName:"\u6240\u6709\u5929\u8d4b\u63cf\u8ff0"})],D.prototype,"allTalentDetail",void 0),__decorate([o({type:cc.Node,displayName:"\u63cf\u8ff0\u80cc\u666f"})],D.prototype,"explainBg",void 0),__decorate([o({type:cc.Label,displayName:"\u5929\u8d4b\u63cf\u8ff0"})],D.prototype,"talentLabel",void 0),__decorate([o({type:cc.Sprite,displayName:"\u5929\u8d4b\u96c6\u5408"})],D.prototype,"talentSprites",void 0),__decorate([o({type:c.NumberImg,displayName:"\u5929\u8d4b\u7b49\u7ea7\u96c6\u5408"})],D.prototype,"talentLevelLabel",void 0),__decorate([o({type:cc.SpriteFrame,displayName:"\u5929\u8d4b\u56fe\u7247\u96c6\u5408"})],D.prototype,"talentSpriteFrames",void 0),__decorate([o({type:cc.Node,displayName:"\u9009\u62e9\u56fe\u7247"})],D.prototype,"selectSprites",void 0),__decorate([o({type:c.NumberImg,displayName:"\u82b1\u8d39"})],D.prototype,"talentCost",void 0),__decorate([o({type:cc.Button,displayName:"\u62bd\u53d6\u6309\u94ae"})],D.prototype,"extractBtn",void 0),__decorate([o({type:cc.Label,displayName:"\u6240\u6709\u5929\u8d4b\u63cf\u8ff0"})],D.prototype,"talentDetailLabel",void 0),n=__decorate([n],D),i.TalentUI=n,cc._RF.pop()},{}],TaskManager:[function(e,t,a){"use strict";cc._RF.push(t,"c9ccancqy9OfIafthasOry4","TaskManager");var n=a;function o(){this.concurrency=5,this.queue=[],this.tasks=[],this.activeCount=0}Object.defineProperty(n,"__esModule",{value:!0}),o.prototype.push=function(e){var t=this;this.tasks.push(new Promise(function(a){function n(){t.activeCount++;try{e().then(function(e){a(e)}).then(function(){t.next()}).catch(function(e){t.next(),console.error(e)})}catch(n){t.next(),console.error(n)}}t.activeCount<t.concurrency?n():t.queue.push(n)}))},o.prototype.all=function(){return Promise.all(this.tasks)},o.prototype.next=function(){this.activeCount--,0<this.queue.length&&this.queue.shift()()},o.prototype.addTask=function(e){this.push(function(){return new Promise(function(t){e(function(){t("")},function(){t("")})})})},o.addTask=function(e){null==this.instance&&(this.instance=new o),this.instance.addTask(e)},o.instance=null,n.TaskManager=o,cc._RF.pop()},{}],ThornsChainsDamageEffect:[function(e,t,a){"use strict";cc._RF.push(t,"9b2f6AyqOVOHaNCDobLoA3I","ThornsChainsDamageEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("SkillSystem"),c=n("EnumAndConst");function p(){var e=null!==l&&l.apply(this,arguments)||this;return e.greenLightAni=null,e.crossChains=null,e.targetData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(p,l),p.prototype.onEnable=function(){this.playAnimation()},p.prototype.lateUpdate=function(){null!=this.targetData&&(this.targetData.isTeleporting||this.targetData.profession==c.ProfessionEnum.LAUNCHER&&!this.targetData.isBoss||this.targetData.profession==c.ProfessionEnum.NECROMANCER||this.targetData.profession==c.ProfessionEnum.SHIELD_WIZARD||this.updatePosition())},p.prototype.bindData=function(e){null==e||e.isDead?this.close():this.targetData=e},p.prototype.playAnimation=function(){var e=this,t=s.SkillSystem.getSkillLevel(c.SkillTypeEnum.THORNS_CHAINS);null!=t&&(this.greenLightAni.play("ThornChainsGreenLight"),this.crossChains.opacity=0,this.crossChains.scale=+t+1,this.crossChains.stopAllActions(),this.crossChains.runAction(cc.sequence(cc.fadeIn(.2),cc.scaleTo(.2,1),cc.delayTime(.5),cc.callFunc(function(){e.close()}))))},p.prototype.updatePosition=function(e){null!=this.targetData&&(this.node.position=null==e?this.targetData.logicPos:e)},p.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u7eff\u5149\u52a8\u753b",type:cc.Animation})],p.prototype,"greenLightAni",void 0),__decorate([o({displayName:"\u5341\u5b57\u9501\u94fe",type:cc.Node})],p.prototype,"crossChains",void 0),n=__decorate([n],p),i.ThornsChainsDamageEffect=n,cc._RF.pop()},{}],ThornsChainsEffect:[function(e,t,a){"use strict";cc._RF.push(t,"166b7Wf6gVFTKGfwQsczq2S","ThornsChainsEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("SkillSystem"),c=n("EnumAndConst"),p=n("WorldEventManager"),d=n("LocalWorldEventType");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.leftChains=null,e.middleChains=null,e.rightChains=null,e.leftChainsActionTag=null,e.middleChainsActionTag=null,e.rightChainsActionTag=null,e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){p.WorldEventManager.addListener(d.LocalWorldEventType.BackHome,this.close,this)},u.prototype.onDisable=function(){p.WorldEventManager.removeListener(d.LocalWorldEventType.BackHome,this.close,this)},u.prototype.init=function(e){this.node.stopAllActions(),this.node.position=cc.v2(-450,-181),this.playCircleAnimation(),this.closeAction=e},u.prototype.playCircleAnimation=function(){var e=s.SkillSystem.getSkillLevel(c.SkillTypeEnum.THORNS_CHAINS);null!=e&&(e=25*e+20,this.leftChains.runAction(cc.repeatForever(cc.rotateBy(1,-e))),this.middleChains.runAction(cc.repeatForever(cc.rotateBy(1,e))),this.rightChains.runAction(cc.repeatForever(cc.rotateBy(1,-e))))},u.prototype.playUpAnimation=function(e){var t=this;this.node.runAction(cc.sequence(cc.moveBy(.5,cc.v2(0,31)),cc.callFunc(function(){e&&t.playDownAnimation()})))},u.prototype.playDownAnimation=function(e){var t=this;void 0===e&&(e=0),this.node.runAction(cc.sequence(cc.delayTime(e),cc.moveBy(.5,cc.v2(0,-31)),cc.callFunc(function(){t.close()})))},u.prototype.playMoveAnimation=function(){var e=this,t=this.node.runAction(cc.sequence(cc.moveBy(2,cc.v2(-700,0)),cc.callFunc(function(){e.close()})));this.leftChainsActionTag=0,t.setTag(this.leftChainsActionTag)},u.prototype.stopMoveAnimation=function(){null!=this.leftChainsActionTag&&this.node.stopActionByTag(this.leftChainsActionTag),null!=this.middleChainsActionTag&&this.middleChains.stopActionByTag(this.middleChainsActionTag),null!=this.rightChainsActionTag&&this.rightChains.stopActionByTag(this.rightChainsActionTag)},u.prototype.close=function(){this.closeAction&&this.closeAction(),r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5de6\u9501\u94fe",type:cc.Node})],u.prototype,"leftChains",void 0),__decorate([o({displayName:"\u4e2d\u9501\u94fe",type:cc.Node})],u.prototype,"middleChains",void 0),__decorate([o({displayName:"\u53f3\u9501\u94fe",type:cc.Node})],u.prototype,"rightChains",void 0),n=__decorate([n],u),i.ThornsChainsEffect=n,cc._RF.pop()},{}],ThunderEffect:[function(e,t,a){"use strict";cc._RF.push(t,"4442cNCC4JLcrCalDm2ONTK","ThunderEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommonPool"),s=n("WorldEventManager"),c=n("LocalWorldEventType"),p=n("LocalSoundManager"),d=n("Util");function u(){var e=null!==l&&l.apply(this,arguments)||this;return e.thunderAni=null,e.thunderChain=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(u,l),u.prototype.onEnable=function(){p.LocalSoundManager.playThunderAudio(),s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this),this.thunderAni.play("Thunder"),this.thunderAni.on("finished",this.close,this)},u.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this),this.thunderAni.off("finished",this.close,this)},u.prototype.bindData=function(e,t){var a;null!=e&&null!=t&&(e!=t?(a=d.Util.getDistance(e,t),e=d.Util.getAngle(t,e),this.thunderChain.active=!0,this.thunderChain.width=a,this.thunderChain.angle=e):this.thunderChain.active=!1)},u.prototype.close=function(){r.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u96f7\u7535\u52a8\u753b",type:cc.Animation})],u.prototype,"thunderAni",void 0),__decorate([o({displayName:"\u95ea\u7535\u94fe",type:cc.Node})],u.prototype,"thunderChain",void 0),n=__decorate([n],u),i.ThunderEffect=n,cc._RF.pop()},{}],ThunderImmuneEffect:[function(e,t,a){"use strict";cc._RF.push(t,"4d533y3Tr5KsppeXNoZUFVL","ThunderImmuneEffect");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=o("GameCommonPool"),s=o("WorldEventManager"),c=o("LocalWorldEventType"),p=o("EnumAndConst");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.targetData=null,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){s.WorldEventManager.addListener(c.LocalWorldEventType.BackHome,this.close,this)},d.prototype.onDisable=function(){s.WorldEventManager.removeListener(c.LocalWorldEventType.BackHome,this.close,this)},d.prototype.update=function(e){if(null!=this.targetData){if(this.targetData.isTeleporting?this.node.opacity=0:this.node.opacity=162,this.targetData.isDead||this.targetData.thunderImmuneTime<=0)return this.targetData.thunderImmuneTime=0,void this.close();this.targetData.thunderImmuneTime-=e}else this.close()},d.prototype.lateUpdate=function(){null!=this.targetData&&(this.targetData.profession==p.ProfessionEnum.LAUNCHER&&!this.targetData.isBoss||this.targetData.profession==p.ProfessionEnum.NECROMANCER||this.targetData.profession==p.ProfessionEnum.SHIELD_WIZARD||this.updatePosition())},d.prototype.bindData=function(e){this.targetData=e,this.targetData.thunderImmuneTime=1.5},d.prototype.updatePosition=function(e){null!=this.targetData&&(this.node.position=null==e?this.targetData.logicPos:e)},d.prototype.close=function(){this.targetData=null,r.GameCommonPool.returnInstant(this.node)},o=__decorate([o],d),i.ThunderImmuneEffect=o,cc._RF.pop()},{}],TimeController:[function(e,t,a){"use strict";cc._RF.push(t,"e4fbcRqrkVEpJJeVsZdYFvx","TimeController");var n,o=e,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=o("LocalData"),c=o("UserData"),p=o("GameConfigData");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.nowTime=null,e.oneSecond=1,e}o=(n=cc._decorator).ccclass,n.property,l=cc.Component,__extends(d,l),(r=d).prototype.update=function(e){var t,a;r.uiBubbleCd-=e,!c.UserData.init||s.LocalData.data.energyNum>=p.GameConfigData.data.maxEnergy||(null==s.LocalData.data.lastGetEnergyTime&&(r.timePass=0,s.LocalData.data.lastGetEnergyTime=Math.floor(Date.now()/1e3)),this.oneSecond-=e,1==Math.ceil(this.oneSecond))||(this.oneSecond=1,this.nowTime=Date.now()/1e3,(a=(t=Math.floor(this.nowTime))-s.LocalData.data.lastGetEnergyTime)>=p.GameConfigData.data.getEnergyTime&&(e=Math.floor(a/p.GameConfigData.data.getEnergyTime),s.LocalData.data.energyNum+=e,s.LocalData.data.energyNum>=p.GameConfigData.data.maxEnergy?(s.LocalData.data.energyNum=p.GameConfigData.data.maxEnergy,s.LocalData.data.lastGetEnergyTime=null):s.LocalData.data.lastGetEnergyTime=t),r.timePass=Math.ceil(a%p.GameConfigData.data.getEnergyTime))},d.timePass=null,d.uiBubbleCd=0,o=r=__decorate([o],d),i.TimeController=o,cc._RF.pop()},{}],Timer:[function(e,t,a){"use strict";cc._RF.push(t,"a6d78OHUJxHmb5zDH1Zj+Ba","Timer");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l,r=cc._decorator;function s(){var e=null!==i&&i.apply(this,arguments)||this;return e.timerMap=new Map,e}n=r.ccclass,r.property,i=cc.Component,__extends(s,i),(l=s).prototype.onLoad=function(){(l.instance=this).timerMap=new Map},s.prototype.update=function(e){var t,a=this;null==this.timerMap||this.timerMap.size<=0||(t=[],this.timerMap.forEach(function(a,n){if(null==n||n.active&&n.isValid)if(null==a||a.length<=0)t.push(n);else for(var o=0;o<a.length;o++){var i=a[o];null!=i&&!i.execute(e)||(a.splice(o,1),o--)}else t.push(n)}),null!=t&&0<t.length&&t.forEach(function(e){a.timerMap.delete(e)}))},s.addTimer=function(e,t,a){var n,o=l.instance;if(null!=o&&null!=e&&null!=t)return null==a&&(a=o.node),t=new c(e,t),o.timerMap.has(a)?(n=null==(n=o.timerMap.get(a))?[]:n).push(t):((n=[]).push(t),o.timerMap.set(a,n)),t},s.removeTargetTimer=function(e,t){var a=l.instance;if(null!=a&&null!=t&&(null==e&&(e=a.node),a.timerMap.has(e))){var n=a.timerMap.get(e);if(!(null==n||n.length<=0))for(var o=0;o<n.length;o++){var i=n[o];if(null!=i&&i==t){n.splice(o,1);break}}}},s.pasueAllTimers=function(e){var t=l.instance;if(null!=t&&(null==e&&(e=t.node),t.timerMap.has(e))){var a=t.timerMap.get(e);if(!(null==a||a.length<=0))for(var n=0;n<a.length;n++){var o=a[n];null!=o&&o.pauseTimer()}}},s.resumeAllTimers=function(e){var t=l.instance;if(null!=t&&(null==e&&(e=t.node),t.timerMap.has(e))){var a=t.timerMap.get(e);if(!(null==a||a.length<=0))for(var n=0;n<a.length;n++){var o=a[n];null!=o&&o.resumeTimer()}}},s.removeAllTimers=function(e){var t=l.instance;null!=t&&(null==e&&(e=t.node),t.timerMap.has(e)&&t.timerMap.delete(e))},s.clearTimers=function(){var e=l.instance;null!=e&&e.timerMap.clear()},s.instance=null,n=l=__decorate([n],s),o.TimerManager=n;var c=(Object.defineProperty(p.prototype,"isPause",{get:function(){return this._isPause},enumerable:!0,configurable:!0}),p.prototype.execute=function(e){if(this.isPause)return!1;if(this.delayTime-=e,this.delayTime<=0)try{return this.callFunc&&this.callFunc(),!0}catch(e){return console.error(e),!0}},p.prototype.pauseTimer=function(){this._isPause=!0},p.prototype.resumeTimer=function(){this._isPause=!1},p);function p(e,t){this._isPause=!1,this.delayTime=null,this.callFunc=null,this.delayTime=e,this.callFunc=t}o.Timer=c,cc._RF.pop()},{}],TipManager:[function(e,t,a){"use strict";cc._RF.push(t,"d22217t3+1BKZTKun+ldtSu","TipManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("CommonTip"),p=n("CommonToast");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.tipNode=null,e.toastNode=null,e.tipPrefab=null,e.toastPrefab=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),(r=d).prototype.onLoad=function(){r.instance=this},d.showToast=function(e){var t,a;null!=e&&(null==(t=r.instance)||null==t.toastNode||null!=(a=s.GameCommonPool.requestInstant(t.toastPrefab))&&(a.setParent(t.toastNode),null!=(a=a.getComponent(p.CommonToast))&&a.showText(e,this.toastColor)))},d.showTip=function(e){if(null!=e&&null!=(a=r.instance)&&null!=a.tipNode){var t,a,n=s.GameCommonPool.requestInstant(a.tipPrefab);if(null!=n&&(n.setParent(a.tipNode),n.y=0,null!=(a=n.getComponent(c.CommonTip)))){a.show(e,this.tipColor),3<=this.tipArray.length&&(t=this.tipArray.shift())&&t.active&&s.GameCommonPool.returnInstant(t);for(var o=0,i=this.tipArray.length-1;0<=i;i--){var l=this.tipArray[i];0==o&&(o=.5*n.height+.5*l.height+10),l.y+=o}this.tipArray.push(n)}}},d.prototype.update=function(){for(;null!=r.tipArray[0]&&!r.tipArray[0].active;)r.tipArray.shift()},d.instance=null,d.tipColor=null,d.toastColor=null,d.tipArray=new Array,__decorate([o({displayName:"\u663e\u793a\u63d0\u793a\u6846\u7684\u8282\u70b9",type:cc.Node})],d.prototype,"tipNode",void 0),__decorate([o({displayName:"\u663e\u793a\u5bf9\u8bdd\u6846\u7684\u8282\u70b9",type:cc.Node})],d.prototype,"toastNode",void 0),__decorate([o({displayName:"\u63d0\u793a\u6846\u7684\u9884\u8bbe",type:cc.Prefab})],d.prototype,"tipPrefab",void 0),__decorate([o({displayName:"\u5bf9\u8bdd\u6846\u6846\u7684\u9884\u8bbe",type:cc.Prefab})],d.prototype,"toastPrefab",void 0),n=r=__decorate([n],d),i.TipManager=n,cc._RF.pop()},{}],TipPoint:[function(e,t,a){"use strict";cc._RF.push(t,"a8866o2brVMTK+m7PB50rjT","TipPoint");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.tipPointExternal=null,e}i=cc.Component,__extends(r,i),r.prototype.onEnable=function(){var e=this;this.tipPointExternal.stopAllActions(),this.tipPointExternal.scale=1,this.tipPointExternal.opacity=255,this.tipPointExternal.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(.5,2),cc.fadeOut(.2),cc.callFunc(function(){e.tipPointExternal.scale=1,e.tipPointExternal.opacity=255}))))},__decorate([l({type:cc.Node,displayName:"\u5916\u5708"})],r.prototype,"tipPointExternal",void 0),n=__decorate([n],r),o.TipPoint=n,cc._RF.pop()},{}],TransmitTouch:[function(e,t,a){"use strict";cc._RF.push(t,"553d1EgX99HYZEl9fFTsNDH","TransmitTouch");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0}),n=(l=cc._decorator).ccclass;var i,l=l.property;function r(){var e=null!==i&&i.apply(this,arguments)||this;return e.clickEvents=new Array,e}i=cc.Component,__extends(r,i),r.prototype.onLoad=function(){var e=this;this.node.on(cc.Node.EventType.TOUCH_START,function(t){null!=e.clickEvents&&cc.Component.EventHandler.emitEvents(e.clickEvents,t)}),this.node._touchListener.setSwallowTouches(!1)},__decorate([l([cc.Component.EventHandler])],r.prototype,"clickEvents",void 0),n=__decorate([n],r),o.TransmitTouch=n,cc._RF.pop()},{}],TurnHeartEffect:[function(e,t,a){"use strict";cc._RF.push(t,"9ed9e2XPKpKfK5OmBjWlh7J","TurnHeartEffect");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool"),p=n("EnumAndConst");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.heart1=null,e.heart2=null,e.roleData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),this.playAnimation()},d.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this)},d.prototype.update=function(){null!=this.roleData&&(this.roleData.isDead||this.roleData.isDestroy)&&this.close()},d.prototype.lateUpdate=function(){null!=this.roleData&&this.roleData.profession!=p.ProfessionEnum.LAUNCHER&&this.roleData.profession!=p.ProfessionEnum.LONG_ZOMBIE&&(this.node.position=this.roleData.logicPos)},d.prototype.bindData=function(e){null!=e&&(this.roleData=e)},d.prototype.playAnimation=function(){var e=this;this.heart1.active=!0,this.heart1.scale=.1,this.heart2.scale=.1,this.heart1.opacity=255,this.heart2.opacity=255,this.heart1.position=cc.v2(0,-29),this.heart2.position=cc.v2(0,-29),this.heart1.stopAllActions(),this.heart2.stopAllActions(),this.heart1.runAction(cc.sequence(cc.spawn(cc.fadeOut(.4),cc.scaleTo(.4,2)),cc.callFunc(function(){e.heart1.active=!1}))),this.heart2.runAction(cc.sequence(cc.scaleTo(.2,1.5),cc.scaleTo(.1,.8),cc.scaleTo(.1,1),cc.spawn(cc.moveTo(.2,cc.v2(0,54)),cc.scaleTo(.2,.6))))},d.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u5fc31",type:cc.Node})],d.prototype,"heart1",void 0),__decorate([o({displayName:"\u5fc32",type:cc.Node})],d.prototype,"heart2",void 0),n=__decorate([n],d),i.TurnHeartEffect=n,cc._RF.pop()},{}],UIManager:[function(e,t,a){"use strict";cc._RF.push(t,"97e12mD8IJLS4m16q8UqSbw","UIManager");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r,s=n("GameCommonPool"),c=n("SelectSkillPop"),p=n("RandomIncidentUI"),d=n("NoobGuide"),u=n("BoxUI"),h=n("LocalData"),m=n("EquipmentPopUI"),f=n("EquipmentCombineUI"),g=n("DayliLogin"),y=n("TipManager"),v=n("DayliLoginManager"),D=n("SpriteFrameManager"),E=n("UserData"),S=n("EquipmentRankEffect"),A=n("EquipmentSellUI"),C=n("BubbleText"),M=n("LocalDialUI"),T=n("Timer"),_=n("EquipmentItem"),k=n("FailTipUI"),P=n("getMoreGoldCoinUI"),R=n("PrefabUrl"),I=n("NewRewardUI"),w=n("EndlessBackUI"),b=n("ContinueBattleUI"),N=n("EggMachineUI"),B=n("InheritPopUI"),L=n("EndlessReceiveRewardUI"),G=n("UnlockSkillUI"),x=n("SkillDescriptionUI"),F=n("ChapterProgressRewardUI"),U=n("GetSkillUI"),q=n("Loading"),H=n("CommonMask"),W=n("BossBubbleText");function O(){var e=null!==l&&l.apply(this,arguments)||this;return e.gameNode=null,e.boardNode=null,e.popNode=null,e.topNode=null,e.gemIcon=null,e.equipmentRankNormalEffect=null,e.equipmentRankSpecialEffect=null,e.currencyUI=null,e.bubbleText=null,e.equipmentmentItem=null,e.currentPopNode=null,e.currentBoardNode=null,e.selectMapPop=null,e.noobGuide=null,e.revivePop=null,e.settlementPop=null,e.gamePausePop=null,e.backHomeWarnPop=null,e.getEnergyPop=null,e.settingPop=null,e.rankingPop=null,e.continueBattlePop=null,e.getBoxPop=null,e.equipmentPop=null,e.equipmentSellPop=null,e.equipmentCombinePop=null,e.dialPop=null,e.failTipPop=null,e.getMoreGoldCoinPop=null,e.eggMachinePop=null,e.newRewardUI=null,e.endlessBackUI=null,e.inheritPop=null,e.endlessRankingUI=null,e.endlessRankingRewardUI=null,e.endlessReceiveRewardUI=null,e.unlockSkillUI=null,e.skillDescriptionUI=null,e.chapterProgressRewardUI=null,e.getSkillUI=null,e}function z(){this.concurrency=1,this.queue=[],this.tasks=[],this.activeCount=0}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(O,l),(r=O).prototype.onLoad=function(){cc.game.addPersistRootNode(this.node),r._instance=this},O.showMainBoard=function(){var e=this,t=r._instance;null!=t&&s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.mainUI,function(a,n){null==a&&null!=n?(n.setParent(t.boardNode),t.currentBoardNode&&t.currentBoardNode.active&&s.GameCommonPool.returnInstant(t.currentBoardNode),t.currentBoardNode=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showMainBoard()},null)})},O.showBattleBoard=function(){var e=this,t=r._instance;null!=t&&s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.battleUI,function(a,n){null==a&&null!=n?(n.setParent(t.boardNode),t.currentBoardNode&&t.currentBoardNode.active&&s.GameCommonPool.returnInstant(t.currentBoardNode),t.currentBoardNode=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showBattleBoard()},null)})},O.closeBoardNode=function(){var e=r._instance;null!=e&&e.currentBoardNode&&e.currentBoardNode.active&&(s.GameCommonPool.returnInstant(e.currentBoardNode),e.currentBoardNode=null)},O.hasPopUI=function(){var e=r._instance;return null!=e&&(e.selectMapPop&&e.selectMapPop.active?void 0:!!(e.noobGuide&&e.noobGuide.active||e.continueBattlePop&&e.continueBattlePop.active||e.currentPopNode&&e.currentPopNode.active||e.revivePop&&e.revivePop.active||e.settlementPop&&e.settlementPop.active||e.gamePausePop&&e.gamePausePop.active||e.backHomeWarnPop&&e.backHomeWarnPop.active||e.getEnergyPop&&e.getEnergyPop.active||e.settingPop&&e.settingPop.active||e.rankingPop&&e.rankingPop.active||e.continueBattlePop&&e.continueBattlePop.active||e.getBoxPop&&e.getBoxPop.active||e.equipmentPop&&e.equipmentPop.active||e.equipmentSellPop&&e.equipmentSellPop.active||e.equipmentCombinePop&&e.equipmentCombinePop.active||e.dialPop&&e.dialPop.active||e.failTipPop&&e.failTipPop.active||e.getMoreGoldCoinPop&&e.getMoreGoldCoinPop.active||e.eggMachinePop&&e.eggMachinePop.active||e.newRewardUI&&e.newRewardUI.active||e.endlessBackUI&&e.endlessBackUI.active||e.inheritPop&&e.inheritPop.active||e.endlessRankingUI&&e.endlessRankingUI.active||e.endlessRankingRewardUI&&e.endlessRankingRewardUI.active||e.endlessReceiveRewardUI&&e.endlessReceiveRewardUI.active||e.unlockSkillUI&&e.unlockSkillUI.active||e.skillDescriptionUI&&e.skillDescriptionUI.active||e.chapterProgressRewardUI&&e.chapterProgressRewardUI.active||e.getSkillUI&&e.getSkillUI.active))},O.showSelectMapPop=function(){var e=this,t=r._instance;null!=t&&(t.selectMapPop&&t.selectMapPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.selectMapUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.selectMapPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showSelectMapPop()},null)})))},O.showNoobGuidePop=function(e){var t,a=this,n=r._instance;null==n||this.hasPopUI()||(n.noobGuide&&n.noobGuide.active?null!=(t=n.noobGuide.getComponent(d.NoobGuide))&&t.bindData(e):(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.noobGuideUIPop,function(t,o){H.CommonMask.hideMask(),null==t&&null!=o?(o.setParent(n.popNode),null!=(o=(n.noobGuide=o).getComponent(d.NoobGuide))&&o.bindData(e)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showNoobGuidePop(e)},null)})))},O.showContinueBattlePop=function(e,t){var a=this,n=r._instance;null==n||n.continueBattlePop&&n.continueBattlePop.active?t&&t():(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.continueBattleUIPop,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.continueBattlePop=i).getComponent(b.ContinueBattleUI))?i.bindData(e,t):t&&t()):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showContinueBattlePop(e,t)},null)}))},O.showSelectSkillPop=function(e){var t=this,a=r._instance;null!=a&&(a.noobGuide&&a.noobGuide.active&&s.GameCommonPool.returnInstant(a.noobGuide),H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.selectSkilllPop,function(n,o){H.CommonMask.hideMask(),null==n&&null!=o?(o.setParent(a.popNode),null!=(o=(a.currentPopNode=o).getComponent(c.SelectSkillPop))&&o.bindData(e)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){t.showSelectSkillPop(e)},null)}))},O.showRandomIncidentPop=function(e,t){var a=this,n=r._instance;null!=n&&(n.noobGuide&&n.noobGuide.active&&s.GameCommonPool.returnInstant(n.noobGuide),H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.randomIncidentUIPop,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.currentPopNode=i).getComponent(p.RandomIncidentUI))&&i.bindData(e,t)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showRandomIncidentPop(e,t)},null)}))},O.showRevivePop=function(){var e=this,t=r._instance;null!=t&&(t.revivePop&&t.revivePop.active||t.settlementPop&&t.settlementPop.active||(t.noobGuide&&t.noobGuide.active&&s.GameCommonPool.returnInstant(t.noobGuide),H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.reviveUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.revivePop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showRevivePop()},null)})))},O.showGamePausePop=function(){var e=this,t=r._instance;null!=t&&(t.gamePausePop&&t.gamePausePop.active||this.hasPopUI()||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.gamePauseUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.gamePausePop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showGamePausePop()},null)})))},O.showBackHomeWarnPop=function(){var e=this,t=r._instance;null!=t&&(t.backHomeWarnPop&&t.backHomeWarnPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.backHomeWarnUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.backHomeWarnPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showBackHomeWarnPop()},null)})))},O.showSettlementPop=function(){var e=this,t=r._instance;null!=t&&(t.settlementPop&&t.settlementPop.active||(t.noobGuide&&t.noobGuide.active&&s.GameCommonPool.returnInstant(t.noobGuide),H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.settlementUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.settlementPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showSettlementPop()},null)})))},O.showSettingUIPop=function(){var e=this,t=r._instance;null!=t&&(t.settingPop&&t.settingPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.settingUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.settingPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showSettingUIPop()},null)})))},O.showEggMachineUIPop=function(e){var t=this,a=r._instance;null==a||a.eggMachinePop&&a.eggMachinePop.active?e&&e():(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.eggMachineUI,function(n,o){H.CommonMask.hideMask(),null==n&&null!=o?(o.setParent(a.popNode),null!=(o=(a.eggMachinePop=o).getComponent(N.EggMachineUI))?o.bind(e):e&&e()):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){t.showEggMachineUIPop(e)},null)}))},O.showNewRewardUIPop=function(e,t){var a=this,n=r._instance;null!=n&&(n.newRewardUI&&n.newRewardUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.newRewardUI,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.newRewardUI=i).getComponent(I.NewRewardUI))&&i.bind(e,t)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showNewRewardUIPop(e,t)},null)})))},O.showRankingUIPop=function(){var e=this,t=r._instance;null!=t&&(t.rankingPop&&t.rankingPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.rankingUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.rankingPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showRankingUIPop()},null)})))},O.showGetEnergyPop=function(){var e=this,t=r._instance;null!=t&&(t.getEnergyPop&&t.getEnergyPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.getEnergyUIPop,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.getEnergyPop=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showGetEnergyPop()},null)})))},O.showEndlessBackPop=function(e,t){var a=this,n=r._instance;null!=n&&(n.endlessBackUI&&n.endlessBackUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.endlessModelBackUI,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.endlessBackUI=i).getComponent(w.EndlessBackUI))&&i.bindData(e,t)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showEndlessBackPop(e,t)},null)})))},O.showGetBoxPop=function(e,t,a){var n=this,o=r._instance;null!=o&&(o.getBoxPop&&o.getBoxPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.boxGetUIPop,function(i,l){H.CommonMask.hideMask(),null==i&&null!=l?(l.setParent(o.popNode),(i=l.getComponent(u.BoxUI))&&i.openBox(e,t,a),o.getBoxPop=l):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){n.showGetBoxPop(e,t,a)},null)})))},O.showEquipmentPop=function(e,t){var a,n=this;null==e||null!=(a=r._instance)&&(a.equipmentPop&&a.equipmentPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.equipmentUIPop,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(a.popNode),(o=i.getComponent(m.EquipmentPopUI))&&o.bindData(e,t),a.equipmentPop=i):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){n.showEquipmentPop(e,t)},null)})))},O.showEquipmentSellPop=function(e,t){var a,n=this;null==e||null!=(a=r._instance)&&(a.equipmentSellPop&&a.equipmentSellPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.sellEquipmentUIPop,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(a.popNode),(o=i.getComponent(A.EquipmentSellUI))&&o.bindData(e,t),a.equipmentSellPop=i):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){n.showEquipmentSellPop(e,t)},null)})))},O.showEquipmentCombinePop=function(e,t,a,n){var o,i=this;null==e||null!=(o=r._instance)&&(o.equipmentCombinePop&&o.equipmentCombinePop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.equipmentCombineUIPop,function(l,r){H.CommonMask.hideMask(),null==l&&null!=r?(r.setParent(o.popNode),(l=r.getComponent(f.EquipmentCombineUI))&&l.bindData(e,t,a,n),o.equipmentCombinePop=r):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){i.showEquipmentCombinePop(e,t,a,n)},null)})))},O.showDailyLoginReward=function(e){var t,a,n,o,i,l,s,c;7<=E.UserData.data.loginRewardRecievedCount||null==(c=r._instance)?e&&e():(t=new Array,a=new g.DayliLoginItemData(1,"x50",c.gemIcon,50,.5),n=new g.DayliLoginItemData(2,"\u9a91\u58eb\u62ab\u98ce",D.SpriteFrameManager.getCloakSpriteFrame(1),1,.3),o=new g.DayliLoginItemData(3,"\u9a91\u58eb\u5934\u76d4\xb7\u65e0\u754f",D.SpriteFrameManager.getHelmetSpriteFrame(2,4),1,.3),i=new g.DayliLoginItemData(1,"x100",c.gemIcon,100,.5),l=new g.DayliLoginItemData(4,"\u767d\u94f6\u76fe\u724c\xb7\u94c1\u58c1",D.SpriteFrameManager.getShieldSpriteFrame(2,4),1,.2),s=new g.DayliLoginItemData(1,"x200",c.gemIcon,200,.5),c=new g.DayliLoginItemData(5," \u9a91\u58eb\u957f\u5251\xb7\u5229\u5203",D.SpriteFrameManager.getLaunchWeaponSpriteFrame(1,5),1,.5),t.push(a),t.push(n),t.push(o),t.push(i),t.push(l),t.push(s),t.push(c),v.DayliLoginManager.showDayliLogin(t,function(e,t,a){if(null!=e){var n=e.itemCount;if(1==e.itemType)return y.TipManager.showTip("\u606d\u559c\u83b7\u5f97\u94bb\u77f3x"+n),h.LocalData.changeGem(n),void(a&&a());switch(e.itemType){case 2:y.TipManager.showTip("\u606d\u559c\u83b7\u5f97\u88c5\u5907  \u53f2\u8bd7\u7ea7 "+e.itemName),h.LocalData.rewardEquipment(h.EquipmentType.cloak,1,4,1);break;case 3:y.TipManager.showTip("\u606d\u559c\u83b7\u5f97\u88c5\u5907  \u53f2\u8bd7\u7ea7 "+e.itemName),h.LocalData.rewardEquipment(h.EquipmentType.helmet,2,4,1);break;case 4:y.TipManager.showTip("\u606d\u559c\u83b7\u5f97\u88c5\u5907  \u53f2\u8bd7\u7ea7 "+e.itemName),h.LocalData.rewardEquipment(h.EquipmentType.shield,2,4,1);break;case 5:y.TipManager.showTip("\u606d\u559c\u83b7\u5f97\u88c5\u5907  \u4f20\u8bf4\u7ea7 "+e.itemName),h.LocalData.rewardEquipment(h.EquipmentType.weapon,1,5,1)}a&&a()}},e))},O.showDialUI=function(e,t,a){var n=this,o=r._instance;null!=o&&(o.dialPop&&o.dialPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.localDial,function(i,l){H.CommonMask.hideMask(),null==i&&null!=l?(l.setParent(o.popNode),null!=(i=l.getComponent(M.LocalDialUI))&&(i.bindData(function(n,o){1==n?(t(!0,o),T.TimerManager.addTimer(2.5,function(){y.TipManager.showTip("\u606d\u559c\u83b7\u5f97"+o+"\u91d1\u5e01\uff01"),e&&e()})):2==n?(t(!1,o),T.TimerManager.addTimer(2.5,function(){y.TipManager.showTip("\u606d\u559c\u83b7\u5f97"+o+"\u94bb\u77f3\uff01"),e&&e()})):3==n?(a(6,null),e&&e()):4==n?(a(15,null),e&&e()):5==n?(a(12,.5),e&&e()):6==n?(a(13,.2),e&&e()):7==n?(a(11,.4),e&&e()):8==n&&(a(14,.4),e&&e())}),o.dialPop=l)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){n.showDialUI(e,t,a)},null)})))},O.createEquipmentRankNormalEffect=function(){var e=r._instance;if(null!=e&&null!=(e=s.GameCommonPool.requestInstant(e.equipmentRankNormalEffect))&&null!=(e=e.getComponent(S.EquipmentRankEffect)))return e},O.createEquipmentRankSpecialEffect=function(){var e=r._instance;if(null!=e&&null!=(e=s.GameCommonPool.requestInstant(e.equipmentRankSpecialEffect))&&null!=(e=e.getComponent(cc.Animation)))return e},O.createCurrencyUI=function(e){var t=r._instance;null==t||null!=(t=s.GameCommonPool.requestInstant(t.currencyUI))&&(t.setParent(e),t.setPosition(cc.Vec2.ZERO))},O.createBubbleText=function(e,t,a,n){var o=r._instance;null==o||null!=(o=s.GameCommonPool.requestInstant(o.bubbleText))&&(o.setParent(e),o.setPosition(t),null!=(o=o.getComponent(C.BubbleText))&&o.bindData(a,n))},O.createBossBubbleText=function(e,t){var a=r._instance;null!=a&&s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.bossBubbleTextUrl,function(n,o){!n&&o&&(o.setParent(a.boardNode),o.setPosition(e.headPosition.add(cc.v2(0,100))),null!=(o=o.getComponent(W.BossBubbleText))&&o.bindData(e,t))})},O.createEquipmentItem=function(e,t,a,n,o,i,l,c){void 0===l&&(l=cc.Vec2.ZERO),void 0===c&&(c=1);var p=r._instance;if(null!=p&&null!=(p=s.GameCommonPool.requestInstant(p.equipmentmentItem))&&(p.setParent(e),p.setPosition(l),p.setScale(c),null!=(p=p.getComponent(_.EquipmentItem))))return p.bindData(t,a,n,o,i),p},O.showFailTipUI=function(e,t){var a=this,n=r._instance;null==n||n.failTipPop&&n.failTipPop.active?t&&t():(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.failTipUIPop,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(o=i.getComponent(k.FailTipUI))?(o.bindIndex(e,t),n.failTipPop=i):t&&t()):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showFailTipUI(e,t)},null)}))},O.showGetMoreGoldCoinUI=function(e){var t=this,a=r._instance;null!=a&&(a.getMoreGoldCoinPop&&a.getMoreGoldCoinPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.getMoreGoldCoin,function(n,o){H.CommonMask.hideMask(),null==n&&null!=o?(o.setParent(a.popNode),null!=(n=o.getComponent(P.getMoreGoldCoinUI))&&n.bindData(e),a.getMoreGoldCoinPop=o):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){t.showGetMoreGoldCoinUI(e)},null)})))},O.showInheritUI=function(e){var t=this,a=r._instance;null!=a&&(a.inheritPop&&a.inheritPop.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.inheritUIPop,function(n,o){H.CommonMask.hideMask(),null==n&&null!=o?(o.setParent(a.popNode),null!=(n=o.getComponent(B.InheritPopUI))&&n.bindData(e),a.inheritPop=o):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){t.showInheritUI(e)},null)})))},O.showEndlessRankingUI=function(){var e=this,t=r._instance;null!=t&&(t.endlessRankingUI&&t.endlessRankingUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.endlessRankingUI,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.endlessRankingUI=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showEndlessRankingUI()},null)})))},O.showEndlessRankingRewardUI=function(){var e=this,t=r._instance;null!=t&&(t.endlessRankingRewardUI&&t.endlessRankingRewardUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.endlessRankingRewardUI,function(a,n){H.CommonMask.hideMask(),null==a&&null!=n?(n.setParent(t.popNode),t.endlessRankingRewardUI=n):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){e.showEndlessRankingRewardUI()},null)})))},O.showEndlessReceiveRewardUI=function(e,t,a,n){var o=this,i=r._instance;null!=i&&(i.endlessReceiveRewardUI&&i.endlessReceiveRewardUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.endlessReceiveRewardUI,function(l,r){H.CommonMask.hideMask(),null==l&&null!=r?(r.setParent(i.popNode),null!=(r=(i.endlessReceiveRewardUI=r).getComponent(L.EndlessReceiveRewardUI))&&r.bindData(e,t,a,n)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){o.showEndlessReceiveRewardUI(e,t,a,n)},null)})))},O.showUnlockSkillUI=function(e,t){var a=this,n=r._instance;null!=n&&(n.unlockSkillUI&&n.unlockSkillUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.unlockSkillUI,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.unlockSkillUI=i).getComponent(G.UnlockSkillUI))&&i.bindData(e,t)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showUnlockSkillUI(e,t)},null)})))},O.showSkillDescriptionUI=function(e,t){var a=this,n=r._instance;null!=n&&(n.skillDescriptionUI&&n.skillDescriptionUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.skillDescriptionUI,function(o,i){H.CommonMask.hideMask(),null==o&&null!=i?(i.setParent(n.popNode),null!=(i=(n.skillDescriptionUI=i).getComponent(x.SkillDescriptionUI))&&i.bindData(e,t)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){a.showSkillDescriptionUI(e,t)},null)})))},O.showChapterProgressRewardUI=function(e,t,a,n,o){var i=this,l=r._instance;null!=l&&(l.chapterProgressRewardUI&&l.chapterProgressRewardUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.chapterProgressRewardUI,function(r,s){H.CommonMask.hideMask(),null==r&&null!=s?(s.setParent(l.popNode),null!=(s=(l.chapterProgressRewardUI=s).getComponent(F.ChapterProgressRewardUI))&&s.bindData(e,t,a,n,o)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){i.showChapterProgressRewardUI(e,t,a,n,o)},null)})))},O.showGetSkillUI=function(e,t,a){var n=this,o=r._instance;null!=o&&(o.getSkillUI&&o.getSkillUI.active||(H.CommonMask.showMask(),s.GameCommonPool.requestInstantByUrl(R.PrefabUrl.getSkillUI,function(i,l){H.CommonMask.hideMask(),null==i&&null!=l?(l.setParent(o.popNode),null!=(l=(o.getSkillUI=l).getComponent(U.GetSkillUI))&&l.bindData(e,t,a)):q.Loading.showWxModal("\u52a0\u8f7d\u6e38\u620f\u5931\u8d25","\u8bf7\u6253\u5f00\u7f51\u7edc\u540e\u91cd\u8bd5~",function(){n.showGetSkillUI(e,t,a)},null)})))},O.getGameNode=function(){var e=r._instance;if(null!=e)return e.gameNode},O._instance=null,O.isMainUI=!1,__decorate([o({displayName:"game\u8282\u70b9",type:cc.Node})],O.prototype,"gameNode",void 0),__decorate([o({displayName:"board\u8282\u70b9",type:cc.Node})],O.prototype,"boardNode",void 0),__decorate([o({displayName:"pop\u8282\u70b9",type:cc.Node})],O.prototype,"popNode",void 0),__decorate([o({displayName:"top\u8282\u70b9",type:cc.Node})],O.prototype,"topNode",void 0),__decorate([o({displayName:"\u94bb\u77f3\u56fe\u6807",type:cc.SpriteFrame})],O.prototype,"gemIcon",void 0),__decorate([o({displayName:"\u88c5\u5907\u54c1\u7ea7\u666e\u901a\u7279\u6548",type:cc.Prefab})],O.prototype,"equipmentRankNormalEffect",void 0),__decorate([o({displayName:"\u88c5\u5907\u54c1\u7ea7\u7279\u6b8a\u7279\u6548",type:cc.Prefab})],O.prototype,"equipmentRankSpecialEffect",void 0),__decorate([o({displayName:"\u8d27\u5e01ui",type:cc.Prefab})],O.prototype,"currencyUI",void 0),__decorate([o({displayName:"\u6c14\u6ce1ui",type:cc.Prefab})],O.prototype,"bubbleText",void 0),__decorate([o({type:cc.Prefab,displayName:"\u88c5\u5907Item\u9884\u5236"})],O.prototype,"equipmentmentItem",void 0),n=r=__decorate([n],O),i.UIManager=n,z.prototype.push=function(e){var t=this;this.tasks.push(new Promise(function(a){function o(){t.activeCount++;try{e().then(function(e){a(e)}).then(function(){t.next()}).catch(function(e){t.next(),console.error(e)})}catch(n){t.next(),console.error(n)}}t.activeCount<t.concurrency?o():t.queue.push(o)}))},z.prototype.all=function(){return Promise.all(this.tasks)},z.prototype.next=function(){this.activeCount--,0<this.queue.length&&this.queue.shift()()},z.prototype.addTask=function(e){this.push(function(){return new Promise(function(t){e(function(){t("")},function(){t("")})})})},z.addTask=function(e){null==this.instance&&(this.instance=new z),this.instance.addTask(e)},z.instance=null,i.PopUITaskManager=n=z,cc._RF.pop()},{}],UnlockSkillDetail:[function(e,t,a){"use strict";cc._RF.push(t,"07053JIBGFNRp8eAvLJY4If","UnlockSkillDetail");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("NumberImg"),s=n("GameConfigData"),c=n("GameCommonPool"),p=n("LocalData"),d=n("SpriteFrameManager"),u=n("ConfigData"),h=n("UIManager");function m(){var e=null!==l&&l.apply(this,arguments)||this;return e.skillIcons=[],e.skillNames=[],e.unlockChapterNum=null,e.skillDetailPosY=[167,87,7,-73],e.skillArray=null,e.buttonCanClick=!1,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(m,l),m.prototype.bindData=function(e){if(null!=e)if(e<=p.LocalData.data.passChapter||4<=e)this.close();else{switch(this.unlockChapterNum.value=e+"",e){case 1:this.skillArray=s.GameConfigData.data.ummonSectArray;break;case 2:this.skillArray=s.GameConfigData.data.recoveryAndBeatBackSectArray;break;case 3:this.skillArray=s.GameConfigData.data.berSerkSectArray}if(!(null==this.skillArray||this.skillArray.length<=0))for(var t=0;t<this.skillArray.length;t++){var a=this.skillArray[t];null!=a&&(this.skillIcons[t].spriteFrame=d.SpriteFrameManager.getSkillSpriteFrame(a),this.skillNames[t].string=u.ConfigData.skillName[a])}}else this.close()},m.prototype.refreshButtons=function(e){this.buttonCanClick=e},m.prototype.clickSkill1=function(e,t){var a;this.buttonCanClick&&(a=parseInt(t),null!=(t=this.skillArray[a])&&h.UIManager.showSkillDescriptionUI(t,this.skillDetailPosY[a]))},m.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u6280\u80fdicon\u96c6\u5408",type:cc.Sprite})],m.prototype,"skillIcons",void 0),__decorate([o({displayName:"\u6280\u80fd\u540d\u79f0\u96c6\u5408",type:cc.Label})],m.prototype,"skillNames",void 0),__decorate([o({displayName:"\u89e3\u9501\u6761\u4ef6\u76f8\u5173\u7ae0\u8282",type:r.NumberImg})],m.prototype,"unlockChapterNum",void 0),n=__decorate([n],m),i.UnlockSkillDetail=n,cc._RF.pop()},{}],UnlockSkillUI:[function(e,t,a){"use strict";cc._RF.push(t,"d2687czIYlBwJqXhaQKjXsm","UnlockSkillUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameConfigData"),s=n("SpriteFrameManager"),c=n("ConfigData"),p=n("GameCommonPool"),d=n("LocalSoundManager"),u=n("UIManager");function h(){var e=null!==l&&l.apply(this,arguments)||this;return e.unlockSkillIcons=[],e.unlockSkillNames=[],e.unlockSkillEffects=[],e.closeAction=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(h,l),h.prototype.update=function(){u.UIManager.isMainUI||p.GameCommonPool.returnInstant(this.node)},h.prototype.bindData=function(e,t){if(null!=e){this.closeAction=t;var a=null;switch(e){case 1:a=r.GameConfigData.data.ummonSectArray;break;case 2:a=r.GameConfigData.data.recoveryAndBeatBackSectArray;break;case 3:a=r.GameConfigData.data.berSerkSectArray}if(!(null==a||a.length<=0))for(var n=0;n<a.length;n++){var o=a[n];null!=o&&(this.unlockSkillIcons[n].spriteFrame=s.SpriteFrameManager.getSkillSpriteFrame(o),this.unlockSkillNames[n].string=c.ConfigData.skillName[o],this.unlockSkillEffects[n].opacity=255,this.unlockSkillEffects[n].stopAllActions(),this.unlockSkillEffects[n].runAction(cc.repeatForever(cc.sequence(cc.fadeTo(.1,120),cc.fadeTo(.1,255)))))}}},h.prototype.clickConfirm=function(){d.LocalSoundManager.playAudio("click"),this.close()},h.prototype.close=function(){this.closeAction&&this.closeAction(),p.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u89e3\u9501\u6280\u80fdicon\u96c6\u5408",type:cc.Sprite})],h.prototype,"unlockSkillIcons",void 0),__decorate([o({displayName:"\u89e3\u9501\u6280\u80fd\u540d\u79f0\u96c6\u5408",type:cc.Label})],h.prototype,"unlockSkillNames",void 0),__decorate([o({displayName:"\u89e3\u9501\u6280\u80fd\u7279\u6548\u8282\u70b9\u96c6\u5408",type:cc.Node})],h.prototype,"unlockSkillEffects",void 0),n=__decorate([n],h),i.UnlockSkillUI=n,cc._RF.pop()},{}],UserData:[function(e,t,a){"use strict";cc._RF.push(t,"53012c5wqVB8o0Z7aOQXcg/","UserData");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("GameCommonUtil"),l=n("GameCommon");function r(){this.playerId=i.GameCommonUtil.uuid(),this.openId=null,this.sessionKey=null,this.coin=0,this.gameSound=!0,this.otherData=null,this.loginRewardCanRecieveCount=1,this.loginRewardRecievedCount=0,this.lastLoginTime=Date.now(),this.freeDialCard=r.maxFreeDialCard,this.shareDialCard=r.maxShareDialCard,this.videoDialCard=r.maxVideoDialCard,this.levelShareSuccCount=0,this.recieveAddGameReward=!1,this.adOpen=0,this.adSuccess=0,this.shareSuccess=0,this.stayTime=0,this.passPart=0,this.detailExports=[],this.detailClicks=[],this.moduleShows=[],this.uploadEventData=null,this.gender=null,this.dataVersion=1}n=function(){this.adOpen=0,this.adSuccess=0,this.shareSuccess=0},o.UserActions=n,r.resetUserActions=function(){this.userActions.adOpen=0,this.userActions.adSuccess=0,this.userActions.shareSuccess=0},r.addModuleShows=function(e,t){for(var a=0;a<this.data.moduleShows.length;a++){var n=this.data.moduleShows[a];if(n&&n.moduleType==e)return void(n.count+=t)}var o=new p;o.moduleType=e,o.count=t,this.data.moduleShows.push(o)},r.addDetailExportsData=function(e,t,a,n,o){void 0===a&&(a=null),void 0===n&&(n=null),void 0===o&&(o=1);for(var i=0;i<this.data.detailExports.length;i++){var l=this.data.detailExports[i];if(l&&l.moduleType==e&&l.targetAppId==t&&l.itemOrder==a&&l.part==n)return void(l.count+=o)}var r=new s;r.moduleType=e,r.targetAppId=t,r.itemOrder=a,r.part=n,r.count=o,this.data.detailExports.push(r)},r.addDetailClicksData=function(e,t,a,n,o){void 0===a&&(a=null),void 0===n&&(n=null),void 0===o&&(o=1);for(var i=0;i<this.data.detailClicks.length;i++){var l=this.data.detailClicks[i];if(l&&l.moduleType==e&&l.targetAppId==t&&l.itemOrder==a&&l.part==n)return void(l.count+=o)}var r=new s;r.moduleType=e,r.targetAppId=t,r.itemOrder=a,r.part=n,r.count=o,this.data.detailClicks.push(r)},r.getJsonStr=function(){var e=JSON.stringify(this.data);return console.log(e),e},r.parseFromStr=function(e){if(this.init=!0,null!=e&&""!=e&&"string"==typeof e){this.newUser=!1;try{var t=JSON.parse(e);if(null==t)return;null!=t.playerId&&(this.data.playerId=t.playerId),null!=t.openId&&(this.data.openId=t.openId),null!=t.coin&&(this.data.coin=t.coin),null!=t.gameSound&&(this.data.gameSound=t.gameSound),null!=t.otherData&&(this.data.otherData=t.otherData),null!=t.loginRewardRecievedCount&&(this.data.loginRewardRecievedCount=t.loginRewardRecievedCount),null!=t.loginRewardCanRecieveCount&&(this.data.loginRewardCanRecieveCount=t.loginRewardCanRecieveCount),null!=t.lastLoginTime&&(i.GameCommonUtil.isToday(t.lastLoginTime)?(null!=t.freeDialCard&&(this.data.freeDialCard=t.freeDialCard),null!=t.shareDialCard&&(this.data.shareDialCard=t.shareDialCard),null!=t.videoDialCard&&(this.data.videoDialCard=t.videoDialCard)):(this.data.loginRewardCanRecieveCount=this.data.loginRewardRecievedCount+1,this.data.freeDialCard=r.maxFreeDialCard,this.data.shareDialCard=r.maxShareDialCard,this.data.videoDialCard=r.maxVideoDialCard)),this.data.lastLoginTime=Date.now(),null!=t.levelShareSuccCount&&(this.data.levelShareSuccCount=t.levelShareSuccCount),null!=t.recieveAddGameReward&&(this.data.recieveAddGameReward=t.recieveAddGameReward),null!=t.sessionKey&&(this.data.sessionKey=t.sessionKey),null!=t.stayTime&&(this.data.stayTime=t.stayTime),null!=t.passPart&&(this.data.passPart=t.passPart),t.detailClicks&&(this.data.detailClicks=t.detailClicks),t.detailExports&&(this.data.detailExports=t.detailExports),t.shareSuccCount&&(this.data.shareSuccess=t.shareSuccCount),t.videoSuccCount&&(this.data.adSuccess=t.videoSuccCount),null!=t.adOpen&&(this.data.adOpen=t.adOpen),null!=t.adSuccess&&(this.data.adSuccess=t.adSuccess),null!=t.shareSuccess&&(this.data.shareSuccess=t.shareSuccess),null!=t.uploadEventData&&(this.data.uploadEventData=t.uploadEventData),null!=t.gender&&(this.data.gender=t.gender),null!=t.moduleShows&&(this.data.moduleShows=t.moduleShows),null!=t.dataVersion&&(this.data.dataVersion=t.dataVersion)}catch(e){console.log(e)}}},r.getUploadEventData=function(){var e,t=r.data.uploadEventData,a={};if(a.eventId=t?t.eventId:i.GameCommonUtil.uuid(),a.uuid=r.data.playerId,a.stayTime=t?t.stayTime+r.data.stayTime:r.data.stayTime,a.version=l.GameConfig.versionCode,null!=this.data.gender&&(a.gender=this.data.gender),0<r.data.passPart?(e=null!=t&&null!=t.events&&null!=t.events[0]?t.events[0].value:0,(f=[]).push({code:"passPart",value:r.data.passPart+e}),a.events=f):null!=t&&null!=t.events&&(a.events=t.events),null!=r.data.detailExports&&0<r.data.detailExports.length){if(null!=t&&null!=t.detailExports)for(var n=0,o=t.detailExports;n<o.length;n++){var s=o[n];null!=s&&r.addDetailExportsData(s.moduleType,s.targetAppId,s.itemOrder,s.part,s.count)}a.detailExports=r.data.detailExports}else null!=t&&null!=t.detailExports&&(a.detailExports=t.detailExports);if(null!=r.data.detailClicks&&0<r.data.detailClicks.length){if(null!=t&&null!=t.detailClicks)for(var c=0,p=t.detailClicks;c<p.length;c++){var d=p[c];null!=d&&r.addDetailClicksData(d.moduleType,d.targetAppId,d.itemOrder,d.part,d.count)}a.detailClicks=r.data.detailClicks}else null!=t&&null!=t.detailClicks&&(a.detailClicks=t.detailClicks);if(null!=r.data.moduleShows&&0<r.data.moduleShows.length){if(null!=t&&null!=t.moduleShows)for(var u=0,h=t.moduleShows;u<h.length;u++){var m=h[u];null!=m&&r.addModuleShows(m.moduleType,m.count)}a.moduleShows=r.data.moduleShows}else null!=t&&null!=t.moduleShows&&(a.moduleShows=t.moduleShows);if(null!=r.userActions){var f=[];if(null!=t&&null!=t.actions)for(var g=0,y=t.actions;g<y.length;g++){var v=y[g];null!=v&&("adOpen"==v.code&&(r.userActions.adOpen+=v.value),"adSuccess"==v.code&&(r.userActions.adSuccess+=v.value),"shareSuccess"==v.code&&(r.userActions.shareSuccess+=v.value))}f.push({code:"adOpen",value:r.userActions.adOpen}),f.push({code:"adSuccess",value:r.userActions.adSuccess}),f.push({code:"shareSuccess",value:r.userActions.shareSuccess}),a.actions=f}else null!=t&&null!=t.actions&&(a.actions=t.actions);return r.resetUserActions(),r.data.stayTime=0,r.data.passPart=0,r.data.detailExports=[],r.data.detailClicks=[],r.data.moduleShows=[],r.data.uploadEventData=a},r.userActions=new n,r.storageKey="userData",r.maxFreeDialCard=3,r.maxShareDialCard=2,r.maxVideoDialCard=50,r.data=new r,r.init=!1,r.newUser=!0,r.lastOnShowTime=0,o.UserData=n=r;var s=function(){this.moduleType=c.CAROUSEL_BUTTON,this.targetAppId=null,this.itemOrder=null,this.part=null,this.count=null};o.DetailExport=s;var c,p=function(){this.moduleType=c.CAROUSEL_BUTTON,this.count=0};o.ExportModuleShow=p,(o=c=o.ExportTypeEnum||(o.ExportTypeEnum={}))[o.CAROUSEL_BUTTON=1]="CAROUSEL_BUTTON",o[o.MORE_GAME=2]="MORE_GAME",o[o.HORIZONTA_GAME_BOX=3]="HORIZONTA_GAME_BOX",o[o.PASS_MORE_GAME=4]="PASS_MORE_GAME",o[o.NEW_MORE_GAME=5]="NEW_MORE_GAME",o[o.PASS_PART_MORE_GAME=6]="PASS_PART_MORE_GAME",o[o.BACK_HOME_MORE_GAME=7]="BACK_HOME_MORE_GAME",o[o.BOY_MORE_GAME=8]="BOY_MORE_GAME",o[o.AD_FRAMES_MORE_GAME=9]="AD_FRAMES_MORE_GAME",o[o.OTHER_MORE_GAME=100]="OTHER_MORE_GAME",cc._RF.pop()},{}],UserStorage:[function(e,t,a){"use strict";cc._RF.push(t,"8d5bbKfuP5BLIR21rDr3OiX","UserStorage");var n=a;function o(){this.uuid=null,this.openId=null,this.gender=null,this.sourceAppId=null,this.sessionSourceAppId=null,this.wxAdInfo=null,this.sesseionWxAdInfo=null}Object.defineProperty(n,"__esModule",{value:!0}),o.parseFromStr=function(e){if(this.data=new o,null==e||""==e||"string"!=typeof e)return!1;try{var t=JSON.parse(e);return null!=t&&(null!=t.uuid&&(this.data.uuid=t.uuid),null!=t.openId&&(this.data.openId=t.openId),null!=t.sourceAppId&&(this.data.sourceAppId=t.sourceAppId),null!=t.sessionSourceAppId&&(this.data.sessionSourceAppId=t.sessionSourceAppId),null!=t.wxAdInfo&&(this.data.wxAdInfo=t.wxAdInfo),null!=t.sesseionWxAdInfo&&(this.data.sesseionWxAdInfo=t.sesseionWxAdInfo),null!=t.uuid&&(this.data.uuid=t.uuid),null!=t.gender&&(this.data.gender=t.gender),!0)}catch(e){return console.error(e),!1}},o.KEY="userStorage",o.data=null,n.UserStorage=o,cc._RF.pop()},{}],Util:[function(e,t,a){"use strict";cc._RF.push(t,"1a4a0iB2vNEur+sx5J6GLcb","Util");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.prototype.onLoad=function(){o.instance=this},o.getDistance=function(e,t){return null==e||null==t?0:Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},o.getRandomNum=function(e,t){if(e==t)return e;var a=t<e?t:e;return t=(t<e?e+1:t+1)-a,Math.floor(Math.random()*t)+a},o.getRandomFloatNum=function(e,t){return e+(t-e)*Math.random()},o.getAngle=function(e,t){return null==e||null==t?0:Math.atan2(e.y-t.y,e.x-t.x)*(180/Math.PI)},o.getVectorsAngle=function(e,t){return null==e||null==t?0:(Math.atan2(t.y,t.x)-Math.atan2(e.y,e.x))*(180/Math.PI)},o.rotateAngle=function(e,t){if(null==e)return cc.v2();var a=Math.PI/180*t,n=Math.sin(a);return t=Math.cos(a),a=e.x*t+e.y*n,t=-e.x*n+e.y*t,cc.v2(a,t)},o.posInRect=function(e,t,a){Math.abs(e.x)<.01&&(e.x=.01*Math.sign(e.x)),Math.abs(e.y)<.01&&(e.y=.01*Math.sign(e.y));var n=cc.v2(0,0),o=e.x*e.y,i=e.y/e.x,l=a/t;return 0<o&&l<i&&0<e.y||o<0&&i<-l&&0<e.y?(n.x=a*(e.x/e.y),n.y=a):0<o&&l<i&&e.y<0||o<0&&i<-l&&e.y<0?(n.x=-a*(e.x/e.y),n.y=-a):0<o&&i<l&&0<e.x||o<0&&-l<i&&0<e.x?(n.x=t,n.y=e.y/e.x*t):(0<o&&i<l&&e.x<0||o<0&&-l<i&&e.x<0)&&(n.x=-t,n.y=e.y/e.x*-t),n},o.getAnlgeByDirection=function(e,t){e=Math.atan2(e.y,e.x);var a=0;switch(t){case 0:a=0;break;case 1:a=90;break;case 2:a=180;break;case 3:a=270}return e*(180/Math.PI)+a},o.getRandomIndexInChanceArray=function(e,t){if(void 0===t&&(t=1),null==e||e.length<=0)return null;for(var a=Math.random()*t,n=0,o=0,i=0,l=e;i<l.length;i++){if(a<=(o+=l[i]))return n;n++}return 0},o.getRandomValueFromArray=function(e){if(null==e||e.length<=0)return null;var t=e.length,a=Math.random();return e[Math.floor(a*t)]},o.getNumRange=function(e,t){return.5<Math.random()&&(t*=-1),e+t*Math.random()},o.getRandomArrayElements=function(e,t){if(!(null==e||e.length<=0||t>e.length||t<=0))return e.sort(function(){return.5<Math.random()?1:-1}),e.slice(0,t)},o.letEnumNumInArray=function(e,t){if(!(null==t||t.length<0)){for(var a in e){if(null==a)return;isNaN(a)||t.push(+a)}return t}},o.arrayIntersection=function(e,t){if(null==e||null==t||e.length<=0||t.length<=0)return[];var a=new Array;return e.forEach(function(e){-1!=t.indexOf(e)&&a.push(e)}),a},o.arrayRemoveRepeatElements=function(e){if(null==e||e.length<=0)return[];for(var t=[],a={},n=0,o=e;n<o.length;n++){var i=o[n];a[i]||(t.push(i),a[i]=1)}return t},o.instance=null,n.Util=o,cc._RF.pop()},{}],VersionShow:[function(e,t,a){"use strict";cc._RF.push(t,"aa166F/NXlLF5iTCPIE2fjK","VersionShow");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("GameCommon");function s(){var e=null!==l&&l.apply(this,arguments)||this;return e.versionLable=null,e.isShowLog=!0,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(s,l),s.prototype.onLoad=function(){this.versionLable.string="v"+r.GameConfig.versionCode+"."+r.GameConfig.versionSuffix,this.isShowLog||(console.log=console.info=function(){})},__decorate([o({displayName:"\u7248\u672c\u53f7",type:cc.Label})],s.prototype,"versionLable",void 0),__decorate([o({displayName:"\u662f\u5426\u663e\u793alog"})],s.prototype,"isShowLog",void 0),n=__decorate([n],s),i.VersionShow=n,cc._RF.pop()},{}],VideoManager:[function(e,t,a){"use strict";cc._RF.push(t,"215b7cHiSVPLaWfmbUJGECC","VideoManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("UserData"),l=n("ShareManager"),r=n("TipManager"),s=n("GameCommonUtil");function c(){}c.addVideoIns=function(e){null!=e&&null!=e.videoAdUnitId&&this.videoAdMap.set(e.videoAdUnitId,e)},c.hasVideoIns=function(e){return null!=e&&null!=this.videoAdMap.get(e)},c.createVideoIns=function(e){var t=this.getVideoIns(e);if(null!=t)return t;var a=window.gameCommon.getSDK.getSystemInfo();return null!=a&&s.GameCommonUtil.compareVersion(a.SDKVersion,"2.8.0")<0&&null!=(t=(a=Array.from(this.videoAdMap.values()))&&a[0])?(t.reInitVideoAd(e,null),this.videoAdMap.clear()):(t=new p).initVideoAd(e,null),this.addVideoIns(t),t},c.createAndShowVideoIns=function(e,t,a,n,o){void 0===o&&(o=null);var i=this.getVideoIns(e);if(null!=i)return i;var l=window.gameCommon.getSDK.getSystemInfo();return null!=l&&s.GameCommonUtil.compareVersion(l.SDKVersion,"2.8.0")<0&&(l=Array.from(this.videoAdMap.values()),null!=(i=l&&l[0]))?(i.loadSuccessCall=function(){i.showVideoAd(t,a,n)},i.reInitVideoAd(e,o),this.videoAdMap.clear()):((i=new p).loadSuccessCall=function(){i.showVideoAd(t,a,n)},i.initVideoAd(e,o)),this.addVideoIns(i),i},c.getVideoIns=function(e){return null==e?null:this.videoAdMap.get(e)},c.hasVideoAdShow=function(){var e=!1;return this.videoAdMap.forEach(function(t){null!=t&&(e=e||t.videoAdShow)}),e},c.videoAdMap=new Map,n=c,o.VideoManager=n;var p=(d.prototype.initVideoAd=function(e,t){var a=this;if(cc.sys.platform===cc.sys.WECHAT_GAME&&null!=e&&null!=wx&&null!=wx.createRewardedVideoAd&&"function"==typeof wx.createRewardedVideoAd){this.videoAdUnitId=e,this.noVideoCall=t;try{if(this.videoAd=wx.createRewardedVideoAd({adUnitId:e,multiton:!0}),!this.videoAd)return this.noVideoCall&&this.noVideoCall(),void(this.noVideoCall=null);this.videoAd.onLoad(this.loadCallBack.bind(this)),this.videoAd.onError(function(e){a.timeoutId&&clearTimeout(a.timeoutId),a.timeoutId=null,a.noVideoCall&&a.noVideoCall(),a.noVideoCall=null,a.errorCallBack&&a.errorCallBack(e)}),this.videoAd.onClose(this.closeVedioCallBack.bind(this)),this.timeoutId=setTimeout(function(){t&&t()},5e3)}catch(e){console.error(e),this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=null,this.noVideoCall&&this.noVideoCall(),this.noVideoCall=null}}},d.prototype.reInitVideoAd=function(e,t){var a=this;if(null==this.videoAd)return this.initVideoAd(e,t);if(cc.sys.platform===cc.sys.WECHAT_GAME&&null!=e&&null!=wx&&null!=wx.createRewardedVideoAd&&"function"==typeof wx.createRewardedVideoAd){this.videoAdUnitId=e;try{if(this.videoAd=wx.createRewardedVideoAd({adUnitId:e,multiton:!0}),!this.videoAd)return;this.videoAdReady=!1,this.videoAd.load().then(function(){a.videoAdReady=!0,a.loadSuccessCall&&a.loadSuccessCall(),a.loadSuccessCall=null}).catch(function(e){console.error(e)})}catch(e){console.error(e)}}},d.prototype.loadCallBack=function(){this.videoAdReady=!0,this.loadSuccessCall&&this.loadSuccessCall(),this.loadSuccessCall=null,this.timeoutId&&clearTimeout(this.timeoutId),this.timeoutId=null,this.noVideoCall=null},d.prototype.errorCallBack=function(e){console.error(e)},d.prototype.closeVedioCallBack=function(e){this.videoAdShow=!1,this.videoStartTime&&((Date.now()-this.videoStartTime)/1e3).toFixed(2),e&&e.isEnded||void 0===e?(this.endCallBack&&this.endCallBack(),i.UserData.data.adSuccess++,i.UserData.userActions.adSuccess++):this.closeCallBack&&this.closeCallBack()},d.prototype.hasVideoAd=function(){var e=this;return!(!l.ShareManager.getVideoAdControl()||null==this.videoAd||!this.videoAdReady&&(this.videoAd.load().then(function(){e.videoAdReady=!0}).catch(function(e){console.error(e)}),1))},d.prototype.showVideoAd=function(e,t,a){var n=this;if(l.ShareManager.getVideoAdControl())if(this.videoAdShow)t&&t();else{if(null==this.videoAd)return this.initVideoAd(this.videoAdUnitId,null),r.TipManager.showTip("\u554a\u5440\uff0c\u89c6\u9891\u8fd8\u6ca1\u9001\u8fbe\uff0c\u7b49\u4e00\u4e0b\u518d\u8bd5\u8bd5\u5427~"),void(t&&t());this.videoAdShow=!0,this.videoAd.load().then(function(){a&&a(),n.videoAd.show().then(function(){i.UserData.data.adOpen++,i.UserData.userActions.adOpen++,n.videoAdReady=!1,n.endCallBack=e,n.closeCallBack=t,n.videoStartTime=Date.now()}).catch(function(e){console.error(e),n.videoAdShow=!1,t&&t(),r.TipManager.showTip("\u554a\u5440\uff0c\u89c6\u9891\u8fd8\u6ca1\u9001\u8fbe\uff0c\u7b49\u4e00\u4e0b\u518d\u8bd5\u8bd5\u5427~")})}).catch(function(e){console.error(e),n.videoAdShow=!1,t&&t(),r.TipManager.showTip("\u554a\u5440\uff0c\u89c6\u9891\u8fd8\u6ca1\u9001\u8fbe\uff0c\u7b49\u4e00\u4e0b\u518d\u8bd5\u8bd5\u5427~")})}else e&&e()},d);function d(){this.videoAdUnitId=null,this.videoAd=null,this.videoAdReady=!1,this.endCallBack=null,this.closeCallBack=null,this.videoStartTime=null,this.videoAdShow=!1,this.loadSuccessCall=null,this.timeoutId=null,this.noVideoCall=null}o.VideoAdIns=p,cc._RF.pop()},{}],Water:[function(e,t,a){"use strict";cc._RF.push(t,"747ee65/eNAibbtmrHtPRBG","Water");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("WorldEventManager"),s=n("LocalWorldEventType"),c=n("GameCommonPool"),p=n("LocalSoundManager");function d(){var e=null!==l&&l.apply(this,arguments)||this;return e.waterAnimation=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(d,l),d.prototype.onEnable=function(){p.LocalSoundManager.playAudio("water"),r.WorldEventManager.addListener(s.LocalWorldEventType.BackHome,this.close,this),this.waterAnimation.play("Water"),this.waterAnimation.on("finished",this.close,this)},d.prototype.onDisable=function(){r.WorldEventManager.removeListener(s.LocalWorldEventType.BackHome,this.close,this),this.waterAnimation.off("finished",this.close,this)},d.prototype.close=function(){c.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u52a8\u753b\u7ec4\u4ef6",type:cc.Animation})],d.prototype,"waterAnimation",void 0),n=__decorate([n],d),i.Water=n,cc._RF.pop()},{}],WebSDK:[function(e,t,a){"use strict";cc._RF.push(t,"f9ebcXqCXFFJaBnQsDk5F/+","WebSDK");var n=a;function o(){}Object.defineProperty(n,"__esModule",{value:!0}),o.prototype.getSystemInfo=function(){return null},o.prototype.getLaunchOptions=function(){return null},o.prototype.registerOnShow=function(e){null!=e&&e(null)},o.prototype.registerOnHide=function(e){null!=e&&e()},o.prototype.isPhoneXScreen=function(){return!1},o.prototype.appGameOnLanch=function(){},o.prototype.share=function(e,t,a,n){n&&n(null,!0)},o.prototype.levelShare=function(e,t){t&&t(!0,!1)},o.prototype.clearTripleLie=function(){},o.prototype.navigateToMiniProgram=function(e,t,a){a&&a(!1)},o.prototype.vibrateShort=function(){},o.prototype.vibrateLong=function(){},o.prototype.wxInitData=function(){},o.prototype.setStorage=function(){},o.prototype.getStorage=function(){return null},o.prototype.previewImage=function(){},o.prototype.showFeedbackButton=function(){},o.prototype.destroyFeedbackButton=function(){},o.prototype.showWxModal=function(){},o.prototype.getMenuButtonBoundingClientRect=function(){return null},o.prototype.showWxLoading=function(){},o.prototype.popWxAuthorization=function(){},n.WebSDK=o,cc._RF.pop()},{}],WizardEnemy:[function(e,t,a){"use strict";cc._RF.push(t,"334ddFjSmlPqoMXIJfLI1GH","WizardEnemy");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("Head"),s=n("GameManager"),c=n("EnumAndConst"),p=n("MagicBall"),d=n("Timer"),u=n("WorldEventManager"),h=n("LocalWorldEventType"),m=n("BattleNodeManager"),f=n("GameCommonPool"),g=n("EnemyArea"),y=n("RoleBase"),v=n("RoleManager"),D=n("GameState"),E=n("EffectCreate"),S=n("GameConfigData"),A=n("EndlessModelConfigData"),C=n("SpecailSkill"),M=n("EquipmentEffectSystem");function T(){var e=null!==l&&l.apply(this,arguments)||this;return e.fireBallPrefab=null,e.iceBallPrefab=null,e.wandPrefab=null,e.attackCd=3,e.wand=null,e.teleportTime=0,e.isMagicShooting=!1,e.attackTimer=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=y.RoleBase,__extends(T,l),T.prototype.onEnable=function(){u.WorldEventManager.addListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.addListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.addListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this),this.roleData=null,this.head=null,this.wand=null,this.footRest=null,this.teleportTime=0,this.isMagicShooting=!1,this.isHitAniRunning=!1,this.attackTimer=null,this.isWaitingRevive=!1},T.prototype.onDisable=function(){u.WorldEventManager.removeListener(h.LocalWorldEventType.BackHome,this.close,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.PlayerRevive,this.isReviveKnocked,this),u.WorldEventManager.removeListener(h.LocalWorldEventType.EnemyRevive,this.enemyRevive,this)},T.prototype.update=function(e){null!=this.roleData&&(this.refreshDeadState(),this.refresReviveState(),this.teleport(e))},T.prototype.lateUpdate=function(){null!=this.roleData&&(this.roleData.logicPos=this.node.position)},T.prototype.bindData=function(e,t,a){this.roleData=e;var n=a.getComponent(r.Head);null!=n&&(this.head=n,this.head.bindData(e)),null!=(a=a.getComponent(cc.Collider))&&this.spineController.bindData(e,t,a),this.equipFootRest(),this.equipWand(),this.attack()},T.prototype.attack=function(){var e,t=this;null==this.roleData||this.roleData.isDead||!D.GameState.isGaming||this.roleData.isFrozening||(this.isHitAniRunning=!1,this.spineController.playAnimation(c.SpineAniNameEnum.Magic_st,!1,!0,null),e=this.attackCd,D.GameState.endlessModel?e/=A.EndlessModelConfigData.getEndlessEnemyAttackFrequency(D.GameState.currentPart):D.GameState.heroModel&&(e/=S.GameConfigData.data.heroEnemyAttackFrequency),this.attackTimer=d.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||t.roleData.isDestroy||(t.shootMagicBall(),t.attackTimer=null)},this.node))},T.prototype.shootMagicBall=function(){var e=this;if(null!=this.roleData&&!this.roleData.isDead&&!this.roleData.isTeleporting){var t=m.BattleNodeManager.getParentNode(c.BattleNodeEnum.PARTICLE_NODE);if(null!=t){this.isMagicShooting=!0;var a=this.roleData.profession==c.ProfessionEnum.FIRE_WIZARD,n=this.createMaigcBall(a);n.forEach(function(e){e.setParent(t),e.scale=0,e.runAction(cc.scaleTo(.5,1))}),this.spineController.magicBalls=n,this.spineController.refreshMagicBalls();for(var o=this,i=0;i<n.length;i++)!function(t){d.TimerManager.addTimer(1+.3*t,function(){var n;null==e.roleData||e.roleData.isDead||e.roleData.isDestroy||null!=(n=e.spineController.magicBalls.shift().getComponent(p.MagicBall))&&n.bindData(t,a,e.roleData,80)},o.node)}(i);this.isHitAniRunning=!1,this.spineController.playAnimation(c.SpineAniNameEnum.Magic_atk,!1,!1,function(){e.isMagicShooting=!1,e.attack()})}}},T.prototype.createMaigcBall=function(e){var t=[];if(e=e?this.fireBallPrefab:this.iceBallPrefab,null!=(e=f.GameCommonPool.requestInstant(e)))return t.push(e),t},T.prototype.teleport=function(e){var t,a=this;!D.GameState.isGaming||null==this.roleData||this.roleData.isDead||this.isMagicShooting||(this.teleportTime+=e,this.teleportTime<5||this.roleData.isFrozening)||(this.teleportTime=0,this.roleData.isTeleporting=!0,E.EffectCreate.createAppearEffect(this.roleData.logicPos),t=this.roleData.logicPos.clone(),this.node.position=cc.v2(1e4,-1e4),this.footRest&&this.footRest.updatePosition(this.node.position),this.attackTimer&&this.attackTimer.pauseTimer(),d.TimerManager.addTimer(.8,function(){if(null!=a.roleData&&!a.roleData.isDead&&!a.roleData.isDestroy){g.EnemyArea.setEnemyPostionMap(t.x,null);var e=g.EnemyArea.getEmptyPosition(a.roleData);if(null==e)return a.node.position=a.roleData.logicPos,void(a.footRest&&a.footRest.updatePosition());a.roleData.logicPos=e,E.EffectCreate.createAppearEffect(a.roleData.logicPos),a.node.position=a.roleData.logicPos,a.footRest&&a.footRest.updatePosition(),g.EnemyArea.setEnemyPostionMap(a.roleData.logicPos.x,a.roleData),a.roleData.isTeleporting=!1,a.attackTimer&&a.attackTimer.resumeTimer()}},this.node))},T.prototype.isHit=function(){var e=this;null==this.roleData||this.roleData.isDead||this.isMagicShooting?this.isHitAniRunning=!1:this.isHitAniRunning||(this.node.stopAllActions(),this.attackTimer&&this.attackTimer.pauseTimer(),this.isHitAniRunning=!0,this.spineController.playAnimation(c.SpineAniNameEnum.Fankui,!1,!1,function(){e.isHitAniRunning=!1,e.spineController.playAnimation(c.SpineAniNameEnum.Magic_st,!1,!0,null),e.attackTimer&&e.attackTimer.resumeTimer()}),this.roleData.isFrozening&&this.spineController.pauseAnimation(!0))},T.prototype.isFroze=function(){var e,t=this;null==this.roleData||this.roleData.isDead||(this.roleData.isFrozening=!0,this.spineController.pauseAnimation(!0),d.TimerManager.pasueAllTimers(this.node),e=this.roleData.frozenTime,d.TimerManager.addTimer(e,function(){null==t.roleData||t.roleData.isDead||(t.roleData.isFrozening=!1,t.spineController.pauseAnimation(!1),d.TimerManager.resumeAllTimers(t.node))},this.node))},T.prototype.equipWand=function(){var e,t=f.GameCommonPool.requestInstant(this.wandPrefab);null==t||null!=(e=m.BattleNodeManager.getParentNode(c.BattleNodeEnum.HELMET_NODE))&&(t.setParent(e),t.setPosition(cc.v2(9999,9999)),this.wand=t,this.spineController.eqiupWand(t))},T.prototype.isReviveKnocked=function(){null==this.roleData||this.roleData.isDead||(this.attack(),v.RoleManager.hitRole(this.roleData))},T.prototype.enemyRevive=function(e){null!=e&&null!=e.roleData&&e.roleData==this.roleData&&(f.GameCommonPool.returnInstant(this.footRest.node),this.footRest=null,this.close())},T.prototype.die=function(){var e,t=this;this.roleData.isFalledDown||(this.roleData.isFalledDown=!0,this.roleData.isFrozening=!1,this.node.stopAllActions(),this.spineController.pauseAnimation(!1),d.TimerManager.removeAllTimers(this.node),s.GameManager.killEnemy(this.roleData),M.EquipmentEffectSystem.killEnemyRestore(this.roleData.killerData),e=this.roleData.headDroped?c.SpineAniNameEnum.D2:c.SpineAniNameEnum.D,this.spineController.playAnimation(e,!1,!1,function(){var e=null!=g.EnemyArea.necromancer&&g.EnemyArea.reviveReady&&null==g.EnemyArea.necromancer.targetData;if(t.roleData.isEnemy&&e)return t.isWaitingRevive=!0,void g.EnemyArea.necromancer.reviveEnemy(t.roleData);d.TimerManager.addTimer(.1,function(){if(null!=t.roleData){if(f.GameCommonPool.returnInstant(t.footRest.node),t.footRest=null,C.SpecailSkill.killBlast(t.roleData))return t.roleData.isDestroy=!0,void t.close();t.node.runAction(cc.sequence(cc.moveBy(2,0,-600),cc.callFunc(function(){t.roleData.isDestroy=!0,t.close()})))}})}))},T.prototype.close=function(){null!=this.wand&&f.GameCommonPool.returnInstant(this.wand),null==this.head||this.roleData.headDroped||(null!=this.head.helmet&&this.head.helmet.close(),null!=this.head.node&&this.head.node.destroy()),f.GameCommonPool.returnInstant(this.node)},__decorate([o({displayName:"\u706b\u7403",type:cc.Prefab})],T.prototype,"fireBallPrefab",void 0),__decorate([o({displayName:"\u51b0\u7403",type:cc.Prefab})],T.prototype,"iceBallPrefab",void 0),__decorate([o({displayName:"\u6cd5\u6756\u9884\u8bbe",type:cc.Prefab})],T.prototype,"wandPrefab",void 0),n=__decorate([n],T),i.WizardEnemy=n,cc._RF.pop()},{}],WorldEventManager:[function(e,t,a){"use strict";cc._RF.push(t,"85057F/Mv1D7YsHgLssY5iw","WorldEventManager");var n=t,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i,l,r=cc._decorator;function s(){return null!==i&&i.apply(this,arguments)||this}n=r.ccclass,r.property,i=cc.Component,__extends(s,i),(l=s).prototype.onLoad=function(){l.worldEventNode=this.node},s.addListener=function(e,t,a){null!=l.worldEventNode&&l.worldEventNode.on(e,t,a,!1)},s.removeListener=function(e,t,a){null!=l.worldEventNode&&l.worldEventNode.off(e,t,a)},s.triggerEvent=function(e,t){null!=l.worldEventNode&&l.worldEventNode.emit(e,t)},s.worldEventNode=null,n=l=__decorate([n],s),o.WorldEventManager=n,cc._RF.pop()},{}],WorldEventType:[function(e,t,a){"use strict";cc._RF.push(t,"fc3f3r1otFH0J60Bx2lBF2C","WorldEventType");var n=a;Object.defineProperty(n,"__esModule",{value:!0}),(n=n.WorldEventType||(n.WorldEventType={})).GetUserDataFinish="GetUserDataFinish",n.GetShareFlagFinish="GetShareFlagFinish",n.GetAllFinish="GetAllFinish",cc._RF.pop()},{}],WorldRankingManager:[function(e,t,a){"use strict";cc._RF.push(t,"03a93CvlEZGe4WY4hcwz25h","WorldRankingManager");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("UserData"),l=n("LocalData"),r=n("GameCommonHttp");function s(){}s.postUserWorldData=function(e){var t=l.LocalData.data.userInfo;if(null!=t&&!(e<=0)){if(this.initWorldDatas){if(null==this.userWorldData&&(this.userWorldData=new c(!0,t.nickName,t.avatarUrl,0,1e4)),e<=this.userWorldData.part)return;this.userWorldData.part=e,this.updateLocalRankDatas()}e={openId:"",uuid:i.UserData.data.playerId,nickname:t.nickName,head:t.avatarUrl,part:e},r.GameCommonHttp.wxHttpPost("https://hsws.dcgstd.cn/rank-service/api/wx/rank/upload",e,null)}},s.getWorldData=function(e){var t=this;this.worldDatas=[],this.initWorldDatas=!0;var a={openId:"",uuid:i.UserData.data.playerId};r.GameCommonHttp.wxHttpPost("https://hsws.dcgstd.cn/rank-service/api/wx/rank/get",a,function(a,n){if(0==a&&null!=n){t.lastMonthRank=n.data.lastMonthNum;var o=n.data.lastPart;if(a=-1==n.data.rankNum?1e4:n.data.rankNum,t.userWorldData=new c(!0,l.LocalData.data.userInfo.nickName,l.LocalData.data.userInfo.avatarUrl,o,a),null!=(n=n.data.commands)){for(var i=0,r=n;i<r.length;i++){var s=r[i];null!=s.nickname&&null!=s.head&&null!=s.part&&null!=s.num&&(s=new c(s.self,s.nickname,s.head,s.part,s.num),t.worldDatas.push(s))}t.updateLocalRankDatas()}e&&e()}})},s.updateLocalRankDatas=function(){var e=l.LocalData.data.userInfo;if(null!=e&&!(null==this.userWorldData||null==this.userWorldData.part||this.userWorldData.part<=0)){for(var t=!1,a=0;a<this.worldDatas.length;a++)null!=(n=this.worldDatas[a])&&null!=n.self&&null!=n.nickname&&null!=n.head&&null!=n.part&&null!=n.num&&n.self&&(n.part=this.userWorldData.part,t=!0);t||(e=new c(!0,e.nickName,e.avatarUrl,this.userWorldData.part,1e4),this.worldDatas.push(e)),this.worldDatas.sort(function(e,t){return t.part-e.part});var n,o=20<=this.worldDatas.length?20:this.worldDatas.length;for(a=0;a<o;a++)null!=(n=this.worldDatas[a])&&null!=n.self&&null!=n.nickname&&null!=n.head&&null!=n.part&&null!=n.num&&n.self&&(n.num=a+1,this.userWorldData.num=a+1)}},s.userWorldData=null,s.worldDatas=null,s.initWorldDatas=!1,s.currentRankOk=!1,s.lastMonthRankOk=!1,s.lastMonthRank=null,n=s,o.WorldRankingManager=n;var c=function(e,t,a,n,o){this.self=e,this.nickname=t,this.head=a,this.part=n,this.num=o};o.WorldData=c,cc._RF.pop()},{}],WxSDK:[function(e,t,a){"use strict";cc._RF.push(t,"65c77FSrwpCcocs34y/F198","WxSDK");var n=e,o=a;Object.defineProperty(o,"__esModule",{value:!0});var i=n("GameCommon"),l=n("ShareManager"),r=n("UserData"),s=n("TipManager"),c=n("GameCommonHttp"),p=n("StatisticsManager"),d=n("AddWxSmallGameConf"),u=n("LaunchOption"),h=n("TaskManager"),m=n("UserStorage"),f=n("MultiTouchManager");function g(){this.systemInfo=new y,this.onShowCall=null,this.onHideCall=null,this.onHideTime=0,this.shareCountMap=new Map,this.tempOnShowCall=null,this.feedbackButton=null,this.launchUpload=!1,this.levelShareFailCount=0,this.shareTime=0,this.shareType=null,this.shareInfo=null,this.onShare=!1,this.authorizationButton=null,this.keepScreenOn(),this.showShareMenu()}g.prototype.getSystemInfo=function(){return this.systemInfo},g.prototype.navigateToMiniProgram=function(e,t,a){if("function"==typeof wx.navigateToMiniProgram){null==t||""==t||-1==t.indexOf("?")?t="?adUserAppJump=true":t+="&adUserAppJump=true";try{wx.navigateToMiniProgram({appId:e,path:t,extraData:i.GameConfig.wxAppId,success:function(){a&&a(!0)},fail:function(){a&&a(!1)}})}catch(e){console.error(e)}}},g.prototype.previewImage=function(e,t){if((null!=e||null!=t)&&"function"==typeof wx.previewImage){t=t||new Array,null!=e&&t.push(e);try{wx.previewImage({urls:t})}catch(e){console.error(e)}}},g.prototype.showFeedbackButton=function(e,t,a,n,o){if("function"==typeof wx.createFeedbackButton){this.destroyFeedbackButton();try{var i=wx.createFeedbackButton({type:"image",image:o,text:"  ",style:{left:e,top:t,width:a,height:n}});i.show(),this.feedbackButton=i}catch(e){console.error(e)}}},g.prototype.destroyFeedbackButton=function(){null!=this.feedbackButton&&(this.feedbackButton.destroy(),this.feedbackButton=null)},g.prototype.setStorage=function(e,t){try{wx.setStorage({key:e,data:t})}catch(e){console.error(e)}},g.prototype.getStorage=function(e){try{return wx.getStorageSync(e)}catch(e){console.error(e)}},g.prototype.vibrateShort=function(){if("function"==typeof wx.vibrateShort)try{wx.vibrateShort()}catch(n){console.error(n)}},g.prototype.vibrateLong=function(){if("function"==typeof wx.vibrateLong)try{wx.vibrateLong()}catch(n){console.error(n)}},g.prototype.getLaunchOptions=function(){try{return wx.getLaunchOptionsSync()}catch(n){console.error(n)}},g.prototype.registerOnShow=function(e){this.onShowCall=e},g.prototype.registerOnHide=function(e){this.onHideCall=e},g.prototype.checkNewVersion=function(){var e;"function"==typeof wx.getUpdateManager?((e=wx.getUpdateManager()).onCheckForUpdate(function(e){e.hasUpdate&&console.log("\u53d1\u73b0\u65b0\u7248\u672c")}),e.onUpdateReady(function(){wx.showModal({title:"\u68c0\u6d4b\u5230\u65b0\u7248\u672c",content:"\u65b0\u7684\u7248\u672c\u5df2\u7ecf\u4e0b\u8f7d\u597d\uff0c\u662f\u5426\u7acb\u5373\u5e94\u7528\u65b0\u7248\u672c?",success:function(t){t.confirm?(console.log("\u7528\u6237\u9009\u66f4\u65b0"),e.applyUpdate()):t.cancel&&console.log("\u7528\u6237\u9009\u4e0d\u66f4\u65b0")}})}),e.onUpdateFailed(function(){console.warn("\u65b0\u7248\u672c\u4e0b\u8f7d\u5931\u8d25")})):console.log("getUpdateManager \u4e0d\u5b58\u5728")},g.prototype.keepScreenOn=function(){if("function"==typeof wx.setKeepScreenOn)try{wx.setKeepScreenOn({keepScreenOn:!0})}catch(n){console.error(n)}},g.prototype.showShareMenu=function(){if("function"==typeof wx.showShareMenu)try{wx.showShareMenu({withShareTicket:!0})}catch(n){console.error(n)}},g.prototype.loginTask=function(e,t){console.log("loginTask");try{var a=this;wx.login({success:function(t){e&&e(),console.log("wxLogin succ  res.code is : "+t.code),u.LaunchPacket.data.code=t.code,h.TaskManager.addTask(a.initSaveTask.bind(a))},fail:function(){t&&t(),wx.showModal({title:"\u767b\u9646\u5931\u8d25",content:"\u8bf7\u68c0\u67e5\u7f51\u7edc\u540e\u91cd\u8bd5~",showCancel:!1,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:function(e){e.confirm?h.TaskManager.addTask(a.loginTask.bind(a)):console.log("\u9009\u62e9\u53d6\u6d88\u767b\u9646")},fail:function(){console.log("\u9009\u62e9\u53d6\u6d88\u767b\u9646")}})}})}catch(e){console.error(e),t&&t()}},g.prototype.saveUserDataTask=function(e,t){var a,n;i.GameConfig.saveRemoteData&&r.UserData.data.openId?(n=r.UserData.getJsonStr(),(a={}).openId=r.UserData.data.openId,a.uuid=r.UserData.data.playerId,a.dataVersion=r.UserData.data.dataVersion,a.data=n,n=l.ShareManager.dataStorageUrl+"wx1a92f54b4acb3568",c.GameCommonHttp.wxHttpPost(n,a,function(a,n){console.log("get user data retCode:"+a),console.log("get user data retData: ",n),0==a?e&&e():t&&t()},!1)):e&&e()},g.prototype.uploadEvent=function(){var e=r.UserData.getUploadEventData();m.UserStorage.data&&h.TaskManager.addTask(function(t,a){var n=l.ShareManager.newStatisticUrl+"upload/"+i.GameConfig.wxAppId;c.GameCommonHttp.wxHttpPost(n,e,function(e){0==e?(r.UserData.data.uploadEventData=null,t&&t()):a&&a()})}.bind(this))},g.prototype.appGameOnLanch=function(){var e;this.launchUpload||(this.launchUpload=!0,(e=this.getLaunchOptions())&&(this.onShow(e),console.log("appGameOnLanch")))},g.prototype.wxInitData=function(){var e=this;this.wxGetSystemInfo();var t=window.gameCommon.getSDK.getStorage(r.UserData.storageKey);t&&""!==t&&r.UserData.parseFromStr(t),i.GameConfig.saveRemoteData||(r.UserData.init=!0),wx.onShareAppMessage(function(){var t=l.ShareManager.getCityShareInfo();e.shareTime=Date.now(),e.shareType="\u53f3\u4e0a\u89d2\u5206\u4eab",e.shareInfo=t,e.onShare=!0;var a=t.convertCityText,n=t.shareImgUrl;return t="&shareType=\u53f3\u4e0a\u89d2\u5206\u4eab&shareImgUrl="+t.shareImgUrl+"&shareImgName="+t.shareImgName+"&shareText="+t.shareText,{title:a,imageUrl:n,query:e.getQueryParam(t),ald_desc:"\u53f3\u4e0a\u89d2\u5206\u4eab"}}),wx.onHide(function(){console.log("hide call"),e.onHideTime=Date.now();try{null!=e.onHideCall&&e.onHideCall()}catch(t){console.log(t)}0!=r.UserData.lastOnShowTime&&(r.UserData.data.stayTime=Math.round((Date.now()-r.UserData.lastOnShowTime)/1e3),r.UserData.lastOnShowTime=0),e.uploadEvent(),r.UserData.data.dataVersion++,e.setStorage(r.UserData.storageKey,r.UserData.getJsonStr()),h.TaskManager.addTask(e.saveUserDataTask.bind(e))}),wx.onShow(function(t){try{f.MultiTouchManager.resetCurrentTouchInfo(),e.onShare&&(e.onShare=!1,3e3<=Date.now()-e.onHideTime&&(r.UserData.data.shareSuccess++,r.UserData.userActions.shareSuccess++)),null!=e.tempOnShowCall&&(e.tempOnShowCall(t),e.tempOnShowCall=null),null!=e.onShowCall&&e.onShowCall(t)}catch(t){console.log(t)}e.onShow(t)});var a,n=this.getLaunchOptions();n&&n.query&&(a=n.query,t=n.scene,(n=u.LaunchPacket.data).scene=t,n.wxAdInfo=a.weixinadinfo),i.GameConfig.saveRemoteData&&(null!=r.UserData.data.openId?h.TaskManager.addTask(this.initSaveTask.bind(this)):h.TaskManager.addTask(this.loginTask.bind(this)))},g.prototype.initSaveTask=function(e,t){var a={};null!=r.UserData.data.openId?a.openId=r.UserData.data.openId:a.uuid=r.UserData.data.playerId,a.sourceType=u.LaunchPacket.data.scene,null!=u.LaunchPacket.data.wxAdInfo&&(a.aid=u.LaunchPacket.data.wxAdInfo),null!=u.LaunchPacket.data.code&&(a.code=u.LaunchPacket.data.code),a.dataVersion=r.UserData.data.dataVersion,c.GameCommonHttp.wxHttpPost("https://game.dcgstd.cn/api/v1/account/init/10/wx1a92f54b4acb3568",a,function(a,n){return r.UserData.init=!0,0!=a||null==n||0!=n.resCode||null==n.extra?(console.log("\u8c03\u7528init\u5931\u8d25\uff0cmsg:",n&&n.errMsg),void(t&&t())):(e&&e(),console.log("resData info :"+n.extra),null!=(n=JSON.parse(n.extra)).data&&(r.UserData.parseFromStr(n.data),n.dataVersion&&0<n.dataVersion&&(r.UserData.data.dataVersion=n.dataVersion)),null!=n.uuid&&(r.UserData.data.playerId=n.uuid),void(null!=n.openId&&(r.UserData.data.openId=n.openId)))})},g.prototype.onShow=function(e){var t,a,n,o;r.UserData.lastOnShowTime=Date.now(),0!=this.shareTime&&(2e3<=Date.now()-this.shareTime&&p.StatisticsManager.uploadSharePictureRecord(this.shareType,this.shareInfo,this.systemInfo.brand+this.systemInfo.model+this.systemInfo.system),this.shareTime=0),null!=e&&(console.log(e),a=e.scene,o=e.query,console.log(o),null!=o&&(!r.UserData.data.recieveAddGameReward&&d.AddTipConfig.rewardEvent&&(1103!=a&&1104!=a||(r.UserData.data.recieveAddGameReward=!0,console.log("\u9886\u53d6\u6dfb\u52a0\u5956\u6536\u85cf\u52b1"),cc.Component.EventHandler.emitEvents([d.AddTipConfig.rewardEvent],null))),null!=(n=o.sharePlayerId)&&n!=r.UserData.data.playerId&&(t=o.shareType,e=o.shareImgName,a=o.shareText,n=o.shareImgUrl,o=o.dmmShareTime,null!=t&&null!=e&&null!=a&&null!=n&&null!=o&&p.StatisticsManager.uploadClickPictureRecord(t,e,a,n,o,this.systemInfo.brand+this.systemInfo.model+this.systemInfo.system))))},g.prototype.share=function(e,t,a,n,o){var i,r=this,c=l.ShareManager.getCityShareInfo();null!=c&&(this.shareTime=Date.now(),this.shareType=e,this.shareInfo=c,i=(i=(i=(i=null!=e?"&shareType="+e:"")+"&shareImgUrl="+c.shareImgUrl)+"&shareImgName="+c.shareImgName)+"&shareText="+c.shareText,null!=a&&a.forEach(function(e,t){i=i+"&"+t+"="+e}),a=c.convertCityText,c=c.shareImgUrl,this.baseShareMsg(a,c,i,e),o&&((o=l.ShareManager.getShareControlType())!=l.ShareControlType.ShareAndAdClose&&o!=l.ShareControlType.ShareCloseAndAdOpen?(o=this.shareCountMap.has(e)?this.shareCountMap.get(e):0,this.tempOnShowCall=0==(o%=3)?function(){r.shareCountMap.set(e,1),l.ShareManager.getAbonormalShareControl()&&s.TipManager.showTip("\u8bf7\u6362\u4e2a\u7fa4\u8bd5\u8bd5\u54e6~"),n(null,!1)}:1==o?function(){3e3<=Date.now()-r.onHideTime?(r.shareCountMap.set(e,2),n(null,!0)):(l.ShareManager.getAbonormalShareControl()&&s.TipManager.showTip("\u77ed\u65f6\u95f4\u5185\uff0c\u4e0d\u8981\u5206\u4eab\u540c\u4e00\u4e2a\u7fa4"),n(null,!1))}:function(){3e3<=Date.now()-r.onHideTime?(r.shareCountMap.set(e,0),n(null,!0)):(l.ShareManager.getAbonormalShareControl()&&s.TipManager.showTip("\u77ed\u65f6\u95f4\u5185\uff0c\u4e0d\u8981\u5206\u4eab\u540c\u4e00\u4e2a\u7fa4"),n(null,!1))}):n&&n(null,!0)))},g.prototype.levelShare=function(e,t){var a,n,o=this,i=l.ShareManager.getShareControlType();i!=l.ShareControlType.ShareAndAdClose&&i!=l.ShareControlType.ShareCloseAndAdOpen?null!=(n=l.ShareManager.getCityShareInfo())&&(this.shareTime=Date.now(),a=(null!=(this.shareType=e)?"&shareType="+e:"")+"&shareImgUrl="+(this.shareInfo=n).shareImgUrl+"&shareImgName="+n.shareImgName+"&shareText="+n.shareText,i=n.convertCityText,n=n.shareImgUrl+"?timestate="+this.shareTime,this.baseShareMsg(i,n,a,e),l.ShareManager.getAbonormalShareControl()?this.tempOnShowCall=function(){var e=!1,a=Date.now()-o.onHideTime,n=r.UserData.data.levelShareSuccCount;(e=2e3<=a?n<2||(n<5?4<=o.levelShareFailCount||3e3<=a:4<=o.levelShareFailCount||5e3<=a):e)?(r.UserData.data.levelShareSuccCount++,o.levelShareFailCount=0,t(!0,!0)):(o.levelShareFailCount++,t(!1,!0))}:this.tempOnShowCall=function(){t(!0,!0)}):t&&t(!0,!0)},g.prototype.clearTripleLie=function(e){null!=e&&this.shareCountMap.delete(e)},g.prototype.baseShareMsg=function(e,t,a){this.onShare=!0,a={title:e,imageUrl:t,query:this.getQueryParam(a)},wx.shareAppMessage(a)},g.prototype.getQueryParam=function(e){var t="sharePlayerId="+r.UserData.data.playerId+"&channelId="+i.GameConfig.DefaultChannelId+"&dmmShareTime="+this.shareTime;return null!=m.UserStorage.data&&(t=t+"&sessionSourceAppId="+m.UserStorage.data.sourceAppId+"&sesseionWxAdInfo="+m.UserStorage.data.wxAdInfo),null!=e?t+"&"+e:t},g.prototype.isPhoneXScreen=function(){if(null==this.systemInfo)return!1;var e=this.systemInfo.screenWidth,t=this.systemInfo.screenHeight;return 2<e/t||2<t/e},g.prototype.showWxModal=function(e,t,a,n){try{wx.showModal({title:e,content:t,showCancel:null!=n,cancelText:"\u53d6\u6d88",confirmText:"\u786e\u5b9a",success:function(e){e.confirm&&a&&a(),e.cancel&&n&&n()}})}catch(e){console.error(e)}},g.prototype.getMenuButtonBoundingClientRect=function(){if("function"!=typeof wx.getMenuButtonBoundingClientRect)return null;try{return wx.getMenuButtonBoundingClientRect()}catch(n){console.error(n)}},g.prototype.showWxLoading=function(e,t,a){if("function"==typeof wx.showLoading)try{wx.showLoading({title:e,mask:!0}),setTimeout(function(){wx.hideLoading(),null!=t&&t()},a)}catch(e){console.error(e)}},g.prototype.popWxAuthorization=function(e,t,a){var n=this;try{if("function"!=typeof wx.createUserInfoButton){var o=this;return void wx.getSetting({success:function(t){null!=t&&null!=t.authSetting&&null!=t.authSetting["scope.userInfo"]||wx.authorize({scope:"scope.userInfo",success:function(t){console.log(t),o.getUserInfo(e)}})}})}this.destroyAuthorizationButton();var i=this.systemInfo&&this.systemInfo.screenWidth,l=this.systemInfo&&this.systemInfo.screenHeight;if(this.authorizationButton=wx.createUserInfoButton({type:"image",image:t||"img/startGameButton.png",style:a||{left:0,top:0,width:i,height:l}}),!this.authorizationButton)return;this.authorizationButton.onTap(function(t){n.destroyAuthorizationButton(),null!=(t=t&&t.userInfo)&&(r.UserData.data.gender=t.gender),e&&e(t)})}catch(e){this.destroyAuthorizationButton(),console.error(e)}},g.prototype.destroyAuthorizationButton=function(){try{if(!this.authorizationButton)return;this.authorizationButton.destroy(),this.authorizationButton=null}catch(n){this.authorizationButton=null,console.error(n)}},g.prototype.getUserInfo=function(e){try{if("function"!=typeof wx.getUserInfo)return;wx.getUserInfo({success:function(t){null!=(t=t&&t.userInfo)&&(r.UserData.data.gender=t.gender),e&&e(t)}})}catch(e){console.error(e)}},g.prototype.wxGetSystemInfo=function(){try{var e=this,t=0;(function a(){wx.getSystemInfo({success:function(t){console.log(t),e.systemInfo.platform=t.platform,e.systemInfo.system=t.system,e.systemInfo.brand=t.brand,e.systemInfo.model=t.model,e.systemInfo.screenWidth=t.screenWidth,e.systemInfo.screenHeight=t.screenHeight,e.systemInfo.windowWidth=t.windowWidth,e.systemInfo.windowHeight=t.windowHeight,e.systemInfo.benchmarkLevel=t.benchmarkLevel,e.systemInfo.wechatVersion=t.version,e.systemInfo.SDKVersion=t.SDKVersion,e.systemInfo.pixelRatio=t.pixelRatio},fail:function(){5<=++t?console.error("wx.getSystemInfo fail 5"):a()}})})()}catch(e){console.error(e)}},n=g,o.WxSDK=n;var y=function(){this.screenWidth=0,this.screenHeight=0,this.windowWidth=0,this.windowHeight=0,this.benchmarkLevel=0,this.pixelRatio=0};o.SystemInfo=y,cc._RF.pop()},{}],getMoreGoldCoinUI:[function(e,t,a){"use strict";cc._RF.push(t,"d516fBM921NXZlDvCXAQXzl","getMoreGoldCoinUI");var n=e,o=t,i=a;Object.defineProperty(i,"__esModule",{value:!0});var l,r=n("LocalSoundManager"),s=n("LocalData"),c=n("TipManager"),p=n("GameConfigData"),d=n("ShareManager"),u=n("ShareVideoControl"),h=n("GameCommonPool"),m=n("UIManager");function f(){var e=null!==l&&l.apply(this,arguments)||this;return e.gemTimesLabel=null,e.allBg=null,e.lastEquipmentData=null,e}n=(o=cc._decorator).ccclass,o=o.property,l=cc.Component,__extends(f,l),f.prototype.onEnable=function(){this.gemTimesLabel.string=s.LocalData.data.getGemTimes+"",this.allBg.stopAllActions(),this.allBg.scale=.01,this.allBg.opacity=1,this.allBg.runAction(cc.spawn(cc.scaleTo(.3,1),cc.fadeIn(.3)))},f.prototype.bindData=function(e){this.lastEquipmentData=e},f.prototype.clickVideoGetGem=function(){var e,t,a=this;r.LocalSoundManager.playAudio("click"),s.LocalData.data.getGemTimes<1?c.TipManager.showTip("\u6b21\u6570\u4e0d\u8db3\uff01"):(e=function(){s.LocalData.changeGem(p.GameConfigData.data.gemNumGet),s.LocalData.data.getGemTimes--,c.TipManager.showTip("\u83b7\u5f97"+p.GameConfigData.data.gemNumGet+"\u94bb\u77f3"),a.gemTimesLabel.string=s.LocalData.data.getGemTimes+""},d.ShareManager.getShareControlType()!=d.ShareControlType.ShareAndAdClose&&cc.sys.platform===cc.sys.WECHAT_GAME?(t=d.ShareManager.configData&&d.ShareManager.configData.storeLimitAdTimes?d.ShareManager.configData.StoreLimitAdTimes:3,!d.ShareManager.shareFlags||!d.ShareManager.shareFlags.storeGetAdControl||s.LocalData.data.showAdTimes<t?u.ShareVideoControl.videoFunc("\u83b7\u5f97\u94bb\u77f3",e,null,e,null,null,u.VideoAdIdEnum.GET_GEM_ID):window.gameCommon.getSDK.share("\u83b7\u5f97\u94bb\u77f3",null,null,function(t,a){a&&e()},!0)):e())},f.prototype.clickBuyCoin1=function(){r.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=p.GameConfigData.data.coin1Cost?(s.LocalData.changeGem(-p.GameConfigData.data.coin1Cost),s.LocalData.changeCoin(p.GameConfigData.data.coin1Get),c.TipManager.showTip("\u83b7\u5f97"+p.GameConfigData.data.coin1Get+"\u91d1\u5e01")):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},f.prototype.clickBuyCoin2=function(){r.LocalSoundManager.playAudio("click"),s.LocalData.data.gemCount>=p.GameConfigData.data.coin2Cost?(s.LocalData.changeGem(-p.GameConfigData.data.coin2Cost),s.LocalData.changeCoin(p.GameConfigData.data.coin2Get),c.TipManager.showTip("\u83b7\u5f97"+p.GameConfigData.data.coin2Get+"\u91d1\u5e01")):c.TipManager.showTip("\u94bb\u77f3\u4e0d\u8db3\uff01")},f.prototype.btnCancel=function(){r.LocalSoundManager.playAudio("click"),this.close(),this.openLastEquipmentPop()},f.prototype.close=function(){h.GameCommonPool.returnInstant(this.node)},f.prototype.openLastEquipmentPop=function(){m.UIManager.showEquipmentPop(this.lastEquipmentData,null)},__decorate([o({type:cc.Label,displayName:"\u83b7\u5f97\u5b9d\u77f3\u6b21\u6570"})],f.prototype,"gemTimesLabel",void 0),__decorate([o({type:cc.Node,displayName:"\u80cc\u666f"})],f.prototype,"allBg",void 0),n=__decorate([n],f),i.getMoreGoldCoinUI=n,cc._RF.pop()},{}]},{},["0","AdManager","AddWxSmallGameConf","AddWxSmallGameTip","AppearEffect","Arrow","AuthorizationManager","AutoAtkBtnUI","BGMPlayer","BackHomeMoreGame","BackHomeReturn","BackHomeWarnUI","BattleNodeManager","BattleNum","BattleNumEffect","BattleNumManager","BattleNumSpecial","BattleStartUI","BattleUI","BgAni","BlastEffect","Body","BossBubbleText","BossFive","BossFlyHead","BossFour","BossOne","BossSeven","BossSix","BossThree","BossTwo","BoxItem","BoxReward","BoxUI","BroadcastManager","BubbleText","CanvasFit","CarouseRotate","CarouselButton","ChapterProgressRewardUI","CloakController","CollisionManager","CommonMask","CommonTip","CommonToast","ConfigData","Connecting","ContinueBattleUI","ConvertManager","CurrencyUI","DailyLoginButton","DailyLoginRoleShow","DamageUpEffect","DayliLogin","DayliLoginItem","DayliLoginManager","DeadEffect","DelayFadeOut","Dial","DialItem","DialManager","DivineShieldEffect","DropManager","DropedEquipment","EffectCreate","EggMachineUI","EllipseAction","EmergencyEquipmentEffect","EndlessBackUI","EndlessModelConfigData","EndlessRankingRewardItem","EndlessRankingRewardUI","EndlessRankingUI","EndlessReceiveRewardUI","EnemyArea","EnemyShield","EnumAndConst","EquipmentCombineUI","EquipmentConfigData","EquipmentEffectSystem","EquipmentItem","EquipmentListUI","EquipmentPopUI","EquipmentRankEffect","EquipmentSellUI","EquipmentUI","EvilDragonSpineController","Eye","FailTipUI","FeedBackManager","FitIphoneX","FlyDragon","FlyDragonSpineController","FlyHead","FlyHeadGhost","FootRest","FrozenEffect","FrozenImmuneEffect","FuryEffect","GameClub","GameCommon","GameCommonHttp","GameCommonPool","GameCommonUtil","GameConfigData","GameGuardSystem","GameManager","GamePauseUI","GameState","GetSkillUI","Head","Helmet","HomeGameItem","HorizontaBoxItem","HorizontaGameBox","HpSlider","ISDK","IgniteEffect","IncidentItem","InheritItem","InheritPopUI","InspireWallEffect","Laser","LaserCollider","LaunchOption","LightningAnimation","LightningEffect","Loading","LocalData","LocalDialUI","LocalGameCommon","LocalHorizontaBoxItem","LocalHorizontaGameBox","LocalSoundManager","LocalWorldEventType","LongEnemy","LongRoleBase","MagicBall","MagicBallBlast","MainBgWeapon","MainUI","MapElement","MapElementData","MapItem","MapManager","MoreGame","MoreGameItem","MoreGameManager","MultiTouchManager","Necromancer","NewBezier","NewLaser","NewRewardUI","NoobGuide","NpcRole","NumberImg","Operate","Player","PlayerManager","PlayerRoleUI","PlayerState","PlayerTip","Portal","PowerGetUI","PrefabUrl","RandomIncidentManager","RandomIncidentUI","RankingItem","RankingManager","RankingUI","RestoreEffect","RestoreMark","ReviveEffect","ReviveHaloEffect","ReviveUI","RewardItem","RobotAimed","RobotBurrow","RobotMixed","RoleBase","RoleBody","RoleData","RoleManager","RunDragon","RunDragonSpineController","SelectMapUI","SelectSkillPop","SettlementUI","ShareManager","ShareVideoControl","Sharker","Shield","ShieldDefender","ShieldWizard","ShortEnemy","ShortRoleBase","ShortZombie","SingleEffectManager","SkillData","SkillDescribeEffect","SkillDescriptionUI","SkillItem","SkillSystem","SliderLayout","SoundManager","SoundSwitch","SparkEffect","SpecailSkill","SpineController","SpottingArrow","SpriteFrameManager","StarUI","StatisticsManager","StoreUI","SuperMagicBall","Sword","TalentUI","TaskManager","ThornsChainsDamageEffect","ThornsChainsEffect","ThunderEffect","ThunderImmuneEffect","TimeController","Timer","TipManager","TipPoint","TransmitTouch","TurnHeartEffect","UIManager","UnlockSkillDetail","UnlockSkillUI","UserData","UserStorage","Util","VersionShow","VideoManager","Water","WebSDK","WizardEnemy","WorldEventManager","WorldEventType","WorldRankingManager","WxSDK","getMoreGoldCoinUI"]);